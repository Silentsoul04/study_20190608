ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6724736 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6esp ipsecv6-esp 1-13 14.3-19.3 20.2-25.1 25.3 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6esp.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IPSECV6-ESP/IPSECV6ESPpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IPSec ESP Anti Replay Window Size        32                  # (0x00000020)
IPSec ESP DUT Supports Configurable Lifetime True
IPSec ESP SA Lifetime Seconds            120                 # (0x00000078)
IPSec ESP SA Lifetime Bytes              1065                # (0x00000429)
IPSec ESP DUT Supports Transport Mode    True
IPSec DUT Supports Configurable Outbound SPD True
IPSec DUT Supports Anti Replay           True
IPSec Wait Time                          10                  # (0x0000000A)
IPSec DUT Supports Configurable Inbound SPD True
IPSec DUT Supports Explicit Congestion Notification True
IPSec DUT Supports Traffic Flow Confidentiality True
IPSecV6 ESP Suite Setup Command          "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Reset IP Security Command    "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Reset SA with Anti Replay Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Set SA Lifetime Bytes Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP Set SA Lifetime Seconds Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 ESP DUT Mode Configure Command   "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Inbound SPD for Protocol and Port Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Inbound SPD for Protocol Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Inbound SPD Policy for Subnet Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Inbound SPD Policy for Host Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 DUT Send Ping Command            "./DocScriptQ35/IPSECV6-ESP/ipsecv6-dut-send-ping-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Host Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Protocol and Port Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Set Outbound SPD for Protocol Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Add Outbound SPD Policy for Subnet Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-outbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 Remove ANVL from SA Command      "./DocScriptQ35/IPSECV6-ESP/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
IPSec DUT ECN Configure Command          "./DocScriptQ35/IPSECV6-ESP/ipsecv6-ecn-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for ICMP Type And Code Command "./DocScriptQ35/IPSECV6-ESP/ipsec-set-outbound-spd-icmp-type-code-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Outbound SPD Policy for Host Command ""
IPSec DUT Verify Audit Log for Bad SPI Command "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP DUT TFC Configure Command      "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-TFC-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP Set SA Lifetime Seconds Command ""
IPSec Set Inbound SPD for Protocol and Port Command ""
IPSec Set Inbound SPD for Host Command   ""
IPSecV6 DUT Uses Wildcard Identification True
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecv6esp.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:1111::5555
  IPV6 ANVL Address                        3ffe:1111::1111
  IPV6 Gateway                             3ffe:1111::5555
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:2222::5555
  IPV6 ANVL Address                        3ffe:2222::1111
  IPV6 Gateway                             3ffe:2222::5555
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Encapsulation                   v6Ov6
  IPSec Configuration                      Manual
  IPSec IPv6 Remote Host Address           3ffe:1111::1111
  IPSec IPv6 Local Host Address            3ffe:2222::1111
  IPSec ANVL SPI                           768               # (0x00000300)
  IPSec DUT SPI                            770               # (0x00000302)
  IPSec Authentication Algorithm           HMAC_MD5_96
  IPSec Authentication Key                 66306630663066306630663066302222
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          SHA
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                AH_MD5
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Authentication Algorithm    HMAC_MD5
  IPSec Encryption Algorithm               NULL_ENCRYPTION
  IPSec Encryption Key                     800000000000000040000000000000002000000000000000
  IPSec Encryption IV                      
  IKE Pre-Shared Key                       abcdefghijklmnopqrstuvwx

# Configuration File End.
%% VALIDATE CFG GLOBAL WARNING: 
! The current mode is not
! Automatic Mode.
! Therefore the following tests cannot be run: 13.2 17.1 20.2 
%% VALIDATE CFG GLOBAL WARNING: 
! The current Authentication algorithm is
! NOT NULL Authentication algorithm.
! Therefore the following tests cannot be run: 6.5 18.1 
%% VALIDATE CFG GLOBAL WARNING: 
! The current Encryption algorithm is not DES-CBC
! Therefore the following tests cannot be run: 5.1 5.2 9.1 9.2 9.3 
%% VALIDATE CFG GLOBAL WARNING: 
! The current Encryption algorithm is
! NULL Encryption algorithm.
! Therefore the following tests cannot be run: 7.5 7.7 
%% VALIDATE PRM GLOBAL WARNING: 
! The DUT does not support 64-bit Extended Sequence Number.
! Therefore the following tests cannot be run: 21.1 21.2 21.3 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL NOT_CONFIGURED NOT_CONFIGURED HMAC_MD5_96 NOT_CONFIGURED NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED NOT_CONFIGURED NOT_CONFIGURED NOT_CONFIGURED NOT_CONFIGURED

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "1"
sysvar: ipnet.inet.AcceptSourceRoute=1 ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 3ffe:1111::5555/64 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 3ffe:2222::5555/64 up
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5555 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 3ffe:1111::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5555 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 3ffe:1111::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5555 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 3ffe:1111::1111 < 3ffe:1111::5555 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:1111::5555 as 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555
33:33:FF:00:55:55 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:5555 < 3ffe:2222::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 3ffe:2222::1111 < 3ffe:2222::5555 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:2222::5555 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite IPSec Encapsulating Security Payload
RFC 4301: 'Security Architecture for the Internet Protocol'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)
RFC 2403: 'The Use of HMAC-MD5-96 within ESP and AH'
(C. Madson Cisco Systems Inc., R. Glenn NIST, November 1998)
RFC 2404: 'The Use of HMAC-SHA-1-96 within ESP and AH'
(C. Madson Cisco Systems Inc., R. Glenn NIST, November 1998)
RFC 2405: 'The ESP DES-CBC Cipher Algorithm With Explicit IV
(C. Madson Cisco Systems Inc., N. Doraswamy Bay Networks, Inc.,
November 1998)
RFC 4306: 'IP Encapsulating Security Payload'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)


ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the machine ANVL is running on is connected
to 2 interfaces that are connected to the device under test.

The ANVL config file must contain 2 IPv6 interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IPSECV6-ESP-1.1
TEST_DESCRIPTION
IPSec MUST accept an IPv6-datagram which is properly secured using
ESP protocol.
TEST_REFERENCE
RFC 4303 s2 p5 Encapsulating Security Payload Packet Format
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
-  DUT: Forward the ICMPv6 Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2074  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2075  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2076  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2077  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2078  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1502] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1501] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1503] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1504] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE 99 61 7F 22 0E 61 BA E2 6C 43 F3               ..a.".a..lC.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected unsecured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-1.1: Passed

>> IPSECV6-ESP-1.2
TEST_DESCRIPTION
Padding also may be required, irrespective of encryption
algorithm requirements, to ensure that the resulting
ciphertext terminates on a 4-byte boundary.
TEST_REFERENCE
RFC 4303 s2.4 p14 Padding (for Encryption)
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host with
        Pad Length and Next Header field right aligned within a
        4-byte word, with default padding of Pad Length equal to
        <padlength>
-  DUT: Forward the ICMPv6 Echo Request to Local Host
- CASE: <padlength> = 0
- CASE: <padlength> = 3
- CASE: <padlength> = 247
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2079  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2080  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2081  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2082  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2083  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1506] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1505] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1507] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1508] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Pad Length to 0 in ESP Trailer
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 22 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC078 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [14 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41         ANVL TEST DATA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CE 3B 3B DC 51 44 7C DB F9 94 39 A5               .;;.QD|...9.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 22 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC078 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [14 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41         ANVL TEST DATA
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected unsecured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Pad Length to 3 in ESP Trailer
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 19 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x14FE (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [11 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44                  ANVL TEST D
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8A 65 5E 6D 8D 8F B6 AE 32 0E FD 97               .e^m....2...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 19 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x14FE (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [11 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44                  ANVL TEST D
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected unsecured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Pad Length to 247 in ESP Trailer
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 324 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 15 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD75 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [7 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45                              ANVL TE
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [247 bytes] ---
ESP:  01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10   ................
ESP:  11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20   ............... 
ESP:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ESP:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ESP:  41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50   ABCDEFGHIJKLMNOP
ESP:  51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60   QRSTUVWXYZ[\]^_`
ESP:  61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70   abcdefghijklmnop
ESP:  71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 7F 80   qrstuvwxyz{|}~..
ESP:  81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F 90   ................
ESP:  91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F A0   ................
ESP:  A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF B0   ................
ESP:  B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF C0   ................
ESP:  C1 C2 C3 C4 C5 C6 C7 C8 C9 CA CB CC CD CE CF D0   ................
ESP:  D1 D2 D3 D4 D5 D6 D7 D8 D9 DA DB DC DD DE DF E0   ................
ESP:  E1 E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE EF F0   ................
ESP:  F1 F2 F3 F4 F5 F6 F7                              .......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 247 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BC 50 43 9B 42 50 B5 20 36 B0 4A 05               .PC.BP. 6.J.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 15 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xAD75 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [7 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45                              ANVL TE
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected unsecured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-1.2: Passed

>> IPSECV6-ESP-1.3
TEST_DESCRIPTION
A compliant Host imlementation MUST support IPsec(Transport mode)
between a pair of Hosts.
TEST_REFERENCE
rfc 4301, s3.1, p8 What IPsec does
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 echo request to DUT,
-  DUT: Send back ESP-secured Echo reply.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2084  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2085  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2086  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2087  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2088  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1510] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1509] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1511] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1512] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ndp -i gei0 -s 3ffe:1111::1111 00:06:29:99:70:78 
Cmd: 'ndp' not found.
C interp: cannot evaluate command
-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2089  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -enc none -ingress  
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2090  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2091  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:1111::5555/128
------------------------------------------
-> cmd keyadm add -proto esp -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -enc none 
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2092  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2093  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:1111::5555/128
 DSTFLOW: addr=3ffe:1111::1111/128
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1514] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1513] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1515] :: use src=3ffe:1111::1111/128:any dst=3ffe:1111::5555/128:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1516] :: use src=3ffe:1111::5555/128:any dst=3ffe:1111::1111/128:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::5555)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 00 00 00 00 05 80 00 6D 23 00 00 00 00   ..........m#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6A 90 B0 A9 FD 69 A9 B2 EB 16 5E 77               j....i....^w
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 02 00 00 00 02 81 00 6C 23 00 00 00 00   ..........l#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6B 0D B7 77 6C E4 B3 0A 5E 47 31 27               k..wl...^G1'
ESP: --- Authentication Data End ---
ESP:

Received expected ESP-secured IPv6 packet on interface 
eth3 (3ffe:1111::1111) 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2094  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2095  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2096  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2097  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2098  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1518] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1517] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1519] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1520] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-1.3: Passed

>> IPSECV6-ESP-1.4
TEST_DESCRIPTION
In Transport mode, ESP is inserted after the IP header and before the
next layer protocol.
(Note: This is basic test for Transport Mode)
TEST_REFERENCE
rfc 4303, s3.1.1, p18, Transport mode processing
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request to DUT.
-  DUT: Send back ESP-secured ICMPv6 Echo Reply.
- ANVL: Verify that the ESP Header is placed in between the original IPv6
        header and the payload data.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2099  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2100  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2101  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2102  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2103  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1522] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1521] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1523] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1524] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ndp -i gei0 -s 3ffe:1111::1111 00:06:29:99:70:78 
Cmd: 'ndp' not found.
C interp: cannot evaluate command
-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2104  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -enc none -ingress  
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2105  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2106  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:1111::5555/128
------------------------------------------
-> cmd keyadm add -proto esp -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -enc none 
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2107  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2108  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:1111::5555/128
 DSTFLOW: addr=3ffe:1111::1111/128
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1526] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1525] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1527] :: use src=3ffe:1111::1111/128:any dst=3ffe:1111::5555/128:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1528] :: use src=3ffe:1111::5555/128:any dst=3ffe:1111::1111/128:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::5555)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 00 00 00 00 06 80 00 6D 23 00 00 00 00   ..........m#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A8 89 5B 77 BE C8 98 DE 72 7E 10 CE               ..[w....r~..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB803 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB803 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB803 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Incorrectly, no regular ESP packet received on! interface eth3 (3ffe:1111::1111) 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2109  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2110  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2111  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2112  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2113  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1530] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1529] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1531] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1532] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-1.4: !FAILED!

>> IPSECV6-ESP-2.1
TEST_DESCRIPTION
If the computed and received ICV's match, then the datagram is valid,
and it is accepted.  If the test fails, then the receiver MUST
discard the received IP datagram as invalid
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.4.1 p30 Integrity Check Value Verification
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
        containing an incorrectly computed ICV in the AuthData
        field of ESP Header
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2114  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2115  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2116  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2117  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2118  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1534] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1533] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1535] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1536] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  00 35 05 B8 D3 DD A0 48 15 DF 7A C4               .5.....H..z.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-2.1: Passed

>> IPSECV6-ESP-2.2
TEST_DESCRIPTION
 The set of SPI values in the range 1 through 255 are reserved
by the Internet Assigned Numbers Authority (IANA) for future use;
a reserved SPI value will not normally be assigned by IANA unless
the use of the assigned SPI value is specified in an RFC.
The SPI value of zero (0) is reserved for local, implementation-
specific use and MUST NOT be sent on the wire.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.1 p11 Security Parameter Index
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
        containing SPI <invalid-SPI> in ESP Header
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
- CASE: <invalid-SPI> = 0
- CASE: <invalid-SPI> = 1
- CASE: <invalid-SPI> = 255
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2119  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2120  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2121  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2122  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2123  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1538] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1537] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1539] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1540] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the SPI Value in ESP Header to 0:
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000000 
ESP: Sequence Number          = 0x00000008 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  3D 5A 72 65 E4 1B FA 93 E8 10 E7 D5               =Zre........
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the SPI value in ESP Header to 1:
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000001 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D9 B9 C3 12 18 BA FB DA 72 8E DD D4               ........r...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the SPI Value in ESP Header to 255:
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x000000FF 
ESP: Sequence Number          = 0x0000000A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  58 A2 4F FF 84 55 52 F8 4E 34 49 82               X.O..UR.N4I.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-2.2: Passed

>> IPSECV6-ESP-2.4
TEST_DESCRIPTION
IPSec Should not discard an incoming ESP-secured IPv6 datagram
secured using a new SA if the Sequence Number in ESP Header is
not 1.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.2 p12 Sequence Number
NEGATIVE: RFC 4303 s3.4.3 p28 Sequence Number verification
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host containing
        the value 2 in the Sequence Number field of the ESP Header
-  DUT: Forward the ICMPv6 Echo Request to Local Host
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2124  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2125  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2126  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2127  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2128  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1542] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1541] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1543] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1544] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Set the Sequence Number to 2 in ESP Header
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE A6 4A 0C 42 A4 E8 CB FD F1 75 7A               ..J.B.....uz
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, received IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-2.4: Passed

>> IPSECV6-ESP-2.5
TEST_DESCRIPTION
 The Payload Data field is mandatory and is an
integral number of bytes in length.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.3 p12 Payload Data
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
        containing zero-length Payload Data in ESP header
-  DUT: Do not forward the ICMPv6 Echo Response to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2129  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2130  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2131  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2132  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2133  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1546] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1545] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1547] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1548] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted IPv6 packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  46 90 DB 8F F0 CB 74 33 DA 04 5C 51               F.....t3..\Q
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for  IP Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-2.5: Passed

>> IPSECV6-ESP-2.6
TEST_DESCRIPTION
Padding also may be required, irrespective of encryption
algorithm requirements, to ensure that the resulting
ciphertext terminates on a 4-byte boundary.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.4 p14 Padding (for Encryption)
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host with
        Pad Length and Next Header field NOT right aligned within a
        4-byte word in ESP trailer
-  DUT: Do not forward the ICMPv6 Echo Request, to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2134  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2135  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2136  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2137  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2138  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1550] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1549] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1551] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1552] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 89 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: --- Bad Encrypted Payload Data [69 bytes] ---
ESP:  60 00 00 00 00 18 3A FF 3F FE 11 11 00 00 00 00   `.....:.?.......
ESP:  00 00 00 00 00 00 11 11 3F FE 22 22 00 00 00 00   ........?.""....
ESP:  00 00 00 00 00 00 11 11 80 00 A0 56 00 00 00 00   ...........V....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP:  01 02 00 03 29                                    ....)
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9C 5F A9 CD CE 83 AC 9E 51 2F 0E BB               ._......Q/..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-2.6: Passed

>> IPSECV6-ESP-2.7
TEST_DESCRIPTION
If Padding bytes are needed but the encryption algorithm does not
specify the padding contents, then the following default processing
MUST be used.  The Padding bytes are initialized with a series of
(unsigned, 1-byte) integer values.  The first padding byte appended
to the plaintext is numbered 1, with subsequent padding bytes making
up a monotonically increasing sequence: 1, 2, 3, ...
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.4 p15 Padding (for Encryption)
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host with
        Padding field in ESP Trailer set to <padding>
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
- CASE: <padding> = 0,0,0,... (all zeros)
- CASE: <padding> = 1,1,1,    (all ones)
- CASE: <padding> = 2,3,... (not starting from 1)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2139  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2140  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2141  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2142  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2143  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1554] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1553] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1555] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1556] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Padding bits to 0,0,... in ESP Trailer
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 328 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [255 bytes] ---
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00      ...............
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 255 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  29 9A 42 E2 8F F2 1E BA 7D 2F 1B 17               ).B.....}/..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111)  (Local Host)


Case: Set the Padding bits to 1,1,... in ESP Trailer
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 328 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [255 bytes] ---
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01      ...............
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 255 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A5 3B 8D 4E FE 9E 49 0A 95 6D 2D AE               .;.N..I..m-.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111)  (Local Host)


Case: Set the Padding bits to 2,3,4,... in ESP Trailer
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 328 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [255 bytes] ---
ESP:  02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10 11   ................
ESP:  12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21   .............. !
ESP:  22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31   "#$%&'()*+,-./01
ESP:  32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41   23456789:;<=>?@A
ESP:  42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51   BCDEFGHIJKLMNOPQ
ESP:  52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61   RSTUVWXYZ[\]^_`a
ESP:  62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71   bcdefghijklmnopq
ESP:  72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 7F 80 81   rstuvwxyz{|}~...
ESP:  82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F 90 91   ................
ESP:  92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F A0 A1   ................
ESP:  A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF B0 B1   ................
ESP:  B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF C0 C1   ................
ESP:  C2 C3 C4 C5 C6 C7 C8 C9 CA CB CC CD CE CF D0 D1   ................
ESP:  D2 D3 D4 D5 D6 D7 D8 D9 DA DB DC DD DE DF E0 E1   ................
ESP:  E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE EF F0 F1   ................
ESP:  F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF 00      ...............
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 255 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  72 7F F5 E3 D9 CF 59 14 4B 34 05 5E               r.....Y.K4.^
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111)  (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-2.7: Passed

>> IPSECV6-ESP-3.1
TEST_DESCRIPTION
IPSec configured in Tunnel Mode MUST discard an incoming ESP-secured
IPv6 datagram, if it is secured in Transport mode.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.1 p19 ESP Header Location
TEST_METHOD
- ANVL: Send a Transport Mode ESP-Secured ICMPv6 Echo Request from
        Remote Host
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2144  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2145  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2146  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2147  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2148  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1558] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1557] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1559] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1560] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 00 00 00 00 07 80 00 6D 23 00 00 00 00   ..........m#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  95 F5 33 2A E9 62 E9 85 A9 99 8C 2C               ..3*.b.....,
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly did not receive IPv6 packet on interface eth4 (3ffe:2222::1111)(Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-3.1: Passed

>> IPSECV6-ESP-3.2
TEST_DESCRIPTION
The protocol header (IPv4, IPv6, or Extension) immediately preceding
the ESP header will contain the value 50 in its Protocol (IPv4) or
Next Header (IPv6, Extension) field
TEST_REFERENCE
RFC 4303 s2 p5 Encapsulating Security Payload Packet Format
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host with
        Next Header field in outer IPv6-Header containing
        the value <proto>
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
- CASE: <proto> = 49
- CASE: <proto> = 52
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2149  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2150  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2151  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2152  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2153  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1562] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1561] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1563] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1564] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Protocol to 49 in Outer IPv6
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = *UNKNOWN* (49)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
IPV6: --- Trailing Data [88 bytes] ---
IPV6:  00 00 03 00 00 00 00 08 60 00 00 00 00 18 3A FF   ........`.....:.
IPV6:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 11 11   ?...............
IPV6:  3F FE 22 22 00 00 00 00 00 00 00 00 00 00 11 11   ?.""............
IPV6:  80 00 A0 56 00 00 00 00 41 4E 56 4C 20 54 45 53   ...V....ANVL TES
IPV6:  54 20 44 41 54 41 20 20 01 02 02 29 BE D6 22 03   T DATA  ...)..".
IPV6:  FA CD BF 22 F4 77 58 30                           ...".wX0
IPV6: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Set the Protocol to 52 in Outer IPv6
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = *UNKNOWN* (52)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
IPV6: --- Trailing Data [88 bytes] ---
IPV6:  00 00 03 00 00 00 00 09 60 00 00 00 00 18 3A FF   ........`.....:.
IPV6:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 11 11   ?...............
IPV6:  3F FE 22 22 00 00 00 00 00 00 00 00 00 00 11 11   ?.""............
IPV6:  80 00 A0 56 00 00 00 00 41 4E 56 4C 20 54 45 53   ...V....ANVL TES
IPV6:  54 20 44 41 54 41 20 20 01 02 02 29 7D 32 7E C2   T DATA  ...)}2~.
IPV6:  8B 7A 73 69 1F 13 C0 01                           .zsi....
IPV6: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-3.2: Passed

>> IPSECV6-ESP-4.1
TEST_DESCRIPTION
For use with either ESP or AH, a truncated value using
the first 96 bits MUST be supported.
TEST_REFERENCE
NEGATIVE: RFC 2403 s2 p2 Algorithm and Mode
          RFC 2404 s2 p2 Algorithm and Mode
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host with
        Authentication Data of length 88 bits (!= 96 bits)
-  DUT: Do not forward the ICMPv6 Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2154  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2155  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2156  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2157  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2158  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1566] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1565] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1567] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1568] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 87 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: --- Bad Encrypted Payload Data [67 bytes] ---
ESP:  60 00 00 00 00 18 3A FF 3F FE 11 11 00 00 00 00   `.....:.?.......
ESP:  00 00 00 00 00 00 11 11 3F FE 22 22 00 00 00 00   ........?.""....
ESP:  00 00 00 00 00 00 11 11 80 00 A0 56 00 00 00 00   ...........V....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP:  01 02 02                                          ...
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  29 4A D6 2F 11 A2 A9 39 22 6A 03 9C               )J./...9"j..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-4.1: Passed

>> IPSECV6-ESP-6.1
TEST_DESCRIPTION
Packets that contain Sequence Numbers lower than the 
left edge of the window are rejected while using Authentication.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host containing
        the value 1 in the Sequence Number field of the ESP Header
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
        containing the value (<window-size> + 2) in the Sequence
        Number field of the ESP header
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host
        containing the value 2 in the Sequence Number field of the
        ESP Header
-  DUT: Do not forward the corresponding ICMPv6 Echo Request to
        Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2159  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2160  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2161  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2162  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2163  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1570] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1569] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1571] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1572] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ANVL_REPLAY_WINDOW_SIZE=32

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 1
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE 99 61 7F 22 0E 61 BA E2 6C 43 F3               ..a.".a..lC.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending encrypted ICMPv6 Echo-Request with Sequence Number: 34
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000022 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  17 BE 64 6A E0 C6 67 A6 50 E4 21 8F               ..dj..g.P.!.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending encrypted ICMPV6 Echo-Request with Sequence Number: 2
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE A6 4A 0C 42 A4 E8 CB FD F1 75 7A               ..J.B.....uz
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-6.1: Passed

>> IPSECV6-ESP-6.2
TEST_DESCRIPTION
If the received packet falls within the window and is new, or if the
packet is to the right of the window, then the receiver proceeds to
ICV verification. 
TEST_REFERENCE
RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host containing
        the value 1 in the Sequence Number field of the ESP Header
-  DUT: Forward the corresponding ICMPv6 Echo Request
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host containing
        the value <window-size> in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Send (<window-size> - 2) ESP-secured ICMPv6 Echo Requests from
        Remote Host, with Sequence Numbers from 2 to
        (<window-size> - 1)
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2164  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2165  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2166  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2167  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2168  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1574] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1573] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1575] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1576] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ANVL_REPLAY_WINDOW_SIZE=32

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 1
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE 99 61 7F 22 0E 61 BA E2 6C 43 F3               ..a.".a..lC.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending encrypted ICMPv6 Echo-Request with Sequence Number: 32
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000020 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2C 21 8A A6 52 6D 0E 7E 1A 5B 00 6D               ,!..Rm.~.[.m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending secured ICMPv6 Echo-Request with Sequence Number: 2
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE A6 4A 0C 42 A4 E8 CB FD F1 75 7A               ..J.B.....uz
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 2
Sending secured ICMPv6 Echo-Request with Sequence Number: 3
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1A C0 4A 62 E8 5A 54 E8 ED 96 4E FF               ..Jb.ZT...N.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 3
Sending secured ICMPv6 Echo-Request with Sequence Number: 4
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 BA A7 89 81 41 45 58 92 43 F0 93               R....AEX.C..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 4
Sending secured ICMPv6 Echo-Request with Sequence Number: 5
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 8F D9 F0 10 1C DA EC 1E 3C D8 9E               I........<..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 5
Sending secured ICMPv6 Echo-Request with Sequence Number: 6
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4B E2 FF 2E D9 91 62 D9 AB 33 5F 45               K.....b..3_E
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 6
Sending secured ICMPv6 Echo-Request with Sequence Number: 7
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9A 35 05 B8 D3 DD A0 48 15 DF 7A C4               .5.....H..z.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 7
Sending secured ICMPv6 Echo-Request with Sequence Number: 8
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BE D6 22 03 FA CD BF 22 F4 77 58 30               .."....".wX0
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 8
Sending secured ICMPv6 Echo-Request with Sequence Number: 9
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7D 32 7E C2 8B 7A 73 69 1F 13 C0 01               }2~..zsi....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 9
Sending secured ICMPv6 Echo-Request with Sequence Number: 10
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4A D6 2F 11 A2 A9 39 22 6A 03 9C 6D               J./...9"j..m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 10
Sending secured ICMPv6 Echo-Request with Sequence Number: 11
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4F 21 81 80 E0 86 05 3D 54 11 05 F2               O!.....=T...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 11
Sending secured ICMPv6 Echo-Request with Sequence Number: 12
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1B 7D 65 74 F4 E1 7B 32 99 42 EE 80               .}et..{2.B..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 12
Sending secured ICMPv6 Echo-Request with Sequence Number: 13
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  80 2F E9 B6 68 61 57 98 13 CA AF F2               ./..haW.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 13
Sending secured ICMPv6 Echo-Request with Sequence Number: 14
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FB E9 64 81 54 FC C8 16 DD D0 E4 6D               ..d.T......m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 14
Sending secured ICMPv6 Echo-Request with Sequence Number: 15
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0F 7D 81 D2 73 67 E4 2D AF 03 5A 59               .}..sg.-..ZY
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 15
Sending secured ICMPv6 Echo-Request with Sequence Number: 16
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  82 3B 69 3A 36 03 3B 2A 42 1B DD 65               .;i:6.;*B..e
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 16
Sending secured ICMPv6 Echo-Request with Sequence Number: 17
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DB A5 C4 E8 95 35 58 93 D1 F2 5B 50               .....5X...[P
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 17
Sending secured ICMPv6 Echo-Request with Sequence Number: 18
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F9 24 69 22 75 01 58 D3 E6 B9 09 2F               .$i"u.X..../
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 18
Sending secured ICMPv6 Echo-Request with Sequence Number: 19
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FF 70 CA D0 CA D5 9B A0 1E AD D4 55               .p.........U
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 19
Sending secured ICMPv6 Echo-Request with Sequence Number: 20
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C5 BF D8 5D AD 03 01 A0 11 51 C3 4B               ...].....Q.K
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 20
Sending secured ICMPv6 Echo-Request with Sequence Number: 21
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000015 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AA 06 D8 3F 11 5F BB 5C C4 B1 B4 17               ...?._.\....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 21
Sending secured ICMPv6 Echo-Request with Sequence Number: 22
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  11 98 0D 51 72 91 C2 89 7C 0C 98 75               ...Qr...|..u
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 22
Sending secured ICMPv6 Echo-Request with Sequence Number: 23
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000017 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D7 8A 0D C5 2A 36 B0 F6 5C 02 B6 CD               ....*6..\...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 23
Sending secured ICMPv6 Echo-Request with Sequence Number: 24
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000018 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  77 E8 03 A9 24 4E 8D DC 5A AA 39 6F               w...$N..Z.9o
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 24
Sending secured ICMPv6 Echo-Request with Sequence Number: 25
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  29 06 AE 48 5D D3 E4 42 53 05 DF B0               )..H]..BS...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 25
Sending secured ICMPv6 Echo-Request with Sequence Number: 26
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F3 F5 0F 85 BB A0 AB E0 B6 9C 0D 2F               .........../
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 26
Sending secured ICMPv6 Echo-Request with Sequence Number: 27
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  91 1A 6B 23 77 64 61 C6 39 97 41 6E               ..k#wda.9.An
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 27
Sending secured ICMPv6 Echo-Request with Sequence Number: 28
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9C B4 F9 56 A6 A4 3D 21 3D D3 60 F5               ...V..=!=.`.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 28
Sending secured ICMPv6 Echo-Request with Sequence Number: 29
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A8 FC 6C F4 C6 32 78 F7 41 11 FF 9D               ..l..2x.A...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 29
Sending secured ICMPv6 Echo-Request with Sequence Number: 30
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 B7 0B BD 62 5C 5C E4 7E 2E AD 2C               ....b\\.~..,
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 30
Sending secured ICMPv6 Echo-Request with Sequence Number: 31
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5B 77 29 55 52 BB C8 83 59 C7 0E 1C               [w)UR...Y...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 31

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-6.2: Passed

>> IPSECV6-ESP-6.3
TEST_DESCRIPTION
IPSec MUST discard an ESP-secured IPv6-datagram that has same Sequence
Number in ESP Header as a previously received datagram falling within
replay window.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host
        containing the value 1 in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host containing
        the value <window-size> in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Send (<window-size> - 2) ESP-secured ICMPv6 Echo Requests from
        Remote Host, with Sequence Numbers from 2 to
       (<window-size> - 1)
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Send (<window-size> - 2) ESP-secured ICMPv6 Echo Requests from
        Remote Host, with Sequence Numbers from 2 to
        (<window-size> - 1)
-  DUT: Do not forward any ICMPv6 Echo Requests to Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2169  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2170  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2171  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2172  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2173  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1578] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1577] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1579] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1580] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ANVL_REPLAY_WINDOW_SIZE=32

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 Echo-Request with Seyquence Number: 1
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE 99 61 7F 22 0E 61 BA E2 6C 43 F3               ..a.".a..lC.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending encrypted ICMPv6 Echo-Request with Sequence Number: 32
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000020 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2C 21 8A A6 52 6D 0E 7E 1A 5B 00 6D               ,!..Rm.~.[.m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending secured ICMPv6 Echo-Request with Sequence Number: 2
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE A6 4A 0C 42 A4 E8 CB FD F1 75 7A               ..J.B.....uz
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 2
Sending secured ICMPv6 Echo-Request with Sequence Number: 3
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1A C0 4A 62 E8 5A 54 E8 ED 96 4E FF               ..Jb.ZT...N.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 3
Sending secured ICMPv6 Echo-Request with Sequence Number: 4
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 BA A7 89 81 41 45 58 92 43 F0 93               R....AEX.C..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 4
Sending secured ICMPv6 Echo-Request with Sequence Number: 5
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 8F D9 F0 10 1C DA EC 1E 3C D8 9E               I........<..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 5
Sending secured ICMPv6 Echo-Request with Sequence Number: 6
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4B E2 FF 2E D9 91 62 D9 AB 33 5F 45               K.....b..3_E
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 6
Sending secured ICMPv6 Echo-Request with Sequence Number: 7
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9A 35 05 B8 D3 DD A0 48 15 DF 7A C4               .5.....H..z.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 7
Sending secured ICMPv6 Echo-Request with Sequence Number: 8
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BE D6 22 03 FA CD BF 22 F4 77 58 30               .."....".wX0
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 8
Sending secured ICMPv6 Echo-Request with Sequence Number: 9
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7D 32 7E C2 8B 7A 73 69 1F 13 C0 01               }2~..zsi....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 9
Sending secured ICMPv6 Echo-Request with Sequence Number: 10
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4A D6 2F 11 A2 A9 39 22 6A 03 9C 6D               J./...9"j..m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 10
Sending secured ICMPv6 Echo-Request with Sequence Number: 11
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4F 21 81 80 E0 86 05 3D 54 11 05 F2               O!.....=T...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 11
Sending secured ICMPv6 Echo-Request with Sequence Number: 12
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1B 7D 65 74 F4 E1 7B 32 99 42 EE 80               .}et..{2.B..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 12
Sending secured ICMPv6 Echo-Request with Sequence Number: 13
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  80 2F E9 B6 68 61 57 98 13 CA AF F2               ./..haW.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 13
Sending secured ICMPv6 Echo-Request with Sequence Number: 14
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FB E9 64 81 54 FC C8 16 DD D0 E4 6D               ..d.T......m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 14
Sending secured ICMPv6 Echo-Request with Sequence Number: 15
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0F 7D 81 D2 73 67 E4 2D AF 03 5A 59               .}..sg.-..ZY
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 15
Sending secured ICMPv6 Echo-Request with Sequence Number: 16
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  82 3B 69 3A 36 03 3B 2A 42 1B DD 65               .;i:6.;*B..e
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 16
Sending secured ICMPv6 Echo-Request with Sequence Number: 17
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DB A5 C4 E8 95 35 58 93 D1 F2 5B 50               .....5X...[P
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 17
Sending secured ICMPv6 Echo-Request with Sequence Number: 18
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F9 24 69 22 75 01 58 D3 E6 B9 09 2F               .$i"u.X..../
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 18
Sending secured ICMPv6 Echo-Request with Sequence Number: 19
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FF 70 CA D0 CA D5 9B A0 1E AD D4 55               .p.........U
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 19
Sending secured ICMPv6 Echo-Request with Sequence Number: 20
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C5 BF D8 5D AD 03 01 A0 11 51 C3 4B               ...].....Q.K
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 20
Sending secured ICMPv6 Echo-Request with Sequence Number: 21
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000015 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AA 06 D8 3F 11 5F BB 5C C4 B1 B4 17               ...?._.\....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 21
Sending secured ICMPv6 Echo-Request with Sequence Number: 22
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  11 98 0D 51 72 91 C2 89 7C 0C 98 75               ...Qr...|..u
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 22
Sending secured ICMPv6 Echo-Request with Sequence Number: 23
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000017 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D7 8A 0D C5 2A 36 B0 F6 5C 02 B6 CD               ....*6..\...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 23
Sending secured ICMPv6 Echo-Request with Sequence Number: 24
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000018 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  77 E8 03 A9 24 4E 8D DC 5A AA 39 6F               w...$N..Z.9o
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 24
Sending secured ICMPv6 Echo-Request with Sequence Number: 25
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  29 06 AE 48 5D D3 E4 42 53 05 DF B0               )..H]..BS...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 25
Sending secured ICMPv6 Echo-Request with Sequence Number: 26
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F3 F5 0F 85 BB A0 AB E0 B6 9C 0D 2F               .........../
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 26
Sending secured ICMPv6 Echo-Request with Sequence Number: 27
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  91 1A 6B 23 77 64 61 C6 39 97 41 6E               ..k#wda.9.An
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 27
Sending secured ICMPv6 Echo-Request with Sequence Number: 28
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9C B4 F9 56 A6 A4 3D 21 3D D3 60 F5               ...V..=!=.`.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 28
Sending secured ICMPv6 Echo-Request with Sequence Number: 29
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A8 FC 6C F4 C6 32 78 F7 41 11 FF 9D               ..l..2x.A...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 29
Sending secured ICMPv6 Echo-Request with Sequence Number: 30
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 B7 0B BD 62 5C 5C E4 7E 2E AD 2C               ....b\\.~..,
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 30
Sending secured ICMPv6 Echo-Request with Sequence Number: 31
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5B 77 29 55 52 BB C8 83 59 C7 0E 1C               [w)UR...Y...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded corresponding ICMPv6 Echo-Request: 31
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 2
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE A6 4A 0C 42 A4 E8 CB FD F1 75 7A               ..J.B.....uz
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 3
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1A C0 4A 62 E8 5A 54 E8 ED 96 4E FF               ..Jb.ZT...N.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 4
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 BA A7 89 81 41 45 58 92 43 F0 93               R....AEX.C..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 5
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 8F D9 F0 10 1C DA EC 1E 3C D8 9E               I........<..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 6
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4B E2 FF 2E D9 91 62 D9 AB 33 5F 45               K.....b..3_E
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 7
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9A 35 05 B8 D3 DD A0 48 15 DF 7A C4               .5.....H..z.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 8
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BE D6 22 03 FA CD BF 22 F4 77 58 30               .."....".wX0
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 9
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7D 32 7E C2 8B 7A 73 69 1F 13 C0 01               }2~..zsi....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 10
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4A D6 2F 11 A2 A9 39 22 6A 03 9C 6D               J./...9"j..m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 11
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4F 21 81 80 E0 86 05 3D 54 11 05 F2               O!.....=T...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 12
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1B 7D 65 74 F4 E1 7B 32 99 42 EE 80               .}et..{2.B..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 13
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  80 2F E9 B6 68 61 57 98 13 CA AF F2               ./..haW.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 14
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FB E9 64 81 54 FC C8 16 DD D0 E4 6D               ..d.T......m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 15
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0F 7D 81 D2 73 67 E4 2D AF 03 5A 59               .}..sg.-..ZY
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 16
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  82 3B 69 3A 36 03 3B 2A 42 1B DD 65               .;i:6.;*B..e
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 17
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DB A5 C4 E8 95 35 58 93 D1 F2 5B 50               .....5X...[P
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 18
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F9 24 69 22 75 01 58 D3 E6 B9 09 2F               .$i"u.X..../
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 19
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FF 70 CA D0 CA D5 9B A0 1E AD D4 55               .p.........U
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 20
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C5 BF D8 5D AD 03 01 A0 11 51 C3 4B               ...].....Q.K
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 21
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000015 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AA 06 D8 3F 11 5F BB 5C C4 B1 B4 17               ...?._.\....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 22
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  11 98 0D 51 72 91 C2 89 7C 0C 98 75               ...Qr...|..u
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 23
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000017 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D7 8A 0D C5 2A 36 B0 F6 5C 02 B6 CD               ....*6..\...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 24
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000018 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  77 E8 03 A9 24 4E 8D DC 5A AA 39 6F               w...$N..Z.9o
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 25
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  29 06 AE 48 5D D3 E4 42 53 05 DF B0               )..H]..BS...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 26
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F3 F5 0F 85 BB A0 AB E0 B6 9C 0D 2F               .........../
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 27
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  91 1A 6B 23 77 64 61 C6 39 97 41 6E               ..k#wda.9.An
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 28
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9C B4 F9 56 A6 A4 3D 21 3D D3 60 F5               ...V..=!=.`.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 29
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A8 FC 6C F4 C6 32 78 F7 41 11 FF 9D               ..l..2x.A...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 30
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 B7 0B BD 62 5C 5C E4 7E 2E AD 2C               ....b\\.~..,
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 31
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5B 77 29 55 52 BB C8 83 59 C7 0E 1C               [w)UR...Y...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-6.3: Passed

>> IPSECV6-ESP-6.4
TEST_DESCRIPTION
if the packet is either inside the window and new, or is outside
the window on the right side, the receiver MUST authenticate
the packet before updating the Sequence Number window data.
TEST_REFERENCE
RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host
        containing the value 1 in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
        containing the value (<window-size> + 2) in the Sequence
        Number field of the ESP header and with incorrect ICV in the
        AuthData field in ESP header
-  DUT: Do not forward the corresponding ICMPv6 Echo Request to
        Local Host
- ANVL: Send ESP-secured ICMPv6 Echo Request from Remote Host
        containing the value 2 in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMPv6 Echo Request to Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2174  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2175  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2176  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2177  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2178  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1582] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1581] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1583] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1584] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 32 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ANVL_REPLAY_WINDOW_SIZE=32

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 Echo-Request with Sequence Number: 1
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE 99 61 7F 22 0E 61 BA E2 6C 43 F3               ..a.".a..lC.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending encrypted ICMPv6 Echo-Request with Sequence Number: 34
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000022 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  00 BE 64 6A E0 C6 67 A6 50 E4 21 8F               ..dj..g.P.!.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Sending encrypted ICMPv6 Echo-Request with Sequence Number: 2
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DE A6 4A 0C 42 A4 E8 CB FD F1 75 7A               ..J.B.....uz
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT has correctly forwarded the corresponding ICMPv6 Echo-Request
on interface eth4(3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-6.4: Passed

>> IPSECV6-ESP-7.1
TEST_DESCRIPTION
The protocol header (IPv4, IPv6, or Extension) immediately preceding
the ESP header will contain the value 50 in its Protocol (IPv4) or
Next Header (IPv6, Extension) field
TEST_REFERENCE
RFC 4303 s2 p5 Encapsulating Security Payload Packet Format
TEST_METHOD
- ANVL: Send a ICMPv6 Echo Request using IPv6 from Local Host
-  DUT: Forward the ESP-secured ICMPv6 Echo Request to Remote Host
        containing the value 50 (ESP) in the Next Header field of the
        outer IPv6-Header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2179  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2180  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2181  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2182  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2183  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1586] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1585] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1587] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1588] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received Next Header in outer IPv6: 50
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.1: Passed

>> IPSECV6-ESP-7.2
TEST_DESCRIPTION
 The set of SPI values in the range 1 through 255 are reserved
by the Internet Assigned Numbers Authority (IANA) for future use;
a reserved SPI value will not normally be assigned by IANA unless
the use of the assigned SPI value is specified in an RFC.
TEST_REFERENCE
RFC 4303 s2.1 p11 Security Parameter Index
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host
-  DUT: Forward ESP-secured ICMPv6 Echo Request to Remote Host
        with SPI field in ESP Header set to value greater
        than 255
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2184  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2185  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2186  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2187  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2188  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1590] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1589] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1591] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1592] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received ESP spi value: 770
received on interface
 eth3 (3ffe:1111::1111)  (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.2: Passed

>> IPSECV6-ESP-7.3
TEST_DESCRIPTION
IPSec MUST set the SPI field in ESP Header in an encrypted outbound IP
datagram using the SPI value associated with the outbound SA
TEST_REFERENCE
RFC 4303 s2.1 p10 Security Parameters Index
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host
-  DUT: Forward ESP-secured ICMPv6 Echo Request to Remote Host
        with SPI field in ESP Header set to value associated
        with the outbound SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2189  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2190  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2191  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2192  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2193  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1594] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1593] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1595] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1596] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received ESP spi value: 770
received on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.3: Passed

>> IPSECV6-ESP-7.4
TEST_DESCRIPTION
IPSec MUST set the Pad Length and Next Header in the ESP Trailer such
that they are right aligned within a 4-byte word, while using NULL
Encryption Algo.
TEST_REFERENCE
RFC 4303 s2.4 p14 Padding
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host with
        <n> bytes of ULP Information
-  DUT: Forward the ESP-secured ICMPv6 Echo Request to Remote Host
        with Padding field in ESP Trailer set such that Pad-Length
        and Next-Header fields are right-aligned within a 4-byte word
- CASE: <n> = 6 (needs 4n bytes Padding, n>=0)
- CASE: <n> = 5 (needs (4n+1) bytes Padding, n>=0)
- CASE: <n> = 4 (needs (4n+2) bytes Padding, n>=0)
- CASE: <n> = 3 (needs (4n+3) bytes Padding, n>=0)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2194  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2195  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2196  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2197  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2198  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1598] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1597] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1599] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1600] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: send ICMPv6 Echo Request with 6 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6D BB 8C AB 60 85 97 3E 63 6F 2E 9C               m...`..>co..
ESP: --- Authentication Data End ---
ESP:

Correctly received Pad Length field in ESP Trailer: 0
received on interface eth3 (3ffe:1111::1111) (Remote Host)


Case 2: send ICMPv6 Echo Request with 5 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [1 bytes] ---
ESP:  01                                                .
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 1 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  37 A0 FA C6 AA 01 A2 A3 E7 92 A1 9F               7...........
ESP: --- Authentication Data End ---
ESP:

Correctly received Pad Length field in ESP Trailer: 1
received on interface eth3 (3ffe:1111::1111) (Remote Host)


Case 3: send ICMPv6 Echo Request with 4 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BA E4 A2 92 90 95 29 62 37 14 1B AC               ......)b7...
ESP: --- Authentication Data End ---
ESP:

Correctly received Pad Length field in ESP Trailer: 2
received on interface eth3 (3ffe:1111::1111) (Remote Host)


Case 4: send ICMPv6 Echo Request with 3 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6E FD CB CE C7 49 FA 94 AE FA 7D 9E               n....I....}.
ESP: --- Authentication Data End ---
ESP:

Correctly received Pad Length field in ESP Trailer: 3
received on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.4: Passed

>> IPSECV6-ESP-7.6
TEST_DESCRIPTION
The first padding byte appended to the plaintext is numbered 1,
with subsequent padding bytes making up a monotonically increasing
sequence: 1, 2, 3, ...  using NULL Encryption.
TEST_REFERENCE
RFC 4303 s2.4 p15 Padding (for Encryption)
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host with <n> bytes of
        ULP Information
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Request
        to Remote Host with Padding field in ESP trailer set such
        that the Padding field contains a sequence of monotonically
        increasing integers starting from 1
- CASE: <n> = 6 (needs 4n bytes Padding, n>=0)
- CASE: <n> = 5 (needs (4n+1) bytes Padding, n>=0)
- CASE: <n> = 4 (needs (4n+2) bytes Padding, n>=0)
- CASE: <n> = 3 (needs (4n+3) bytes Padding, n>=0)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2199  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2200  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2201  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2202  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2203  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1602] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1601] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1603] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1604] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: send ICMPv6 Echo Request with 6 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 14 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF276 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [6 bytes] ---
ICMPv6:  41 4E 56 4C 20 54                                 ANVL T
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6D BB 8C AB 60 85 97 3E 63 6F 2E 9C               m...`..>co..
ESP: --- Authentication Data End ---
ESP:

Correctly received Padding field in ESP Trailer:
received on interface eth3 (3ffe:1111::1111) (Remote Host)


Case 2: send ICMPv6 Echo Request with 5 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 13 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF2CB (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [5 bytes] ---
ICMPv6:  41 4E 56 4C 20                                    ANVL 
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [1 bytes] ---
ESP:  01                                                .
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 1 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  37 A0 FA C6 AA 01 A2 A3 E7 92 A1 9F               7...........
ESP: --- Authentication Data End ---
ESP:

Correctly received Padding field in ESP Trailer:01                                                .
received on interface eth3 (3ffe:1111::1111) (Remote Host)


Case 3: send ICMPv6 Echo Request with 4 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 12 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x12CD (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [4 bytes] ---
ICMPv6:  41 4E 56 4C                                       ANVL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BA E4 A2 92 90 95 29 62 37 14 1B AC               ......)b7...
ESP: --- Authentication Data End ---
ESP:

Correctly received Padding field in ESP Trailer:01 02                                             ..
received on interface eth3 (3ffe:1111::1111) (Remote Host)


Case 4: send ICMPv6 Echo Request with 3 bytes of ULP Information
Sending Non-Encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 11 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x131A (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [3 bytes] ---
ICMPv6:  41 4E 56                                          ANV
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6E FD CB CE C7 49 FA 94 AE FA 7D 9E               n....I....}.
ESP: --- Authentication Data End ---
ESP:

Correctly received Padding field in ESP Trailer:01 02 03                                          ...
received on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.6: Passed

>> IPSECV6-ESP-7.8
TEST_DESCRIPTION
The value of this field is chosen from the set of IP Protocol
Numbers defined in the most recent Assigned Numbers RFC from
the Internet Assigned Numbers Authority (IANA).
TEST_REFERENCE
RFC 4303 s2.6 p16 Next Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Request
        to Remote Host with the Next-Header field in ESP Trailer
        set to IPv6 (41)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2204  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2205  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2206  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2207  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2208  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1606] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1605] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1607] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1608] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received NextHeader Field: 41
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.8: Passed

>> IPSECV6-ESP-7.9
TEST_DESCRIPTION
The value of this field is chosen from the set of IP Protocol
Numbers defined in the most recent Assigned Numbers RFC from
the Internet Assigned Numbers Authority (IANA).
TEST_REFERENCE
RFC 4303 s2.6 p16 Next Header
TEST_METHOD
- ANVL: Send an IPv6 datagram containing a payload of type <plt>
        from Local Host
-  DUT: Forward the corresponding ESP-secured IPv6 datagram
        to Remote Host with the Next-Header field in ESP Trailer set to
        the value IPv6 and the Next Header field in inner IPv6 header
        to <plt>
- CASE: <plt> = ICMPv6
- CASE: <plt> = TCP
- CASE: <plt> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2209  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2210  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2211  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2212  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2213  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1610] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1609] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1611] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1612] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send the ICMPv6 packet
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IPv6 Next Header: 58
on interface eth3 (3ffe:1111::1111)
(Remote Host)


Case: send the TCP packet
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6D 4C 57 9C FB E3 89 F9 26 79 9D DF               mLW.....&y..
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IPv6 Next Header: 6
on interface eth3 (3ffe:1111::1111)
(Remote Host)


Case: send the UDP packet
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D2 F4 76 4E 07 AB B7 68 20 86 DE D6               ..vN...h ...
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IPv6 Next Header: 17
on interface eth3 (3ffe:1111::1111)
(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.9: Passed

>> IPSECV6-ESP-7.10
TEST_DESCRIPTION
IPSec MUST set the AuthData field in ESP Header, to a 96 bits ICV.
TEST_REFERENCE
RFC 2403 s2.7 p2 Algorithm and Mode
RFC 2404 s2.7 p2 Algorithm and Mode
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host
-  DUT: Forward the corresponding ICMPv6 Echo Request to Remote Host
        containing 96 bits of ICV in the AuthData field in ESP Header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2214  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2215  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2216  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2217  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2218  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1614] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1613] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1615] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1616] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received  Auth Data Length: 12
on interface eth3 (3ffe:1111::1111)
(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.10: Passed

>> IPSECV6-ESP-7.11
TEST_DESCRIPTION
If necessary, fragmentation is performed after ESP processing
within an IPsec implementation.
TEST_REFERENCE
RFC 4303 s3.3.4 p26 Fragmentation
TEST_METHOD
-  DUT:  Sends a Transport mode secured ICMPv6 Echo Request
      :  of greater than <MTU-size> in two fragments 
- ANVL: Verify the first part will contain:
        - ESP Header after IPv6-Header
        - Fragment Header containing:
          - M flag set on
          - Fragment Offset set to 0
- ANVL: Verify the second part will contain:
        - Fragment Header containing:
          - M flag set off
          - Fragment Offset set to non-zero value
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2219  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2220  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2221  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2222  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2223  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1618] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1617] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1619] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1620] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Configuring DUT to Send an ICMP Echo-Request to 3ffe:1111::1111

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 1500

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-dut-send-ping-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Listen For Two IPv6 Fragments 
Waiting (up to 10.000 seconds) for Encrypted  IP Packet
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping6 -c 1 -S 3ffe:2222::5555 -s 1500 3ffe:1111::1Received Encrypted IPV6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1456 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ESP (50)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 0 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 1
IPv6: Identification       = 3729443136
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: --- Payload Data [1354 bytes] ---
ESP:  00 00 03 02 00 00 00 01 60 00 00 00 05 DC 3A 40   ........`.....:@
ESP:  3F FE 22 22 00 00 00 00 00 00 00 00 00 00 55 55   ?.""..........UU
ESP:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 11 11   ?...............
ESP:  80 00 D5 76 3D 9D 00 00 20 21 22 23 24 25 26 27   ...v=... !"#$%&'
ESP:  28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37   ()*+,-./01234567
ESP:  38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47   89:;<=>?@ABCDEFG
ESP:  48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57   HIJKLMNOPQRSTUVW
ESP:  58 59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67   XYZ[\]^_`abcdefg
ESP:  68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77   hijklmnopqrstuvw
ESP:  78 79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28   xyz{|}~ !"#$%&'(
ESP:  29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38   )*+,-./012345678
ESP:  39 3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48   9:;<=>?@ABCDEFGH
ESP:  49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58   IJKLMNOPQRSTUVWX
ESP:  59 5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68   YZ[\]^_`abcdefgh
ESP:  69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78   ijklmnopqrstuvwx
ESP:  79 7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29   yz{|}~ !"#$%&'()
ESP:  2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39   *+,-./0123456789
ESP:  3A 3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49   :;<=>?@ABCDEFGHI
ESP:  4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59   JKLMNOPQRSTUVWXY
ESP:  5A 5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69   Z[\]^_`abcdefghi
ESP:  6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79   jklmnopqrstuvwxy
ESP:  7A 7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A   z{|}~ !"#$%&'()*
ESP:  2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A   +,-./0123456789:
ESP:  3B 3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A   ;<=>?@ABCDEFGHIJ
ESP:  4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A   KLMNOPQRSTUVWXYZ
ESP:  5B 5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A   [\]^_`abcdefghij
ESP:  6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A   klmnopqrstuvwxyz
ESP:  7B 7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B   {|}~ !"#$%&'()*+
ESP:  2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B   ,-./0123456789:;
ESP:  3C 3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B   <=>?@ABCDEFGHIJK
ESP:  4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B   LMNOPQRSTUVWXYZ[
ESP:  5C 5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B   \]^_`abcdefghijk
ESP:  6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B   lmnopqrstuvwxyz{
ESP:  7C 7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C   |}~ !"#$%&'()*+,
ESP:  2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C   -./0123456789:;<
ESP:  3D 3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C   =>?@ABCDEFGHIJKL
ESP:  4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C   MNOPQRSTUVWXYZ[\
ESP:  5D 5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C   ]^_`abcdefghijkl
ESP:  6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C   mnopqrstuvwxyz{|
ESP:  7D 7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D   }~ !"#$%&'()*+,-
ESP:  2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D   ./0123456789:;<=
ESP:  3E 3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D   >?@ABCDEFGHIJKLM
ESP:  4E 4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D   NOPQRSTUVWXYZ[\]
ESP:  5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D   ^_`abcdefghijklm
ESP:  6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D   nopqrstuvwxyz{|}
ESP:  7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E   ~ !"#$%&'()*+,-.
ESP:  2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E   /0123456789:;<=>
ESP:  3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E   ?@ABCDEFGHIJKLMN
ESP:  4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E   OPQRSTUVWXYZ[\]^
ESP:  5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E   _`abcdefghijklmn
ESP:  6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E   opqrstuvwxyz{|}~
ESP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ESP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ESP:  40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F   @ABCDEFGHIJKLMNO
ESP:  50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F   PQRSTUVWXYZ[\]^_
ESP:  60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F   `abcdefghijklmno
ESP:  70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20   pqrstuvwxyz{|}~ 
ESP:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ESP:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ESP:  41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50   ABCDEFGHIJKLMNOP
ESP:  51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60   QRSTUVWXYZ[\]^_`
ESP:  61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70   abcdefghijklmnop
ESP:  71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21   qrstuvwxyz{|}~ !
ESP:  22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31   "#$%&'()*+,-./01
ESP:  32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41   23456789:;<=>?@A
ESP:  42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51   BCDEFGHIJKLMNOPQ
ESP:  52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61   RSTUVWXYZ[\]^_`a
ESP:  62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71   bcdefghijklmnopq
ESP:  72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22   rstuvwxyz{|}~ !"
ESP:  23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32   #$%&'()*+,-./012
ESP:  33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42   3456789:;<=>?@AB
ESP:  43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52   CDEFGHIJKLMNOPQR
ESP:  53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62   STUVWXYZ[\]^_`ab
ESP:  63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72   cdefghijklmnopqr
ESP:  73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23   stuvwxyz{|}~ !"#
ESP:  24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33   $%&'()*+,-./0123
ESP:  34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43   456789:;<=>?@ABC
ESP:  44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53   DEFGHIJKLMNOPQRS
ESP:  54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61 62 63   TUVWXYZ[\]^_`abc
ESP:  64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73   defghijklmnopqrs
ESP:  74 75 76 77 78 79 7A 7B 7C 7D 7E 20 21 22 23 24   tuvwxyz{|}~ !"#$
ESP:  25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34   %&'()*+,-./01234
ESP:  35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41 42 43 44   56789:;<=>?@ABCD
ESP:  45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54   EFGHIJKLMNOPQRST
ESP:  55 56 57 58 59 5A 5B 5C 5D 5E                     UVWXYZ[\]^
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [80 bytes] ---
ESP:  5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E   _`abcdefghijklmn
ESP:  6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E   opqrstuvwxyz{|}~
ESP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ESP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ESP:  40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F   @ABCDEFGHIJKLMNO
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 80 
ESP: Next Header              = 81 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 53 54 55 56 57 58 59 5A 5B 5C 5D               RSTUVWXYZ[\]
ESP: --- Authentication Data End ---
ESP:

Received Encrypted IPV6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 124 (bytes)
IPv6: Next Header          = Fragment Header (44)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Fragment Extention Header ----
IPv6: 
IPv6: Next Header          = ESP (50)
IPv6: Reserved             = 0
IPv6: Fragment Offset      = 181 (in unit of 8 octets)
IPv6: Res                  = 0
IPv6: mFlag                = 0
IPv6: Identification       = 3729443136
IPv6: 
IPV6: --- Trailing Data [116 bytes] ---
IPV6:  5E 5F 60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D   ^_`abcdefghijklm
IPV6:  6E 6F 70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D   nopqrstuvwxyz{|}
IPV6:  7E 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E   ~ !"#$%&'()*+,-.
IPV6:  2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E   /0123456789:;<=>
IPV6:  3F 40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E   ?@ABCDEFGHIJKLMN
IPV6:  4F 50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E   OPQRSTUVWXYZ[\]^
IPV6:  5F 60 61 62 01 02 02 29 A3 CA 51 6E 6E F0 72 9A   _`ab...)..Qnn.r.
IPV6:  5D B3 90 87                                       ]...
IPV6: --- Trailing Data End ---

Received expected 2 Fragmented packets on interface
eth3 (3ffe:1111::1111) (Remote Host)


Received first secured packet correctly contains
ESP and IPv6 Header

Received first secured packet correctly contains
MF bit set on

Received first secured packet correctly
contains offset set to zero

Received second IPv6 packet correctly
contains MF bit set off

Received second IPv6 packet correctly
contains offset not set to zero

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-7.11: Passed

>> IPSECV6-ESP-8.1
TEST_DESCRIPTION
The sender increments the Sequence Number for this SA and inserts
the new value into the Sequence Number field.  Thus the first
packet sent using a given SA will have a Sequence Number of 1.
TEST_REFERENCE
RFC 4303 s2.2 p11 Sequence Number
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from Local Host
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Request to
        Remote Host containing some value <v1> in the Sequence-Number
        field of ESP Header
- ANVL: Note the value <v1> and send next ICMPv6 Echo Request from
        Local Host
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Request
        to Remote Host containing value greater than <v1>
        in the Sequence-Number field of ESP header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
111 

Pinging 3ffe:1111::1111 (3ffe:1111::1111) with 1500 bytes of data:

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2224  pid=0x689a60
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2225  pid=0x689a60
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2226  pid=0x689a60
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2227  pid=0x689a60
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2228  pid=0x689a60
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1622] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1621] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1623] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1624] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  66 35 30 DF 7C 3C 79 2B E4 C7 B0 7D               f50.|<y+...}
ESP: --- Authentication Data End ---
ESP:

Correctly received sequence number in ESP Packet: 2
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-8.1: Passed

>> IPSECV6-ESP-8.2
TEST_DESCRIPTION
The sender increments the Sequence Number for this SA and inserts
the new value into the Sequence Number field.  Thus the first
packet sent using a given SA will have a Sequence Number of 1.
TEST_REFERENCE
RFC 4303 s2.2 p11 Sequence Number
TEST_METHOD
- ANVL: Reset the SA between ANVL and the DUT
- ANVL: Send an ICMPv6 Echo Request from Local Host
-  DUT: Forward the corresponding ESP-secure ICMPv6 Echo Request
        to Remote Host containing the value 1 in the 
        Sequence-Number field in ESP header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2229  pid=0x684de0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2230  pid=0x684de0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2231  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2232  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2233  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1626] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1625] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1627] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1628] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received ESP sequence number: 1
on interface eth3 (3ffe:1111::1111)
(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-8.2: Passed

>> IPSECV6-ESP-8.3
TEST_DESCRIPTION
In other words, the sender MUST NOT send a packet on an SA
if doing so would cause the Sequence Number to cycle.
TEST_REFERENCE
RFC 4303 s3.4.3 p25 Sequence Number Verification
TEST_METHOD
- ANVL: Set SA between ANVL and the DUT with Lifetime
        <LifeTimeSeconds> seconds
- ANVL: Send at most 10 ICMPv6 Echo Requests from Local Host
        within the Lifetime of the SA
-  DUT: Forward the corresponding ESP-secured ICMPv6 Echo Requests to
        Remote Host without duplicating the Sequence Number in the
        ESP Header of any response
- ANVL: Restore default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2234  pid=0x684de0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2235  pid=0x684de0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2236  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2237  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2238  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1630] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1629] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1631] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1632] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 120 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

--- 3ffe:1111::1111 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1017 ms
-> e
-> cmd keyxit
Au revoir!
Connection closed by foreign host.
adm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2239  pid=0x684de0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 1290 -lh 120 
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=144  seq=2240  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=120 usetime=0 bytes=1290
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2241  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=216  seq=0  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31130 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1290
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  66 35 30 DF 7C 3C 79 2B E4 C7 B0 7D               f50.|<y+...}
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9E E5 34 23 6C 9A 55 A6 19 56 9F B1               ..4#l.U..V..
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E9 73 8B 07 97 A5 DF 2B AC 4F 2C 2D               .s.....+.O,-
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BB 5F 6D 0A BB 93 5F A0 C0 78 E8 BA               ._m..._..x..
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CD 99 00 6C CF D0 27 0A 98 10 73 5E               ...l..'...s^
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B5 4D 4E DB D4 B5 63 E9 7A A8 A7 DC               .MN...c.z...
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C4 BD 4C 47 5F AF 23 9E D3 F5 77 78               ..LG_.#...wx
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  83 AC 65 05 C9 62 70 85 D2 C3 6F 5C               ..e..bp...o\
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x0000000A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4D 92 C6 B7 68 F4 05 92 DB 4F 2B 3A               M...h....O+:
ESP: --- Authentication Data End ---
ESP:

DUT correctly forwarded Encrypted packets without duplicating
sequence number field in ESP
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2243  pid=0x684de0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2244  pid=0x684de0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2245  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2246  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2247  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1637] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1636] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1638] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1639] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-8.3: Passed

>> IPSECV6-ESP-10.1
TEST_DESCRIPTION
IPSec gateway MUST de-secure inbound Tunnel Mode secured IPv6-datagram
and forward resultant packet, which is itself Tunnel Mode secured.
TEST_REFERENCE
RFC 4301 s4.3 p17 Basic Combinations Security Associations
TEST_METHOD
- ANVL: Set up an SA-bundle at ANVL side such that packets sent to DUT
        are first (outer) Tunnel Mode secured, and next (inner) again
        Tunnel Mode secured. The outer SA-destination is the DUT while
        the inner SA-destination is virtual host ANVL Remote Address
        behind the DUT
- ANVL: Send secured ICMPv6 Echo Request which is Tunnel-Mode secured
        at TWO levels (inner and outer), down interface A1
-  DUT: Forward the secured ICMPv6 Echo Request which is Tunnel-Mode
        secured using the inner SA, down interface A2
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2248  pid=0x684de0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2249  pid=0x684de0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2250  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2251  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2252  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1641] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1640] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1642] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1643] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted IPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 152 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2225::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA053 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  74 1C 8A 1A B7 E4 4D B3 A5 3C B2 DE               t.....M..<..
ESP: --- Authentication Data End ---
ESP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E6 D4 C5 AC 9E F5 99 5D B5 71 3D E6               .......].q=.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2225::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA053 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  74 1C 8A 1A B7 E4 4D B3 A5 3C B2 DE               t.....M..<..
ESP: --- Authentication Data End ---
ESP:

Received expected Secured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-10.1: Passed

>> IPSECV6-ESP-10.2
TEST_DESCRIPTION
IPSec gateway MUST de-secure inbound Tunnel Mode secured IP-datagram
and forward resultant packet, which is itself Transport Mode secured.
TEST_REFERENCE
RFC 4301 s4.3 p17 Basic Combinations Security Associations
TEST_METHOD
- ANVL: Set up an SA-bundle at ANVL side such that packets forwarded
        by DUT are first (outer) Tunnel Mode secured, and next (inner)
        again Transport Mode secured. The outer SA-destination is the
        DUT while the inner SA-destination is some virtual host
        ANVL Remote Address behind the DUT
- ANVL: Send secured ICMPv6 Echo Request down interface A1 which is
        Tunnel-Mode secured at the outer level and Transport Mode
        secured at the outer level
-  DUT: Forward secure ICMPv6 Echo Request down interface A2 which is
        Transport-Mode-Secured using inner level security
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2253  pid=0x684de0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2254  pid=0x684de0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2255  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2256  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2257  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1645] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1644] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1646] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1647] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted IPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 152 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2225::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 96 (*Unknown Type 96*)
ICMPv6: Code               = 0 (*Unknown*)
ICMPv6: Checksum           = 0x00 *Should be 0x2D21*
ICMPv6: 
ICMPv6: --- Trailing Data [20 bytes] ---
ICMPv6:  00 18 3A FF 3F FE 11 11 00 00 00 00 00 00 00 00   ..:.?...........
ICMPv6:  00 00 11 11                                       ....
ICMPv6: --- Trailing Data End ---
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  90 29 67 47 76 5B C8 43 D0 FD 6B 1C               .)gGv[.C..k.
ESP: --- Authentication Data End ---
ESP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  94 AF E6 21 C6 0D 8B D5 BB 92 9E F5               ...!........
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2225::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 96 (*Unknown Type 96*)
ICMPv6: Code               = 0 (*Unknown*)
ICMPv6: Checksum           = 0x00 *Should be 0x2D21*
ICMPv6: 
ICMPv6: --- Trailing Data [20 bytes] ---
ICMPv6:  00 18 3A FF 3F FE 11 11 00 00 00 00 00 00 00 00   ..:.?...........
ICMPv6:  00 00 11 11                                       ....
ICMPv6: --- Trailing Data End ---
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  90 29 67 47 76 5B C8 43 D0 FD 6B 1C               .)gGv[.C..k.
ESP: --- Authentication Data End ---
ESP:

Received expected Secured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-10.2: Passed

>> IPSECV6-ESP-11.1
TEST_DESCRIPTION
Thus, to ensure consistent, predictable processing, SPD entries
MUST be ordered and the SPD MUST always be searched in the same
order, so that the first matching entry is consistently selected.
TEST_REFERENCE
RFC 4301 p21 s4.4.1 Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound secured
        IPv6-datagrams via interface D1 with outer IPv6 Destination
        Address within Subnet-2 (specified using address + mask) are
        bypassed. Add another entry in the DUT's SPD such that
        inbound secured IPv6-datagrams with outer IPv6 Destination
        Address set to A2Addr, are processed using IPSec
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward secured ICMPv6 Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add the SPD entries again, but
        in reverse order (the SPD entry for Subnet-2 which was earlier
        added first is added second this time)
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward unsecured ICMPv6 Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add entry in the DUT's SPD such
        that inbound secured IPv6-datagrams via interface D1, with inner
        IPv6-Header Destination Address within Subnet-2 (specified using
        address + mask) are processed using IPsec. Add another entry
        in the DUT's SPD such that inbound secured IPv6-datagrams with
        inner IPv6-Header Destination Address set to A2Addr,
        are bypassed
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward unsecured ICMPv6 Echo Request, to Local Host
- ANVL: Delete all SPD entries in DUT. Add the SPD entries again just
        as last time, except that the entry for Subnet-2 is added
        second
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward secured ICMPv6 Echo Request, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2258  pid=0x684de0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2259  pid=0x684de0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2260  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2261  pid=0x684de0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2262  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1650] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1651] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2263  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1652
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=ESP  len=16  seq=2264  pid=0x684de0
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2265  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1653
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2266  pid=0x684de0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1654
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1652] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[1653] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1654] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2267  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -flowpri 1 -bypass -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=288  seq=2268  pid=0x684de0
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=bypass prio=1 dscp=0x0 dir=in id=1655
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1655] :: bypass pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[1653] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1654] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:2222::1111

DUT_ACTION=APPLY

HOST_TYPE =LOCAL 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=NONE  len=16  seq=2269  pid=0x684de0
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=208  seq=2270  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1653
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2271  pid=0x684de0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1656
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2272  pid=0x684de0
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1649
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2272  pid=0x684de0
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1648
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=2272  pid=0x684de0
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=bypass prio=1 dscp=0x0 dir=in id=1655
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=2272  pid=0x684de0
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1656
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=0  pid=0x684de0
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1654
------------------------------------------
Total of 5 flows
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1655] :: bypass pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[1656] :: use pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1654] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
exit
-> Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 8F D9 F0 10 1C DA EC 1E 3C D8 9E               I........<..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 8F D9 F0 10 1C DA EC 1E 3C D8 9E               I........<..
ESP: --- Authentication Data End ---
ESP:

Correctly, received secured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2273  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1657
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=208  seq=2274  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1656
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2275  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1658
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2276  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1659
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1657] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[1655] :: bypass pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[1658] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1659] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 6 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:1111::1111

DUT_ACTION=APPLY

HOST_TYPE =LOCAL 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=NONE  len=16  seq=2277  pid=0x625240
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=208  seq=2278  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1658
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2279  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1660
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2280  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1649
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2280  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1648
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=2280  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1657
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=2280  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=bypass prio=1 dscp=0x0 dir=in id=1655
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=2280  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1660
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=0  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1659
------------------------------------------
Total of 6 flows
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1657] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[1655] :: bypass pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[1660] :: use pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1659] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 6 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2281  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -flowpri 1 -bypass -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=288  seq=2282  pid=0x625240
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=bypass prio=1 dscp=0x0 dir=in id=1661
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1661] :: bypass pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[1660] :: use pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1659] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4B E2 FF 2E D9 91 62 D9 AB 33 5F 45               K.....b..3_E
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2283  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1662
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=208  seq=2284  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1660
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2285  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1663
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2286  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1664
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1662] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[1661] :: bypass pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: BYPS
[1663] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1664] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 6 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2287  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0  -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -flowpri 1 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2288  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=use prio=1 dscp=0x0 dir=in id=1665
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1665] :: use pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1663] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1664] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:2222::1111

DUT_ACTION=BYPASS

HOST_TYPE =LOCAL 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:2222::1111 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=2289  pid=0x625240
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:2222::1111
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2290  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1649
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2290  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1648
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=2290  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=1666
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=2290  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=use prio=1 dscp=0x0 dir=in id=1665
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=2290  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1663
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=0  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1664
------------------------------------------
Total of 6 flows
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1666] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[1665] :: use pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1663] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1664] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 6 flows.
exit
-> Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9A 35 05 B8 D3 DD A0 48 15 DF 7A C4               .5.....H..z.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received unsecured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2291  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1667
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=208  seq=2292  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1663
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2293  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1668
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2294  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1669
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1666] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[1667] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[1665] :: use pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1668] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1669] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 7 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:1111::1111

DUT_ACTION=BYPASS

HOST_TYPE =LOCAL 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:2222::1111 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=2295  pid=0x625240
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:2222::1111
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2296  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1649
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2296  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1648
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=2296  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=1670
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=2296  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1667
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=2296  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=use prio=1 dscp=0x0 dir=in id=1665
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=2296  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1668
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=0  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1669
------------------------------------------
Total of 7 flows
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1670] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[1667] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[1665] :: use pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
exit
[1668] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1669] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 7 flows.
-> 
Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host(3ffe:2222::1111) with mask 64
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 64 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2297  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0  -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -flowpri 1 -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2298  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=use prio=1 dscp=0x0 dir=in id=1671
------------------------------------------
-> cmd ipsecctrl flows
Flows:
[1649] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1648] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1670] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[1671] :: use pri=1 src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1668] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1669] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 6 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BE D6 22 03 FA CD BF 22 F4 77 58 30               .."....".wX0
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received Neighbor Solicitation from fe80::215:17ff:fec8:9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9029
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA5CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2E66 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BE D6 22 03 FA CD BF 22 F4 77 58 30               .."....".wX0
ESP: --- Authentication Data End ---
ESP:

Correctly received Secured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-11.1: Passed

>> IPSECV6-ESP-12.1
TEST_DESCRIPTION
The following selector parameters MUST be supported for SA
management to facilitate control of SA granularity.
- Destination IP Address  (IPv4 or IPv6)
TEST_REFERENCE
RFC 4301 s4.4.1.1 p26 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound secured
        IPv6-datagrams with outer IPv6 Destination Address set to
        ANVL Local Address are Discarded
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Do not forward ICMPv6 Echo Request, to Local Host
- ANVL: Modify the SPD entry to use Bypass
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward secured ICMPv6 Echo Request, to Local Host
- ANVL: Modify the SPD entry to use IPsec for IPv6 Destination
        Address set to <DIface-0>
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward ICMPv6 Echo Request, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2299  pid=0x625240
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2300  pid=0x625240
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2301  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2302  pid=0x625240
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2303  pid=0x625240
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1673] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1672] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1674] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1675] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
DISCARD IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 DISCARD LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:2222::1111

DUT_ACTION=DISCARD

HOST_TYPE =LOCAL 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=192  seq=2304  pid=0x625240
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2305  pid=0x625240
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1676
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2306  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1673
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2306  pid=0x625240
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1672
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=2306  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1676
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x625240
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1675
------------------------------------------
Total of 4 flows
-> cmd ipsecctrl flows
Flows:
[1673] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1672] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1676] :: deny src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1675] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7D 32 7E C2 8B 7A 73 69 1F 13 C0 01               }2~..zsi....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:2222::1111

DUT_ACTION=BYPASS

HOST_TYPE =LOCAL 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:2222::1111 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=2307  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:2222::1111
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2308  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1673
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2308  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1672
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=2308  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=1677
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1675
------------------------------------------
Total of 4 flows
-> cmd ipsecctrl flows
Flows:
[1673] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1672] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1677] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[1675] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4A D6 2F 11 A2 A9 39 22 6A 03 9C 6D               J./...9"j..m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4A D6 2F 11 A2 A9 39 22 6A 03 9C 6D               J./...9"j..m
ESP: --- Authentication Data End ---
ESP:

Correctly Received Encrypted IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:2222::1111

DUT_ACTION=APPLY

HOST_TYPE =LOCAL 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=192  seq=2309  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=ESP  len=16  seq=2310  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2311  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1678
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2312  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1673
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2312  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1672
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=2312  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=use prio=10 dscp=0x0 dir=in id=1678
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1675
------------------------------------------
Total of 4 flows
-> cmd ipsecctrl flows
Flows:
[1673] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1672] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1678] :: use pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1675] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
exit
-> Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4F 21 81 80 E0 86 05 3D 54 11 05 F2               O!.....=T...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-12.1: Passed

>> IPSECV6-ESP-12.2
TEST_DESCRIPTION
The following selector parameters MUST be supported for SA
management to facilitate control of SA granularity.
- Source Address 
TEST_REFERENCE
RFC 4301 s4.4.1.1 p26 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound IPv6-datagrams
        from ANVL to DUT with outer IPv6 Source Address virtual Host IP
        address ANVL Remote Address, are Discarded
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Do not forward ICMPv6 Echo Request, to Local Host
- ANVL: Modify the SPD entry to use Bypass
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward secured ICMPv6 Echo Request, to Local Host
- ANVL: Modify the SPD entry to use IPsec
- ANVL: Send secured ICMPv6 Echo Request, from Remote Host
-  DUT: Forward ICMPv6 Echo Request, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2313  pid=0x5b38d0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2314  pid=0x5b38d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2315  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2316  pid=0x5b38d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2317  pid=0x5b38d0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1680] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1679] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1681] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1682] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT by adding the following Inbound IPSec policy:
DISCARD IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:1111::1111

DUT_ACTION=DISCARD

HOST_TYPE =REMOTE 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=NONE  len=192  seq=2318  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2319  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1683
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2320  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1680
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2320  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1679
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=2320  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1683
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1682
------------------------------------------
Total of 4 flows
-> cmd ipsecctrl flows
Flows:
[1680] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1679] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1683] :: deny src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1682] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1B 7D 65 74 F4 E1 7B 32 99 42 EE 80               .}et..{2.B..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, No IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
BYPASS IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 BYPASS REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:1111::1111

DUT_ACTION=BYPASS

HOST_TYPE =REMOTE 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:2222::1111 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=2321  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:2222::1111
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2322  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1680
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2322  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1679
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=2322  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=in id=1684
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1682
------------------------------------------
Total of 4 flows
-> cmd ipsecctrl flows
Flows:
[1680] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1679] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1684] :: bypass src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: BYPS
[1682] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  80 2F E9 B6 68 61 57 98 13 CA AF F2               ./..haW.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  80 2F E9 B6 68 61 57 98 13 CA AF F2               ./..haW.....
ESP: --- Authentication Data End ---
ESP:

Correctly Received Encrypted IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT by adding the following Inbound IPSec policy:
APPLY IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 APPLY REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
HOST_ADDRESS=3ffe:1111::1111

DUT_ACTION=APPLY

HOST_TYPE =REMOTE 

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=NONE  len=192  seq=2323  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
------------------------------------------
-> cmd keyadm dumpflow
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2324  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=0.0.0.0/0
 DSTFLOW: addr=128.224.166.238/32 port=500
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=in id=1680
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2324  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1679
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=2324  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=require prio=0 dscp=0x0 dir=in id=1685
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1682
------------------------------------------
Total of 4 flows
-> cmd ipsecctrl flows
Flows:
[1680] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1679] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1685] :: require src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1682] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
exit
-> Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FB E9 64 81 54 FC C8 16 DD D0 E4 6D               ..d.T......m
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Unsecure IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-12.2: Passed

>> IPSECV6-ESP-12.3
TEST_DESCRIPTION
The following selector parameters MUST be supported for SA
management to facilitate control of SA granularity.
- Transport Layer Protocol 
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound IPv6-datagrams from
        ANVL to DUT with Next Header set to <protocol>, are
        Discarded
- ANVL: Send secured IPv6 Packet with Next Header set to
        <protocol>, from Remote Host
-  DUT: Do not forward the IPv6 packet, to Local Host
- ANVL: Modify the SPD entry to use Bypass
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol>, from Remote Host
-  DUT: Forward the secured IPv6 packet, to Local Host
- ANVL: Modify the SPD entry to use IPsec
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol>, from Remote Host
-  DUT: Forward the IPv6 packet, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = ICMPv6
- CASE: <protocol> = TCP
- CASE: <protocol> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2325  pid=0x5b38d0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2326  pid=0x5b38d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2327  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2328  pid=0x5b38d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2329  pid=0x5b38d0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1687] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1686] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1688] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1689] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Next Header> = ICMPV6

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for icmpv6 transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -ingress -proto esp -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2330  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -ingress -proto esp -transport 0 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2331  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1690
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0F 7D 81 D2 73 67 E4 2D AF 03 5A 59               .}..sg.-..ZY
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, No IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for icmpv6 transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 0 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2332  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  82 3B 69 3A 36 03 3B 2A 42 1B DD 65               .;i:6.;*B..e
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  82 3B 69 3A 36 03 3B 2A 42 1B DD 65               .;i:6.;*B..e
ESP: --- Authentication Data End ---
ESP:

Correctly Received Secured IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for icmpv6 transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 0 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2333  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DB A5 C4 E8 95 35 58 93 D1 F2 5B 50               .....5X...[P
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2334  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2335  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2336  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2337  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2338  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1694] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1693] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1695] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1696] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Next Header> = TCP

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -ingress -proto esp -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2339  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -ingress -proto esp -transport 6 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2340  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1697
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D1 7A 4B E3 24 05 FA 59 F9 68 27 93               .zK.$..Y.h'.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, No IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 6 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2341  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1C 57 13 90 E0 0A E9 E7 75 43 CF 6C               .W......uC.l
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1C 57 13 90 E0 0A E9 E7 75 43 CF 6C               .W......uC.l
ESP: --- Authentication Data End ---
ESP:

Correctly Received Secured IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 6 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2342  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  88 7C 35 E4 A2 07 EB E4 8F C4 03 4A               .|5........J
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2343  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2344  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2345  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2346  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2347  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1701] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1700] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1702] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1703] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Next Header> = UDP

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -ingress -proto esp -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2348  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -ingress -proto esp -transport 17 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2349  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1704
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000015 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5C FD 13 29 E4 17 A4 F4 BC F5 51 9F               \..)......Q.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, No IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 17 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2350  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 24 8B A0 3A 76 F0 70 67 A2 D0 C1               I$..:v.pg...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 24 8B A0 3A 76 F0 70 67 A2 D0 C1               I$..:v.pg...
ESP: --- Authentication Data End ---
ESP:

Correctly Received Secured IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 17 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2351  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000017 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 E4 F1 27 06 6F 91 7C 26 A7 2C 28               R..'.o.|&.,(
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2352  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2353  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2354  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2355  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2356  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1708] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1707] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1709] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1710] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-12.3: Passed

>> IPSECV6-ESP-12.4
TEST_DESCRIPTION
The following selector parameters MUST be supported for SA
management to facilitate control of SA granularity.
- TCP/UDP Source Port 
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound IP-datagrams from
        ANVL to DUT with Transport Protocol set to <protocol> and
        Transport Protocol Source Port Number set to <port>, are
        Discarded
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol> and Transport Protocol Source Port Number set to
        <port>, from Remote Host
-  DUT: Do not forward the IPv6 packet, to Local Host
- ANVL: Modify the SPD entry to use Bypass
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol> and Transport Protocol Source Port Number set
        to <port>, from Remote Host
-  DUT: Forward the secured IPv6 packet, to Local Host
- ANVL: Modify the SPD entry to use IPsec
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol> and Transport Protocol Source Port Number set to
        <port>, from Remote Host
-  DUT: Forward the IPv6 packet, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = TCP, <port> = 6000
- CASE: <protocol> = UDP, <port> = 6000
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2357  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2358  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2359  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2360  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2361  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1712] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1711] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1713] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1714] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 6000

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and SOURCE port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -ingress -proto esp -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2362  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -ingress -proto esp -transport 6 -srcport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2363  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64 port=6000
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1715
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000018 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C8 C7 2F C6 C2 35 D0 C4 93 6F 1E A3               ../..5...o..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and SOURCE port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 6 -srcport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2364  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64 port=6000
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A9 57 C5 01 A5 F2 01 5B 1C F9 FF C0               .W.....[....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A9 57 C5 01 A5 F2 01 5B 1C F9 FF C0               .W.....[....
ESP: --- Authentication Data End ---
ESP:

Correctly Received Secured IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and SOURCE port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 6 -srcport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2365  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64 port=6000
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001A 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 DF EE 13 5B EA 79 B2 59 E0 8E 14               ....[.y.Y...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2366  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2367  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2368  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2369  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2370  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1719] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1718] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1720] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1721] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Source Port> = 6000

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and SOURCE port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -ingress -proto esp -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2371  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -ingress -proto esp -transport 17 -srcport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2372  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64 port=6000
 DSTFLOW: addr=3ffe:2222::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1722
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001B 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4B 9D 4C F1 A7 3C 4A C9 92 2D FA 8A               K.L..<J..-..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and SOURCE port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 17 -srcport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2373  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64 port=6000
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C1 47 CE 66 1F 0B 89 C4 02 4F 68 FD               .G.f.....Oh.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C1 47 CE 66 1F 0B 89 C4 02 4F 68 FD               .G.f.....Oh.
ESP: --- Authentication Data End ---
ESP:

Correctly Received Secured IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and SOURCE port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 17 -srcport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2374  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64 port=6000
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001D 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8C 54 AE 01 29 73 EE A3 96 67 48 B2               .T..)s...gH.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2375  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2376  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2377  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2378  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2379  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1726] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1725] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1727] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1728] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-12.4: Passed

>> IPSECV6-ESP-12.5
TEST_DESCRIPTION
The following selector parameters MUST be supported for SA
management to facilitate control of SA granularity.
- TCP/UDP Destination Port 
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that inbound IPv6-datagrams
        from ANVL to DUT with Transport Protocol set to <protocol> and
        Transport Protocol Destination Port Number set to <port>, are
        Discarded
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol> and Transport Protocol Destination Port Number
        set to <port>, from Remote Host
-  DUT: Do not forward the IPv6 packet, to Local Host
- ANVL: Modify the SPD entry to use Bypass
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol> and Transport Protocol Destination Port Number
        set to <port>, from Remote Host
-  DUT: Forward the secured IPv6 packet, to Local Host
- ANVL: Modify the SPD entry to use IPsec
- ANVL: Send secured IPv6 Packet with Transport Layer Protocol
        <protocol> and Transport Protocol Destination Port Number
        set to <port>, from Remote Host
-  DUT: Forward the IPv6 packet, to Local Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = TCP, <port> = 6000
- CASE: <protocol> = UDP, <port> = 6000
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2380  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2381  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2382  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2383  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2384  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1730] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1729] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1731] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1732] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Destination Port> = 6000

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport protocol and DESTINATION port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -ingress -proto esp -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2385  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -ingress -proto esp -transport 6 -dstport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2386  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64 port=6000
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1733
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001E 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  82 D8 3F 8B 7F F5 F5 EC 31 71 55 7B               ..?.....1qU{
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport protocol and DESTINATION port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 6 -dstport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2387  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  43 4F 74 73 BB 50 B7 27 61 36 EF 8A               COts.P.'a6..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  43 4F 74 73 BB 50 B7 27 61 36 EF 8A               COts.P.'a6..
ESP: --- Authentication Data End ---
ESP:

Correctly Received Secured IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport protocol and DESTINATION port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 6 -dstport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2388  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted TCP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000020 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4A FB C2 6D FF D9 CD F0 C0 A2 0F 19               J..m........
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2389  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2390  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2391  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2392  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2393  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1737] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1736] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1738] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1739] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Destination Port> = 6000

Configuring DUT with the following Inbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport protocol and DESTINATION port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm delflow -ingress -proto esp -spi 300 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_DELFLOW  err=0  satype=ESP  len=192  seq=2394  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64
------------------------------------------
-> cmd keyadm addflow -ingress -proto esp -transport 17 -dstport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2395  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64 port=6000
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1740
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000021 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5B F6 67 C5 34 DD BB 3F 7C 4B FE 67               [.g.4..?|K.g
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packets received on interface
eth4 (3ffe:2222::1111) (Local Host)

Configuring DUT with the following Inbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport protocol and DESTINATION port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 17 -dstport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2396  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000022 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5A F8 C6 4A D9 33 1C 5F 4B E6 83 BC               Z..J.3._K...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000022 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5A F8 C6 4A D9 33 1C 5F 4B E6 83 BC               Z..J.3._K...
ESP: --- Authentication Data End ---
ESP:

Correctly Received Secured IPv6 Packet on interface
eth3 (3ffe:2222::1111)(Local Host)

Configuring DUT with the following Inbound IPSec policy:
APPLY IPSec to the IP packet for udp transport protocol and DESTINATION port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -ingress -proto esp -transport 17 -dstport 6000 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2397  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:1111::1111/64
 DSTFLOW: addr=3ffe:2222::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted UDP (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000023 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A6 0B B0 07 E4 D3 86 96 5C DD 21 4E               ........\.!N
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received Unsecured IPv6 Packet on interface
eth4 (3ffe:2222::1111)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2398  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2399  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2400  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2401  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2402  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1744] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1743] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1745] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1746] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-12.5: Passed

>> IPSECV6-ESP-13.1
TEST_DESCRIPTION
For inbound processing, for unicast SAs, the SPI is used either alone
to look up an SA or in conjunction with the IPsec protocol type.
IPSec MUST discard an incoming IP datagram containing a SPI and protocolentry for which no corresponding entry exists in the SAD.
TEST_REFERENCE
NEGATIVE: RFC 4301 s4.4.2 p34 Security Association Database
TEST_METHOD
- ANVL: Send secured IPv6 packet from Remote Host with one of the
        elements <e> of the 2-tuple <Protocol, SPI>
        not matching the SA configuration
-  DUT: Do not forward IPv6 packet, to Local Host
- CASE: <e> = SPI
- CASE: <e> = Protocol
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2403  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2404  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2405  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2406  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2407  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1748] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1747] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1749] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1750] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Setting the SPI Value to 778 in ESP Header
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x0000030A 
ESP: Sequence Number          = 0x00000024 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D4 0A DC 0E 30 1D D9 85 BE A1 65 C4               ....0.....e.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)


Case: Setting the Next Header to 51 in Outer IPv6 Header
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = AH (51)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 41 
AH: Payload Length           = 4 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00000300 
AH: Sequence Number          = 0x00000025 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 02 D7 2C 38 5B DA EE 6A 2C 6C 61 B4               ..,8[..j,la.
AH:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
AH: ---- IP Authenticated Packet ----
AH:
AH: Next Header              = 96 
AH: Payload Length           = 0 
AH: Reserved                 = 0 
AH: Security Parameter Index = 0x00183AFF 
AH: Sequence Number          = 0x3FFE1111 
AH: --- Integrity Check Value-ICV [12 bytes] ---
AH:
AH: 00 00 00 00 00 00 00 00 00 00 11 11               ............
AH:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 63 (*Unknown Type 63*)
ICMPv6: Code               = 254 (*Unknown*)
ICMPv6: Checksum           = 0x1111 *Should be 0x086C*
ICMPv6: 
ICMPv6: --- Trailing Data [52 bytes] ---
ICMPv6:  00 00 00 00 00 00 00 00 00 00 11 11 3F FE 22 22   ............?.""
ICMPv6:  00 00 00 00 00 00 00 00 00 00 11 11 80 00 A0 56   ...............V
ICMPv6:  00 00 00 00 41 4E 56 4C 20 54 45 53 54 20 44 41   ....ANVL TEST DA
ICMPv6:  54 41 20 20                                       TA  
ICMPv6: --- Trailing Data End ---
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, no IPv6 packet received on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-13.1: Passed

>> IPSECV6-ESP-14.3
TEST_DESCRIPTION
The inner IP header is not changed except to decrement the TTL
as noted below, and remains unchanged during its delivery to
the tunnel exit point.
TEST_REFERENCE
RFC 4301 s5.1.2.2 p57 IPv6 - Header Construction for Tunnel mode
TEST_METHOD
- ANVL: Send ICMPv6 Echo Request, from Local Host
-  DUT: Forward secured ICMPv6 Echo Request to Remote Host
        decrementing the Hop Limit field in inner IPv6-Header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2408  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2409  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2410  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2411  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2412  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1752] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1751] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1753] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1754] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IPv6 Hop Limit field: 254
on interface eth3 (3ffe:1111::1111)
(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-14.3: Passed

>> IPSECV6-ESP-15.1
TEST_DESCRIPTION
If no policy is found in the SPD that matches the packet (for either
inbound or outbound traffic), the packet MUST be discarded.
TEST_REFERENCE
NEGATIVE: RFC 4301 s5 p50 IP Traffic Processing
TEST_METHOD
- ANVL: Remove IPSec SA on the DUT with source address ANVL Local
        Host address and destination address ANVL Remote Address
- ANVL: Send an ICMPv6 Echo Request from ANVL Local Host to
        ANVL Remote Host
-  DUT: Do not forward secured ICMPv6 Echo Request or secured ICMPv6
        Request to Remote Host
- ANVL: Restore default IPSec SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2413  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2414  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2415  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2416  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2417  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1756] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1755] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1757] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1758] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Removing ANVL Local Address (3ffe:2222::1111) and Remote Host Addresses (3ffe:1111::1111)
configured on the DUT from IPSec SAs
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2418  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1759
------------------------------------------
-> cmd keyadm delflow -proto esp -spi 300 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress
SADB_MSG: msgtype=X_DELFLOW  err=3  satype=ESP  len=16  seq=2419  pid=0x5de180
   ERRNO: errno = 0x3 (3)
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::1111 -dstflow 3ffe:2222::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -flowpri 10 -ingress -deny
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2420  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:2222::1111/128
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1760
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2421  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1761
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1756] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1755] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1759] :: deny src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: none
[1760] :: deny pri=10 src=3ffe:1111::1111/128:any dst=3ffe:2222::1111/128:any any <- SA: none
[1761] :: deny src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: none
Total of 5 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no encrypted ICMPv6 packet received
on interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-15.1: Passed

>> IPSECV6-ESP-15.2
TEST_DESCRIPTION
Lifetime of this Security Association: a time interval after
which an SA must be replaced with a new SA (and new SPI) or
terminated, plus an indication of which of these actions should 
occur.  This may be expressed as a time or byte count, 
(Note:This test is for Lifetime Bytes. Please make sure that
the Lifetime Seconds configured in PRM file is long enough, so that
the SA becomes invalid only after the Lifetime Bytes expires.)
TEST_REFERENCE
RFC 4301 s4.4.2.1 p37 Data Items in the SAD
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with Lifetime
        <LifeTimeBytes> bytes
- ANVL: Send as many ICMPv6 Echo Requests as possible within the
        Lifetime from Local Host
-  DUT: Forward the corresponding ESP secured ICMPv6 Echo Requests
        to Remote Host
- ANVL: Send ICMPv6 Echo Requests beyond the Lifetime bytes
        from Local Host
-  DUT: Do not forward the corresponding ESP secured ICMPv6
        Echo Requests to Remote Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2422  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2423  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2424  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2425  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2426  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1763] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1762] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1764] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1765] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 1065 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
0=128.224.166.238

1=6

2=0

3=3ffe:1111::5555

4=3ffe:2222::5555

5=64

6=64

7=3ffe:2222::1111

8=3ffe:1111::1111

9=TUNNEL

10=MANUAL

11=PRESHARED-KEY

12=HMAC_MD5

13=HMAC_MD5_96

14=AH_MD5

15=NULL

16=NOT_CONFIGURED

17=66306630663066306630663066302222

18=800000000000000040000000000000002000000000000000

19=768

20=770

21=NOT_CONFIGURED

22=SHA

23=DES_CBC

24=MODP768

25=1065

26=MODP1024

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> guo4
cmd keyadm update -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -bh 1065
SADB_MSG: msgtype=UPDATE  err=0  satype=ESP  len=144  seq=2427  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=0 usetime=0 bytes=1065
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=2428  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=31328 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31328 usetime=0 bytes=0
    HARD: addtime=0 usetime=0 bytes=1065
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 1 ICMPv6 plain Packet to DUT to expire Lifetime
byte in DUT
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1024 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 8B 41 3C DB 3B 83 93 29 75 A0 19               ..A<.;..)u..
ESP: --- Authentication Data End ---
ESP:

Correctly, 1st ESP packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Correctly, no ESP packets received on interface eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2429  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2430  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2431  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2432  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2433  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1767] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1766] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1768] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1769] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-15.2: Passed

>> IPSECV6-ESP-15.3
TEST_DESCRIPTION
Lifetime of this Security Association: a time interval after
which an SA must be replaced with a new SA (and new SPI) or
terminated, plus an indication of which of these actions should 
occur.  This may be expressed as a time or byte count, 
(Note:This test is for Lifetime Seconds. Please make sure that
the Lifetime Bytes configured in PRM file is long enough, so that
the SA becomes invalid only after the Lifetime Seconds expires.)
TEST_REFERENCE
RFC 4301 s4.4.2.1 p37 Data Items in the SAD
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with Lifetime
        <LifeTimeSeconds> seconds
- ANVL: Send ICMPv6 Echo Requests within the Lifetime
        from Local Host
-  DUT: Forward the corresponding ESP secured ICMPv6 Echo Requests
        to Remote Host
- ANVL: Send ICMPv6 Echo Requests beyond the Lifetime seconds
        from Local Host
-  DUT: Do not forward the corresponding ESP secured ICMPv6
        Echo Requests to Remote Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2434  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2435  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2436  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2437  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2438  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1771] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1770] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1772] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1773] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 120 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2439  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 1290 -lh 120 
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=144  seq=2440  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=120 usetime=0 bytes=1290
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2441  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31340 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1290
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly, ESP packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received Neighbor Solicitation from fe80::215:17ff:fec8:9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9028
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB6E1 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x508A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo request from 3ffe:2222::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9F56 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Got ECHO Request, sending reply
Received Neighbor Solicitation from fe80::215:17ff:fec8:9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9029
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA5CE (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2E66 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no ESP packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2443  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2444  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2445  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2446  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2447  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1778] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1777] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1779] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1780] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-15.3: Passed

>> IPSECV6-ESP-15.4
TEST_DESCRIPTION
 If the entire packet does not get delivered during
 the SAs lifetime, the packet SHOULD be discarded.
(Note:This test uses Lifetime Bytes to expire SA. Please make sure
that the Lifetime Seconds configured in PRM file is long enough,so that
the SA becomes invalid only after the Lifetime Bytes expires.)
TEST_REFERENCE
RFC 4301 s4.4.2 p37 Security Association Database (SAD)
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with Lifetime
        <LifeTimeBytes> bytes
-SETUP: Configure lifetime seconds on DUT such that
        SA doesnt get expired
- ANVL: Send as many ICMPv6 Echo Requests as possible within the
        Lifetime from Local Host
-  DUT: Forward the corresponding ESP secured ICMPv6 Echo Requests
        to Remote Host
- ANVL: Send an ICMPv6 Echo Request of size more than the residue
        Lifetime bytes from Local Host
-  DUT: Do not forward the corresponding ESP secured ICMPv6
        Echo Requests to Remote Host
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2448  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2449  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2450  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2451  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2452  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1782] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1781] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1783] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1784] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 1065 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
0=128.224.166.238

1=6

2=0

3=3ffe:1111::5555

4=3ffe:2222::5555

5=64

6=64

7=3ffe:2222::1111

8=3ffe:1111::1111

9=TUNNEL

10=MANUAL

11=PRESHARED-KEY

12=HMAC_MD5

13=HMAC_MD5_96

14=AH_MD5

15=NULL

16=NOT_CONFIGURED

17=66306630663066306630663066302222

18=800000000000000040000000000000002000000000000000

19=768

20=770

21=NOT_CONFIGURED

22=SHA

23=DES_CBC

24=MODP768

25=1065

26=MODP1024

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> guo4
cmd keyadm update -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -bh 1065
SADB_MSG: msgtype=UPDATE  err=0  satype=ESP  len=144  seq=2453  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=0 usetime=0 bytes=1065
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=2454  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=31474 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31474 usetime=0 bytes=0
    HARD: addtime=0 usetime=0 bytes=1065
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 120 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2455  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 1290 -lh 120 
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=144  seq=2456  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
    HARD: addtime=120 usetime=0 bytes=1290
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2457  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=216  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31475 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1290
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 1 ICMPv6 plain Packet to DUT to expire Lifetime
byte in DUT
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 1024 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 8B 41 3C DB 3B 83 93 29 75 A0 19               ..A<.;..)u..
ESP: --- Authentication Data End ---
ESP:

Correctly, 1st ESP packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 960 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC8D5 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [952 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6:  01 01 01 01 01 01 01 01                           ........
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Correctly, no ESP packets received on interface eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2459  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2460  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2461  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2462  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2463  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1789] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1788] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1790] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1791] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-15.4: Passed

>> IPSECV6-ESP-16.1
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on a Destination IPv6 Address
selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IPv6-datagrams
        (via interface D1) with IPv6 Destination Address set to
        ANVL Remote Address use Discard policy
- ANVL: Send ICMPv6 Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Do not forward secured ICMPv6 Echo Request to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send ICMPv6 Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Forward unsecured ICMPv6 Echo Request to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send ICMPv6 Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Forward secure ICMPv6 Echo Request to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2464  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2465  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2466  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2467  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2468  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1793] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1792] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1794] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1795] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2469  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1796
------------------------------------------
-> cmd keyadm dumpflow -egress
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2470  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1792
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1796
------------------------------------------
Total of 2 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received non-encrypted IP packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Incorrectly received secured ICMPv6 packet on interface
! eth3 (3ffe:1111::1111) (Remote Host)


Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 BYPASS REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=2471  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm dumpflow -egress
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2472  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1792
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=out id=1797
------------------------------------------
Total of 2 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received ICMPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)


Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for REMOTE Host (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 APPLY REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2473  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm dumpflow -egress
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2474  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1792
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1798
------------------------------------------
Total of 2 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly Received ICMPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-16.1: !FAILED!

>> IPSECV6-ESP-16.2
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on a Source IPv6 Address selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with IPv6 Source Address set to A2Addr use Discard
        policy
- ANVL: Send ICMPv6 Echo Request from Local Host
-  DUT: Do not forward secured ICMPv6 Echo Request to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send ICMPv6 Echo Request from Local Host
-  DUT: Forward ICMPv6 Echo Request to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send ICMPv6 Echo Request from Local Host
-  DUT: Forward secure ICMPv6 Echo Request to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2475  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2476  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2477  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2478  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2479  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1800] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1799] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1801] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1802] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 DISCARD LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=288  seq=2480  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1803
------------------------------------------
-> cmd keyadm dumpflow -egress
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2481  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1799
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=NONE  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1803
------------------------------------------
Total of 2 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)


Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=272  seq=2482  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm dumpflow -egress
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2483  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1799
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=bypass prio=0 dscp=0x0 dir=out id=1804
------------------------------------------
Total of 2 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received Neighbor Solicitation from fe80::215:17ff:fec8:9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9028
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB6E1 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x508A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)


Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for LOCAL Host (3ffe:2222::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:2222::1111 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2484  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> cmd keyadm dumpflow -egress
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=BYPASS  len=136  seq=2485  pid=0x5de180
PROTOCOL: proto=UDP 
 SRCFLOW: addr=128.224.166.238/32 port=500
 DSTFLOW: addr=0.0.0.0/0
 FLOWOPT: type=bypass prio=-120 dscp=0x0 dir=out id=1799
------------------------------------------
SADB_MSG: msgtype=X_DUMPFLOW  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=use prio=0 dscp=0x0 dir=out id=1805
------------------------------------------
Total of 2 flows
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-16.2: Passed

>> IPSECV6-ESP-16.3
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on Transport Layer Protocol
selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with Transport Layer Protocol <protocol> use
        Discard policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer
        Protocol <protocol>
-  DUT: Do not forward secured IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer
        Protocol <protocol>
-  DUT: Forward IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send ICMPv6 Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Forward secured IPv6 Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = ICMPv6
- CASE: <protocol> = TCP
- CASE: <protocol> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2486  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2487  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2488  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2489  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2490  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1807] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1806] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1808] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1809] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = ICMPv6

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for icmpv6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2491  pid=0x632d10
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1810
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for icmpv6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2492  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for icmpv6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmpv6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2493  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2494  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2495  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2496  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2497  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2498  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1814] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1813] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1815] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1816] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2499  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1817
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for TCP Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2500  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for TCP Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2501  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x608D (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E5 93 75 AE 7C D1 F8 6D 72 3C A9 E9               ..u.|..mr<..
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2502  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2503  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2504  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2505  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2506  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1821] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1820] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1822] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1823] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2507  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1824
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for UDP Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2508  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for UDP Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2509  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  06 9D A2 6F 97 A5 74 61 26 7F 36 B6               ...o..ta&.6.
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2510  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2511  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2512  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2513  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2514  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1828] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1827] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1829] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1830] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-16.3: Passed

>> IPSECV6-ESP-16.4
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on TCP/UDP Source Port Number
selector
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with Transport Layer Protocol <protocol> and
        Transport Layer Source Port <port> use Discard policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer
        Protocol <protocol> and Transport Layer Source Port <port>
-  DUT: Do not forward secured IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer
        Protocol <protocol> and Transport Layer Source Port <port>
-  DUT: Forward IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer
        Protocol <protocol> and Transport Layer Source Port <port>
-  DUT: Forward secured IPv6 Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = TCP, <port> = 6000
- CASE: <protocol> = UDP, <port> = 6000
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2515  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2516  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2517  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2518  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2519  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1832] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1831] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1833] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1834] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 6000  -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2520  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=6000
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1835
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for TCP Packet
Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 6000 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2521  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=6000
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for TCP Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -srcport 6000 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2522  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=6000
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x702E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CC 6F 3D A7 1F 9A C5 8D CC 62 D4 D5               .o=......b..
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2523  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2524  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2525  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2526  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2527  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1839] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1838] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1840] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1841] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Source Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 6000  -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2528  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=6000
 DSTFLOW: addr=3ffe:1111::1111/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1842
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for UDP Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 6000 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2529  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=6000
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for UDP Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -srcport 6000 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2530  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64 port=6000
 DSTFLOW: addr=3ffe:1111::1111/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  32 36 54 5A D6 57 2C 0B 66 7B 7D EC               26TZ.W,.f{}.
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2531  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2532  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2533  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2534  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2535  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1846] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1845] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1847] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1848] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-16.4: Passed

>> IPSECV6-ESP-16.5
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify security
processing for outbound traffic based on TCP/UDP Destination Port
Number selector
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with Transport Layer Protocol <protocol> and
        Transport Layer Destination Port <port> use Discard policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer Protocol
        <protocol> and Transport Layer Destination Port <port>
-  DUT: Do not forward secured IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer Protocol
        <protocol> and Transport Layer Destination Port <port>
-  DUT: Forward IPv6 Packet to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send IPv6 Packet from Local Host with Transport Layer Protocol
        <protocol> and Transport Layer Destination Port <port>
-  DUT: Forward secured IPv6 Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = TCP, port = <6000>
- CASE: <protocol> = UDP, port = <6000>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2536  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2537  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2538  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2539  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2540  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1850] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1849] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1851] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1852] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Destination Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 6000 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2541  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=6000
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1853
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for TCP Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 6000 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2542  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for TCP Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 6 -dstport 6000 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2543  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=TCP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 84 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 20 (bytes)
IPv6: Next Header          = TCP (6)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x973E (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  66 8D 0E 5A 74 58 19 24 5F 0E 20 88               f..ZtX.$_. .
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2544  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2545  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2546  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2547  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2548  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1857] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1856] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1858] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1859] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Destination Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 6000 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2549  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=6000
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1860
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for UDP Packet
Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, no IPv6 packets received on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 6000 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2550  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for UDP Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::1111 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 17 -dstport 6000 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2551  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=UDP 
 SRCFLOW: addr=3ffe:2222::1111/64
 DSTFLOW: addr=3ffe:1111::1111/64 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 72 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 8 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  01 57 9D 71 32 26 2A 6F 07 6F 33 DA               .W.q2&*o.o3.
ESP: --- Authentication Data End ---
ESP:

Correctly Received IPv6 Packet on interface
eth3 (3ffe:1111::1111)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2552  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2553  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2554  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2555  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2556  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1864] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1863] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1865] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1866] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-16.5: Passed

>> IPSECV6-ESP-16.8
TEST_DESCRIPTION
IPsec MUST allow an management interface to specify the security
processing for outbound traffic based on SA value - Next Layer 
protocol (e.g. ICMPv6). 
TEST_REFERENCE
rfc 4301 S4.4.1, p23, The Security Policy Database (SPD)
rfc 4301 S4.4.1.1, p28, Selectors
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD:  Discard packets 
         containing next protocol set to ICMPv6
- ANVL:  Send an ICMPv6 packets, from Local Host through the DUT 
         to Remote Host
-  DUT:  Do not forward the ICMPv6 packet to Remote Host
- SETUP: Add the following entry in the DUT SPD:  Bypass IPsec for
         packets containing next protocol set to ICMPv6
- ANVL:  Send an ICMPv6 packet, from Local Host through the DUT 
         to Remote Host  
-  DUT:  Forward the ICMPv6 packet to Remote Host  
- SETUP: Add the following entry in the DUT SPD:  Use IPsec while  
         packets containing next protocol set to ICMPv6
- ANVL:  Send an ICMPv6 packet, from Local Host through the DUT 
         to Remote Host 
-  DUT:  Forward the secured ICMPv6 packet to Remote Host 
- ANVL:  Restore the DUT SPD 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2557  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2558  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2559  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2560  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2561  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1868] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1867] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1869] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1870] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2562  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1871
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Correctly, no IPv6 packet received on interface eth3 (3ffe:1111::1111)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2563  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected Unsecured IP Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2564  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Received expected secured IPv6 Packet on interface
eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2565  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2566  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2567  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2568  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2569  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1875] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1874] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1876] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1877] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-16.8: Passed

>> IPSECV6-ESP-18.2
TEST_DESCRIPTION
ESP and AH headers can be combined in a variety of modes.  The IPsec
Architecture document describes the combinations of security
associations that must be supported.
TEST_REFERENCE
Rfc 4303 s3.1 ESP Header Location
TEST_METHOD
 Setup: Setup one SA on DUT between AIface-1 and DIface-1
        providing both confidentiality and authentication
 ANVL : Send an ICMPV6 Request for AIface-1 on DIface-0
 DUT  : Forward ICMPV6 Request to AIface-1 after applying SAs
 ANVL : Verify received ICMPV6 Request contains
        - atleast one ESP header with Authentication data
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2570  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2571  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2572  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2573  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2574  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1879] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1878] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1880] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1881] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:


Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-18.2: Passed

>> IPSECV6-ESP-19.1
TEST_DESCRIPTION
In transport mode, the DSCP value might change en route, but this SHOULD
not cause problems with respect to IPsec processings - since the value
is not employed for SA selection and MUST NOT be checked as part of
SA/packet validation.
(Note: DSCP is the Traffic Class field of IPv6 header)
TEST_REFERENCE
rfc 4301 S4.1 p14 Definition and Scope
TEST_METHOD
- ANVL: Send an ICMPv6 echo request from Local host to
        DUT, with DSCP field set to <DSCP>
- ANVL: Listen up to <ParamListenTime> for ESP-secured ICMPv6
        echo reply.
-  DUT: Send an secured echo reply to <AIface-0>
- ANVL: Verify that the received packet is ESP-secured.
- CASE: <DSCP> = 40 (EXPRESS FWDing precedence)
- CASE: <DSCP> = 48 (stays for IP routing protocol)
- CASE: <DSCP> = 0  (Default case. Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2575  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2576  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2577  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2578  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2579  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1883] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1882] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1884] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1885] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ndp -i gei0 -s 3ffe:1111::1111 00:06:29:99:70:78 
Cmd: 'ndp' not found.
C interp: cannot evaluate command
-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2580  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555  -akey 66306630663066306630663066302222 -enc none -ingress  
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2581  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow  3ffe:1111::1111 -dstflow 3ffe:1111::5555 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -ingress 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2582  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::1111/128
 DSTFLOW: addr=3ffe:1111::5555/128
------------------------------------------
-> cmd keyadm add -proto esp -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111  -akey 66306630663066306630663066302222 -enc none 
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2583  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:1111::5555 -dstflow  3ffe:1111::1111 -srcmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff -dstmask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2584  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:1111::5555/128
 DSTFLOW: addr=3ffe:1111::1111/128
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1887] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1886] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1888] :: use src=3ffe:1111::1111/128:any dst=3ffe:1111::5555/128:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1889] :: use src=3ffe:1111::5555/128:any dst=3ffe:1111::1111/128:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


		 Case: Setting DSCP field to 40
		----------------------------------

Sending encrypted IPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::5555)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 160
IPv6:  |01234567
IPv6:  |101000..           = 40 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000026 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 00 00 00 00 26 80 00 6D 23 00 00 00 00   .......&..m#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A2 78 16 44 73 E9 A2 9B 22 25 BB 91               .x.Ds..."%..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 02 00 00 00 02 81 00 6C 23 00 00 00 00   ..........l#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6B 0D B7 77 6C E4 B3 0A 5E 47 31 27               k..wl...^G1'
ESP: --- Authentication Data End ---
ESP:

Received expected secured packet on interface eth3 (3ffe:1111::1111)


		 Case: Setting DSCP field to 48
		----------------------------------

Sending encrypted IPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::5555)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 192
IPv6:  |01234567
IPv6:  |110000..           = 48 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000027 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 00 00 00 00 27 80 00 6D 23 00 00 00 00   .......'..m#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F6 A1 FF 36 7D 59 83 6E 53 33 13 16               ...6}Y.nS3..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 02 00 00 00 03 81 00 6C 23 00 00 00 00   ..........l#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  35 F7 26 C1 AA B7 50 65 BF 91 00 FE               5.&...Pe....
ESP: --- Authentication Data End ---
ESP:

Received expected secured packet on interface eth3 (3ffe:1111::1111)


		 Case: Setting DSCP field to 0
		----------------------------------

Sending encrypted IPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::5555)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000028 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6D23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 00 00 00 00 28 80 00 6D 23 00 00 00 00   .......(..m#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1C 28 F5 A6 7A BC 1D 60 39 02 2B A6               .(..z..`9.+.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet

Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x6C23 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: --- Payload Data [32 bytes] ---
ESP:  00 00 03 02 00 00 00 04 81 00 6C 23 00 00 00 00   ..........l#....
ESP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 58 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1D A4 63 AB 02 E2 FF 4D 4F 9B AE BA               ..c....MO...
ESP: --- Authentication Data End ---
ESP:

Received expected secured packet on interface eth3 (3ffe:1111::1111)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:1111::5555 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2585  pid=0x639a70
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1891] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1890] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
Total of 2 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-19.1: Passed

>> IPSECV6-ESP-19.2
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the DS field from the inner IP
header to the outer IP header.
(Note: DS is the Traffic Class field of IPv6 header)
TEST_REFERENCE
RFC 4301 s5.1.2.2 p59 IPv6 header construction for tunnel mode
TEST_METHOD
- ANVL: Send ICMPv6 Echo Request from Local Host, with the DS field
        in the inner IP-Header set to <ds>
-  DUT: Forward secured ICMPv6 Echo Request to Remote Host
- ANVL: Verify that the DS field of the outer header is set to <ds>
- CASE: <DSCP> = 101110 (High Priority, Expedited Forwarding)
- CASE: <DSCP> = 001010 (Assured forwarding 11)
- CASE: <DSCP> = 000000 (Default case.Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2586  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2587  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2588  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2589  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2590  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1893] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1892] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1894] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1895] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a plain packet with DSCPfield set to 0xB8
Sending non-encrypted ICMP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 184
IPv6:  |01234567
IPv6:  |101110..           = 46 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 184
IPv6:  |01234567
IPv6:  |101110..           = 46 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 184
IPv6:  |01234567
IPv6:  |101110..           = 46 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  95 24 04 88 40 B5 1F 75 BA 23 B6 79               .$..@..u.#.y
ESP: --- Authentication Data End ---
ESP:

Correctly received outer IP DSCP field: 0xB8
on interface eth3 (3ffe:1111::1111) (Remote Host) 


 Case: Sending a plain packet with DSCPfield set to 0x28
Sending non-encrypted ICMP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 40
IPv6:  |01234567
IPv6:  |001010..           = 10 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 40
IPv6:  |01234567
IPv6:  |001010..           = 10 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 40
IPv6:  |01234567
IPv6:  |001010..           = 10 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  43 1A C9 B3 4B B5 64 01 1A 2C D8 4A               C...K.d..,.J
ESP: --- Authentication Data End ---
ESP:

Correctly received outer IP DSCP field: 0x28
on interface eth3 (3ffe:1111::1111) (Remote Host) 


 Case: Sending a plain packet with DSCPfield set to 0x0
Sending non-encrypted ICMP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9E E5 34 23 6C 9A 55 A6 19 56 9F B1               ..4#l.U..V..
ESP: --- Authentication Data End ---
ESP:

Correctly received outer IP DSCP field: 0x0
on interface eth3 (3ffe:1111::1111) (Remote Host) 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-19.2: Passed

>> IPSECV6-ESP-19.3
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the ECN field from 
the inner IPv6 header to the outer IPv6 header.
(Note: This test is for tunnel mode, Encapsulator side)
TEST_REFERENCE
RFC 4301 s5.1.2.2 p59 IPv6 header construction for tunnel mode
IETF-proceedings-draft-ipsec-ecn-00.txt s3.1.3 p7 
TEST_METHOD
- ANVL: Send plain ICMPv6 Echo Request from Local Host to Remote host 
     through DUT
-  DUT: Forward secured ICMP Echo Request to Remote Host
- ANVL: Verify that the ECT & CE bit-field of the outer IP-header 
- CASE: <ECN> = 2 
- CASE: <ECN> = 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2591  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2592  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2593  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2594  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2595  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1897] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1896] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1898] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1899] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a plain packet with ECNfield set to 2
Sending non-encrypted ICMP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received Neighbor Solicitation from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB803 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x51AC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 2
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......10           = 2 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AC 61 E5 A8 1A 29 EF A2 40 CF 9E 93               .a...)..@...
ESP: --- Authentication Data End ---
ESP:

 Correctly received outer ECT bit field: 2
 on interface eth3 (3ffe:1111::1111) (Remote Host) 


 Case: Sending a plain packet with ECNfield set to 0
Sending non-encrypted ICMP packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  66 35 30 DF 7C 3C 79 2B E4 C7 B0 7D               f50.|<y+...}
ESP: --- Authentication Data End ---
ESP:

 Correctly received outer ECT bit field: 0
 on interface eth3 (3ffe:1111::1111) (Remote Host) 

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-19.3: Passed

>> IPSECV6-ESP-22.1
TEST_DESCRIPTION
If the tunnel mode is being used, then the IPsec implementation can add
Traffic Flow Confidentiality(TFC) padding after the payload data and
before the Padding(0-255 bytes) field.
TEST_REFERENCE
RFC 4303 s2 p7 ESP packet format
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from local host to remote host
        through the DUT.
-  DUT: Forward the ESP-secured ICMPv6 Echo Request to Remote Host
        containing:
        - TFC padding after the payload and before the Padding field.
- ANVL: Verify that the TFC padding in the recieved ESP-secured packet.
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2596  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2597  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2598  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2599  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2600  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1901] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1900] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1902] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1903] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
153848999

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-TFC-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2601  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2602  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2603  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2604  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2605  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=2606  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=31616 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=0  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31616 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 120 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
IPV6: --- Trailing Data [32 bytes] ---
IPV6:  FE F1 3D 46 3D 6E 77 18 BE 38 C2 DC 29 62 E8 5F   ..=F=nw..8..)b._
IPV6:  36 2E 6B 0C 46 26 38 DC B9 6C 0A D2 F3 08 B9 9B   6.k.F&8..l......
IPV6: --- Trailing Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  98 71 D8 95 DE 09 A0 3F 0C A9 16 A3               .q.....?....
ESP: --- Authentication Data End ---
ESP:

Correctly received pkt has TFC padding in ESP header
on interface eth3 (3ffe:1111::1111) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
153849004

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-TFC-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2607  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2608  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2609  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2610  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2611  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=2612  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=31617 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=0  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31617 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-22.1: Passed

>> IPSECV6-ESP-22.2
TEST_DESCRIPTION
If TFC padding is added, the field containing the specification of the 
length of the IP datagram MUST NOT be modified to reflect this padding.
TEST_REFERENCE
RFC 4303 s2.7 p17 TFC Padding 
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request from local host to remote host
        through the DUT
-  DUT: Forward the ESP-secured ICMPv6 Echo Request to remote Host
        containing
        - TFC padding after the payload and before the Padding field.
- ANVL: Verify that the Datagram-length field is same as the actual
        Payload length.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2613  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2614  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2615  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2616  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2617  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1913] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1912] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1914] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1915] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
153848999

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-TFC-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2618  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2619  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2620  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2621  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2622  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=2623  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=31618 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=0  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31618 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x00 *Should be 0xA253*
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x00 *Should be 0xA253*
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
IPV6: --- Trailing Data [21 bytes] ---
IPV6:  44 F0 B5 4A 4E B5 F9 ED E8 6F 7B 29 49 AC F1 A4   D..JN....o{)I...
IPV6:  DB 2E C6 B4 C0                                    .....
IPV6: --- Trailing Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [1 bytes] ---
ESP:  01                                                .
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 1 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  87 62 E3 8A 89 A5 CB 50 8B 3D CB D6               .b.....P.=..
ESP: --- Authentication Data End ---
ESP:

Correctly received pkt has TFC padding in ESP header
on interface eth3 (3ffe:1111::1111) (Remote Host)
Inner IPv6 data Length field of the received packet
is same as what transmitted. 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
153849004

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-configure-TFC-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2624  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2625  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2626  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -tfc
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2627  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2628  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd keyadm dump
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=2629  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel ingress tfc 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 AUTHKEY: bits=128
 CURRENT: addtime=31620 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=184  seq=0  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=0  tunnel tfc 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 AUTHKEY: bits=128
 CURRENT: addtime=31620 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-22.2: Passed

>> IPSECV6-ESP-22.3
TEST_DESCRIPTION
IPSec MUST accept an IPv6-datagram which is properly secured using
ESP protocol with TFC padding.
TEST_REFERENCE
RFC 4303 s2 p5 Encapsulating Security Payload Packet Format
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from Remote Host
        containing:
        - TFC padding bytes
-  DUT: Forward the ICMPv6 Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2630  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2631  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2632  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2633  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2634  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1925] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1924] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1926] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1927] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 96 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000029 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
IPV6: --- Trailing Data [8 bytes] ---
IPV6:  01 02 00 00 00 00 00 00                           ........
IPV6: --- Trailing Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  3D E8 38 6D 74 3E 7B 6F A7 30 D8 1F               =.8mt>{o.0..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received non-encrypted IP packet from 3ffe:1111::1111 on interface eth4 (3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
IPV6: --- Trailing Data [8 bytes] ---
IPV6:  01 02 00 00 00 00 00 00                           ........
IPV6: --- Trailing Data End ---

Received expected unsecured IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-22.3: Passed

>> IPSECV6-ESP-23.1
TEST_DESCRIPTION
If the value of the Next header field is 59(i.e. no next header), the
packet (Dummy packet) is discarded without further processing.
TEST_REFERENCE
RFC 4303, s3.4.4., p31, Separate Confidentiality & Integrity Algorithm 
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 Echo Request from remote host to
        local host through the DUT having Next Layer Protocol field
        of ESP header set to 59.
-  DUT: Do not forward the ICMPv6 Echo Request to local Host.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2635  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2636  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2637  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2638  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2639  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1929] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1928] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1930] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1931] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Next Header to 59 in ESP Trailer
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 96 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000002A 
ESP:
ESP: --- Payload Data [80 bytes] ---
ESP:  00 00 03 00 00 00 00 2A 60 00 00 00 00 18 3A FF   .......*`.....:.
ESP:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 11 11   ?...............
ESP:  3F FE 22 22 00 00 00 00 00 00 00 00 00 00 11 11   ?.""............
ESP:  80 00 A0 56 00 00 00 00 41 4E 56 4C 20 54 45 53   ...V....ANVL TES
ESP:  54 20 44 41 54 41 20 20 01 02 00 00 00 00 00 00   T DATA  ........
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 59 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9B E3 08 74 0E 61 6F C2 E2 15 FC 7B               ...t.ao....{
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly, did not receive IPv6 packet on interface
eth4 (3ffe:2222::1111) (Local Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-23.1: Passed

>> IPSECV6-ESP-24.1
TEST_DESCRIPTION
No valid SA exists for a session.The audit Log entry for this event
SHOULD include the SPI values, date/time received, source address and
destination address, sequence number.
(Note: Here we are doing this test only for SPI mismatch scenario. Can
be done for other parameter mis-match also)
TEST_REFERENCE
RFC 4303, s4, p33, Auditing
TEST_METHOD
- ANVL: Send an ESP-secured ICMPv6 echo request containing a SPI value
        that doesn't match the SPI entry of the established SA from
        remote host.
-  DUT: Discard the packet and LOG the error.
- ANVL: Verify DUT has correctly logged the error with incorrect SPI
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2640  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2641  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2642  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2643  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2644  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1933] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1932] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1934] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1935] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMPv6 (over IPv6) packet from interface eth3 (ANVL virtual address 3ffe:1111::1111) 
to interface eth4 (ANVL virtual address 3ffe:2222::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 96 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::5555
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x0000030A 
ESP: Sequence Number          = 0x0000002B 
ESP:
ESP: --- Payload Data [80 bytes] ---
ESP:  00 00 03 0A 00 00 00 2B 60 00 00 00 00 18 3A FF   .......+`.....:.
ESP:  3F FE 11 11 00 00 00 00 00 00 00 00 00 00 11 11   ?...............
ESP:  3F FE 22 22 00 00 00 00 00 00 00 00 00 00 11 11   ?.""............
ESP:  80 00 A0 56 00 00 00 00 41 4E 56 4C 20 54 45 53   ...V....ANVL TES
ESP:  54 20 44 41 54 41 20 20 01 02 00 00 00 00 00 00   T DATA  ........
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 59 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  32 A2 51 AD 75 CB 33 3E 7D 4E 34 08               2.Q.u.3>}N4.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv6 Packet

Correctly, did not receive IPv6 packet on interface eth4 (3ffe:2222::1111) (Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
778

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> DUT has logged this SA-mismatch phenomenon properly

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-24.1: Passed

>> IPSECV6-ESP-25.1
TEST_DESCRIPTION
To simplify the Next_Layer_Protocol, there SHOULD be a mechanism
for configuring which IPv6 extension headers to skip. The default
configuration SHOULD allow to skip when the IPv6 extension header
is "Hop by Hop options" (Next header code value is Zero).
TEST_REFERENCE
RFC 4301, s4.4.1.1, p27 Selectors(Next Layer Protocol)
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD: DISCARD packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header 
         between the IPv6 header and payload) to Remote host
         from Local host to Remote Host
-   DUT: Do not forward the packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Hop-by-Hop option" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         DISCARD it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: BYPASS packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from
         Local host
-   DUT: Forward the plain ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Hop-by-Hop option" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         BYPASS it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: APPLY IPsec on
         outgoing packets having next higher layer protocol is ICMPv6.
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from 
         Local host
-   DUT: Forward the ESP-secured ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Hop-by-Hop option" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         APPLY IPsec on it according to the SPD.
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2645  pid=0x5b38d0
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2646  pid=0x5b38d0
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2647  pid=0x5b38d0
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2648  pid=0x5b38d0
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2649  pid=0x5b38d0
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1937] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1936] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1938] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1939] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2650  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1940
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Correctly no packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Hop-By-Hop Extended Header
Sending non-encrypted IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet
Correctly no ESP-secured packet received on
interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2651  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet - with Hop-By-Hop header
Sending non-encrypted IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2652  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received expected ESP-secured packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Hop-By-Hop Extended Header
Sending non-encrypted IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 96 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Hop-by-Hop Header (0)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Hop-by-Hop Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  74 F0 1C E4 71 CB F6 05 0F CA A9 0D               t...q.......
ESP: --- Authentication Data End ---
ESP:

Correctly received expected ESP-secured packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-25.1: Passed

>> IPSECV6-ESP-25.3
TEST_DESCRIPTION
To simplify the Next_Layer_Protocol, there SHOULD be a mechanism
for configuring which IPv6 extension headers to skip. The default
configuration SHOULD allow to skip when the IPv6 extension header
is "Destination Options" (Next header code value is 60).
TEST_REFERENCE
RFC 4301, s4.4.1.1, p27 Selectors(Next Layer Protocol)
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD: DISCARD packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from 
         Local host
-   DUT: Do not forward the packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Destination Options" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         DISCARD it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: BYPASS packets
         having next higher layer protocol is ICMPv6
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from
         Local host
-   DUT: Forward the plain ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Destination Options" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         BYPASS it according to the SPD.
- SETUP: Add the following entry in the DUT SPD: APPLY IPsec on
         outgoing packets having next higher layer protocol is ICMPv6.
-  ANVL: Send an ICMPv6 echo-packet(having no extension header
         between the IPv6 header and payload) to Remote host from 
         Local host
-   DUT: Forward the ESP-secured ICMPv6 packet to Remote host.
-  ANVL: Send an ICMPv6 echo-packet having one extension header,
         set to "Destination Options" to Remote host from Local host.
-   DUT: Process the packet deep up to the ICMPv6 header and then 
         APPLY IPsec on it according to the SPD.
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 3ffe:1111::5555 3ffe:2222::5555 64 64 3ffe:2222::1111 3ffe:1111::1111 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 AH_MD5 NULL NOT_CONFIGURED 66306630663066306630663066302222 800000000000000040000000000000002000000000000000 768 770 NOT_CONFIGURED SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2653  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2654  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 3ffe:1111::1111 -dst 3ffe:1111::5555 -srcflow 3ffe:1111::0 -dstflow 3ffe:2222::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2655  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=3ffe:1111::1111
     DST: addr=3ffe:1111::5555
 SRCFLOW: addr=3ffe:1111::/64
 DSTFLOW: addr=3ffe:2222::/64
------------------------------------------
-> cmd keyadm add -proto esp -enc none -auth md5 -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=2656  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=NONE  replay=32  tunnel 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow 3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=272  seq=2657  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1944] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1943] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1945] :: use src=3ffe:1111::/64:any dst=3ffe:2222::/64:any any <- SA: ESP  spi=0x300 src=3ffe:1111::1111 dst=3ffe:1111::5555
[1946] :: use src=3ffe:2222::/64:any dst=3ffe:1111::/64:any any -> SA: ESP  spi=0x302 src=3ffe:1111::5555 dst=3ffe:1111::1111
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=296  seq=2658  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1947
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received Neighbor Solicitation from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x31C5 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:2222::5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1E78 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

! Unexpected IPv6 packet received from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x64F9 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly no packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Destination Options Header
Sending non-encrypted IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet
Received Neighbor Solicitation from fe80::215:17ff:fec8:9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:11:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = fe80::215:17ff:fec8:9028
IPv6: Destination Address  = ff02::1:ff00:1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB6E1 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = fe80::215:17ff:fec8:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x508A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::1111
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly no packet received on interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=280  seq=2659  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for ICMPv6 Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Destination Options Header
Sending non-encrypted IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for IPv6 Packet
Received non-encrypted IP packet from 3ffe:2222::1111 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Correctly received expected plain packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMPV6 transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMPV6 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/ipsecv6-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -src 3ffe:1111::5555 -dst 3ffe:1111::1111 -srcflow 3ffe:2222::0 -dstflow  3ffe:1111::0 -srcmask ffff:ffff:ffff:ffff::0 -dstmask ffff:ffff:ffff:ffff::0 -transport 0 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=280  seq=2660  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=3ffe:1111::5555
     DST: addr=3ffe:1111::1111
PROTOCOL: proto=any
 SRCFLOW: addr=3ffe:2222::/64
 DSTFLOW: addr=3ffe:1111::/64
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.

Sending plain IPv6 packet - without any Extended Header
Sending non-encrypted ICMPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 88 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 24 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 3F F4 11 D4 EF 8A D2 D8 3E 98 33               .?.......>.3
ESP: --- Authentication Data End ---
ESP:

Correctly received expected ESP-secured packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Sending plain IPv6 packet with Destination Option Extended Header
Sending non-encrypted IPv6 packet from interface eth4 (ANVL virtual address 3ffe:2222::1111) 
to interface eth3 (ANVL virtual address 3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting (up to 10.000 seconds) for Encrypted IPv6 Packet
Received encrypted IPv6 packet from 3ffe:1111::5555 on interface eth3 (3ffe:1111::1111)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 96 (bytes)
IPv6: Next Header          = ESP (50)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = Destination Header (60)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
IPv6: ---- Destination Extention Header ---- 
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 0 (in unit of 8 octets)
IPv6: 
IPv6: ---- PadN Option ----
IPv6: 
IPv6: Type                 = 1
IPv6: Data Len             = 4
IPv6: --- PadN Data [4 bytes] ---
IPv6:  00 00 00 00                                       ....
IPv6: --- PadN Data End ---
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA056 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [16 bytes] ---
ICMPv6:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 41 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  32 58 3F 8B AD 75 F4 5A 8D 4D C5 66               2X?..u.Z.M.f
ESP: --- Authentication Data End ---
ESP:

Correctly received expected ESP-secured packet on
interface eth3 (3ffe:1111::1111) (Remote Host)

Neighbor Discovery for 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xA272 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::5555
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x3EB4 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:55:55
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::1111
IPv6: Destination Address  = ff02::1:ff00:5555
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x804F (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::5555

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::5555
IPv6: Destination Address  = 3ffe:2222::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xB80 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::5555
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPSECV6-ESP-25.3: Passed
Executing system command:
  "./DocScriptQ35/IPSECV6-ESP/IPSECV6ESPpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "0"
sysvar: ipnet.inet.AcceptSourceRoute=0 ok
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=2661  pid=0x5de180
------------------------------------------
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          60
Number of tests passed:       58
Number of tests failed:       2
Number of tests inconclusive: 0
