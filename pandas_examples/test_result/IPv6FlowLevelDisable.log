ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6734028 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipv6_FlowLevelDisable ipv6 7 11 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipv6_FlowLevelDisable.prm 

Reboot Time                              60                  # (0x0000003C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IPV6/IPV6postsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IPv6 DUT is a Router                     True
IPv6 Unknown Option Type                 20                  # (0x00000014)
IPv6 Invalid Header                      254                 # (0x000000FE)
IPv6 DUT Echo Request Send Command       "./DocScriptQ35/IPV6/ipv6-dut-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPv6 DUT Periodic Router Advertise Is Supported False
IPv6 DUT Deprecation of RH0 Is Supported False
IPv6 DUT Configure Deprecation of RH0 Command "./DocScriptQ35/IPV6/ipv6-dut-configure-deprecation-of-rh0-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPv6 Suite Setup Command                 "./DocScriptQ35/IPV6/ipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPv6 DUT PPP Interface Configure Command ""
IPv6 MTU of First Interface of DUT       1500                # (0x000005DC)
IPv6 MTU of Second Interface of DUT      1300                # (0x00000514)
IPv6 Unknown Routing Type                10                  # (0x0000000A)
IPv6 DUT Support Flow Level              False
ICMPv6 Packet Listen Time                15                  # (0x0000000F)
ICMPv6 Packet Tolerance Time             1                   # (0x00000001)
ICMPv6 Packet Tolerance Factor           1                   # (0x00000001)
IPv6 Packet Listen Time                  15                  # (0x0000000F)
ICMPv6 ANVL Listen Time                  3                   # (0x00000003)
PPP Send Configure To Start              False
PPP Delay After Connect                  0                   # (0x00000000)
PPP Delay After LCP                      0                   # (0x00000000)
PPP Delay After NCP                      0                   # (0x00000000)
PPP Allow Dynamic Addressing             False

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipv6_FlowLevelDisable.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:1111::9028
  IPV6 ANVL Address                        3ffe:1111::1111
  IPV6 Gateway                             3ffe:1111::9028
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         3ffe:2222::9029
  IPV6 ANVL Address                        3ffe:2222::2222
  IPV6 Gateway                             3ffe:2222::9029
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::9028 64 1500 3ffe:2222::9029 64 1300 ROUTER

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 3ffe:1111::9028 prefixlen 64 mtu 1500 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 3ffe:2222::9029 prefixlen 64 mtu 1300 up 
-> cmd sysvar set -co ipnet.inet6.AcceptRtAdv "1" 
sysvar: ipnet.inet6.AcceptRtAdv=1 ok
-> cmd sysvar set -co ipnet.inet6.radvd.interfaces "gei0,gei1"
sysvar: ipnet.inet6.radvd.interfaces=gei0,gei1 ok
-> cmd radvdconfig gei0 add t0 3ffe:1111::/64 valid 600 preferred 200 L A
t0 already exist on interface gei0
-> cmd radvdconfig gei0 enable t0
-> cmd radvdconfig gei1 add t1 3ffe:2222::/64 valid 600 preferred 200 L A
t1 already exist on interface gei1
-> cmd radvdconfig gei1 enable t1
-> cmd ipd start ipnet_radvd
ipd: start ipnet_radvd ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028
33:33:FF:00:90:28 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:9028 < 3ffe:1111::1111 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 3ffe:1111::1111 < 3ffe:1111::9028 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:1111::9028 as 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029
33:33:FF:00:90:29 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:9029 < 3ffe:2222::2222 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 3ffe:2222::2222 < 3ffe:2222::9029 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 3ffe:2222::9029 as 00:15:17:C8:90:29

This test suite tests statements from:
RFC 2460: 'Internet Protocol, Version6 (IPv6) Specification'
(S. Deering (Cisco), R. Hinden(Nokia), December 1998)
RFC 2464: 'Transmission of IPv6 Packets over Ethernet Networks'
(M. Crawford, Femilab, December 1998)

ANVL Test Suite Required Setup:
This suite expects to be running against an IPv6 host or a router which
has an IPv6 stack. There are a number of parameters controlling this
suite that need to be setup for a completely automated run.
Many of the tests can be run against a single interface, but more 
thorough testing requires that the machine ANVL is running on be 
connected to 2 interfaces that are connected to the router under test.

The ANVL config file must contain at least one IP interface
configured. 




This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IPV6-7.2
TEST_DESCRIPTION
If, while processing an IPv6 packet, a node encounters a Routing
header with an unrecognized Routing Type value, and if Segments Left
is zero, the node must ignore the Routing header and proceed to
process the next header in the packet
TEST_REFERENCE
RFC 2460 s4.4 p12 Routing Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header with an <UnrecognizedRoutingtype>.
          Address field of Routing Option Header is set to the
          address of host-2 and Segments Left field is set to 0
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that the Identification Number, Sequence Number and
        Data of received ICMPv6 Echo Reply are same as those of
        the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Routing Option Header
of unrecognized type
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 10
IPv6: Segments Left        = 0
IPv6: 
IPv6: --- Unknown Routing Type specific Data [20 bytes] ---
IPv6:  00 00 00 00 3F FE 22 22 00 00 00 00 00 00 00 00   ....?.""........
IPv6:  00 00 22 22                                       ..""
IPv6: --- Unknown Routing Type specific Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-7.2: Passed

>> IPV6-7.3
TEST_DESCRIPTION
If, while processing an IPv6 packet, a node encounters a Routing 
header with an unrecognized Routing Type value and if Segments Left
is non-zero, it sends an ICMP Parameter Problem, Code 0, message to
the packet's Source Address, pointing to the unrecognized Routing
Type
TEST_REFERENCE
RFC 2460 s4.4 p12 Routing Header
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header with an <UnrecognizedRoutingtype>.
          Address field of Routing Option Header is set to the
          address of host-2 and Segments Left field is set to 1
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 0
        - ICMPv6 Pointer field pointing to unrecognized Routing
          Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet with Routing Option Header
of unrecognized type
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::
Problem in Routing Header : Routing type(10) unknown

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 10
IPv6: Segments Left        = 1
IPv6: 
IPv6: --- Unknown Routing Type specific Data [20 bytes] ---
IPv6:  00 00 00 00 3F FE 22 22 00 00 00 00 00 00 00 00   ....?.""........
IPv6:  00 00 22 22                                       ..""
IPv6: --- Unknown Routing Type specific Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Checksum can't be calculated)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from ::78bb:700:80:ffff 
to 3ffe:1111::1111
Problem in Routing Header : Routing type(10) unknown

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = ::78bb:700:80:ffff
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 0 (Errorneous header field encountered)
ICMPv6: Checksum           = 0x67C3 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 52 (bytes)
ICMPv6: IPv6: Next Header          = Routing Header (43)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [52 bytes] ---
ICMPv6: IPv6:  3A 02 0A 01 00 00 00 00 3F FE 22 22 00 00 00 00   :.......?.""....
ICMPv6: IPv6:  00 00 00 00 00 00 22 22 80 00 77 36 00 00 00 00   ......""..w6....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 10
IPv6: Segments Left        = 1
IPv6: 
IPv6: --- Unknown Routing Type specific Data [20 bytes] ---
IPv6:  00 00 00 00 3F FE 22 22 00 00 00 00 00 00 00 00   ....?.""........
IPv6:  00 00 22 22                                       ..""
IPv6: --- Unknown Routing Type specific Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Checksum can't be calculated)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 2,
pointing to the Unrecognized Option Type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-7.3: Passed

>> IPV6-7.4
TEST_DESCRIPTION
If, while processing an IPv6 packet, a node encounters a Routing
header with an unrecognized Routing Type value, and if Segments Left
is zero, the node must ignore the Routing header and proceed to
process the next header in the packet
TEST_REFERENCE
RFC 2460 s4.4 p12 Routing Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header with an <UnrecognizedRoutingtype>.
          Address field of Routing Option Header is set to the
          address of DUT and Segments Left field is set to 0
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that the Identification Number, Sequence Number and
        Data of received ICMPv6 Echo Reply are same as those of
        the ICMPv6 Echo Request sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Routing Option Header
of unrecognized type
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 10
IPv6: Segments Left        = 0
IPv6: 
IPv6: --- Unknown Routing Type specific Data [20 bytes] ---
IPv6:  00 00 00 00 3F FE 11 11 00 00 00 00 00 00 00 00   ....?...........
IPv6:  00 00 90 28                                       ...(
IPv6: --- Unknown Routing Type specific Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received ICMPv6 Echo
Reply have same Identification Number, Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-7.4: Passed

>> IPV6-7.5
TEST_DESCRIPTION
If, while processing an IPv6 packet, a node encounters a Routing 
header with an unrecognized Routing Type value and if Segments Left
is non-zero, it sends an ICMP Parameter Problem, Code 0, message to
the packet's Source Address, pointing to the unrecognized Routing
Type
TEST_REFERENCE
RFC 2460 s4.4 p12 Routing Header
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - a Routing Option Header with an <UnrecognizedRoutingtype>.
          Address field of Routing Option Header is set to the
          address of DUT and Segments Left field is set to 1
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Parameter Problem message to <AIface-0>
- ANVL: Verify that the ICMPv6 message contains:
        - ICMPv6 code value 0
        - ICMPv6 Pointer field pointing to unrecognized Routing
          Type
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.

Sending ICMPv6 Echo Request Packet with Routing Option Header
of unrecognized type
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:1111::
Problem in Routing Header : Routing type(10) unknown

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 10
IPv6: Segments Left        = 1
IPv6: 
IPv6: --- Unknown Routing Type specific Data [20 bytes] ---
IPv6:  00 00 00 00 3F FE 11 11 00 00 00 00 00 00 00 00   ....?...........
IPv6:  00 00 90 28                                       ...(
IPv6: --- Unknown Routing Type specific Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Checksum can't be calculated)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Parameter Problem from ::78bb:700:80:ffff 
to 3ffe:1111::1111
Problem in Routing Header : Routing type(10) unknown

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 100 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = ::78bb:700:80:ffff
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 4 (Parameter Problem)
ICMPv6: Code               = 0 (Errorneous header field encountered)
ICMPv6: Checksum           = 0x67C3 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Parameter Problem ----
ICMPv6: 
ICMPv6: Pointer             = 42
ICMPv6: 
ICMPv6: IPv6: ---- IPv6 Packet ----
ICMPv6: IPv6: 
ICMPv6: IPv6: Version              = 6
ICMPv6: IPv6: Traffic Class        = 0
ICMPv6: IPv6:  |01234567
ICMPv6: IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
ICMPv6: IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
ICMPv6: IPv6: Flow Label           = 0
ICMPv6: IPv6: Payload Length       = 52 (bytes)
ICMPv6: IPv6: Next Header          = Routing Header (43)
ICMPv6: IPv6: Hop Limit            = 255
ICMPv6: IPv6: Source Address       = 3ffe:1111::1111
ICMPv6: IPv6: Destination Address  = 3ffe:1111::9028
ICMPv6: IPv6: 
ICMPv6: IPv6: ---- End of IPv6 Header ----
ICMPv6: IPv6:
ICMPv6: IPv6: --- Payload [52 bytes] ---
ICMPv6: IPv6:  3A 02 0A 01 00 00 00 00 3F FE 11 11 00 00 00 00   :.......?.......
ICMPv6: IPv6:  00 00 00 00 00 00 90 28 80 00 1A 41 00 00 00 00   .......(...A....
ICMPv6: IPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6: IPv6:  53 54 45 52                                       STER
ICMPv6: IPv6: --- Payload End ---
ICMPV6: ---- End of Parameter Problem Packet ----
ICMPV6: 
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 52 (bytes)
IPv6: Next Header          = Routing Header (43)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
IPv6: ---- Routing Extention Header ----
IPv6: 
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hdr Ext Len          = 2 (in unit of 8 octets)
IPv6: Routing Type         = 10
IPv6: Segments Left        = 1
IPv6: 
IPv6: --- Unknown Routing Type specific Data [20 bytes] ---
IPv6:  00 00 00 00 3F FE 11 11 00 00 00 00 00 00 00 00   ....?...........
IPv6:  00 00 90 28                                       ...(
IPv6: --- Unknown Routing Type specific Data End ---
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Checksum can't be calculated)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT correctly sent ICMPv6 Parameter Problem, Code 0,
pointing to the Unrecognized Option Type

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-7.5: Passed

>> IPV6-11.1
TEST_DESCRIPTION
Hosts or routers that do not support the functions of the Flow Label
field are required to set the field to zero when originating a
packet
TEST_REFERENCE
RFC 2460 s6 p23 Flow Labels
TEST_METHOD
- ANVL: Cause DUT to send an ICMPv6 Echo Request to <AIface-0>
        containing:
        - source address set to address of DUT
        - destination address set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Request to <AIface-0>
- ANVL: Verify that Flow Label field value of the received packet
        is zero
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.


Causing DUT to send ICMPv6 Echo Request of size 100
to	3ffe:1111::1111
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3ffe:1111::1111 100

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IPV6/ipv6-dut-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Waiting for an Echo Request from DUT
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmReceived IPv6 Packet from 3ffe:1111::9028
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 148 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xEE09 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 50784
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [140 bytes] ---
ICMPv6:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMPv6:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMPv6:  40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F   @ABCDEFGHIJKLMNO
ICMPv6:  50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F   PQRSTUVWXYZ[\]^_
ICMPv6:  60 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F   `abcdefghijklmno
ICMPv6:  70 71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 20   pqrstuvwxyz{|}~ 
ICMPv6:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ICMPv6:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ICMPv6:  41 42 43 44 45 46 47 48 49 4A 4B 4C               ABCDEFGHIJKL
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received expected Echo Request from DUT
Flow Label field value of the received packet is zero
d ping6 -c 1 -s 148 3ffe:1111::1111 

Pinging 3ffe:1111::1111 (3ffe:1111::1111) with 148 bytes of data:

--- 3ffe:1111::1111 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1017 ms
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-11.1: Passed

>> IPV6-11.2
TEST_DESCRIPTION
Hosts or routers that do not support the functions of the Flow Label
field are required to pass the field on unchanged when forwarding a
packet
TEST_REFERENCE
RFC 2460 s6 p23 Flow Labels
TEST_METHOD
- ANVL: Perform Router Solicitation
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of host-2
        - Flow Label field of IPv6 header set to non-zero value
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-1>
-  DUT: Forward the packet to <AIface-1>
- ANVL: Verify that Flow Label field value remains unaltered
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-2 (TOPO-2)
-------------------

       +----------+
       |          |<AIface-0>           N0
       |  HOST-1  |+---------------------+
       |          |                      |             +-------------+
       +----------+                      |   <DIface-0>|             |
                                         +------------+|    DUT      |
                                                       |             | 
                                         +------------+| (as router) |
       +----------+                      |   <DIface-1>|             |
       |          |                      |             +-------------+
       |  HOST-2  |+---------------------+
       |          |<AIface-1>           N1
       +----------+
 
This topology simulates HOSTs to router communication scenario 
between the DUT and ANVL. Here the DUT is an IPv6 router and ANVL
simulates two HOSTs around it. In this topology both ANVL and DUT 
should use Site Local IPv6 address. Here N0 and N1 represent two 
different networks.

Sending ICMPv6 Echo Request Packet
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

Waiting (up to 16.000 seconds) for IPv6 and ICMPv6 packets on net 3ffe:2222::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 1
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received IPv6 packet from 3ffe:1111::1111 
to 3ffe:2222::2222 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 1
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 254
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x7736 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

DUT forwarded expected ICMPv6 Echo Request packet
Flow Label field value correctly remains unaltered

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-11.2: Passed

>> IPV6-11.3
TEST_DESCRIPTION
Hosts or routers that do not support the functions of the Flow Label
field are required to ignore the field when receiving a packet
TEST_REFERENCE
RFC 2460 s6 p25 Flow Labels
TEST_METHOD
- ANVL: Send an ICMPv6 Echo Request to <DIface-0>, containing:
        - source address set to address of host-1
        - destination address set to address of DUT
        - Flow Label field of IPv6 Header set to <Value>
- ANVL: Listen (for upto <ListenTime> seconds) on <AIface-0>
-  DUT: Send an ICMPv6 Echo Reply to <AIface-0>
- ANVL: Verify that Identification Number, Sequence Number and Data
        field of the received ICMPv6 Echo Reply are same as those of
        the ICMPv6 Echo Request sent
- CASE: <Value> = 0
- CASE: <Value> = 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


_____________________
 SIMULATED TOPOLOGY 
_____________________
--------------------
Topology-1 (TOPO-1)
-------------------

         +----------+                           +-----------+
         |          |<AIface-0>       <DIface-0>|           |
         |  HOST-1  |+-------------------------+|   DUT     |   
         |          |                           | (as HOST) |
         +----------+                           +-----------+   

This topology simulates HOST to HOST communication scenario between
the DUT and ANVL. In this topology both ANVL and DUT should use Link
Local IPv6 address.


 <CASE>: Flow Label is 0
Sending an ICMPv6 Echo Request to DUT
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received
ICMPv6 Echo Reply have same Identification Number,
Sequence Number and data

 <CASE>: Flow Label is 1
Sending an ICMPv6 Echo Request to DUT
Sending IPv6 packet from 3ffe:1111::1111 
to 3ffe:1111::9028 

Waiting (up to 16.000 seconds) for ICMPv6 packets on net 3ffe:1111::

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 1
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = 3ffe:1111::9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 128 (Echo Request)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1A41 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Request ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Request Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ICMPv6 Echo Reply from 3ffe:1111::9028 
to 3ffe:1111::1111

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 28 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 129 (Echo Reply)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x1941 (Correct)
ICMPv6: 
ICMPv6: ---- ICMPv6 Echo Reply ----
ICMPv6: 
ICMPv6: Identifier         = 0
ICMPv6: Sequence Number    = 0
ICMPv6: 
ICMPv6: --- Data [20 bytes] ---
ICMPv6:  49 50 56 36 5F 50 52 4F 54 4F 43 4F 4C 5F 54 45   IPV6_PROTOCOL_TE
ICMPv6:  53 54 45 52                                       STER
ICMPv6: --- Data End ---
ICMPV6: ---- End of Echo Reply Packet ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

The sent ICMPv6 Echo Request and the received
ICMPv6 Echo Reply have same Identification Number,
Sequence Number and data

Neighbor Discovery for 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::1111
IPv6: Destination Address  = ff02::1:ff00:9028
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x2CCC (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:1111::9028

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:1111::9028
IPv6: Destination Address  = 3ffe:1111::1111
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC90D (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:1111::9028
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::2222
IPv6: Destination Address  = ff02::1:ff00:9029
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xF995 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 3ffe:2222::9029

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 3ffe:2222::9029
IPv6: Destination Address  = 3ffe:2222::2222
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x84C6 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 3ffe:2222::9029
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IPV6-11.3: Passed
Executing system command:
  "./DocScriptQ35/IPV6/IPV6postsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipnet_radvd
ipd: kill ipnet_radvd ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar unset ipnet.inet6.AcceptRtAdv 
sysvar: 'ipnet.inet6.AcceptRtAdv' unset ok
-> cmd sysvar unset ipnet.inet6.radvd.interfaces 
sysvar: 'ipnet.inet6.radvd.interfaces' unset ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          7
Number of tests passed:       7
Number of tests failed:       0
Number of tests inconclusive: 0
