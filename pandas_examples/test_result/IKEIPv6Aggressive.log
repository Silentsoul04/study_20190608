ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5771752 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_aggressive ike-ipv6 14.1-14.16 14.18-15.13 15.15-17.5 17.7-18.5 18.7-18.9 18.11-18.17 18.20-18.26 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_aggressive.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IKEIPV6/IKEIPV6postsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IKE SA Down Command                      "./DocScriptQ35/IKEIPV6/ike-sa-down-command.exp $ANVL_DUTHOSTNAME"
IKE Certificate Data                     "abcdefghijklmnop"
IKE Certificate Type                     2                   # (0x00000002)
IKE Signature Data                       "ABCDEFGHIJKLMNOP"
IKE Retransmit Count                     5                   # (0x00000005)
IKE Unique Cookie Test Count             3                   # (0x00000003)
IKE Test Timeout                         3                   # (0x00000003)
IKE DUT Major Version                    1                   # (0x00000001)
IKE DUT Minor Version                    1                   # (0x00000001)
IKE Non Zero Value                       1                   # (0x00000001)
IKE Nonce Payload Invalid Length         7                   # (0x00000007)
IKE ID Payload Invalid Port              10                  # (0x0000000A)
IKE ID Payload Invalid Protocol          10                  # (0x0000000A)
IKE Invalid Exchange Type                10                  # (0x0000000A)
IKE Invalid Message ID                   10                  # (0x0000000A)
IKE Invalid DOI                          10                  # (0x0000000A)
IKE Invalid Protocol ID                  10                  # (0x0000000A)
IKE Invalid Transform ID                 10                  # (0x0000000A)
IKE Invalid Attribute Class              20                  # (0x00000014)
IKE Invalid SPI                          210                 # (0x000000D2)
IKE DUT Supports Certificate Payload Processing True
IKE DUT Supports Main Mode As Initiator  True
IKE DUT Supports Main Mode As Responder  True
IKE DUT Supports Quick Mode As Initiator True
IKE DUT Supports Quick Mode As Responder True
IKE DUT Supports Aggressive Mode As Initiator True
IKE DUT Supports Aggressive Mode As Responder True
IKE DUT Supports New Group Mode As Initiator False
IKE DUT Supports New Group Mode As Responder False
IKE DUT Supports Sending of Notification Message True
IKE DUT Supports Traffic Processing before CONNECTED Notify False
IKEIPV6 Suite Setup Command              "./DocScriptQ35/IKEIPV6/ikeipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 ISAKMP SA Initiate Command       "./DocScriptQ35/IKEIPV6/ikeipv6-isakmp-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 IPSec SA Initiate Command        "./DocScriptQ35/IKEIPV6/ikeipv6-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Another IPSec SA Initiate Command "./DocScriptQ35/IKEIPV6/ikeipv6-another-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Restart Command                  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Specify DES MD5 Attribute Command "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Specify DES SHA Attribute Command "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Combined SA Initiate Command     "./DocScriptQ35/IKEIPV6/ikeipv6-combined-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Two SA Initiate Command          "./DocScriptQ35/IKEIPV6/ikeipv6-two-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Aggressive Mode Initiate Command "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Aggressive Mode Configure Command "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 New Group Mode Initiate Command  "./DocScriptQ35/IKEIPV6/ikeipv6-new-group-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 DUT Uses Wildcard Identification False
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_aggressive.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         2000::5
  IPV6 ANVL Address                        2000::1
  IPV6 Gateway                             2000::5
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         2111::5
  IPV6 ANVL Address                        2111::1
  IPV6 Gateway                             2111::5
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Encapsulation                   v6Ov6
  IPSec Configuration                      Auto
  IPSec IPv6 Remote Host Address           2000::1
  IPSec IPv6 Local Host Address            2111::1
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          SHA
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP1024
  IKE IPSec SA Transform ID                ESP_DES
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Encapsulation Mode          TUNNEL
  IKE IPSec SA Authentication Algorithm    HMAC_SHA
  IKE Alternative ISAKMP SA Encryption Algorithm DES_CBC
  IKE Alternative ISAKMP SA Hashing Algorithm SHA
  New Group Description                    32768             # (0x00008000)
  New Group Prime                          "FFFDFF6FF2FF3FFFC90FDAA22168C234C6C6628B86DC6CD129064E088A676C74020B6EA636139B62564A06798634646D6F6569B3CD3A431B302B0A6DF25F14676FE6366D66516245E4656576665E6EC6F66662E9A6"
  New Group Generator                      "3"
  New Group Modulus Length                 680               # (0x000002A8)
  IKE Pre-Shared Key                       abcdef

# Configuration File End.
%% VALIDATE CFG GLOBAL WARNING: 
! The following test should run for ISAKMP group-1 mode
! Therefore the following test cannot be run: 16.9 16.10 14.5 14.6 18.11 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 2000::5 prefixlen 64 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 2111::5 prefixlen 64 up
-> cmd ifconfig -a
lo0	Link type:Local loopback
	inet 127.0.0.1  mask 255.255.255.255
	inet6 unicast fe80::1%lo0  prefixlen 64  automatic
	inet6 unicast ::1  prefixlen 128
	UP RUNNING LOOPBACK MULTICAST NOARP ALLMULTI 
	MTU:1500  metric:1  VR:0  ifindex:1
	RX packets:1199455 mcast:3395 errors:0 dropped:0
	TX packets:1199455 mcast:3395 errors:0
	collisions:0 unsupported proto:0
	RX bytes:89146162 (89 M)  TX bytes:89146162 (89 M)

gei2	Link type:Ethernet  HWaddr 00:25:90:04:e2:de
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 128.224.166.238  mask 255.255.254.0  broadcast 128.224.167.255
	inet6 unicast fe80::225:90ff:fe04:e2de%gei2  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:2
	RX packets:868225 mcast:21911 errors:0 dropped:2551
	TX packets:63685 mcast:1126 errors:0
	collisions:0 unsupported proto:0
	RX bytes:64994572 (64 M)  TX bytes:6691975 (6691 k)

gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	inet6 unicast 2000::5  prefixlen 64  tentative
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:55
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:2 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:180

gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	inet6 unicast 2111::5  prefixlen 64  tentative
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:56
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:2 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:180

-> cmd sysvar set -co ipike.strict_lifetime_policy "1"
sysvar: ipike.strict_lifetime_policy=1 ok
-> cmd sysvar get ipike.strict_lifetime_policy 
sysvar: ipike.strict_lifetime_policy=1
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd reconfigure ipike
ipd: reconfigure ipike failed: not started
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 2000::1 < 2000::5 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 2000::5 as 00:15:17:C8:90:28

Neighbor Discovery for 2111::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:5 < 2111::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 2111::1 < 2111::5 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 2111::5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite Internet Key Exchange (IKE)
RFC 2407: 'The Internet IP Security Domain of Interpretation
for ISAKMP'
(D. Piper Network Alchemy, November 1988)
RFC 2408: 'Internet Security Association and Key Management
Protocol (ISAKMP)'
(D. Maughan National Security Agency,
M. Schertler Securify, Inc.
M. Schneider National Security Agency,
J. Turner RABA Technologies, Inc., November 1998)
RFC 2409: The Internet Key Exchange (IKE)
(D. Harkins, D. Carrel, Cisco Systems, November 1998


ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the machine on which ANVL is running
be connected to 2 interfaces that are connected
to the device under test.

The ANVL config file must contain 2 IP interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IKE-IPV6-14.1
TEST_DESCRIPTION
The following attributes are used by IKE and are negotiated as part
of the ISAKMP Security Association.
- encryption algorithm
- hash algorithm
- authentication method
- information about a group over which to do Diffie-Hellman.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Externally cause DUT to initiate ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with SA Attributes for Enc.algo,
        Hash algo, Auth. method, Group information 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike failed: not started
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x6F7D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  74 26 CB 14 9E 94 73 88                           t&....s.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  53 92 39 E3 B0 7A 81 30 1A B1 79 96 73 A6 DD FB   S.9..z.0..y.s...
ISAKMP:  C8 5E 59 2C C3 31 3F 21 F7 E5 62 99 F9 B8 8D 91   .^Y,.1?!..b.....
ISAKMP:  41 35 21 46 3C F6 C8 3B FC 38 BD 36 E3 ED D3 41   A5!F<..;.8.6...A
ISAKMP:  A0 B3 04 15 E3 D4 CF 1B FA 36 C3 F2 5D F8 BE CA   .........6..]...
ISAKMP:  FA 1F D8 70 F1 F3 DE 16 F7 20 43 7E FB A1 A8 3B   ...p..... C~...;
ISAKMP:  9D E9 C1 06 E3 33 19 D3 9C 49 70 1F 36 99 5D A9   .....3...Ip.6.].
ISAKMP:  10 EC 00 28 54 30 26 7A B7 3F 22 76 00 EA 9F FB   ...(T0&z.?"v....
ISAKMP:  59 E4 2C C8 CC C0 55 BF A2 C8 7E CD 5E B5 F3 5E   Y.,...U...~.^..^
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  95 E3 08 A4 95 F4 02 D7 0A 1D 00 D3 B7 19 F5 7D   ...............}
ISAKMP:  2D C8 8C 3C B5 6A 09 7B 3A 51 31 F9 6A CA 45 84   -..<.j.{:Q1.j.E.
ISAKMP:  80 30 4D 07 35 8E D0 9C 92 13 83 6D 60 31 BA 24   .0M.5......m`1.$
ISAKMP:  6C FC B4 1F F7 E3 8D B0 DF 47 81 DA 71 8F 85 67   l........G..q..g
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
4 mandatory SA Attrbitues

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.1: Passed

>> IKE-IPV6-14.2
TEST_DESCRIPTION
During Phase 1 negotiations, the value MUST be set to 0.
IKE MUST set the Message ID field to 0 in an outbound ISAKMP Packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p25 ISAKMP Header Format
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with Message ID field in the HDR
        set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xB8E1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A2 1B B1 15 77 EE 2C 4C                           ....w.,L
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2E CF 87 5F FC 2D D2 A5 5E 7E 2A E7 65 FA 7B B8   ..._.-..^~*.e.{.
ISAKMP:  62 2B 6C A4 B9 DA B3 6E 7D 04 B7 D7 9C 85 12 4C   b+l....n}......L
ISAKMP:  C1 E6 3A 1C 46 60 A2 CC F5 73 D9 01 0E B3 EC CB   ..:.F`...s......
ISAKMP:  8D C4 43 43 28 49 FE 2C 7B B6 77 8D E3 25 1C 66   ..CC(I.,{.w..%.f
ISAKMP:  6C B5 CF 6F 9A A8 BB 19 7E 8F 5E 31 8A B0 A8 7A   l..o....~.^1...z
ISAKMP:  69 9E C8 32 3A 91 62 8C 51 35 18 1D EF 32 42 95   i..2:.b.Q5...2B.
ISAKMP:  2A 98 DB C8 A7 80 BC C8 F6 FF B8 48 E3 2A A6 9F   *..........H.*..
ISAKMP:  D3 4B EC D1 14 7F E7 05 ED 58 52 40 BD 6F 82 4F   .K.......XR@.o.O
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  A1 AB D5 D0 4D C3 D3 43 DC 8A 33 99 8E B4 53 94   ....M..C..3...S.
ISAKMP:  95 14 A4 AE 3F D9 88 5D BB 84 43 E5 22 9E A3 78   ....?..]..C."..x
ISAKMP:  BF 81 AE 72 03 08 19 DE C1 72 E1 8A D4 73 D2 BE   ...r.....r...s..
ISAKMP:  93 D8 91 9C 72 D2 EA D2 8B EC AD 21 2A 5A 4B 99   ....r......!*ZK.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received ISAKMP Packet with Message ID:0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
reconfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.2: Passed

>> IKE-IPV6-14.3
TEST_DESCRIPTION
IKE MUST not set the NP field of Security Association Payload
to Proposal
Payload.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
      Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with the NP field in SA not set to 
        Proposal Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipiReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x63CB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  24 10 E7 B5 CB 3B 8A 73                           $....;.s
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  01 80 F9 46 05 BD 81 BC 59 23 3B D7 97 92 9E 4B   ...F....Y#;....K
ISAKMP:  A7 7C 71 9F ED CE 1C B1 CB F1 EB F6 60 F0 54 36   .|q.........`.T6
ISAKMP:  89 C9 0B 84 18 4C C2 4C 06 25 1A 11 FD 9E D5 03   .....L.L.%......
ISAKMP:  D3 32 35 66 6C 36 EE A3 6A 56 DC 15 C1 DE 64 7F   .25fl6..jV....d.
ISAKMP:  B3 6B 9D 7F EB 92 F8 39 B2 C3 F6 DF 2F 97 8B B0   .k.....9..../...
ISAKMP:  C6 CE 26 34 C6 7D 86 82 74 CE 90 13 D9 8D 06 1D   ..&4.}..t.......
ISAKMP:  67 7A 82 FF 49 5E C6 00 F8 35 DD 04 F8 B6 1D 74   gz..I^...5.....t
ISAKMP:  E4 6F E3 BC A0 DF 3C B9 C3 C6 8C B7 FC 21 98 AB   .o....<......!..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  BD F0 41 E7 75 B0 8B 42 2F 5A D8 7B DB F6 05 AD   ..A.u..B/Z.{....
ISAKMP:  D8 51 C2 F7 D0 D3 11 76 31 38 10 B6 89 C6 C5 C3   .Q.....v18......
ISAKMP:  66 57 45 C1 D6 A5 90 1D CB 6B 9E 90 5F 2B 22 89   fWE......k.._+".
ISAKMP:  C5 AD CF 23 2B C6 D5 54 65 C7 E3 A6 37 19 90 F1   ...#+..Te...7...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
with Next Payload of SA Payload
set to: (4)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ke
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.3: Passed

>> IKE-IPV6-14.4
TEST_DESCRIPTION
During SA Payload exchange, IKE MUST set the Encryption flag to 0 in an
outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2408 s5.2 p60 ISAKMP Header Processing
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
      Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with the Encryption flag in the 
      HDR set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigurReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x8C99 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F4 B8 BF CD 62 C9 FB 1F                           ....b...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C9 64 EE 28 3F 37 EF 1E CA 96 15 8E 08 E6 9E 9B   .d.(?7..........
ISAKMP:  EE 62 82 E1 DE 22 4F DE 9B 13 05 1A C9 89 CC 56   .b..."O........V
ISAKMP:  DF 73 C2 E5 87 A1 B7 40 FA 1A 07 E5 1D 96 BB C4   .s.....@........
ISAKMP:  67 E9 5C 86 75 BB 48 80 5F FB F0 34 0C E2 4E 74   g.\.u.H._..4..Nt
ISAKMP:  E5 B8 78 54 DF D8 4C 14 3D 1B 6E D8 15 04 22 03   ..xT..L.=.n...".
ISAKMP:  BF 14 1B DC A6 14 C6 A6 0D 48 C6 10 AB 7D E3 C9   .........H...}..
ISAKMP:  EB 76 73 E8 64 27 A0 52 26 A1 02 95 68 99 FE 4A   .vs.d'.R&...h..J
ISAKMP:  A1 0D AC 93 C4 52 1C AA 4D 94 03 29 D5 6B 4C C1   .....R..M..).kL.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  44 E4 4D BB 43 2F 89 94 BE FD 17 88 63 7A 02 08   D.M.C/......cz..
ISAKMP:  B8 97 FD 29 69 BB E9 23 2B EA 83 89 B6 F2 C6 E6   ...)i..#+.......
ISAKMP:  C4 5E BC B1 86 C0 24 0C 5F 97 9C F1 61 29 9B 24   .^....$._...a).$
ISAKMP:  80 C6 14 EE AA 37 E7 D6 AE 6F F4 94 41 B8 21 CD   .....7...o..A.!.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
Header Flag set to: 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
e ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.4: Passed

>> IKE-IPV6-14.7
TEST_DESCRIPTION
SA Payload MUST precede all other Payloads in an outbound
ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting SA Payload immediately 
        after HDR
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xB286 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  51 CB 6F 7B EF 9A 74 7E                           Q.o{..t~
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4D 18 1B CA 9F 13 6C A8 3B 12 36 6D 26 9C 43 48   M.....l.;.6m&.CH
ISAKMP:  16 4C EF 53 19 C4 AB 3D 80 DD 20 CD 1D 02 F3 19   .L.S...=.. .....
ISAKMP:  80 A3 AC CD B4 22 17 CC A0 84 1B 96 4A 50 BA D6   ....."......JP..
ISAKMP:  09 56 FF C2 DC 6C B3 40 3F A0 A5 B1 BA 28 3C 12   .V...l.@?....(<.
ISAKMP:  75 5C 76 BC CF E1 6B E7 08 31 35 FB 86 ED 50 92   u\v...k..15...P.
ISAKMP:  9D 8F 0A 38 23 72 85 9F 46 DC F2 C8 CE AC B4 FD   ...8#r..F.......
ISAKMP:  49 F9 3F EE 41 2E E2 68 6D 08 4A A6 18 9C A4 C5   I.?.A..hm.J.....
ISAKMP:  B1 C3 38 DC 61 2F 14 80 25 39 CB 2F 3D D9 2D 71   ..8.a/..%9./=.-q
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  B9 4A 24 29 F0 DA EB 37 B8 79 95 58 C2 47 61 C2   .J$)...7.y.X.Ga.
ISAKMP:  B7 B4 1F E0 50 9F CF 84 5B 74 CD B3 A9 AD 1C 62   ....P...[t.....b
ISAKMP:  80 96 A0 51 0B 7E AC 65 6B 10 70 DC 7E 48 D3 E3   ...Q.~.ek.p.~H..
ISAKMP:  C2 27 2F 43 D4 74 3D 07 22 DD E9 DE AB 4D CC 10   .'/C.t=."....M..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.7: Passed

>> IKE-IPV6-14.8
TEST_DESCRIPTION
IKE MUST support SIT_IDENTITY_ONLY for Situation field in the Security
Association Payload. 
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2407 s4.2 p3 IPSEC Situation Definition
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
        with Situation field in SA set to SIT_IDENTITY_ONLY
-  DUT: Send <HDR,SA,KE,Ni,IDii> with Situation field in SA set to 
        SIT_IDENTITY_ONLY    
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd recoReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xCE1A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7E 28 45 67 93 33 64 E7                           ~(Eg.3d.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  39 92 BF DE CD B7 A2 E9 D3 D8 54 AE CC F8 DE CA   9.........T.....
ISAKMP:  4B 5F 8A 30 20 8B 93 19 E5 FD B2 D4 E9 F0 62 A4   K_.0 .........b.
ISAKMP:  C3 9C 3C C5 A8 95 A5 70 9F 14 97 8A 68 3F 3A AC   ..<....p....h?:.
ISAKMP:  D3 3A BD F6 7D BF 51 F3 65 6C D5 35 0A D0 9E 7D   .:..}.Q.el.5...}
ISAKMP:  39 FC A9 83 2C 81 83 EF 06 F6 93 4B AB EB ED 88   9...,......K....
ISAKMP:  CD E2 FB 8F CB 8E 6A 78 41 B0 CB C2 25 C8 BA 20   ......jxA...%.. 
ISAKMP:  56 AA 56 62 CB C0 D7 66 95 83 7F B4 94 B9 EA 04   V.Vb...f........
ISAKMP:  22 20 D3 5D B3 96 0A 30 E2 1B BF 26 FD 53 B6 21   " .]...0...&.S.!
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  BA 8A A5 03 A6 D1 58 8E 30 9E 9C 49 AA A4 BD 36   ......X.0..I...6
ISAKMP:  FE 65 41 BA 75 F0 19 82 B1 A7 C1 47 7C D1 DA 1A   .eA.u......G|...
ISAKMP:  CF EF 65 BE 59 39 B7 A3 21 FA 43 C9 42 55 00 BB   ..e.Y9..!.C.BU..
ISAKMP:  2C BA D4 74 46 45 2A CB FA 82 3C 0C 31 F5 62 5C   ,..tFE*...<.1.b\
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii>
Packet from DUT with situation field set to SIT_IDENTITY_ONLY

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
nfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.8: Passed

>> IKE-IPV6-14.9
TEST_DESCRIPTION
The Proposal Payload fields are defined as follows:
Payload Length (2 octets) - Length in octets of the entire
Proposal payload, including generic payload header, the Proposal
payload, and all Transform payloads associated with this
proposal.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.5 p28 Proposal Payload             
RFC 2408 s5.1 p58 General Message Processing 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Payload Length of Proposal to 
        (PROPL_HLEN + Total length of all Transforms)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xCE62 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FB 95 A1 3D 35 DC 40 76                           ...=5.@v
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6D A4 16 B1 1F EC 72 68 2E 58 70 AE 8F A2 E2 59   m.....rh.Xp....Y
ISAKMP:  A9 2F 17 55 F2 48 74 AA 02 7B 75 1F B7 B6 F0 30   ./.U.Ht..{u....0
ISAKMP:  B3 5F 16 9D 1E A0 CF 01 4E 15 2C 4A 72 64 C1 BD   ._......N.,Jrd..
ISAKMP:  FC EB FC 34 C6 FB E1 92 0E 72 19 57 40 7E E0 39   ...4.....r.W@~.9
ISAKMP:  04 C0 08 BC A9 F0 3D 11 DB 0A CB 21 7E E1 DF E9   ......=....!~...
ISAKMP:  0F 48 B9 F4 D6 4D 72 C3 4E 2E CD 9A F5 50 43 51   .H...Mr.N....PCQ
ISAKMP:  1D 17 E0 90 CD 90 45 22 B6 04 2E 71 42 D9 E1 78   ......E"...qB..x
ISAKMP:  3B 22 74 77 B4 A2 E7 2E 35 BD 99 00 73 79 C2 F8   ;"tw....5...sy..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  A7 3C 27 BC E9 33 46 87 D4 99 CE 6D FB 92 B3 0F   .<'..3F....m....
ISAKMP:  AD 1D AE 98 1C AC F2 00 71 95 97 EF BF DF 3E DA   ........q.....>.
ISAKMP:  1F 31 9A 25 C3 ED BC 4F 51 40 63 84 E9 D0 44 8D   .1.%...OQ@c...D.
ISAKMP:  90 BC 98 2A 1C 89 75 1B 06 6C 0F 3E 0E 41 75 2C   ...*..u..l.>.Au,
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
with valid Proposal Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
reconfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.9: Passed

>> IKE-IPV6-14.10
TEST_DESCRIPTION
The Transform Payload fields are defined as follows:
Payload Length (2 octets) - Length in octets of the current
payload, including the generic payload header, Transform values,
and all SA Attributes.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s5.1 p58 General Message Processing
RFC 2408 s3.6 p30 Transform Payload
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
      Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Payload Length of the
        Transform to 
        (TRANS_HLEN + Total length of all SA Attributes)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipiReceived Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xE632 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  91 16 29 89 3A 8A 89 2A                           ..).:..*
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E3 A9 E4 9F 29 D0 11 A5 CC 42 FB 92 E6 8A 49 7B   ....)....B....I{
ISAKMP:  B5 4F C9 E9 29 56 A1 06 E9 A7 23 38 32 9E E7 D0   .O..)V....#82...
ISAKMP:  9E 9D D6 F4 E9 77 87 F4 10 F7 87 AD 09 2B 07 65   .....w.......+.e
ISAKMP:  D9 02 A6 63 1E 08 34 18 69 EA 8A 91 05 A1 34 01   ...c..4.i.....4.
ISAKMP:  7C DE E7 2F 56 F3 90 06 8A AB 78 9E E3 C4 F9 EB   |../V.....x.....
ISAKMP:  E5 88 77 F5 5F 84 54 7E 1F 6C 0E 75 44 98 59 43   ..w._.T~.l.uD.YC
ISAKMP:  81 92 B7 8E 7D 67 C0 AB DB E6 F0 6A 73 20 C1 1E   ....}g.....js ..
ISAKMP:  28 00 68 96 D7 22 B8 62 66 F5 E5 4A E9 24 28 2D   (.h..".bf..J.$(-
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  6B C4 50 28 89 CA D9 0D 76 DC 19 64 F7 C6 C8 E5   k.P(....v..d....
ISAKMP:  FE 7D 0E 26 19 8F 87 BC 96 C5 C0 52 6B B2 BF 55   .}.&.......Rk..U
ISAKMP:  D8 D2 56 FA C0 13 9F 0C 6F 05 43 08 70 DC A7 BA   ..V.....o.C.p...
ISAKMP:  A9 E2 BD 13 7B 1F 03 D0 FF A9 C4 EC 9E C9 FB 99   ....{...........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ke
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.10: Passed

>> IKE-IPV6-14.11
TEST_DESCRIPTION
A DOI value of 0 during a Phase 1 exchange specifies a Generic ISAKMP
SA which can be used for any protocol during the Phase 2 exchange.
IKE MUST set the DOI field of Security Asociation Payload to 0 in an
outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408, s3.4 p27 Security Association Payload
RFC 2408, s5.4 p62 Security Association Payload Processing 
RFC 2409  s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with DOI field in SA set to 0 or 1
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigureReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x6753 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  17 6A 2B BE 88 CD 94 BB                           .j+.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  94 32 C4 76 37 09 8C 76 16 95 23 18 CB 5A 3C 2F   .2.v7..v..#..Z</
ISAKMP:  47 CA 49 1E 40 82 F0 6A 72 2A 8B 01 79 DA 6C FB   G.I.@..jr*..y.l.
ISAKMP:  1F 8D 0B 33 E1 15 35 96 EF E6 DD B6 4F C8 54 E4   ...3..5.....O.T.
ISAKMP:  EB F8 00 A9 19 A5 ED 89 8A 60 A8 E7 83 1B F4 E4   .........`......
ISAKMP:  FB C8 09 C1 F2 80 35 D2 91 46 69 65 08 82 BC 6A   ......5..Fie...j
ISAKMP:  31 62 9E DF 54 E8 31 F2 7B C5 A8 00 82 BC 1C C9   1b..T.1.{.......
ISAKMP:  82 17 28 AA 37 5D 1A 3A B2 F2 12 AB B9 81 5F B0   ..(.7].:......_.
ISAKMP:  CF D7 B3 49 CD 10 E1 DD F0 88 BF A0 34 2B D8 82   ...I........4+..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D4 4F E3 2D CD 62 4A AC 29 5E 2D C0 8E 85 E5 A6   .O.-.bJ.)^-.....
ISAKMP:  15 64 5B 39 DA 93 D2 C9 91 6F 0F 72 E4 BD FA 22   .d[9.....o.r..."
ISAKMP:  8F C5 04 5E B8 A7 E0 54 A6 4B 6A 4C 4F 37 54 3A   ...^...T.KjLO7T:
ISAKMP:  C0 F7 B8 15 D2 EE 8D A8 17 70 9F DB 57 18 AC 06   .........p..W...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1) with DOI set to 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
 ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.11: Passed

>> IKE-IPV6-14.12
TEST_DESCRIPTION
During SA Payload exchange, IKE MUST set the Responder Cookie field of 
the ISAKMP Header to 0 in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s2.4 p18 Identifying Security Associations
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with CKY-R field in HDR set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xD42F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8A 10 D9 01 70 B3 1C 59                           ....p..Y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  39 E2 A7 A2 B3 D5 45 B5 ED 0A 94 A6 55 06 24 67   9.....E.....U.$g
ISAKMP:  C3 3F 32 85 5C 86 97 FC 84 39 47 66 75 A6 DE 67   .?2.\....9Gfu..g
ISAKMP:  DE 13 F4 B1 0F 2C 94 47 4A 5F F9 9A 0E CD 6C C4   .....,.GJ_....l.
ISAKMP:  C5 4B 0E F9 45 BB BD 9D 47 6B A6 CF AA 06 07 C8   .K..E...Gk......
ISAKMP:  70 27 0C 6F A7 E3 AB C0 33 5D DE F0 FC 63 03 31   p'.o....3]...c.1
ISAKMP:  E1 51 5C E0 81 61 F7 53 DC 71 00 55 76 E3 7D 25   .Q\..a.S.q.Uv.}%
ISAKMP:  F7 BC 75 A4 18 FD 13 80 35 72 1B CD F6 EC C1 44   ..u.....5r.....D
ISAKMP:  5D FC 7F 75 3C D7 1B A9 7C 35 86 23 84 59 0E EC   ]..u<...|5.#.Y..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  1A E4 E9 C5 F5 A7 64 F7 B2 A4 0C EC 7C 82 45 71   ......d.....|.Eq
ISAKMP:  03 A9 97 20 56 F2 97 74 9C 5F BE 8B B4 37 57 98   ... V..t._...7W.
ISAKMP:  53 B4 19 CC 01 2F 1B DA C0 6B 0A C3 EB EE 8D 25   S..../...k.....%
ISAKMP:  B3 17 0D 28 B2 17 F8 57 BC 9E 1D 5D 65 46 29 BC   ...(...W...]eF).
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
valid Cookies

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.12: Passed

>> IKE-IPV6-14.13
TEST_DESCRIPTION
The ISAKMP Header fields are defined as follows:
Length (4 octets) - Length of total message (header + payloads)
in octets.  Encryption can expand the size of an ISAKMP message.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p25 ISAKMP Header Format              
RFC 2408 s 5.1 p58 General Message Processing 
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Length of the HDR to 
        (ISAKMP_HLEN + Total length of all Payloads)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure iReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x7C95 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  37 E1 A7 4A B3 24 DC 2B                           7..J.$.+
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A9 0A 66 41 AA 87 01 E8 27 64 87 B2 6F 27 56 3F   ..fA....'d..o'V?
ISAKMP:  BC 5C C2 BB 71 E9 95 E9 83 C6 E5 3F 38 0F BD 05   .\..q......?8...
ISAKMP:  46 85 66 60 40 91 E4 79 FA 40 B7 7C C8 5E C3 5B   F.f`@..y.@.|.^.[
ISAKMP:  CE AF FC F5 FD 5C 6E 28 B4 C0 8E 2C 42 7C 53 15   .....\n(...,B|S.
ISAKMP:  CE 54 16 96 25 57 D4 5A A1 3D 30 43 FC E2 D0 9D   .T..%W.Z.=0C....
ISAKMP:  1A 58 E1 DF 3D B1 A2 87 83 34 F0 95 E3 AA 3E 9F   .X..=....4....>.
ISAKMP:  70 74 37 7A 12 D2 87 E9 D1 58 09 E7 93 4E 4F 7D   pt7z.....X...NO}
ISAKMP:  B0 0D DD EC 0C 31 DF 48 9E B4 44 8B E1 E7 54 92   .....1.H..D...T.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  B0 83 65 72 B0 20 EA 7F 2A C7 21 47 50 45 CB 4C   ..er. ..*.!GPE.L
ISAKMP:  8A 8E A2 CF A6 23 AC 26 33 D4 D6 22 E0 51 E9 CC   .....#.&3..".Q..
ISAKMP:  04 E8 EA 03 E7 59 4B DF B4 7F 09 C6 AD 1E C0 E4   .....YK.........
ISAKMP:  6B 09 DB C3 10 12 CB 97 5E 23 8B 70 7D CB B6 22   k.......^#.p}.."
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1) with ISAKMP Header Payload Length 324 bytes

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
pike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.13: Passed

>> IKE-IPV6-14.14
TEST_DESCRIPTION
This field MUST NOT contain the values for the Proposal or
Transform payloads as they are considered part of the
security association negotiation.
Note: This test checks that the Next Payload field of Security
Association Payload is not set to Transform Payload.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with NP field in SA not set to 
        Transform Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmdReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x204C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  91 5E 3C DF 8A 3A 0C EF                           .^<..:..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A3 AE EA 70 9F 69 3F D2 62 26 04 D3 7F 6C C2 EE   ...p.i?.b&...l..
ISAKMP:  EE D0 A7 EF 48 CF C6 65 BD 7F 5A 91 EB D0 14 BA   ....H..e..Z.....
ISAKMP:  89 85 ED 82 6F 0B B6 B0 3A 03 1E 91 84 AA 9D 56   ....o...:......V
ISAKMP:  66 EC DC EE BD 20 E1 F8 35 25 FD 77 13 8D 27 73   f.... ..5%.w..'s
ISAKMP:  D6 B1 57 1F C9 40 68 DD E3 33 2D 07 62 92 24 BA   ..W..@h..3-.b.$.
ISAKMP:  F7 72 F2 1F 5A 37 84 8D CC 88 C2 95 82 51 75 48   .r..Z7.......QuH
ISAKMP:  75 C0 E2 C7 A7 A6 59 63 D1 47 DF 7D 17 0B 93 76   u.....Yc.G.}...v
ISAKMP:  E5 13 9F C6 17 03 68 16 2D 22 48 F8 EE 54 DA E8   ......h.-"H..T..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  C0 0E C1 50 09 3B 5B 1A 57 E5 D8 F7 E2 9C A9 99   ...P.;[.W.......
ISAKMP:  FC B7 FF 00 17 63 7F 85 D1 3B 09 BF B9 5F 93 4A   .....c...;..._.J
ISAKMP:  1C BA 31 7D C2 6F A1 AB 04 91 5B 19 C6 AE 34 B9   ..1}.o....[...4.
ISAKMP:  D1 13 14 1E 66 8A 8C BF 2F 4B CC 02 22 69 3B 94   ....f.../K.."i;.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with valid SA Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
 ipd reconfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.14: Passed

>> IKE-IPV6-14.15
TEST_DESCRIPTION
There MUST NOT be multiple Proposal Payloads for a single SA Payload.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p9 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with only one Proposal Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xE868 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F7 CC 75 B0 73 86 6B E6                           ..u.s.k.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  59 CE 18 32 4A 27 62 DA C6 02 01 49 5E 14 6E 4E   Y..2J'b....I^.nN
ISAKMP:  90 1E B3 C3 BC 04 81 43 C5 FA E3 4C C7 FE 0A B1   .......C...L....
ISAKMP:  52 02 B2 F7 78 86 FB 38 71 79 2E E2 12 19 81 08   R...x..8qy......
ISAKMP:  67 2B AD B6 22 0C 8D 69 5B 88 9F 50 07 86 67 74   g+.."..i[..P..gt
ISAKMP:  D0 7F C7 71 46 F2 98 5B EC B6 A1 1A 22 C7 63 6D   ...qF..[....".cm
ISAKMP:  1D D9 F6 C4 73 BE F7 23 37 AC 18 10 FD 1C CA 2E   ....s..#7.......
ISAKMP:  3B F2 01 03 2B 2A 14 21 26 17 C1 D9 D7 E4 EC 6C   ;...+*.!&......l
ISAKMP:  68 4A 79 F3 21 5B 84 18 02 17 13 87 DB 31 DB BE   hJy.![.......1..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  DD 45 76 AF BD B4 EE 52 09 45 A9 F3 88 10 B2 B0   .Ev....R.E......
ISAKMP:  2C 40 29 13 D7 36 9A D8 CF 25 51 D0 B8 85 0A AF   ,@)..6...%Q.....
ISAKMP:  23 E7 24 43 14 D9 E8 5E 9B 14 8B B0 07 6C 5E 76   #.$C...^.....l^v
ISAKMP:  78 CB 4F FF F3 82 98 7D E2 BF 52 B4 08 ED 40 F6   x.O....}..R...@.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with only 1 Proposal Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.15: Passed

>> IKE-IPV6-14.16
TEST_DESCRIPTION
The remaining bits of the Flags field (of ISAKMP Header) MUST be
set to 0 prior to transmission.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p3 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii> with REMAINING_BITS in HDR set 
        to {0,0,0,0,0} 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfiReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x9268 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  49 72 0C C5 B9 13 37 39                           Ir....79
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DD AC C7 FF F8 5B 5E 8A 77 EA 66 74 58 5B 73 E6   .....[^.w.ftX[s.
ISAKMP:  56 E7 A9 20 A4 B4 30 F2 CA 8E 93 0E D8 0D 86 BD   V.. ..0.........
ISAKMP:  94 F9 FF 51 A9 15 6C 65 18 4F 3B A2 D1 D0 84 DB   ...Q..le.O;.....
ISAKMP:  A6 ED D0 A6 5C 2D 78 46 BA 0B 7E 60 EE 6C DB 7C   ....\-xF..~`.l.|
ISAKMP:  F0 30 80 24 99 77 18 9E F5 F6 23 C3 B3 8C B0 25   .0.$.w....#....%
ISAKMP:  12 59 1F 51 11 79 BB 6D 27 58 72 DE 55 A8 73 9F   .Y.Q.y.m'Xr.U.s.
ISAKMP:  41 70 43 C7 46 05 7B 22 81 37 C2 98 FC 8B 51 7A   ApC.F.{".7....Qz
ISAKMP:  67 29 8F D4 CA 80 58 FC BD 1D AC 65 C0 83 19 F2   g)....X....e....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  1D 6F 33 EB 0A E1 70 22 40 C7 F8 11 1E EF 89 43   .o3...p"@......C
ISAKMP:  DE 7E B2 4B 48 8B 68 10 92 6B CB FA CA 8F B9 45   .~.KH.h..k.....E
ISAKMP:  2B 08 21 7E 49 69 2E A4 A1 D6 F1 7F B4 06 3B F5   +.!~Ii........;.
ISAKMP:  86 3E 83 F6 2A DD E0 D7 10 D4 00 D8 72 3D FD 78   .>..*.......r=.x
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with valid Flags in Header

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
gure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.16: Passed

>> IKE-IPV6-14.18
TEST_DESCRIPTION
All RESERVED fields in the ISAKMP protocol MUST be set to
zero (0) when a packet is issued.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
-  DUT: Send <HDR,SA,KE,Ni,IDii> with RESERVED field 
        of SA, Proposal, Transform, KE, Ni and ID 
        all set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigureReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xA9D6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C2 01 B9 6E 72 65 B3 17                           ...nre..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D7 F9 FC B7 C1 61 C6 EA 43 42 91 FC 18 B5 D9 20   .....a..CB..... 
ISAKMP:  8F 9B 16 28 E6 47 FD 5D B0 B3 15 BC 9A 61 E7 77   ...(.G.].....a.w
ISAKMP:  D7 AD 33 6D C4 5F EE 1A BB 3E AC 53 CA 02 A8 28   ..3m._...>.S...(
ISAKMP:  F3 64 47 D5 08 B8 74 E4 45 8D DC 87 E7 7D A4 CB   .dG...t.E....}..
ISAKMP:  48 39 B6 67 AF 8D 4B 53 1B 4E AF FE BC C8 77 DF   H9.g..KS.N....w.
ISAKMP:  5E 1C CD 92 50 F1 D9 86 F5 D2 42 FF F0 86 B7 77   ^...P.....B....w
ISAKMP:  F4 61 33 79 35 13 8F E5 41 D6 2C BC C8 DC 8C E4   .a3y5...A.,.....
ISAKMP:  4C A7 BB 37 90 74 91 14 B0 85 D9 09 39 0C E9 6B   L..7.t......9..k
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  B4 39 6A B7 EB AC 8C 80 B7 1E 86 E0 05 CB EC 03   .9j.............
ISAKMP:  25 35 32 D7 CF 8C BC AF C2 95 78 8E 79 CC A5 28   %52.......x.y..(
ISAKMP:  64 6A 80 39 21 BD 58 83 E8 AA D9 9E 37 14 1F 31   dj.9!.X.....7..1
ISAKMP:  C2 43 E6 FD 78 9C 7D 29 39 B1 7F 9B FD 66 D5 32   .C..x.})9....f.2
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii>
packet from DUT with RESERVED field of SA, Proposal,
Transform, KE, Nonce, ID set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
 ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.18: Passed

>> IKE-IPV6-14.19
TEST_DESCRIPTION
All RESERVED fields in the ISAKMP protocol MUST be set to
zero (0) when a packet is issued.
Note: This test checks the RESERVED field of Hash Payload in an
outbound ISAKMP Packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
        with Authentication method is Pre-shared key
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>
-  DUT: Send <HDR,HASH_I> with RESERVED field in HASH_I set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xD49B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E0 49 E7 D0 1E 67 2F 09                           .I...g/.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  01 15 9F F3 15 A5 00 F0 2F F5 2B BC F0 1B 3A A2   ......../.+...:.
ISAKMP:  99 4D 66 47 A1 17 27 8A 7E 2D 7C A4 99 E8 D6 EC   .MfG..'.~-|.....
ISAKMP:  9A B4 E6 0F 15 72 1F 8E D7 69 03 CE F0 05 B3 C0   .....r...i......
ISAKMP:  41 98 E7 3A D8 A2 B7 82 40 54 09 88 EE DC E9 CB   A..:....@T......
ISAKMP:  7C F1 65 36 5E 96 CA 8B D0 71 0F 7B 39 E6 D2 3E   |.e6^....q.{9..>
ISAKMP:  1D 93 5A 62 E1 C5 C4 72 D5 19 0F EC 84 8C 55 6B   ..Zb...r......Uk
ISAKMP:  B4 0C F9 E7 30 A9 F7 3F C3 66 FE AC D5 56 61 68   ....0..?.f...Vah
ISAKMP:  67 E1 0B 91 B7 85 19 22 DC A1 4C 47 DF 75 DC B3   g......"..LG.u..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  8C 77 AB 05 63 01 80 96 6E BE 14 34 FD B4 9E C2   .w..c...n..4....
ISAKMP:  ED AA B1 0F 5A 37 C1 5A 60 D2 FF 62 C0 5A F2 E0   ....Z7.Z`..b.Z..
ISAKMP:  89 35 0E 32 BF D0 F5 F3 F5 D0 59 34 9A D0 5A 1B   .5.2......Y4..Z.
ISAKMP:  64 24 BA 43 C9 F0 61 19 2D 10 D2 AE 3D 77 45 0E   d$.C..a.-...=wE.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir,HASH_R> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x82FC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E0 49 E7 D0 1E 67 2F 09                           .I...g/.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  4A 91 5D 75 A8 6F 0C 40                           J.]u.o.@
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  65 69 19 FB F8 3A 49 8B CF 02 6D 5F A6 70 2F 76   ei...:I...m_.p/v
ISAKMP:  AD 1F 10 45 28 5D E3 67 AD F9 07 86 B3 AA 57 09   ...E(].g......W.
ISAKMP:  90 5D 11 90 39 0D E2 D6 36 51 36 C3 8D 17 59 2F   .]..9...6Q6...Y/
ISAKMP:  D5 B7 3F E9 CE B5 56 A6 2A F7 97 0E C9 46 76 1D   ..?...V.*....Fv.
ISAKMP:  63 3D 72 2B 30 77 70 A3 EE 7C 72 9A F9 0F 4A CE   c=r+0wp..|r...J.
ISAKMP:  33 F8 1A 36 3F 19 BC 52 B6 4E 7D 14 25 27 77 DA   3..6?..R.N}.%'w.
ISAKMP:  7A 75 54 32 E4 7C 64 97 48 76 24 7D 59 91 FB BB   zuT2.|d.Hv$}Y...
ISAKMP:  10 45 23 14 F6 FA 77 65 30 54 02 D4 B5 65 86 FE   .E#...we0T...e..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A1 22 CB 1A 32 3A 76 36 7E E7 8D 71 87 0B 71 34   ."..2:v6~..q..q4
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  80 84 E7 A5 CF AA 8C A5 BB 11 1F 6D B3 B4 A2 53   ...........m...S
ISAKMP:  84 88 AA 6D                                       ...m
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 60 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 60 
UDP: Checksum         = 0xD1B3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E0 49 E7 D0 1E 67 2F 09                           .I...g/.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  4A 91 5D 75 A8 6F 0C 40                           J.]u.o.@
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x01 (1)
ISAKMP:  |012
ISAKMP:  |1..                    = Encryption bit Set
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 52 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  01 5A E0 65 99 72 0A 8E 16 39 34 1A 57 8A D1 71   .Z.e.r...94.W..q
ISAKMP:  F4 A7 32 44                                       ..2D
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:

Received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received <HDR,HASH_I> Packet with
reserved field of Hash Payload is set to zero

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.19: Passed

>> IKE-IPV6-14.20
TEST_DESCRIPTION
Implementations MUST include send and receive capability for
ISAKMP using the User Datagram Protocol (UDP) on port 500. UDP Port
500 has been assigned to ISAKMP by the Internet Assigned Numbers
Authority (IANA).
IKE MUST set the Port field of Identification Payload to 0 or
UDP Port 500 in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Port field of IDii 
        to 0 or 500    
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x0A45 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B7 A0 EC A6 2C 12 DC AF                           ....,...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AF B4 95 BE 1C 14 23 FA 3C 5C 70 79 61 5A 29 82   ......#.<\pyaZ).
ISAKMP:  73 0B 35 97 19 8F 6A 05 E8 67 DF F7 66 25 04 41   s.5...j..g..f%.A
ISAKMP:  BD 28 41 97 E8 31 7A AE 3C 3B 25 84 9F CF 89 82   .(A..1z.<;%.....
ISAKMP:  20 42 64 4B F6 5A 9C DF 6B FF 02 63 16 DA 6F C3    BdK.Z..k..c..o.
ISAKMP:  FE 18 6C E3 B4 EC DB 75 09 34 7B 89 38 B0 B3 9C   ..l....u.4{.8...
ISAKMP:  20 89 9F 36 28 A9 07 67 FE 31 AF 1C 3F 61 45 F8    ..6(..g.1..?aE.
ISAKMP:  26 A7 33 DE 75 8E 4E AC 1F FB 6A 0F 26 74 90 77   &.3.u.N...j.&t.w
ISAKMP:  77 6C 97 96 23 7D 97 15 1A 95 A7 44 C6 45 50 15   wl..#}.....D.EP.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  99 E3 32 1E BC 20 3C A9 BC D2 82 16 43 20 6E DE   ..2.. <.....C n.
ISAKMP:  8A 19 C5 0D 25 A2 E5 9B 8D 69 54 29 F9 08 BA E1   ....%....iT)....
ISAKMP:  55 84 D7 6B 83 75 1E E6 98 8D B2 23 04 A8 C4 A7   U..k.u.....#....
ISAKMP:  2D 90 DB CA 89 E0 BF 00 99 27 84 3C DD F5 69 F4   -........'.<..i.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received ISAKMP Packet from DUT with
ID Port Field set to (0) (Should be 0 or 500)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.20: Passed

>> IKE-IPV6-14.21
TEST_DESCRIPTION
IKE MUST set the Protocol ID field of Identification Payload to
0 or UDP Protocol(0x11) in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Protocol ID field of IDii 
        to 0 or UDP(0x11)    
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd recoReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xAE08 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  06 DE 63 74 E2 30 7E 24                           ..ct.0~$
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  BE 2D AB 0C 44 19 86 49 76 F3 C1 A3 15 42 4E 68   .-..D..Iv....BNh
ISAKMP:  EC 80 E1 BE 70 1C 56 E8 29 69 22 6F 96 78 EA 54   ....p.V.)i"o.x.T
ISAKMP:  A7 6B 10 F8 ED 43 F2 D3 6D 2D 0F 2A 9C A0 17 36   .k...C..m-.*...6
ISAKMP:  0A 3D DF 6A 8B 21 5A 8F 06 27 58 78 4A 3B EB 84   .=.j.!Z..'XxJ;..
ISAKMP:  A8 3B 07 2F C5 90 00 2E 26 F2 DF 1E 41 8C C4 2F   .;./....&...A../
ISAKMP:  B7 C8 6B AB 68 9C 74 65 C0 15 D8 1C 8F F6 8E 8A   ..k.h.te........
ISAKMP:  DC 53 A2 6F CA 98 0A 4D E1 31 3A 35 26 FA F1 9A   .S.o...M.1:5&...
ISAKMP:  68 DC FC D7 66 BE 2A E2 08 2C 01 1C F6 A8 4E 39   h...f.*..,....N9
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  34 1E A0 66 5D 7B 02 E1 34 95 FB A2 6E 2F E9 1B   4..f]{..4...n/..
ISAKMP:  6B 3C 0F 22 A4 6D D1 5E 9B 49 D9 40 29 76 33 65   k<.".m.^.I.@)v3e
ISAKMP:  2C 1A 75 7F BB 3E 97 B0 72 A5 60 3D 28 68 E5 04   ,.u..>..r.`=(h..
ISAKMP:  CC 7B 20 F0 11 7C B5 C8 6B E6 14 79 DD C1 5C 09   .{ ..|..k..y..\.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
 from DUT with ID Protocol Field set to (0)
 (Should be 0 or UDP)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
nfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.21: Passed

>> IKE-IPV6-14.22
TEST_DESCRIPTION
The length of nonce payload MUST be between 8 and 256 bytes
inclusive.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii> setting Payload Length of Nonce 
        Payload to a number which lies in between 8 and 256
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfiReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xA280 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7C B5 1A 3B 15 D3 2F 12                           |..;../.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2B 1A 7E 89 36 35 F1 0A CC 09 D1 82 63 3D 89 8B   +.~.65......c=..
ISAKMP:  FE D0 8E 77 80 87 E6 CD 4D 26 EA 47 9E AD B2 95   ...w....M&.G....
ISAKMP:  4A CA E4 ED 21 D4 8F 56 96 B9 1A 18 84 7A EE 53   J...!..V.....z.S
ISAKMP:  14 88 B4 4F CF 53 E9 AE 06 38 EC AE 0A F4 C0 1D   ...O.S...8......
ISAKMP:  45 B8 AB 98 BA 27 38 A6 5D 6F 75 26 F1 5B C0 BA   E....'8.]ou&.[..
ISAKMP:  86 C6 EF 86 E1 A1 CF BE 29 4E 21 B4 E9 33 E8 0F   ........)N!..3..
ISAKMP:  6E 29 E0 85 FD DA 34 8B 60 80 7C 76 EA 3A 60 B4   n)....4.`.|v.:`.
ISAKMP:  18 11 2E 64 CE B4 3A 84 0A 0E 8D 86 B3 63 3B 75   ...d..:......c;u
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7F 62 97 0C F6 76 69 80 F8 57 01 90 2B AB 7F 05   .b...vi..W..+...
ISAKMP:  F0 49 DC AF 00 8F 47 0C 20 B7 D3 47 2B B1 CC 84   .I....G. ..G+...
ISAKMP:  B6 EC 2D FC 43 B9 1D 86 01 AB 7D 22 F1 7A 43 F0   ..-.C.....}".zC.
ISAKMP:  12 3F 7B 5C FA D3 B5 CB 16 AA 64 E6 DE 5F 28 68   .?{\......d.._(h
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii>
Packet from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
gure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.22: Passed

>> IKE-IPV6-14.23
TEST_DESCRIPTION
IKE MUST set the Exchange Type field of ISAKMP Header to Aggressive 
in an outbound ISAKMP packet.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2408 s5.2 p60 ISAKMP Header Processing
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA 
-  DUT: Send HDR,SA,KE,Nr,IDii setting the Exchange Type field to 
        Aggressive 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xD4AA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  72 B1 9F 47 F8 8B 0E 33                           r..G...3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B0 87 D3 5E 6F C6 A2 AB EA DA 77 F5 55 75 40 C9   ...^o.....w.Uu@.
ISAKMP:  DE 6B 64 1F 85 10 1B 0E FA A5 83 5A B7 F4 F9 D0   .kd........Z....
ISAKMP:  90 A0 DE EA DE 28 74 0F BC 5D 6E 39 A5 B8 A1 0B   .....(t..]n9....
ISAKMP:  AB 83 1F 74 E9 E3 BA DA 4E C8 B2 82 6D 67 85 EE   ...t....N...mg..
ISAKMP:  38 9B CE 19 30 60 D1 FA 84 95 F5 F8 F5 E5 1C F8   8...0`..........
ISAKMP:  19 A7 BC 69 11 27 1C 29 29 14 C7 A7 0D 9F 44 C5   ...i.'.)).....D.
ISAKMP:  98 BD 67 E4 BF D6 AC 3E 4C 4A 45 39 9A C3 E8 C9   ..g....>LJE9....
ISAKMP:  FA 8C C9 7A 37 90 C7 B7 C9 B7 0B FC 15 B7 02 36   ...z7..........6
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7B 6F A7 BB 59 38 0A 9B A8 37 E1 87 AF DB 7F 82   {o..Y8...7......
ISAKMP:  3D 9C 71 D7 9F 25 32 51 B7 1A 5F 32 9B AF 8B A3   =.q..%2Q.._2....
ISAKMP:  40 C7 9E EE E5 23 B4 58 D3 2E 5E CF EC 71 2D 7F   @....#.X..^..q-.
ISAKMP:  3F 33 13 40 AD 0D 86 DB D3 0A 13 FC 92 F4 A3 41   ?3.@...........A
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet
from DUT with Exchange Type in HDR set to
Aggressive
Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
figure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.23: Passed

>> IKE-IPV6-15.1
TEST_DESCRIPTION
If the cookie validation fails, the message is discarded and the
following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-COOKIE message type MAY be sent to the
transmitting entity.
Note: Here we check that DUT discards the messageAggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with CKY-I field
        set to <CKY-I> and CKY-R field set to <CKY-R>
-  DUT: Do not send <HDR,HASH_I>
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x4116 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C8 D4 08 19 16 72 5F 9C                           .....r_.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B8 94 62 35 28 AF F0 D9 5D E1 87 E1 A7 39 01 AE   ..b5(...]....9..
ISAKMP:  B7 AA D0 AF A4 90 5D 33 73 CE BD CF AD A6 21 75   ......]3s.....!u
ISAKMP:  00 EA 4A E0 B1 D4 87 49 CA 04 03 31 2E 31 7D 1F   ..J....I...1.1}.
ISAKMP:  F7 D0 94 6A 4F C0 2E 35 8F C4 9E 43 14 BE 62 18   ...jO..5...C..b.
ISAKMP:  C6 50 F3 CC E6 6E D5 11 D6 D6 55 40 93 CE 93 55   .P...n....U@...U
ISAKMP:  E7 9E 03 01 3E 0B C0 4E 06 20 97 BB 17 0E E5 82   ....>..N. ......
ISAKMP:  F0 C1 FF E7 49 11 1F EC C9 1B 83 8D 7B 5D FA 18   ....I.......{]..
ISAKMP:  96 53 62 67 02 E7 DD 7C 95 14 35 D2 5E 2C 25 6F   .Sbg...|..5.^,%o
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AC 3A C9 15 CC 4C CE C0 ED 39 1F B1 29 C2 56 47   .:...L...9..).VG
ISAKMP:  DA 39 77 01 35 2F F6 62 CF 56 2D A6 24 46 86 E9   .9w.5/.b.V-.$F..
ISAKMP:  0F 9D C5 4B B7 6D C5 03 A1 87 C1 E2 7D 67 55 70   ...K.m......}gUp
ISAKMP:  31 79 BE 0F CC 4F 96 7C B1 D3 EB 56 60 35 F2 1B   1y...O.|...V`5..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Case:1 Set CKY-I to 0 and CKY-R to 0.

Sending  <HDR,SA,KE,Nr,IDir,HASH_R> Packet with CKY-I field
set to <CKY-I> and CKY-R field set to <CKY-R>
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x0898 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  56 A8 63 61 C1 AA E8 9F 30 EC 68 B8 D9 2A FD 3C   V.ca....0.h..*.<
ISAKMP:  8B AF E1 AD A2 F2 3C 4B CF C9 C5 7B 96 7A A9 BB   ......<K...{.z..
ISAKMP:  9A B5 5A 31 14 7F 93 68 76 46 DA 53 9B 4F 76 A0   ..Z1...hvF.S.Ov.
ISAKMP:  A1 8B 9B FB 2E E9 41 87 C6 22 52 FE CE FC 0B 39   ......A.."R....9
ISAKMP:  68 C6 CF EE BC BC 9D 62 EE 35 4D 2F BC D7 E1 27   h......b.5M/...'
ISAKMP:  37 0F 49 41 00 72 BF 07 F6 A7 54 7A F0 75 E1 AE   7.IA.r....Tz.u..
ISAKMP:  7C 0E 63 DF 6B 3B 21 54 D4 C0 D7 E8 F4 91 4D D2   |.c.k;!T......M.
ISAKMP:  4F 19 C2 60 F2 6D 0F D1 D3 72 9B 28 56 16 7C 5D   O..`.m...r.(V.|]
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  C6 18 23 37 8C A0 6D E0 1C 8B 6F B1 48 C9 BC 93   ..#7..m...o.H...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  41 52 C7 20 04 6D 93 9B CA 96 D9 7F 34 A5 7E 7D   AR. .m......4.~}
ISAKMP:  CA BE AC 69                                       ...i
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xAB57 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
figure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xC9C5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  73 9B 4A 43 DA F1 7F 78                           s.JC...x
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  01 B7 37 D2 FB 7B 6E 3B 10 37 E9 A2 88 77 82 41   ..7..{n;.7...w.A
ISAKMP:  92 98 61 77 6A 4F FB 2C 43 1A 08 B7 45 83 BF F9   ..awjO.,C...E...
ISAKMP:  38 4F 74 A7 6C 4B 8B 1D 46 25 D0 09 D5 11 71 AC   8Ot.lK..F%....q.
ISAKMP:  A3 C9 5D F4 E2 32 F0 43 50 1D B1 FB D8 D4 DC 37   ..]..2.CP......7
ISAKMP:  96 80 9F C0 D2 0D 09 3C 22 B1 A0 8A 66 B0 34 02   .......<"...f.4.
ISAKMP:  BA 4F 96 74 CB B5 46 A6 2D EA 7D 6B BB 63 48 4E   .O.t..F.-.}k.cHN
ISAKMP:  96 4F 2E 5E D0 B1 AF DF A9 2A 92 F9 58 02 FE AE   .O.^.....*..X...
ISAKMP:  09 0A 49 D1 FB 93 A9 9E 2D B0 02 19 F9 BF 45 76   ..I.....-.....Ev
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7B 76 84 7B 0E 42 13 EA E4 19 DA 9A 5E 63 F1 93   {v.{.B......^c..
ISAKMP:  A8 AD 0D 5A 49 84 D4 C9 FA DA 8A 84 2D 32 29 E2   ...ZI.......-2).
ISAKMP:  33 C5 63 9E D9 C6 8B 9D 39 65 1D FC 4F 56 A1 2C   3.c.....9e..OV.,
ISAKMP:  54 65 C0 43 A5 C0 99 72 65 9A 2E A5 6D E3 9F 62   Te.C...re...m..b
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending  <HDR,SA,KE,Nr,IDir,HASH_R> Packet with CKY-I field
set to <CKY-I> and CKY-R field set to <CKY-R>
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0xEF71 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  82 4E 6F A6 56 38 05 86 8C 47 E4 20 3D 30 56 DC   .No.V8...G. =0V.
ISAKMP:  75 1A D0 8A 9B D4 2A A7 9F B9 E0 7B 31 7D 20 3C   u.....*....{1} <
ISAKMP:  F4 FF 1D 4C 9E AD 41 3C 52 8B 94 49 35 9C 6E 05   ...L..A<R..I5.n.
ISAKMP:  AB 24 E5 85 EB 58 8D 61 45 41 EE 05 48 0C DF 5B   .$...X.aEA..H..[
ISAKMP:  5C 17 A2 60 0E BE 10 AD B1 B9 1E 03 75 4B 43 18   \..`........uKC.
ISAKMP:  37 D3 9E E5 92 89 43 C8 B4 81 01 85 5A 6E 24 5D   7.....C.....Zn$]
ISAKMP:  E2 1B BC 52 50 96 B2 E0 F3 E2 A4 67 CD D9 1B D6   ...RP......g....
ISAKMP:  8A A0 B4 DF F0 2C A0 82 D4 61 76 4D A2 A3 59 FA   .....,...avM..Y.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6D 5E 85 02 2C A2 A2 C3 83 C2 8E 85 AD 03 8C 37   m^..,..........7
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  1B 44 7F AE AE D9 FC 6A F7 00 CF F4 4C A0 E3 6C   .D.....j....L..l
ISAKMP:  29 2C C2 40                                       ),.@
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA753 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.1: Passed

>> IKE-IPV6-15.2
TEST_DESCRIPTION
If the cookie validation fails, the message is discarded and the
following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-COOKIE message type MAY be sent to the
transmitting entity.
Note: Here we check that DUT discards the message and sends NotifyAggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> CKY-I field set to
        <CKY-I> and CKY-R field set to <CKY-R>
-  DUT: Notify INVALID-COOKIE
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x1A4E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B4 ED 75 D1 BA E4 33 E2                           ..u...3.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  78 B8 1B B9 94 E7 2B 31 D2 53 84 69 58 F5 9D DE   x.....+1.S.iX...
ISAKMP:  01 6A 6C 7A 3E 23 0B 7B A5 FA 9E 63 24 E6 59 2D   .jlz>#.{...c$.Y-
ISAKMP:  C9 2B 9E 10 7B 1A 03 93 00 13 4E D7 76 84 A5 CE   .+..{.....N.v...
ISAKMP:  9D 30 A2 CD 1F C1 33 9F D0 19 9E 79 83 FC 6A 7A   .0....3....y..jz
ISAKMP:  95 17 37 3C 9A 7B D3 70 FF F2 68 F4 59 45 89 F7   ..7<.{.p..h.YE..
ISAKMP:  3D 83 3D 7B C3 09 81 58 E3 13 47 35 01 B8 D2 7D   =.={...X..G5...}
ISAKMP:  1F B4 86 2E 27 43 CF 4B 84 C0 12 13 28 19 44 92   ....'C.K....(.D.
ISAKMP:  62 43 11 B1 30 02 52 C0 FC BE D1 CD 3E 6D 1C F0   bC..0.R.....>m..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F3 FF 5E 1F 38 45 E2 52 FA 49 C7 32 D9 76 7C 26   ..^.8E.R.I.2.v|&
ISAKMP:  12 35 3B E5 73 A2 39 8D FC 36 8D 08 1B D7 FD 03   .5;.s.9..6......
ISAKMP:  7C D3 DC 89 6B 8C 61 50 F9 50 A2 83 39 F0 5F A1   |...k.aP.P..9._.
ISAKMP:  05 B2 8C 3D 08 88 7C 50 30 F3 4C 08 B4 FC 41 E9   ...=..|P0.L...A.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Case:1 Set CKY-I to 0 and CKY-R to 0.

Sending <HDR,SA,KE,Nr,IDir, HASH_R> CKY-I field set to
<CKY-I> and CKY-R field set to <CKY-R> to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0xD8BE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  29 69 1C 6E 29 93 CB C4 2C E3 80 02 C5 22 3C F0   )i.n)...,...."<.
ISAKMP:  53 B2 A8 60 55 69 1D D7 38 62 8A F8 6A 2D 3C 39   S..`Ui..8b..j-<9
ISAKMP:  0D B9 73 1F 9E A5 67 91 C2 5C 28 BB 7F 04 04 6D   ..s...g..\(....m
ISAKMP:  11 8E 68 21 F2 1A 6C 48 59 1A CC A7 6C 2F A7 64   ..h!..lHY...l/.d
ISAKMP:  63 A2 F4 8E 0C AE 4F 7F B7 EF 98 7C 1B 0C 80 99   c.....O....|....
ISAKMP:  E5 17 BB F9 75 94 6E C5 48 DB 57 93 FB B3 41 46   ....u.n.H.W...AF
ISAKMP:  C1 88 C9 02 AF 4B DD C6 6B 55 0F 9E D3 7F F2 1F   .....K..kU......
ISAKMP:  43 3E D9 58 80 1C 53 FD 2F 59 E0 1A 55 BE CE 24   C>.X..S./Y..U..$
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  42 A0 4A 98 9C 58 00 52 8E F6 87 C9 78 35 5E 9C   B.J..X.R....x5^.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  C5 55 32 EF B5 F6 56 81 78 A4 56 AF A0 F9 80 8A   .U2...V.x.V.....
ISAKMP:  03 C6 CA 51                                       ...Q
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xAB57 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd recReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x4BE6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E8 FD 85 52 8C EE 45 68                           ...R..Eh
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  FD BA AD A4 68 C4 1A 3E 67 A5 01 16 9B 82 25 87   ....h..>g.....%.
ISAKMP:  D9 5F D7 D2 DA F6 D5 E1 0D FD 6F A8 96 7A 51 C6   ._........o..zQ.
ISAKMP:  0E A6 D2 06 8A 60 01 25 BC F0 84 18 D8 37 9A 05   .....`.%.....7..
ISAKMP:  D1 39 9A 07 4E 82 16 30 25 AB 33 CA DD A5 37 28   .9..N..0%.3...7(
ISAKMP:  66 4E EA 23 29 CA 74 48 A2 BE BA EF B8 B7 E9 AD   fN.#).tH........
ISAKMP:  A8 AA 29 51 01 72 DC 46 19 B0 20 5B 86 6F 35 87   ..)Q.r.F.. [.o5.
ISAKMP:  8A 48 93 C3 38 50 48 11 01 CC 81 98 96 47 FE E2   .H..8PH......G..
ISAKMP:  11 AE 65 F2 EC 6A A8 82 08 D5 D8 44 43 5C 5A 7F   ..e..j.....DC\Z.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7B AE A3 EA EF 39 9A E3 E5 F6 5D 27 40 7A 61 5C   {....9....]'@za\
ISAKMP:  67 24 45 D4 F0 53 29 38 DE 01 8D D4 42 EA 35 86   g$E..S)8....B.5.
ISAKMP:  F5 0B AF E6 F9 B1 BB D5 73 84 F4 95 34 A2 F8 74   ........s...4..t
ISAKMP:  AE 60 E5 D1 AA 35 E7 A6 0B ED 25 DB FE F7 3C B1   .`...5....%...<.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending <HDR,SA,KE,Nr,IDir, HASH_R> CKY-I field set to
<CKY-I> and CKY-R field set to <CKY-R> to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x9121 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  29 E3 9A 16 4C 25 B1 7B BC 61 04 2C EA A7 22 52   )...L%.{.a.,.."R
ISAKMP:  D3 A8 9D C4 FD 9B F9 B4 B5 92 F8 CB 84 BB 7B 74   ..............{t
ISAKMP:  54 BE 2D 62 5E 6C 7C 64 E9 CF 33 EF 7F 5C 6E 5E   T.-b^l|d..3..\n^
ISAKMP:  F0 00 1D 2E 2B 44 C4 57 BD D0 71 74 72 08 BB 98   ....+D.W..qtr...
ISAKMP:  A1 34 60 F7 60 A6 51 D6 A3 B8 0A 96 CC 4F 11 7D   .4`.`.Q......O.}
ISAKMP:  26 1D 79 35 0F C5 4E C3 81 A2 44 FA 77 29 84 03   &.y5..N...D.w)..
ISAKMP:  63 8A DA 8A 33 9B 5A B5 29 7E 44 15 8D 55 B3 28   c...3.Z.)~D..U.(
ISAKMP:  0E 4A B5 9A 6B C8 E5 06 E5 C6 DE AF 15 E6 4E F8   .J..k.........N.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E8 7E EF A9 51 79 CA 11 BE DC DF 42 0E B6 DF 91   .~..Qy.....B....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  5C 20 5D 8B BF 6D D6 B6 86 4F 0C 35 CF 89 49 47   \ ]..m...O.5..IG
ISAKMP:  8F 6A 3C 56                                       .j<V
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA753 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
onfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.2: Passed

>> IKE-IPV6-15.3
TEST_DESCRIPTION
Implementations SHOULD never accept packets with a major version
number larger than its own.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> Major Version set
        to DUT_IKE_MAJ_VER + 1
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd Received Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xD228 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  ED F4 C5 43 43 3B A8 5B                           ...CC;.[
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C2 23 B2 99 04 CE 1E 5F 3A 07 74 7C 03 DD 3F DD   .#....._:.t|..?.
ISAKMP:  B7 DF 76 7D 66 50 C8 AC 1E 2C 80 CE 56 EA E0 5C   ..v}fP...,..V..\
ISAKMP:  70 B3 BA F0 56 94 8C 93 A8 7A 2C 24 B6 BC C8 76   p...V....z,$...v
ISAKMP:  AD 78 1C C4 0A 27 AA CE EC 70 5D AB 96 06 94 B5   .x...'...p].....
ISAKMP:  F8 6B 61 D0 EB 66 37 59 6E E7 5E 2E 4E 09 9B D6   .ka..f7Yn.^.N...
ISAKMP:  85 DB E9 29 A1 07 32 B5 C6 32 2A 66 E8 77 ED 8C   ...)..2..2*f.w..
ISAKMP:  8A E6 CB B7 4E 3A C9 E1 84 AE 50 61 9D 49 0D 45   ....N:....Pa.I.E
ISAKMP:  93 5F 94 34 84 2F 98 AB F2 F1 E1 5B D3 16 8D A1   ._.4./.....[....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  21 06 18 A6 D5 67 4B 5E 9E D5 20 E0 32 6E DE 81   !....gK^.. .2n..
ISAKMP:  69 9C 7B A4 D8 32 70 E0 EB 01 8B A7 00 84 36 CA   i.{..2p.......6.
ISAKMP:  EA 35 E9 67 CA CF E8 3E C4 50 61 A0 D4 92 CB B0   .5.g...>.Pa.....
ISAKMP:  98 45 42 2A 5D 04 FA 42 14 C3 3D EA 2B 80 6F 19   .EB*]..B..=.+.o.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> packet with Major Version set
to 2 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x91AC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  ED F4 C5 43 43 3B A8 5B                           ...CC;.[
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  55 18 15 38 4C 0E 17 54                           U..8L..T
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  FF 31 C3 2D E0 2F 49 27 4D 4C 3B 64 22 C6 30 8C   .1.-./I'ML;d".0.
ISAKMP:  55 D0 A4 47 93 5E 5F 4D E6 40 AD 9D 25 49 15 4B   U..G.^_M.@..%I.K
ISAKMP:  FE B6 AB 15 DF 7A 72 B0 84 EF 90 FB 0E EE BE 61   .....zr........a
ISAKMP:  96 4C 52 62 8E 21 C6 4B 61 E9 B6 31 EC 5C 72 05   .LRb.!.Ka..1.\r.
ISAKMP:  B1 81 EF 26 47 4C 2E B0 93 2C 16 3E 4D 3D 3B 8A   ...&GL...,.>M=;.
ISAKMP:  F0 1C B7 44 77 39 1C 40 A9 1C 81 75 03 4E 43 0C   ...Dw9.@...u.NC.
ISAKMP:  30 18 31 49 5F D3 C2 3B 7C 5E 9C 9F EB 2D 4A 3C   0.1I_..;|^...-J<
ISAKMP:  0E BE 30 AE 22 AA 4C 45 89 AE 51 4A 31 B1 61 A3   ..0.".LE..QJ1.a.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  44 38 AD 87 6E C0 F7 AC 22 79 29 88 BB 6C D7 83   D8..n..."y)..l..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  94 16 D2 0A C2 BA 09 05 19 29 7B 88 B0 3E 65 69   .........){..>ei
ISAKMP:  60 EF 92 37                                       `..7
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE31A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  ED F4 C5 43 43 3B A8 5B                           ...CC;.[
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xF35495F7
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 5 (Invalid Major Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  ED F4 C5 43 43 3B A8 5B 00 00 00 00 00 00 00 00   ...CC;.[........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
reconfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.3: Passed

>> IKE-IPV6-15.4
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with a Major Version number
larger than its own and MUST notify INVALID-MAJOR-VERSION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Major Version set to 
        DUT_IKE_MAJ_VER + 1
-  DUT: Notify with INVALID-MAJOR-VERSION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x2B0C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A7 E0 67 0E C4 EE CC 2D                           ..g....-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3D C7 06 43 56 D4 26 C0 F1 70 1E F9 4F A7 CD 68   =..CV.&..p..O..h
ISAKMP:  13 1B F9 35 DD 9D 80 A8 50 E8 89 4E 1A 92 4F A3   ...5....P..N..O.
ISAKMP:  DE 7C F0 94 3C 1C CD C3 B3 80 6C 42 D3 A4 FC 98   .|..<.....lB....
ISAKMP:  AF 04 98 14 73 A4 64 68 D9 44 99 84 62 AE 97 DC   ....s.dh.D..b...
ISAKMP:  4C 5A 0D 74 73 5A C3 E3 53 89 3F B4 AF 38 9F 73   LZ.tsZ..S.?..8.s
ISAKMP:  91 EB 7F C3 A2 C4 9C F2 F7 84 9A 06 9F AF 5B 40   ..............[@
ISAKMP:  95 9D 1F 2B D1 4D 7A 11 B7 84 8B FB 7A 3D 6C 53   ...+.Mz.....z=lS
ISAKMP:  B5 32 B8 80 1A 27 DA 9C 33 3A FA 88 7C 19 FD A6   .2...'..3:..|...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  4E 1C E0 E6 B4 1A 30 0F B7 74 A9 71 FC 0E 25 65   N.....0..t.q..%e
ISAKMP:  5B E5 2F ED F2 8A E1 DE DE 1F 1A 96 3E 44 3E E8   [./.........>D>.
ISAKMP:  AC E9 D5 2E 82 39 6C 20 10 B2 54 FB 23 2C 17 09   .....9l ..T.#,..
ISAKMP:  BA 6F 2E 3D 3E 64 78 0D 7C D3 37 B9 92 FD F7 77   .o.=>dx.|.7....w
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> packet with Major Version set
to 2 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x3824 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A7 E0 67 0E C4 EE CC 2D                           ..g....-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  42 0D 3F 3A 62 EC 18 04                           B.?:b...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  28 2D 76 A1 83 34 D8 0A 98 C7 43 3C 52 42 30 40   (-v..4....C<RB0@
ISAKMP:  14 61 4D 23 84 B2 05 84 27 7C CA B5 EB AE 51 2D   .aM#....'|....Q-
ISAKMP:  76 7D 11 9B 78 FC A9 AB 9B 8C 86 C7 23 3D 1D 56   v}..x.......#=.V
ISAKMP:  2F C2 93 7B EE BC 7A AD F2 CA AE 99 A4 62 66 F1   /..{..z......bf.
ISAKMP:  1F DB AB 2C 2C 01 97 02 D5 69 B3 18 F6 DA 2F BD   ...,,....i..../.
ISAKMP:  81 F7 F6 96 3D 05 FE 8F 07 80 F3 C2 CD 9E 48 D0   ....=.........H.
ISAKMP:  BA BF 70 39 35 9D 24 28 18 F0 56 74 6D 05 95 5D   ..p95.$(..Vtm..]
ISAKMP:  01 85 C8 40 4E 33 EC 76 06 63 6F 8D 95 B9 74 47   ...@N3.v.co...tG
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A 56 25 49 D4 33 C6 00 E3 A4 08 5C 12 35 35 AA   *V%I.3.....\.55.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F5 B3 0A E3 5D 0F 43 F5 07 7A CB 9B 1E CA 9E 2E   ....].C..z......
ISAKMP:  8A E1 76 9C                                       ..v.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD62F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A7 E0 67 0E C4 EE CC 2D                           ..g....-
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xAC8DE731
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 5 (Invalid Major Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A7 E0 67 0E C4 EE CC 2D 00 00 00 00 00 00 00 00   ..g....-........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 5

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.4: Passed

>> IKE-IPV6-15.5
TEST_DESCRIPTION
IKE SHOULD never accept inbound ISAKMP packets with a Minor Version
number larger than its own and MAY notify INVALID-MINOR-VERSION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 
        DUT_IKE_MIN_VER + 1
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure iReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x46BB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  71 C7 E7 56 CB 85 DB A0                           q..V....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  CF F1 EE 12 73 5C 3B 66 33 BB 86 D8 BC 18 89 02   ....s\;f3.......
ISAKMP:  D8 9D F2 81 D0 83 DA AA F8 8D 82 30 0B 23 93 5A   ...........0.#.Z
ISAKMP:  2C EC 25 BA 53 13 AE B8 BC D2 66 FE FA 49 2B BF   ,.%.S.....f..I+.
ISAKMP:  69 32 24 BF D0 CF D1 48 BB 16 96 46 3B 14 2A BE   i2$....H...F;.*.
ISAKMP:  45 C5 0F DD BC EE 07 EF 5F CF 75 09 D8 C4 9C 1C   E......._.u.....
ISAKMP:  27 6B E0 B1 CA 5D AA 05 01 F4 B5 E3 E4 F2 C5 C4   'k...]..........
ISAKMP:  70 83 03 E5 67 63 1F 84 2A 43 86 19 45 1C 68 0A   p...gc..*C..E.h.
ISAKMP:  BF 86 5A 87 F3 73 F3 F5 ED E1 BE 4D 3B 4A EB BE   ..Z..s.....M;J..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  04 8F 53 B4 5D 29 25 1E 2F B8 5E EF 47 FC F6 9D   ..S.])%./.^.G...
ISAKMP:  EE C1 6A FA 5D A5 BC FB A8 2D E6 4F 29 63 EE 0D   ..j.]....-.O)c..
ISAKMP:  63 34 53 FF 00 07 9E F6 67 58 6A 9C F7 5A D0 DA   c4S.....gXj..Z..
ISAKMP:  51 C9 3F 25 4F 65 F9 39 EF 53 C6 71 89 DD 98 CE   Q.?%Oe.9.S.q....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 0
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x73B9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  71 C7 E7 56 CB 85 DB A0                           q..V....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  2A F4 3D 73 8C A6 4C 7C                           *.=s..L|
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 1
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  40 94 36 47 26 3E 03 4E 74 AA A7 73 1D CA 05 DC   @.6G&>.Nt..s....
ISAKMP:  8F 27 6A 97 C4 87 67 01 79 47 04 3E 23 C4 09 40   .'j...g.yG.>#..@
ISAKMP:  40 64 67 12 C6 31 BE B6 42 A9 95 74 CE 08 18 AA   @dg..1..B..t....
ISAKMP:  DA 0F 59 0E 3C 15 85 41 81 B1 28 0A 0D 09 92 1A   ..Y.<..A..(.....
ISAKMP:  3E E1 07 D6 B2 14 08 5C 1A 16 51 C5 7F 75 5D D8   >......\..Q..u].
ISAKMP:  B8 D4 DE B5 BE 73 D6 DA 61 C4 87 32 8F 3B 0F 8D   .....s..a..2.;..
ISAKMP:  32 18 6E 90 15 CD 73 21 24 BA A7 88 9F 69 30 CB   2.n...s!$....i0.
ISAKMP:  1F F1 55 CC 46 14 B2 1A E8 66 EE 6E D7 C7 C3 FF   ..U.F....f.n....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D8 BF FC DD 82 50 4C 05 A2 41 E2 67 42 F0 A8 67   .....PL..A.gB..g
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  1C 25 51 1F 49 53 28 71 C0 3E A8 70 14 51 53 9E   .%Q.IS(q.>.p.QS.
ISAKMP:  2F 11 D7 61                                       /..a
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xB3A9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  71 C7 E7 56 CB 85 DB A0                           q..V....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x737E8253
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  71 C7 E7 56 CB 85 DB A0 00 00 00 00 00 00 00 00   q..V............
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
pike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.5: Passed

>> IKE-IPV6-15.6
TEST_DESCRIPTION
IKE SHOULD never accept inbound ISAKMP packets with a Minor Version
number larger than its own and MUST notify INVALID-MINOR-VERSION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 
        DUT_IKE_MIN_VER + 1
-  DUT: Notify with INVALID-MINOR-VERSION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xB9B5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  70 F3 A4 6A 13 D3 2B E0                           p..j..+.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AF A2 E3 10 9A 92 7C 99 7B 5F C7 CA BD 96 C0 C6   ......|.{_......
ISAKMP:  85 18 2F AA 63 26 10 81 6D DC B4 93 FF 1E 82 96   ../.c&..m.......
ISAKMP:  6B 50 0E 0E EF E7 17 72 0D 45 13 C6 DA 7D D7 0C   kP.....r.E...}..
ISAKMP:  7B E9 40 17 F7 10 57 EE B7 34 D4 80 BC 24 B6 D4   {.@...W..4...$..
ISAKMP:  90 F8 8A 96 7B EF 74 0E FE 42 1F B7 05 E4 3F F8   ....{.t..B....?.
ISAKMP:  0B FD B0 85 54 13 0F D2 01 A9 5A 20 AA F7 63 38   ....T.....Z ..c8
ISAKMP:  61 56 09 59 9B 19 63 6A A6 7A 02 6C 4D AF 63 B1   aV.Y..cj.z.lM.c.
ISAKMP:  D1 5E BF 7C F5 0F 41 42 9E 04 52 A4 DD 42 95 EB   .^.|..AB..R..B..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  49 46 B7 25 5E A5 8C 18 5A 93 B6 B8 30 0F 1E 2F   IF.%^...Z...0../
ISAKMP:  F1 48 D2 1A 7E FF 3D 28 36 05 18 E3 57 24 64 2B   .H..~.=(6...W$d+
ISAKMP:  73 0B EF 7E 8C 7E 83 79 C1 7D FC E4 5E 28 DC 64   s..~.~.y.}..^(.d
ISAKMP:  9C AC D4 1C 69 59 16 28 00 0A 59 CA 25 57 62 69   ....iY.(..Y.%Wbi
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Minor Version set to 0
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x538C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  70 F3 A4 6A 13 D3 2B E0                           p..j..+.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  6A C8 59 7F CF FC F9 08                           j.Y.....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 1
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6E 44 B5 4A F2 E4 66 14 B1 11 51 27 CE 75 87 0B   nD.J..f...Q'.u..
ISAKMP:  46 2B 4C DA 93 95 BE D1 78 41 51 5B 54 7C 59 11   F+L.....xAQ[T|Y.
ISAKMP:  B5 39 93 70 25 09 74 EC CC 58 BD 03 96 4A 81 99   .9.p%.t..X...J..
ISAKMP:  81 C2 50 73 2E 42 A2 4F A8 39 ED 12 81 09 DD 24   ..Ps.B.O.9.....$
ISAKMP:  47 F7 DD DC 7E 60 1D A4 C0 31 8B B7 02 F0 5C 14   G...~`...1....\.
ISAKMP:  2A 20 FB 86 49 66 56 46 D2 DC A3 66 9E C5 20 8C   * ..IfVF...f.. .
ISAKMP:  8B 7E 3C 24 94 42 9C D4 31 69 4D 8D 25 71 45 C8   .~<$.B..1iM.%qE.
ISAKMP:  46 73 4A 55 B7 70 2D 31 D0 4F D2 F7 8C CB 56 7A   FsJU.p-1.O....Vz
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  62 5D 3A 9B 09 7E C8 51 0E 01 71 04 EA 45 6E CA   b]:..~.Q..q..En.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E3 7B FD C5 CB 20 07 37 B5 A7 D8 2A 72 1C A1 75   .{... .7...*r..u
ISAKMP:  7E 02 1C 44                                       ~..D
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x8186 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  70 F3 A4 6A 13 D3 2B E0                           p..j..+.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x9E51E00A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  70 F3 A4 6A 13 D3 2B E0 00 00 00 00 00 00 00 00   p..j..+.........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 6

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.6: Passed

>> IKE-IPV6-15.7
TEST_DESCRIPTION
Message ID (4 octets) - During Phase 1 negotiations, the value
MUST be set to 0.
If the Message ID validation fails, the message is discarded
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
        HDR set to <prm_inv_ph1_msg_id>
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x0550 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  91 19 0E 71 A7 79 F9 09                           ...q.y..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B1 79 E1 6D F1 59 F3 FD 59 99 E4 20 5D CF 3F 19   .y.m.Y..Y.. ].?.
ISAKMP:  84 F5 7B 15 13 1A 3A 23 68 02 A0 B9 47 9E 92 8B   ..{...:#h...G...
ISAKMP:  C2 3A 68 97 5F E3 6D 8C 02 6D 68 F6 F4 42 5B AC   .:h._.m..mh..B[.
ISAKMP:  28 64 AA 0E 7B 7E F1 04 A8 87 F3 FB 36 B6 04 E7   (d..{~......6...
ISAKMP:  01 29 B4 95 F1 FF 1B 72 A1 3C 04 56 DC 2A 49 83   .).....r.<.V.*I.
ISAKMP:  F5 E8 34 52 9D EA D9 66 44 5A C9 94 B4 2D AC D0   ..4R...fDZ...-..
ISAKMP:  EE C7 20 B9 0F 30 B8 C5 4E 7E F5 0F 35 A3 93 01   .. ..0..N~..5...
ISAKMP:  7B D4 1E AD 73 9A 44 1B C3 1C 53 7E 31 04 D5 9A   {...s.D...S~1...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  76 EE B7 C3 24 40 E8 A1 F3 7B 1E AE 44 C7 B4 F7   v...$@...{..D...
ISAKMP:  59 36 DF 7B 9F 29 C4 8B 2E B6 19 E2 83 CB AB 76   Y6.{.).........v
ISAKMP:  A1 AF 16 65 CC F4 FD 62 C3 8A C4 E0 3E C1 4B A7   ...e...b....>.K.
ISAKMP:  55 6E 97 61 51 F3 8D FE C5 F0 49 A6 E6 27 65 28   Un.aQ.....I..'e(
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
HDR set to <prm_inv_ph1_msg_id> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0xA588 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  91 19 0E 71 A7 79 F9 09                           ...q.y..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  6A 3B 38 06 AD 45 7E 7D                           j;8..E~}
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DF 72 75 3B DD CA 1C 0F 16 83 67 7F 18 07 EB 0C   .ru;......g.....
ISAKMP:  F4 DF CE DB 59 FE AF 50 CE B4 32 B6 5C F1 7F D6   ....Y..P..2.\...
ISAKMP:  DD 2F CE F5 E7 CF CB B6 F3 EE 51 65 4A 9B A9 16   ./........QeJ...
ISAKMP:  49 5D 55 FF 06 52 C8 3D 58 58 86 37 F6 CB 8E 27   I]U..R.=XX.7...'
ISAKMP:  7C 3E 75 E8 CA 52 10 DD D3 DD 80 F1 D3 3D 7A 0B   |>u..R.......=z.
ISAKMP:  E8 12 9C 4C 6C 51 AD DC 75 4A B4 52 6E 9F 45 87   ...LlQ..uJ.Rn.E.
ISAKMP:  BA C2 ED FB BD 7D 6F F0 A9 FF 47 34 A7 7D D1 E4   .....}o...G4.}..
ISAKMP:  87 A1 E0 93 84 0A 30 5E 48 8C 49 80 0C 46 CC A3   ......0^H.I..F..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F5 CD C9 CD BD 93 59 A5 BB 7B 67 95 0C 45 9E 1C   ......Y..{g..E..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  2B F3 1D CD 77 F6 1C E6 1C AE 9B 48 FF FC 87 BF   +...w......H....
ISAKMP:  32 0B BC 3D                                       2..=
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x2983 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  91 19 0E 71 A7 79 F9 09                           ...q.y..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x446BBBF7
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  91 19 0E 71 A7 79 F9 09 00 00 00 00 00 00 00 00   ...q.y..........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.7: Passed

>> IKE-IPV6-15.8
TEST_DESCRIPTION
Message ID (4 octets) - During Phase 1 negotiations, the value
MUST be set to 0.
If the Message ID validation fails, the message is discarded and
the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-MESSAGE-ID message type MAY be sent to the
transmitting entity.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
        HDR set to <prm_inv_ph1_msg_id>
-  DUT: Notify INVALID-MESSAGE-ID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd recReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x47D9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8C 95 61 B2 2E 52 1E 0A                           ..a..R..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  1A 51 92 AE 17 79 6E BD 34 B7 B0 94 AA F9 5D 89   .Q...yn.4.....].
ISAKMP:  EC B1 15 4B 0E 35 C8 0E 00 9C CA 9E FE 11 0E CE   ...K.5..........
ISAKMP:  0D 0E 40 38 67 5B E5 08 37 CD C9 3C C1 81 B4 BB   ..@8g[..7..<....
ISAKMP:  84 6A 2A 5D 85 83 DA 2F E2 BB 72 3C 10 27 6C A3   .j*].../..r<.'l.
ISAKMP:  FF 7D 4B 1D DD 3E CC 07 26 63 A4 35 BB 9D A4 24   .}K..>..&c.5...$
ISAKMP:  19 87 77 B1 CB 66 BD 41 68 0D F8 01 35 36 3B AA   ..w..f.Ah...56;.
ISAKMP:  C2 8C 58 A1 B5 CE F4 AF 91 BB D3 D0 97 F6 01 E3   ..X.............
ISAKMP:  DB 8E 24 E0 01 40 7B 49 C6 57 6A C9 D5 63 4D 21   ..$..@{I.Wj..cM!
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7D 57 09 BA DD 8B 51 3B C8 94 30 C2 C0 64 6C 7C   }W....Q;..0..dl|
ISAKMP:  A5 B2 15 F2 B7 89 A7 97 05 9F DC CF A8 BB 7B 73   ..............{s
ISAKMP:  D7 B0 22 D0 22 8D C8 5C A4 EE E8 80 9F 22 AA 5B   .."."..\.....".[
ISAKMP:  C7 7A BE 8F 3D B8 1B 5C A5 40 79 B8 CD 40 34 D6   .z..=..\.@y..@4.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with Message Id field of
HDR set to <prm_inv_ph1_msg_id> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0xFFED (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8C 95 61 B2 2E 52 1E 0A                           ..a..R..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  94 FA A8 55 44 C6 91 1E                           ...UD...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5D 78 FA A2 B1 5A 46 EA F0 F1 65 F8 FF 99 D8 59   ]x...ZF...e....Y
ISAKMP:  3A 58 DF 5B 6E 8D 37 96 0F B3 29 ED EE C1 98 19   :X.[n.7...).....
ISAKMP:  0D 3D B3 5B 42 1B 57 9C D2 0D DC 87 AF 2D 98 3D   .=.[B.W......-.=
ISAKMP:  AE DD 70 00 E0 0B 62 E7 98 B6 20 26 12 05 65 65   ..p...b... &..ee
ISAKMP:  26 8F 53 B7 48 EB D2 C8 1D A8 A5 50 64 13 F3 FE   &.S.H......Pd...
ISAKMP:  65 AD 73 FA C9 D5 CC 62 C0 84 15 41 DD 12 DF D3   e.s....b...A....
ISAKMP:  80 5A 50 79 8B 72 FF 33 3C E2 8C DC 33 01 BF 79   .ZPy.r.3<...3..y
ISAKMP:  D9 70 02 E3 CA 82 F3 D2 54 65 4B 7B CC 21 2F CB   .p......TeK{.!/.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A FB E9 39 7C 81 EA CC DA CC 98 7A B0 2E FD DB   *..9|......z....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  CC C9 E6 63 37 66 61 81 78 05 0A 86 84 48 7D 9C   ...c7fa.x....H}.
ISAKMP:  DE AB 80 0B                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x2F96 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  8C 95 61 B2 2E 52 1E 0A                           ..a..R..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x3452D0D1
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  8C 95 61 B2 2E 52 1E 0A 00 00 00 00 00 00 00 00   ..a..R..........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 9

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
onfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.8: Passed

>> IKE-IPV6-15.9
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if SA Payload does
not precede all other payloads and MAY notify INVALID-PAYLOAD-TYPE
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send HDR,KE,SA,Nr,IDir, HASH_R
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigurReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x8C64 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  86 5A B4 39 83 32 66 E9                           .Z.9.2f.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7D E9 B6 E1 5F C0 62 07 CB 6A 24 9E 26 66 A5 1A   }..._.b..j$.&f..
ISAKMP:  E1 6D B4 56 F3 C9 9B 32 E9 5E 0A C0 37 1F BE 89   .m.V...2.^..7...
ISAKMP:  0B 0E 03 8D DD 05 FE 1A 8C B6 2E 75 CB C6 7F C9   ...........u....
ISAKMP:  A1 66 F2 95 31 CC 78 4A A3 B6 93 FE 2B AE 6B 31   .f..1.xJ....+.k1
ISAKMP:  7E 2F 1B D6 37 E1 29 22 42 53 E5 0C 1D A5 4E 30   ~/..7.)"BS....N0
ISAKMP:  D4 6C C2 C9 D1 BD 32 14 4D 53 AE 87 D0 BE 78 00   .l....2.MS....x.
ISAKMP:  16 FD FC 67 40 FF C9 F4 00 67 EB 13 06 76 88 82   ...g@....g...v..
ISAKMP:  44 29 17 F1 FD 02 5B D0 E7 81 01 4B B3 BB 16 99   D)....[....K....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  BC 66 33 6A 5B 37 38 E2 57 C0 6C 4A 5B 46 17 D1   .f3j[78.W.lJ[F..
ISAKMP:  C4 78 41 5C 68 CD F2 A0 C3 C4 A9 29 E7 AA F3 5B   .xA\h......)...[
ISAKMP:  10 3B F3 32 8C DF 8B E7 84 0F 99 64 E1 B7 71 72   .;.2.......d..qr
ISAKMP:  8E 73 56 8D C6 7C FA AD 5D 78 84 4C C8 8D 7E 9B   .sV..|..]x.L..~.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,KE,SA,Nr,IDir,HASH_R> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x1C58 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  86 5A B4 39 83 32 66 E9                           .Z.9.2f.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D9 AD 9A 0C AE 6D 0E 17                           .....m..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  8C 8C 31 64 FA 09 C2 27 1A D6 A1 62 CB 4C B2 82   ..1d...'...b.L..
ISAKMP:  B4 2A 02 C2 15 1B E5 25 07 9F 34 5D BF 34 8F 93   .*.....%..4].4..
ISAKMP:  DA 1F F4 10 F6 DA 70 1E 68 5D F4 B0 78 AF 72 A2   ......p.h]..x.r.
ISAKMP:  06 2E 67 E8 32 D5 55 A4 B2 DD 5D AD 41 3E 1D D1   ..g.2.U...].A>..
ISAKMP:  C7 67 39 F2 90 4C F3 8C 83 B5 71 E6 82 1B A0 1D   .g9..L....q.....
ISAKMP:  7B 6E CF 42 BD 5E 57 77 3F 4A 7A F4 BE BE 48 9E   {n.B.^Ww?Jz...H.
ISAKMP:  08 25 CA 14 5F 83 97 3B EC 2C 25 F8 F0 F5 F3 FB   .%.._..;.,%.....
ISAKMP:  1E 23 7C 4E 36 02 E8 F5 D6 4D C6 F0 DA 85 68 49   .#|N6....M....hI
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E8 FE 53 8C 39 3F 47 A5 49 0E 14 AA 67 0A DC 80   ..S.9?G.I...g...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  74 0F 39 A7 5D 6E 86 85 4C C0 C4 89 A7 A8 60 F1   t.9.]n..L.....`.
ISAKMP:  16 84 80 0B                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xCB0A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  86 5A B4 39 83 32 66 E9                           .Z.9.2f.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D9 AD 9A 0C AE 6D 0E 17                           .....m..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x61B0D370
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  86 5A B4 39 83 32 66 E9 D9 AD 9A 0C AE 6D 0E 17   .Z.9.2f......m..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
e ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.9: Passed

>> IKE-IPV6-15.10
TEST_DESCRIPTION
The SA payload MUST precede all other payloads in a phase 1 exchange.
If the Next Payload field validation fails, the message is discarded
and the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-PAYLOAD-TYPE message type MAY be sent to the
transmitting entity.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
          RFC 2408 s5.2 p59 ISAKMP Header Processing
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using
        Aggressive Mode
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send HDR,KE,SA,Nr,IDir, HASH_R
-  DUT: Notify INVALID-PAYLOAD-TYPE or PAYLOAD-MALFORMED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xF519 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4F 8D F6 F5 50 63 D2 42                           O...Pc.B
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A0 CB EB A5 F3 90 BB C5 AB AA 20 DD 01 E2 C5 94   .......... .....
ISAKMP:  7D D5 36 6F 62 00 01 A9 31 AB D1 1E 21 DE 1F 5A   }.6ob...1...!..Z
ISAKMP:  C3 F3 DD A1 CF BF D0 E3 85 CF BF 58 66 4A 4E 69   ...........XfJNi
ISAKMP:  03 53 99 ED 61 98 0F 73 11 24 CF B5 56 E3 66 3E   .S..a..s.$..V.f>
ISAKMP:  3F 51 0D 0A 2D BA 4C 1D 0A E8 13 F9 06 0A AE A1   ?Q..-.L.........
ISAKMP:  0B 6A 98 56 58 DD C1 CA 50 27 C5 3C CE 85 67 67   .j.VX...P'.<..gg
ISAKMP:  EA E2 0F 20 5F F0 7E CA 93 07 39 55 C1 6C DF F6   ... _.~...9U.l..
ISAKMP:  DB 00 44 69 32 01 20 EF 88 70 C1 A0 56 A9 6C 82   ..Di2. ..p..V.l.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  9C 74 71 D3 2A 53 80 81 12 13 0B DA 8A D7 D9 98   .tq.*S..........
ISAKMP:  79 54 CA A2 5A F7 7A 63 54 E9 E7 6B B3 68 86 63   yT..Z.zcT..k.h.c
ISAKMP:  D6 A2 22 0F B8 9A 10 F4 14 26 ED 85 FB D0 31 0D   .."......&....1.
ISAKMP:  A1 FA 39 6B 00 05 D1 E3 CF 4C E1 71 1F 32 88 EB   ..9k.....L.q.2..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,KE,SA,Nr,IDir,HASH_R> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x99BC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4F 8D F6 F5 50 63 D2 42                           O...Pc.B
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9A FD E6 0E 5B 2B DB 22                           ....[+."
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  99 CC 07 B4 15 1C 7F B3 64 91 26 96 5F 4B 1E 58   ........d.&._K.X
ISAKMP:  2D 92 32 5A 7C C8 8B D9 40 FD 30 C9 81 D1 AA 37   -.2Z|...@.0....7
ISAKMP:  F4 05 58 FE C1 0F 7A 03 E2 E1 60 1E D3 5B D2 AD   ..X...z...`..[..
ISAKMP:  9F A4 EB 70 A8 A9 25 5E 3A D3 3A C9 06 54 BB 14   ...p..%^:.:..T..
ISAKMP:  57 15 50 64 25 9A 4B C4 99 47 79 AA E7 E4 2F E4   W.Pd%.K..Gy.../.
ISAKMP:  18 C7 F2 2C 53 AE 3C 2F 5C 75 1A 0E 21 8A DD A6   ...,S.</\u..!...
ISAKMP:  FD 59 4F 25 B2 CB 90 CB 74 7F 86 85 0E D9 5A 17   .YO%....t.....Z.
ISAKMP:  F9 D7 20 32 BE D3 7C C1 DE F3 B0 CD 94 E5 AB 2B   .. 2..|........+
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  89 DE B8 53 56 FE 97 29 06 0D D3 96 0E EF D7 0D   ...SV..)........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  B1 B8 8A 73 1E 12 C9 65 9F 34 1B 23 9A E3 0A AC   ...s...e.4.#....
ISAKMP:  F3 C0 27 C1                                       ..'.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7C9A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4F 8D F6 F5 50 63 D2 42                           O...Pc.B
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9A FD E6 0E 5B 2B DB 22                           ....[+."
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x69208347
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4F 8D F6 F5 50 63 D2 42 9A FD E6 0E 5B 2B DB 22   O...Pc.B....[+."
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 1 (Invalid Payload Type)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.10: Passed

>> IKE-IPV6-15.15
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if Port field
of Identification Payload is other than 0 or 500 and MAY
notify INVALID-ID-INFORMATION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set ID Port field of IDir
        to an invalid <prm_inv_Id_port>
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipiReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0xF7B5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DC EE AC 1E 08 9D 84 50                           .......P
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C3 7C A3 32 6C 5D CB 45 2A 8D 40 D6 E9 0B 30 59   .|.2l].E*.@...0Y
ISAKMP:  CB 19 FC 2A A7 4F 82 E9 C4 78 A7 61 A5 34 10 03   ...*.O...x.a.4..
ISAKMP:  25 49 FE 86 AD 28 F5 06 66 67 77 0C A8 EA DC 61   %I...(..fgw....a
ISAKMP:  21 A8 D8 EF 14 D1 AD 48 3E EA 31 A7 8B 5F 91 A3   !......H>.1.._..
ISAKMP:  46 41 6B CF 48 58 A0 D3 F5 19 A5 4A 5E F8 5F 75   FAk.HX.....J^._u
ISAKMP:  F5 14 92 5F 27 4E 6F EF 01 EE 4E E8 09 4D 5B 8C   ..._'No...N..M[.
ISAKMP:  B9 9B 61 7A 5A 8B 40 B2 48 00 2F 16 0F EF 6C 4B   ..azZ.@.H./...lK
ISAKMP:  B4 71 04 89 FB B6 11 25 8B 48 EC DE 82 29 FC F4   .q.....%.H...)..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  9B E3 22 F5 46 79 9E 2B BE 9E AE ED 5C 6E DD 93   ..".Fy.+....\n..
ISAKMP:  1C FC 61 14 48 FF CB CB B8 99 EF DE 9F 99 9A 98   ..a.H...........
ISAKMP:  03 DF F4 90 45 D6 E0 D2 CC 1E 7C D0 3D A3 99 73   ....E.....|.=..s
ISAKMP:  43 A9 D3 4C A0 5D B9 AF 11 1A 34 1F BE ED 43 59   C..L.]....4...CY
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> Packet
to DUT with invalid Id Port 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x2C4E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DC EE AC 1E 08 9D 84 50                           .......P
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  ED 8A F7 26 56 C5 69 5E                           ...&V.i^
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  86 7F CC 74 C9 C1 22 12 E0 96 D7 A7 55 E8 0A A5   ...t..".....U...
ISAKMP:  70 68 2B F6 3B AC B8 A6 6D DB E8 F0 7D 35 57 2E   ph+.;...m...}5W.
ISAKMP:  69 28 20 B9 97 3E 9E F6 13 78 C2 A2 72 22 D9 C6   i( ..>...x..r"..
ISAKMP:  80 9E A7 61 79 84 00 DE D9 44 F5 48 06 68 DC E3   ...ay....D.H.h..
ISAKMP:  80 93 5A 5F B1 B9 BD 06 68 51 BD 1B AA 6F 6B 85   ..Z_....hQ...ok.
ISAKMP:  A9 63 A5 51 E8 F6 80 1E BF 32 6D CE 77 E1 A5 6C   .c.Q.....2m.w..l
ISAKMP:  4C BB 1C 93 C1 24 3E FF 0D 12 C3 9C CF D8 31 30   L....$>.......10
ISAKMP:  E6 7D D2 F1 D3 3E C0 82 A3 E1 99 EC 23 75 31 0C   .}...>......#u1.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  3E EF 9A C9 7D C9 D3 D4 47 E9 79 C0 9E 55 7D 2B   >...}...G.y..U}+
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F3 F7 A9 0B 4C 5D 73 A9 2F 7D 79 AB D5 19 25 BB   ....L]s./}y...%.
ISAKMP:  43 00 E0 36                                       C..6
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF069 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DC EE AC 1E 08 9D 84 50                           .......P
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  ED 8A F7 26 56 C5 69 5E                           ...&V.i^
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x43F5FFF8
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  DC EE AC 1E 08 9D 84 50 ED 8A F7 26 56 C5 69 5E   .......P...&V.i^
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ke
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.15: Passed

>> IKE-IPV6-15.16
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP packet
if Port field of Identification Payload is other than 0 or 500.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set ID Port field of IDir to 
        an invalid <prm_inv_Id_port>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x183C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A0 4F 4C 28 6D E3 FB AA                           .OL(m...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  77 3A A7 4A 17 25 9C 0D 9B BE 51 87 39 E4 D8 D8   w:.J.%....Q.9...
ISAKMP:  6B D2 44 0D 9A C9 FB CB E8 8A 34 F3 35 E2 F3 87   k.D.......4.5...
ISAKMP:  09 FF B0 C0 24 56 CC F8 03 E7 18 E8 F7 17 E3 7B   ....$V.........{
ISAKMP:  E1 35 F5 F1 3B F1 65 7B DB F9 88 11 6B E1 DC AB   .5..;.e{....k...
ISAKMP:  08 94 D3 E7 4A C6 40 76 7F 76 4A 95 10 3B 3B 17   ....J.@v.vJ..;;.
ISAKMP:  96 D0 D2 71 D7 62 73 CE 80 B9 B6 EA 14 C4 1C 1C   ...q.bs.........
ISAKMP:  9A 19 20 DD AC C5 DC B6 FA D4 CC F6 44 0E 14 D5   .. .........D...
ISAKMP:  08 81 11 94 73 74 D0 8A CB 3F A3 8D 07 B2 2A 1A   ....st...?....*.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  3C 3B FB 5C 9F D4 60 68 A9 5C 8F 7B 78 D9 E2 D4   <;.\..`h.\.{x...
ISAKMP:  D8 D6 16 F4 36 CB A0 9A 33 54 CF 84 46 DD B0 1B   ....6...3T..F...
ISAKMP:  4C 0A 9B 9B 6D D9 C1 2B AD 7F 1F 12 DC 3E 9E EF   L...m..+.....>..
ISAKMP:  9B CF 57 5A 97 4C B4 63 DC 35 EF 53 A6 04 6D BF   ..WZ.L.c.5.S..m.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> Packet
to DUT with invalid Id Port 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x1D93 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A0 4F 4C 28 6D E3 FB AA                           .OL(m...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7E 30 09 62 E9 04 78 2B                           ~0.b..x+
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  CC 7D 7B 1F 62 7C D4 27 A7 F0 0D 05 D2 20 C7 B6   .}{.b|.'..... ..
ISAKMP:  29 F5 4A 9A F1 DF EC 9E 51 30 89 67 F1 15 72 45   ).J.....Q0.g..rE
ISAKMP:  9E 72 2F B6 98 9E E6 11 BC 1F F6 9A BE 7A 0C 78   .r/..........z.x
ISAKMP:  4C 66 01 86 0C DD E6 4F 7A 60 F4 24 A2 B7 B0 01   Lf.....Oz`.$....
ISAKMP:  27 58 A2 2C FB 46 2C B5 CB 95 DE CC 19 6B 27 90   'X.,.F,......k'.
ISAKMP:  43 BF FE 12 51 48 D6 04 04 B0 AD 0F 9B 46 42 5A   C...QH.......FBZ
ISAKMP:  6F 80 A0 E6 0C 9D 5A 1D C7 37 77 8A FF F7 39 20   o.....Z..7w...9 
ISAKMP:  01 CB 1F B2 9D 30 7A 76 9D 9D 65 2A BC 2B 97 94   .....0zv..e*.+..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B4 F4 E2 AC ED 7D 51 AA B7 16 D5 3B B4 F1 03 58   .....}Q....;...X
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F7 F3 FE C5 50 60 04 02 80 31 C2 82 96 AE 9B AB   ....P`...1......
ISAKMP:  4E CF F9 D4                                       N...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x14E6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A0 4F 4C 28 6D E3 FB AA                           .OL(m...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7E 30 09 62 E9 04 78 2B                           ~0.b..x+
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x9BE27B9E
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A0 4F 4C 28 6D E3 FB AA 7E 30 09 62 E9 04 78 2B   .OL(m...~0.b..x+
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 18 (Invalid ID Information)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
igure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.16: Passed

>> IKE-IPV6-15.17
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet with Protocol ID
field of ID Payload other than 0 or UDP protocol (0x11) and MAY
notify INVALID-ID-INFORMATION.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set Protocol-ID field
        of IDii to an invalid <prm_inv_id_proto>
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x59E3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  81 DB 89 4A 08 9E F6 1E                           ...J....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  15 43 BB D8 9D 89 75 8E 6C 4F CD B5 DB 06 19 6C   .C....u.lO.....l
ISAKMP:  6F 1C 93 97 28 AC 87 47 85 41 8A 44 74 41 10 95   o...(..G.A.DtA..
ISAKMP:  77 3A 14 D0 98 92 45 A7 37 08 33 F3 35 86 2D 85   w:....E.7.3.5.-.
ISAKMP:  F0 46 34 E4 86 25 0F 61 0B 48 7B E8 DA 92 32 E4   .F4..%.a.H{...2.
ISAKMP:  6B CF C0 4F BF E4 33 F2 B8 BE 54 23 45 6E 9B 51   k..O..3...T#En.Q
ISAKMP:  1C 38 1A 40 B6 61 31 F1 0A EB E2 07 F0 36 D3 D2   .8.@.a1......6..
ISAKMP:  31 ED EB 92 50 22 32 3F DF 30 A6 E3 CD 64 47 38   1...P"2?.0...dG8
ISAKMP:  D8 39 B3 91 97 BE D0 FD 2B BD 46 68 CE 3E CE 71   .9......+.Fh.>.q
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  6A 00 87 B8 C1 3C 9B 80 A6 7E CE A3 57 87 8E 4A   j....<...~..W..J
ISAKMP:  9D 49 09 7A F7 A7 8A D4 F8 A6 65 1C 14 0B 84 C1   .I.z......e.....
ISAKMP:  65 58 6E 5B 9E A2 95 BA 54 9A 9F DE 70 21 02 6C   eXn[....T...p!.l
ISAKMP:  E2 D8 56 52 83 07 7B 5A 6F 15 25 E3 30 5F 08 27   ..VR..{Zo.%.0_.'
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> Packet
with invalid Portocol-Id 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x7005 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  81 DB 89 4A 08 9E F6 1E                           ...J....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  80 C2 5F 37 B4 62 EB 00                           .._7.b..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E1 87 E7 AD 05 52 C3 D1 C1 A3 6D FF 78 FA A7 D6   .....R....m.x...
ISAKMP:  08 9A 08 24 20 B8 C6 79 C6 91 BF 5B D8 B1 AE 83   ...$ ..y...[....
ISAKMP:  7E 7C 23 CD 25 7A CB B0 C9 E6 F2 D5 76 D4 00 F7   ~|#.%z......v...
ISAKMP:  3B E5 FD DD B3 63 51 E3 05 60 2F CB B5 8E A8 1E   ;....cQ..`/.....
ISAKMP:  B9 6E F6 C5 92 33 74 98 F3 80 4F B9 56 74 A5 90   .n...3t...O.Vt..
ISAKMP:  54 21 35 B3 8F A2 E4 0F B0 4F 2B 82 F6 91 4E 38   T!5......O+...N8
ISAKMP:  98 35 05 46 B4 A2 70 68 45 E7 AA D1 79 FC 9D 2B   .5.F..phE...y..+
ISAKMP:  F4 7F 33 17 EE 6D D2 BE B7 6F 6A 32 97 17 3D EB   ..3..m...oj2..=.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D1 DE 59 F0 3E 70 EE D4 B8 45 9F FE 26 F9 D4 7B   ..Y.>p...E..&..{
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  D7 15 92 1B 0B 3A 0D F8 B8 94 B5 29 B4 57 57 D4   .....:.....).WW.
ISAKMP:  23 BE F7 90                                       #...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xEEB6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  81 DB 89 4A 08 9E F6 1E                           ...J....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  80 C2 5F 37 B4 62 EB 00                           .._7.b..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x8C931C2E
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  81 DB 89 4A 08 9E F6 1E 80 C2 5F 37 B4 62 EB 00   ...J......_7.b..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.17: Passed

>> IKE-IPV6-15.18
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP packet
with Protocol ID field of ID Payload other than 0 or UDP
protocol (0x11).
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>. Set Protocol-ID
        field of IDii to an invalid <prm_inv_id_proto>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x7055 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 1F 6E 6F 3D 5D DA 9F                           b.no=]..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E4 B6 9B 29 8B 9C 32 00 8A 1E DB AD C1 59 24 2C   ...)..2......Y$,
ISAKMP:  1A 45 3E 8C F2 54 9A 05 D2 0B B5 48 03 BF 4F EB   .E>..T.....H..O.
ISAKMP:  C9 11 16 F5 57 AE AB 21 0A 72 E4 47 29 E2 98 E5   ....W..!.r.G)...
ISAKMP:  01 52 D4 06 BE AA 30 17 E8 0B A0 3B 42 06 68 C9   .R....0....;B.h.
ISAKMP:  D7 2F B4 5B DC 88 4F 42 68 3C 28 86 8D C4 19 FB   ./.[..OBh<(.....
ISAKMP:  B4 A8 BC 2F DC D8 3A B8 E8 9D 6B 44 D5 AF FE 12   .../..:...kD....
ISAKMP:  89 17 FF BC F8 21 55 79 FC 1E 1E C6 0C AD 37 3E   .....!Uy......7>
ISAKMP:  42 74 5B 0D 19 AE 00 0A 47 2C 52 71 E9 19 CA 73   Bt[.....G,Rq...s
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  82 69 E5 AF EE B9 17 D0 A9 FC 70 4B 13 89 0C AC   .i........pK....
ISAKMP:  AA 1F 5F 50 17 E0 BC 86 58 1D 5D 54 61 C1 08 B7   .._P....X.]Ta...
ISAKMP:  4A CC 49 35 77 B3 24 83 1E B5 DC 9E 20 E6 AF 8D   J.I5w.$..... ...
ISAKMP:  A8 57 10 AE 7C 91 4D E9 C3 12 9E E9 1F EC EE 8C   .W..|.M.........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> Packet
with invalid Portocol-Id 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x5043 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 1F 6E 6F 3D 5D DA 9F                           b.no=]..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  87 0C 8D 49 C4 FF 07 53                           ...I...S
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F7 8A 81 7A EC EC 18 2F 75 C3 BA BB 03 D4 0A D9   ...z.../u.......
ISAKMP:  42 E0 B0 8D 21 86 D6 A6 E4 54 22 1C 1B 74 04 4D   B...!....T"..t.M
ISAKMP:  6B 2A 44 94 EC 54 13 03 C5 94 ED 9D 9D AC 41 04   k*D..T........A.
ISAKMP:  44 CC 98 22 0F 32 46 24 51 4C 05 E1 80 FC AD 60   D..".2F$QL.....`
ISAKMP:  5C 90 AA C1 F9 1E D8 44 F0 EA 9D 2E E2 48 6E FA   \......D.....Hn.
ISAKMP:  57 B4 78 FB 90 E6 1D 58 CF 09 E3 C8 AA B6 AC E9   W.x....X........
ISAKMP:  A8 99 76 53 F9 E9 1A 74 D1 0A E0 91 67 BE BA E9   ..vS...t....g...
ISAKMP:  07 21 0C 63 23 31 F2 97 3D F0 D0 A2 AF 87 1E B5   .!.c#1..=.......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F0 75 F8 E4 33 F4 31 7D AC 87 08 B4 83 E3 CB D1   .u..3.1}........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  4E BF 52 9C 74 53 9D D3 CB 1C DF CF 4C 14 0F 49   N.R.tS......L..I
ISAKMP:  80 F4 3E A8                                       ..>.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3B60 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  62 1F 6E 6F 3D 5D DA 9F                           b.no=]..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  87 0C 8D 49 C4 FF 07 53                           ...I...S
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD8160419
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  62 1F 6E 6F 3D 5D DA 9F 87 0C 8D 49 C4 FF 07 53   b.no=].....I...S
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 18 (Invalid ID Information)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
igure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.18: Passed

>> IKE-IPV6-15.19
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with a Nonce Payload
if Length of Nonce Payload is not between 8 and 256 bytes and
MAY notify PAYLOAD-MALFORMED.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>.
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>.Set the value of the Payload
        Length field of Nonce Payload to <prm_inv_nonce_len> which is
        less than 8 or greater than 256
-  DUT: Do not send <HDR,HASH_I>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfiReceived Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x5ADA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E1 82 96 DA 61 9D 5F C5                           ....a._.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  EE F3 8E 9E 59 36 76 05 A8 92 42 34 55 16 AD 55   ....Y6v...B4U..U
ISAKMP:  8E A3 D2 47 7A 42 DF 78 61 92 B0 7B AD 4C 83 15   ...GzB.xa..{.L..
ISAKMP:  24 9F 0A 55 FA 93 6A EC 51 AB 9A 90 47 19 60 6F   $..U..j.Q...G.`o
ISAKMP:  FA 3F 0B EE 8B C7 B7 53 E8 4F A5 B8 11 8E C7 F5   .?.....S.O......
ISAKMP:  49 14 C3 60 B3 46 38 54 00 63 DA 4F DB FD 18 9F   I..`.F8T.c.O....
ISAKMP:  75 6A 5D 9B 04 96 EA AC C6 5A 46 A8 1E 70 8D 97   uj]......ZF..p..
ISAKMP:  FD 5D 80 62 80 23 22 60 27 7D FD D1 53 5F 29 78   .].b.#"`'}..S_)x
ISAKMP:  83 2D 92 92 9A E3 61 BB 9A 55 EF BD 34 D6 DA C0   .-....a..U..4...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  33 B6 F4 9A D5 C7 D0 E7 15 7F 6A 30 E5 BC 22 1E   3.........j0..".
ISAKMP:  86 EA 17 C9 2E F9 88 C6 21 CC 52 A8 1B AB EB CB   ........!.R.....
ISAKMP:  C7 36 E0 68 96 49 6C 08 5C CA 93 99 E4 44 9B 96   .6.h.Il.\....D..
ISAKMP:  5A 9C FB E1 67 02 2C 16 92 EE 30 F3 39 79 1D D4   Z...g.,...0.9y..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
! 2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with the value of the Payload
Length field of Nonce Payload to <prm_inv_nonce_len> 7 which is
less than 8 or greater than 256 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 275 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 275 
UDP: Checksum         = 0x0E87 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E1 82 96 DA 61 9D 5F C5                           ....a._.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E2 A4 2F 4B 54 A0 32 54                           ../KT.2T
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 267 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  34 98 74 55 37 A7 B2 F8 7F 49 B8 E6 6A 15 AA D2   4.tU7....I..j...
ISAKMP:  BD B0 36 88 BE 61 3C 97 80 7F F7 73 53 E1 38 84   ..6..a<....sS.8.
ISAKMP:  23 4F DD 39 17 E3 62 C5 DB E2 37 42 76 6D A2 9C   #O.9..b...7Bvm..
ISAKMP:  18 E7 16 6A 3A BE 69 E2 49 38 A7 AD 2D 4A B3 35   ...j:.i.I8..-J.5
ISAKMP:  DD 73 8B 2B 28 9E 20 D7 5C 24 8F CF C6 3C 2F BF   .s.+(. .\$...</.
ISAKMP:  22 B8 FD 00 16 73 98 E9 32 3C BB 70 35 DB 2F 5A   "....s..2<.p5./Z
ISAKMP:  A0 43 8C B9 34 57 F3 8D 78 97 44 E5 1D 1D 1B 89   .C..4W..x.D.....
ISAKMP:  D2 7D BC F2 D5 63 E0 57 96 DE 69 05 A8 B1 6C 51   .}...c.W..i...lQ
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 7 bytes
ISAKMP: --- Nonce Data [3 bytes] ---
ISAKMP:  CB 50 41                                          .PA
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  CB D9 AD B0 AF D7 61 4A 41 E4 B8 61 EB 2F 7A 3F   ......aJA..a./z?
ISAKMP:  36 7F 3C AC                                       6.<.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x086C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E1 82 96 DA 61 9D 5F C5                           ....a._.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xBCA87166
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  E1 82 96 DA 61 9D 5F C5 00 00 00 00 00 00 00 00   ....a._.........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not received <HDR,HASH_I> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
gure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.19: Passed

>> IKE-IPV6-15.20
TEST_DESCRIPTION
IKE MUST notify PAYLOAD-MALFORMED for an incoming ISAKMP packet with a
Nonce Payload if Length of Nonce Payload is not between 8 and 256
bytes.
Aggressive mode/DUT initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA
-  DUT: Send <HDR,SA,KE,Ni,IDii>.
- ANVL: Send <HDR,SA,KE,Nr,IDir, HASH_R>.Set the value of the Payload 
        Length field to <prm_inv_nonce_len> which is less than 8 or 
        greater than 256
-  DUT: Notify PAYLOAD-MALFORMED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_init.cfg ok
-> cmd ipd reconfigure ipike
Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 332 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 332 
UDP: Checksum         = 0x68F9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D6 50 A7 A3 3A 33 C7 3F                           .P..:3.?
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 324 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  35 A7 1D 15 0D 8D 19 19 D8 A8 83 96 0A 9E 52 0D   5.............R.
ISAKMP:  A4 AF DD CE 95 93 AC E4 9D 4F 5A E2 E8 A3 E2 48   .........OZ....H
ISAKMP:  F0 7D F2 18 EC 3F 52 1B 9A B9 90 14 62 9C 2A 70   .}...?R.....b.*p
ISAKMP:  99 3E 2B 08 EA 18 D2 CB E7 FC 66 25 EE 6D 1E B9   .>+.......f%.m..
ISAKMP:  08 97 04 BE 52 37 2B E1 FD 33 D6 B9 DF 94 AD D0   ....R7+..3......
ISAKMP:  B2 C1 23 36 C3 C1 68 DF EB E8 A1 6A BF DE AD 61   ..#6..h....j...a
ISAKMP:  B4 A1 60 DA DC 50 52 3F B1 3A 01 15 72 BC C3 22   ..`..PR?.:..r.."
ISAKMP:  FD 46 C3 6A 17 3A 41 70 71 F0 9C 9F 33 25 85 22   .F.j.:Apq...3%."
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  E9 26 A7 21 24 81 C1 0E C0 9E 74 69 B5 DC 93 89   .&.!$.....ti....
ISAKMP:  0D 25 27 66 22 59 43 6C E7 A8 07 54 B2 0A 3D 45   .%'f"YCl...T..=E
ISAKMP:  D2 F3 3E 51 F0 C8 F8 A8 48 98 1A 7B 48 CF 45 AD   ..>Q....H..{H.E.
ISAKMP:  6D 61 AC 6C 4D EC FD 43 6A 71 FF 3E E7 B5 3F D8   ma.lM..Cjq.>..?.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)

Sending <HDR,SA,KE,Nr,IDir, HASH_R> with the value of the Payload
Length field of Nonce Payload to <prm_inv_nonce_len> 7 which is
less than 8 or greater than 256 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 275 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 275 
UDP: Checksum         = 0x402A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D6 50 A7 A3 3A 33 C7 3F                           .P..:3.?
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  88 87 9A 1D 12 97 17 27                           .......'
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 267 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  BE 17 A7 B9 13 52 18 81 E8 C5 CD 16 78 F1 92 AB   .....R......x...
ISAKMP:  F1 CD 1E 9F 17 7D 81 66 0E 4D D4 20 AC 52 48 7F   .....}.f.M. .RH.
ISAKMP:  9F A4 81 74 ED 4B 08 38 5C 3E D0 5E 5C 46 DF CF   ...t.K.8\>.^\F..
ISAKMP:  A4 77 24 0D 4E EA 3E 56 8A 22 E1 61 2A F9 8C 2A   .w$.N.>V.".a*..*
ISAKMP:  16 61 29 89 3C 1E 59 B1 AF 9F A9 59 B1 B4 5C CF   .a).<.Y....Y..\.
ISAKMP:  D6 E0 06 62 0D A5 9B 22 4B 2C 20 7E DA 72 3C 11   ...b..."K, ~.r<.
ISAKMP:  B9 A1 81 AC ED D4 5E D2 62 71 5F 84 71 02 9C 03   ......^.bq_.q...
ISAKMP:  C4 B2 CF 77 8C 17 CA 52 29 1E 7B 6E 50 31 DB A0   ...w...R).{nP1..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 7 bytes
ISAKMP: --- Nonce Data [3 bytes] ---
ISAKMP:  55 85 FF                                          U..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  C2 35 62 50 8B 44 4A 0D 8C 4D 4E 91 DA E7 46 47   .5bP.DJ..MN...FG
ISAKMP:  1F 66 86 27                                       .f.'
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6C93 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D6 50 A7 A3 3A 33 C7 3F                           .P..:3.?
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x8002BE96
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  D6 50 A7 A3 3A 33 C7 3F 00 00 00 00 00 00 00 00   .P..:3.?........
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 16 (Payload Malformed)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-15.20: Passed

>> IKE-IPV6-16.1
TEST_DESCRIPTION
Implementations MUST include send and receive capability for ISAKMP
using the User Datagram Protocol (UDP) on port 500.  UDP Port
500 has been assigned to ISAKMP by the Internet Assigned Numbers
Authority (IANA).
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.1 p20 Transport Protocol
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> using User Datagram
        Protocol(UDP) on Port 500
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x1E62 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1D 5F 10 36 86 CA C2 36                           ._.6...6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2E E7 C8 EA D6 A7 BA A5 BA 3E B7 B2 D0 53 BF 0D   .........>...S..
ISAKMP:  EE 8E DF C1 A1 E0 7D BD 59 1E BB F4 C5 97 6A F1   ......}.Y.....j.
ISAKMP:  93 EA 7D 99 CA AA 9C 3D 87 38 45 93 83 31 EE F6   ..}....=.8E..1..
ISAKMP:  57 9E B8 6C F3 9F 8F 96 A8 EE 80 D0 7D AE 2A A5   W..l........}.*.
ISAKMP:  0E 1A A0 8D 4F BF 2F 21 F1 4A 14 FD 10 3A 65 60   ....O./!.J...:e`
ISAKMP:  2E 61 09 FE 23 FB 12 EF 76 5C E2 1B 67 9A 94 64   .a..#...v\..g..d
ISAKMP:  6A FF F3 AC B8 5F E0 6E 6F 04 70 77 7E 5F 3F E0   j...._.no.pw~_?.
ISAKMP:  DE B0 38 56 A6 7E 9F 07 EA 59 F5 53 19 E1 BF DB   ..8V.~...Y.S....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 27 95 90 8A D2 04 51 BF D4 41 E2 83 F2 A1 3C   .'.....Q..A....<
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xDF7F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1D 5F 10 36 86 CA C2 36                           ._.6...6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B6 E2 0F 09 02 1B 03 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7D 56 80 95 43 A4 05 88 1C 1C 24 9F B6 B6 37 A0   }V..C.....$...7.
ISAKMP:  94 E0 02 73 ED 4D 75 03 92 DA 0A 43 D5 1B 98 B6   ...s.Mu....C....
ISAKMP:  28 FD 7B F9 60 19 E0 73 B0 62 31 AE 10 F0 74 87   (.{.`..s.b1...t.
ISAKMP:  D2 E1 7D BF 3B D9 BD 21 01 02 EA 07 3E 15 28 B7   ..}.;..!....>.(.
ISAKMP:  C9 80 78 47 F5 2B 9F 7B 55 D0 D2 71 E0 A3 CF 41   ..xG.+.{U..q...A
ISAKMP:  06 30 DF 26 4B CC CA A7 4F BF FE 3F 16 2B 90 22   .0.&K...O..?.+."
ISAKMP:  4D AC C0 A5 32 94 40 A1 01 A6 5F F8 15 D3 C2 39   M...2.@..._....9
ISAKMP:  51 AA 25 88 8B A6 3C 26 2E 94 77 2F 62 4C 75 43   Q.%...<&..w/bLuC
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  77 FC 3E DB 70 BE 1B 81 55 BE CA F2 6C 30 DB C9   w.>.p...U...l0..
ISAKMP:  FD 2A 13 A4 E6 B3 86 9A BA AF 4A B8 E0 9C BD 26   .*........J....&
ISAKMP:  51 05 BF 7D C4 4A 4C AA 5F 63 89 20 15 C9 B0 99   Q..}.JL._c. ....
ISAKMP:  87 D9 34 0F B9 BD DE C7 CE 05 DE FC F1 8C 94 84   ..4.............
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  2A 25 EE 35 E4 52 31 AF E3 23 ED 84 95 8B 1A 9A   *%.5.R1..#......
ISAKMP:  90 9C 06 A5                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with UDP as transport protocol
on port 500

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.1: Passed

>> IKE-IPV6-16.2
TEST_DESCRIPTION
The existence of RESERVED fields within ISAKMP payloads are used
strictly to preserve byte alignment.  All RESERVED fields in the
ISAKMP protocol MUST be set to zero (0) when a packet is issued.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2408 s3.4 p27 Security Association Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with NP field of SA Payload set to 2
-  DUT: Send <HDR,NOT> with RESERVED field of NOT Payload to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with NP field of SA Payload set to 2
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x47D1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  71 33 D4 59 E2 59 DB 5A                           q3.Y.Y.Z
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x948B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  71 33 D4 59 E2 59 DB 5A                           q3.Y.Y.Z
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  3C E9 39 36 98 D5 44 1B                           <.96..D.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x525B167F
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  71 33 D4 59 E2 59 DB 5A 3C E9 39 36 98 D5 44 1B   q3.Y.Y.Z<.96..D.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Received Responder's <HDR,NOT> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,NOT> packet from DUT
with RESERVED field set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.2: Passed

>> IKE-IPV6-16.3
TEST_DESCRIPTION
Message ID (4 octets) - During Phase 1 negotiations, the value MUST
be set to 0.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p25 ISAKMP Header Format
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Message ID field in the
        HDR set to 0
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the selected Proposal
        with Message ID field in the HDR set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Message ID field in the
HDR set to 0 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x9F04 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EF 26 66 06 99 14 D0 07                           .&f.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  29 AD EC 4D A3 A9 01 96 1A 1E D7 C5 6B EA E5 8E   )..M........k...
ISAKMP:  80 B7 DA ED 13 70 6E E3 4E 61 45 4E 33 11 F1 01   .....pn.NaEN3...
ISAKMP:  F2 3A 63 7B 87 4B 5B 01 33 67 71 B9 C9 16 0A 1A   .:c{.K[.3gq.....
ISAKMP:  EF 22 E2 4C 01 E1 26 63 93 A3 CE 50 EC 62 95 CB   .".L..&c...P.b..
ISAKMP:  63 0A 0B 63 C8 FF 5A E2 15 5F 71 74 27 D1 56 67   c..c..Z.._qt'.Vg
ISAKMP:  C4 5F 4B BF A8 3D 6F 72 60 34 85 97 F8 56 9D C3   ._K..=or`4...V..
ISAKMP:  65 86 0E 45 BB 67 D4 51 F8 FC 4A 69 AE FF 8D 9E   e..E.g.Q..Ji....
ISAKMP:  EF 24 C7 98 50 47 79 CB DA 13 23 13 06 C3 C4 FA   .$..PGy...#.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  95 DB 11 1D C1 94 5A 8E C3 DD DB BE 64 29 27 C8   ......Z.....d)'.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xD385 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EF 26 66 06 99 14 D0 07                           .&f.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  96 6D A1 2A 9A 7A BE 53                           .m.*.z.S
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A6 26 8E 2F F4 2C 85 E5 1D D2 62 0F 65 B0 12 DD   .&./.,....b.e...
ISAKMP:  49 F9 F9 86 63 38 E3 97 E7 16 1B 21 2A DC 45 42   I...c8.....!*.EB
ISAKMP:  4B BE C8 D0 D2 8A BF 8B 46 AD 55 29 5A 97 E7 DE   K.......F.U)Z...
ISAKMP:  D7 A5 B1 0D 7C 49 19 4F 24 F4 2A 09 FB D4 99 B3   ....|I.O$.*.....
ISAKMP:  41 15 05 C3 3E 32 A9 47 02 02 5C F9 09 6D C2 83   A...>2.G..\..m..
ISAKMP:  09 5C 18 8A 74 F8 C8 83 42 64 C4 1A 76 4F B4 0F   .\..t...Bd..vO..
ISAKMP:  61 D7 4B 93 69 C0 98 B0 67 2D 5B 41 DF 93 A3 DC   a.K.i...g-[A....
ISAKMP:  02 03 82 ED CE ED E5 41 36 EE 8F 85 5A 84 DC AE   .......A6...Z...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  7C 0A 6E 30 3C 0E 0B 01 A6 D5 F5 C6 9F 75 2C CD   |.n0<........u,.
ISAKMP:  56 73 E2 22 13 EA 4F EE 2B 59 2F A2 C7 11 BC 14   Vs."..O.+Y/.....
ISAKMP:  BC 91 BB 9E 16 A8 1D 9D 39 48 A7 7C 00 4A FC D3   ........9H.|.J..
ISAKMP:  64 1B 36 0D 13 63 9F 67 5F FE 4C FE F5 ED CF 9A   d.6..c.g_.L.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F9 37 46 5C 4F 9E EA FB 7A 1E 7E 31 44 14 4E 46   .7F\O...z.~1D.NF
ISAKMP:  69 5E D5 AE                                       i^..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R>
Packet
! from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Message ID: 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.3: Passed

>> IKE-IPV6-16.4
TEST_DESCRIPTION
Next Payload (1 octet) - this field MUST NOT contain the values
for the Proposal payload.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with NP field in SA
        not set to Proposal Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x0F44 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1D 87 73 77 58 CD 60 79                           ..swX.`y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  04 FD 9D 09 1E 49 FB 8C 4E 38 CA FF E6 25 4F 5B   .....I..N8...%O[
ISAKMP:  EA 88 CB 15 9B 59 2B 21 D2 D7 17 27 5D 8E 30 C6   .....Y+!...'].0.
ISAKMP:  C1 AB A1 9A 4D 28 68 5A D3 8A 95 90 4B A1 01 9B   ....M(hZ....K...
ISAKMP:  5E 9D C3 A2 BC 88 12 59 15 E4 3E BA 1C 31 B6 BE   ^......Y..>..1..
ISAKMP:  A3 FE 45 65 F4 1D DD 86 B8 CF 54 03 91 EB 14 96   ..Ee......T.....
ISAKMP:  45 EF 17 C9 8A 65 A7 EE D1 F7 AF 42 4D 34 12 85   E....e.....BM4..
ISAKMP:  18 51 79 34 09 1E 1C 0A FD F6 8C 92 F6 A8 66 4C   .Qy4..........fL
ISAKMP:  7C FE 8B 74 8A E3 85 A8 C3 BD 68 51 94 6F F2 68   |..t......hQ.o.h
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  73 B1 F5 2E 49 3E 60 69 FE CB E8 96 71 86 81 87   s...I>`i....q...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xCCFC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1D 87 73 77 58 CD 60 79                           ..swX.`y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E6 48 85 81 C0 CF BB CE                           .H......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D1 9D 1E 42 F3 5E 78 4C F1 F5 6E 64 BA 44 CB 62   ...B.^xL..nd.D.b
ISAKMP:  A3 49 50 CF D5 9E 8B 57 BD FD 7E 35 B6 9B 1B DC   .IP....W..~5....
ISAKMP:  39 57 DE 36 93 A6 97 72 77 29 88 C1 5F 26 56 8A   9W.6...rw).._&V.
ISAKMP:  9D EB FB 4B A0 2E E2 13 27 B2 41 07 C3 05 83 5C   ...K....'.A....\
ISAKMP:  31 06 21 7B F5 83 3E 9D DA F7 84 82 D5 95 9E 79   1.!{..>........y
ISAKMP:  92 0A 09 5E 33 E1 4E 82 72 D4 4B 61 E4 1F 94 FC   ...^3.N.r.Ka....
ISAKMP:  F9 65 EC 67 D8 A2 B3 F3 DA 57 A3 D0 E1 B5 DB FB   .e.g.....W......
ISAKMP:  83 06 13 4B EB C8 F1 20 8D 2A A5 7A C6 2F 24 E7   ...K... .*.z./$.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F0 DA 50 1D 6B 3F CE 7E 79 F7 DA 09 A6 3D 7F A2   ..P.k?.~y....=..
ISAKMP:  8A 47 B7 56 E4 EE E1 82 8C DC BD 33 F3 E0 ED 32   .G.V.......3...2
ISAKMP:  0C 2D 77 96 59 BF 36 61 90 B2 CE BC E1 83 51 9D   .-w.Y.6a......Q.
ISAKMP:  EE A2 C1 FF 01 81 70 8E 08 6B 49 B4 F6 82 14 C4   ......p..kI.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E7 45 CA BB 7B F6 66 7C 58 97 71 9F C4 04 5E A1   .E..{.f|X.q...^.
ISAKMP:  D9 A1 06 53                                       ...S
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Next Payload of SA (4)(Should
be: 4) not set to Proposal

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.4: Passed

>> IKE-IPV6-16.5
TEST_DESCRIPTION
During SA Payload exchange, IKE MUST set the Encryption flag to 0
in an outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s5.2 p60 ISAKMP Header Processing
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Encryption flag in
        the HDR set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xC0CF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E7 0C A9 29 F4 2A 3A 2B                           ...).*:+
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7A 5A D6 25 C8 EE 89 7A 0F C0 DD FE 9E E7 90 C8   zZ.%...z........
ISAKMP:  F3 AA 20 D7 36 57 CF 2A 96 E6 4D 45 D4 B4 83 9A   .. .6W.*..ME....
ISAKMP:  26 29 EA A2 55 1D 31 B8 1C AC E6 36 75 26 1C E8   &)..U.1....6u&..
ISAKMP:  9A 8F EE 75 00 85 0B 2B C1 A4 4D 27 F6 62 CC 43   ...u...+..M'.b.C
ISAKMP:  DC B6 92 E4 48 04 5C 37 C8 F4 BA 89 E4 66 0D D1   ....H.\7.....f..
ISAKMP:  DE D7 3D 3D 8C F0 47 DB A2 91 43 9D 30 6C 57 1E   ..==..G...C.0lW.
ISAKMP:  BB F9 8D 7F 4D 4E 0C A2 05 1F BB 16 60 40 07 8E   ....MN......`@..
ISAKMP:  92 47 AE B2 7C 1D B0 D8 32 19 0B DE 05 41 69 30   .G..|...2....Ai0
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B7 5B A4 DC 9F AE 10 FD CB 1F E9 2E 70 E9 4D CC   .[..........p.M.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x0FCC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E7 0C A9 29 F4 2A 3A 2B                           ...).*:+
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FF 56 49 2C E6 E6 71 6B                           .VI,..qk
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F4 F5 A1 0A E7 C6 19 11 2E 17 60 91 69 68 BE A8   ..........`.ih..
ISAKMP:  74 03 EF 35 6C FD FE 8E 5A CD A2 28 74 05 84 73   t..5l...Z..(t..s
ISAKMP:  57 B7 E9 05 40 40 B4 5E 6F D5 53 20 EB E7 9E 63   W...@@.^o.S ...c
ISAKMP:  DB DC B6 C6 B1 44 48 77 71 47 CF 76 03 4E BB 2F   .....DHwqG.v.N./
ISAKMP:  2F 04 DA 16 71 B9 D0 32 93 98 09 67 87 C5 00 CE   /...q..2...g....
ISAKMP:  57 0B 47 8B D8 0E AD 82 9F F1 F2 05 14 41 C6 CA   W.G..........A..
ISAKMP:  FC E3 43 E6 2F 39 A7 A9 75 5D 4B 31 55 6A EE A5   ..C./9..u]K1Uj..
ISAKMP:  8D AA 9F CD E5 8E A2 CC 3F 99 E2 56 87 9D 5A 88   ........?..V..Z.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  21 76 4C 93 A3 85 03 48 88 28 9C FD 16 52 13 6B   !vL....H.(...R.k
ISAKMP:  07 8A 3A 87 7B C0 16 4B 0A 09 A3 4A FC DB 88 60   ..:.{..K...J...`
ISAKMP:  A1 49 A9 7D 1C 5A 00 CD 3B 0E BA 57 59 97 79 55   .I.}.Z..;..WY.yU
ISAKMP:  87 B6 84 3B E6 B0 51 AF 57 47 ED B8 8F 32 68 D5   ...;..Q.WG...2h.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  87 6E 4A 9B AA 89 EC 39 60 F9 68 95 CE CC AF 3F   .nJ....9`.h....?
ISAKMP:  77 F5 5A 60                                       w.Z`
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Encryption bit set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.5: Passed

>> IKE-IPV6-16.6
TEST_DESCRIPTION
If the current Transform payload is the last within the proposal,
then this field will be 0.
IKE MUST set the NP field of the Transform Payload to 0 in an outbound 
ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.6 p30 Transform Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> using Aggressive Mode with
        one Proposal Payload and two Transforms Payloads
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the selected Transform,
        with the NP field of Transform Payload set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> using Aggressive Mode with
one Proposal Payload and two Transforms Payloads to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xDCF1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  53 65 B9 40 66 85 DD 41                           Se.@f..A
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  EC 6B 76 B9 A4 1B 8D 91 93 0B D8 26 60 1F D3 58   .kv........&`..X
ISAKMP:  61 F8 7F AF 64 8C E1 A4 E3 AC CD A3 7D E8 C5 E3   a...d.......}...
ISAKMP:  5E 68 37 F1 0D 10 13 B3 AF 95 35 C7 AB 35 AE 92   ^h7.......5..5..
ISAKMP:  7D 5B 3C 5E 0A 8B 84 9A 58 B6 3E A5 27 17 62 AE   }[<^....X.>.'.b.
ISAKMP:  8C 8A CD CE 7D 41 C7 7D C1 27 ED 73 C4 6B 8F 7D   ....}A.}.'.s.k.}
ISAKMP:  0A F2 F1 D9 23 D0 80 C2 3B 07 A5 4B 72 1B 0C 76   ....#...;..Kr..v
ISAKMP:  43 E2 2F 44 3D EF E1 CF CA A2 CB 56 61 E5 8A 1A   C./D=......Va...
ISAKMP:  CB 48 12 13 B7 B9 05 BF EA 85 A5 5E 0D BB 0C F4   .H.........^....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  0C 01 22 EB E1 F5 49 37 12 18 0E DA A2 45 79 95   .."...I7.....Ey.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x4E4E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  53 65 B9 40 66 85 DD 41                           Se.@f..A
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DC 38 8E 8D 3D FE 6D AF                           .8..=.m.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  17 EF 68 22 61 4B 64 B7 7A 76 EE 65 AC 2B 40 C6   ..h"aKd.zv.e.+@.
ISAKMP:  28 B5 46 F7 DD 34 63 50 38 B7 A5 06 9F D9 38 08   (.F..4cP8.....8.
ISAKMP:  92 71 43 6F BE 5E C6 34 4E 82 0E 54 32 63 D6 2F   .qCo.^.4N..T2c./
ISAKMP:  0E BD 77 D4 3A 93 1E 92 78 35 FF AA B1 12 0B 16   ..w.:...x5......
ISAKMP:  75 29 B0 84 7C DF 2E DB 11 B2 87 2F D6 0D AD 96   u)..|....../....
ISAKMP:  9D 53 59 E6 6C 83 00 ED 7D 68 AD E9 32 9E CB AB   .SY.l...}h..2...
ISAKMP:  0C 08 E6 95 E0 7C 58 71 AD 41 9E 40 37 F1 F3 56   .....|Xq.A.@7..V
ISAKMP:  F5 81 A8 31 44 EC 31 96 F8 2C 7F DB 83 82 07 C2   ...1D.1..,......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  3E C7 F1 CE E7 11 4F A7 E5 79 14 77 81 D9 F7 99   >.....O..y.w....
ISAKMP:  3A 29 60 E5 6E 5B 63 37 43 D3 FC F7 10 8D C2 D5   :)`.n[c7C.......
ISAKMP:  B8 47 E3 AA AF CA 7B 43 5B FE FE EF 7F AF 5E B4   .G....{C[.....^.
ISAKMP:  6E 08 7F 93 FB 83 EE 3E BB 73 9F DB 93 BA 81 14   n......>.s......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F1 A3 84 78 C7 34 AA CB E7 16 9B 09 4F D9 4F DD   ...x.4......O.O.
ISAKMP:  83 44 14 CF                                       .D..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R>
Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.6: Passed

>> IKE-IPV6-16.7
TEST_DESCRIPTION
The receiving entity MUST select a single transform for each protocol
in a proposal
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s4.2 p47 Security Association Establishment
RFC 2409 s5.1 p11 IKE Phase 1 Authenticated With Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
        two Transforms
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with one Transform Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
two Transforms to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x4CE9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D0 63 CE 74 45 99 C1 75                           .c.tE..u
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D1 A4 62 DD B1 B8 DD 6A 10 DF 87 22 AA 87 2F 8B   ..b....j..."../.
ISAKMP:  EE 4A CE 1E F2 6E 3A 57 9C CC D2 43 64 98 3F C8   .J...n:W...Cd.?.
ISAKMP:  17 16 B1 23 CF B3 7C 5F D7 0D A3 68 04 43 50 06   ...#..|_...h.CP.
ISAKMP:  72 B9 2F 99 0C EF 5E F7 A1 55 AE F2 80 0C F4 C0   r./...^..U......
ISAKMP:  CC 7A FF E6 3E 3A 7C A4 B7 1C 1B 2B 34 87 48 82   .z..>:|....+4.H.
ISAKMP:  08 F7 1F B0 05 F9 FB 36 B7 1B AF A8 BD 7E 56 FB   .......6.....~V.
ISAKMP:  AA E7 41 7C 18 29 9E 6F A9 32 C9 A3 E5 BE 25 37   ..A|.).o.2....%7
ISAKMP:  12 E2 94 13 BC EF 72 2B 3A BF DD 48 76 12 11 FE   ......r+:..Hv...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  BC 70 79 C3 0C 7E 76 5E E4 83 EF 4B EC 42 09 DE   .py..~v^...K.B..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x9F1F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D0 63 CE 74 45 99 C1 75                           .c.tE..u
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7C 9F C2 29 58 31 41 53                           |..)X1AS
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A3 3C 7A 3D 03 81 F7 8C D3 EB B8 D0 C0 FD 6D FB   .<z=..........m.
ISAKMP:  4F 29 48 C2 20 EB A5 CF D4 26 FA F7 42 D4 A0 20   O)H. ....&..B.. 
ISAKMP:  05 39 D2 88 1F 0F B2 07 E4 D6 36 95 3B 5F 38 14   .9........6.;_8.
ISAKMP:  4A 33 E0 47 9D 40 7A 90 A7 CC 8A D9 2D 88 05 D2   J3.G.@z.....-...
ISAKMP:  13 9F 6F C0 87 D6 30 B8 10 C7 67 AB 5F 75 41 EC   ..o...0...g._uA.
ISAKMP:  0F 65 F6 B2 5B E2 A6 10 6E 7B 7E CE 54 AF 75 7D   .e..[...n{~.T.u}
ISAKMP:  DD 2A AF FE 50 44 35 41 2C AE DF 12 21 36 28 9A   .*..PD5A,...!6(.
ISAKMP:  CA 4D B5 EC 23 2F 45 66 6B 7F 66 27 4D EA 78 A6   .M..#/Efk.f'M.x.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  79 38 1B FE 27 A3 60 11 A4 EA F1 4D 29 C9 61 C3   y8..'.`....M).a.
ISAKMP:  8D 3F 66 1C 1F F0 30 3C CF F5 EE 65 28 A9 07 27   .?f...0<...e(..'
ISAKMP:  52 34 31 DD FA 93 56 A5 40 68 47 36 4D 11 7F 8F   R41...V.@hG6M...
ISAKMP:  98 0F 3B 90 0E AB 3D C5 AC 07 43 C5 15 C2 CA B0   ..;...=...C.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  A0 EE 47 AB A1 7D 06 2F 4C 63 65 59 92 97 7A E4   ..G..}./LceY..z.
ISAKMP:  8F E2 BB 6D                                       ...m
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet from DUT
containing only one Transform Payload

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.7: Passed

>> IKE-IPV6-16.8
TEST_DESCRIPTION
The responder SHOULD retain the Proposal Number field in the Proposal
payload and the Transform Number field in each Transform payload
of the selected Proposal.
Note: Here we check for Transform NumberAggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s4.2 p48 Security Association Establishment
RFC 2409 s5.1 p11 IKE Phase 1 Authenticated With Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
        two Transforms 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the selected Transform
        Payload without changing the Transform Number field 
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload and 
two Transforms to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xC8DA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  70 27 1E 04 9B BF 45 33                           p'....E3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C3 D3 FC C9 AC 1D 6D EB 82 EB 84 43 61 76 A9 A4   ......m....Cav..
ISAKMP:  5A 98 F0 E3 2F C2 C5 BD 9E 2B A7 F2 3C 55 E3 31   Z.../....+..<U.1
ISAKMP:  71 62 68 EA 06 38 6C D0 DD FD 2D C1 5D 03 0A 0F   qbh..8l...-.]...
ISAKMP:  38 76 3C 96 DE 60 64 CC 75 50 10 AF 57 DA F3 A5   8v<..`d.uP..W...
ISAKMP:  31 5D 9C 61 B5 F4 56 AF 90 9B 32 78 EA 1B E1 C2   1].a..V...2x....
ISAKMP:  21 DE 71 C8 DC CD 9D FB 60 14 FC DF 8B 60 27 27   !.q.....`....`''
ISAKMP:  3D 7F D5 97 13 72 A5 A1 30 53 A4 E5 C8 70 F0 64   =....r..0S...p.d
ISAKMP:  69 6C 72 CF BB 41 0E ED 39 02 51 5C E2 A7 2C A8   ilr..A..9.Q\..,.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2D 99 C6 57 C3 46 C6 E6 DD 7F 00 DB 12 FF CA AA   -..W.F..........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xD76C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  70 27 1E 04 9B BF 45 33                           p'....E3
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C2 59 F0 85 EB F8 C6 00                           .Y......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  EC 1D C6 D6 6E 84 FE 6B 48 E8 D5 0D F8 B8 8E 28   ....n..kH......(
ISAKMP:  9D 1E 12 70 05 07 A1 31 67 78 FA 95 C2 E4 5D 97   ...p...1gx....].
ISAKMP:  11 65 3F 61 54 18 0F AE 67 AD F4 88 52 76 A9 64   .e?aT...g...Rv.d
ISAKMP:  77 19 83 71 B6 B6 7B A4 D7 34 AC 36 05 F1 FD C3   w..q..{..4.6....
ISAKMP:  19 38 46 C3 A6 11 45 91 CD 4F CE 21 D8 9A C3 74   .8F...E..O.!...t
ISAKMP:  D6 19 4B 12 90 3B D0 84 D2 FB 69 0D 4F 7A 04 A4   ..K..;....i.Oz..
ISAKMP:  64 B7 5B F3 B7 76 1F C1 62 AE 4B E3 A8 6B 0E 07   d.[..v..b.K..k..
ISAKMP:  B0 1F F5 8E F6 76 75 18 75 41 7A BA 33 5A 94 B7   .....vu.uAz.3Z..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  25 D2 77 F7 1A 35 DD 97 F0 08 D9 06 76 8B 87 B4   %.w..5......v...
ISAKMP:  8E 1F 8B 97 B6 C1 43 E3 FC 07 31 6A C1 C3 6B 54   ......C...1j..kT
ISAKMP:  44 B0 AE 8B 62 4B 14 D5 19 14 45 34 FC 8F 59 7C   D...bK....E4..Y|
ISAKMP:  3D 6C BA 40 81 86 31 71 79 7A 87 28 8A B5 A2 44   =l.@..1qyz.(...D
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  8A EB 4C 18 9B B7 6B FE B0 3B 5E 52 EE 74 13 C6   ..L...k..;^R.t..
ISAKMP:  70 58 7E D2                                       pX~.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.8: Passed

>> IKE-IPV6-16.11
TEST_DESCRIPTION
SA Payload MUST precede all other Payloads in an outbound
ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send the <HDR,SA,KE,Nr,IDir, HASH_R> setting SA Payload
        immediately after HDR
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x90F8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  77 D6 3B 3C 0A B0 A1 7D                           w.;<...}
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5C FA 9B 36 CC 0B A8 83 69 57 4F D4 7E 39 F7 19   \..6....iWO.~9..
ISAKMP:  88 66 14 4C 90 92 B2 33 95 F3 16 76 FD 54 8C 28   .f.L...3...v.T.(
ISAKMP:  A2 14 86 03 D8 59 C8 3F 01 B0 6E DD 59 EC EA 43   .....Y.?..n.Y..C
ISAKMP:  03 42 C9 DA DB D4 9C F8 52 76 62 59 6A C4 A8 B6   .B......RvbYj...
ISAKMP:  0C 17 F3 B3 0A A5 01 F4 40 D1 39 EA 29 B3 D5 8B   ........@.9.)...
ISAKMP:  81 1B 7E 48 C7 EB 2D 0C A9 50 E5 6B F7 04 02 BA   ..~H..-..P.k....
ISAKMP:  0E A2 36 2E CB BB A8 5D 20 98 29 20 B2 4C C7 23   ..6....] .) .L.#
ISAKMP:  75 4B 15 E5 0E 2A 08 1B 3D 3B AD 15 F1 67 5A A7   uK...*..=;...gZ.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DD 00 50 DC 24 65 B1 E3 A8 F0 86 48 46 9C 79 30   ..P.$e.....HF.y0
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x4318 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  77 D6 3B 3C 0A B0 A1 7D                           w.;<...}
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  89 42 4C FE DF 3A 28 90                           .BL..:(.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  41 B1 96 C9 F4 73 14 7B D6 EF 35 A1 1B 5E 83 89   A....s.{..5..^..
ISAKMP:  BA D1 4A 25 46 D4 79 DA 7F CB DF 37 78 25 C3 61   ..J%F.y....7x%.a
ISAKMP:  FB 27 79 09 C5 EE 32 7A AC 94 97 BA 20 0A DC 01   .'y...2z.... ...
ISAKMP:  BA A1 C1 DA 63 D9 2C 94 28 3F E8 A5 DD FE 95 27   ....c.,.(?.....'
ISAKMP:  E6 DB AB A4 0D 24 29 94 C7 70 1A D4 25 0D 45 86   .....$)..p..%.E.
ISAKMP:  8D 97 4C 6A D6 A0 7B 92 42 90 34 8C F8 9A 17 6D   ..Lj..{.B.4....m
ISAKMP:  61 E4 E6 F2 63 7B 3D 25 DB D7 07 3D E6 51 64 89   a...c{=%...=.Qd.
ISAKMP:  C2 66 1D C9 6A 88 1F A8 26 DB 71 9D 15 3D 0D 5D   .f..j...&.q..=.]
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  D2 D6 9B 53 D1 2F D2 78 3D F7 01 9B D2 50 D5 A0   ...S./.x=....P..
ISAKMP:  16 14 5F 27 0F 91 C7 D1 E9 BB 86 69 54 56 F7 B2   .._'.......iTV..
ISAKMP:  1F CC EB 8E 39 2E CD 11 D1 F3 A7 0C 59 14 F5 BF   ....9.......Y...
ISAKMP:  47 64 43 D9 85 98 FC B3 7B 81 53 AC 31 93 B0 F4   GdC.....{.S.1...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  08 9D FA E5 C1 1D 3A 92 E4 C3 4B F5 D1 2C 02 2C   ......:...K..,.,
ISAKMP:  A9 D1 0C 59                                       ...Y
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with next payload of ISAKMP HDR set to SA

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.11: Passed

>> IKE-IPV6-16.12
TEST_DESCRIPTION
Responders MUST NOT modify attributes of any offer, attribute encoding
excepted (see Appendix A).
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p9 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal containing 
        one Transform with SA Attributes
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with one Proposal containing
        one Transform with the same SA Attributes with the same values
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal containing 
one Transform with SA Attributes Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x7A61 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2C 6C FC 2F 50 8F 04 31                           ,l./P..1
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  30 D5 68 96 A1 AF 98 35 1A A7 15 AB 94 24 FC 44   0.h....5.....$.D
ISAKMP:  AF C3 67 6F 6F FC 34 2B 8C 14 F7 A3 77 5C 00 6C   ..goo.4+....w\.l
ISAKMP:  FE 74 6E DE 8E 51 3D 74 74 73 11 81 DB EE 91 E3   .tn..Q=tts......
ISAKMP:  59 F7 11 63 7E A0 FD 1B 17 A7 A6 4B A1 78 DF 6D   Y..c~......K.x.m
ISAKMP:  9B 65 67 27 04 9B F4 21 84 08 AA 87 00 C9 08 33   .eg'...!.......3
ISAKMP:  6F 84 72 43 47 82 65 53 BD F0 04 DB 87 E1 08 7B   o.rCG.eS.......{
ISAKMP:  DA EB 39 7D EC 9E DB 6D 3B BA 63 B5 53 F5 74 B2   ..9}...m;.c.S.t.
ISAKMP:  9D 9C E2 18 16 7A 4B 4E 25 D6 13 13 F1 FB 83 88   .....zKN%.......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 91 75 DD 45 92 2C CA 07 D8 43 A8 81 C4 9F 2B   ..u.E.,...C....+
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xAD93 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2C 6C FC 2F 50 8F 04 31                           ,l./P..1
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FB DC D4 B6 55 0B 6E 90                           ....U.n.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  1A CA 70 1D 92 21 23 69 3B 74 06 B2 2B 8E D8 54   ..p..!#i;t..+..T
ISAKMP:  0E BC 68 A5 72 D4 5D 48 36 8F 9C A2 74 FC 87 E1   ..h.r.]H6...t...
ISAKMP:  D4 AD 4F CF DC 5E C8 D6 87 6E D2 76 7B E1 81 4F   ..O..^...n.v{..O
ISAKMP:  40 C5 77 92 64 82 56 91 0F F4 79 8D A9 37 46 8C   @.w.d.V...y..7F.
ISAKMP:  EB F8 75 AD D5 3E 98 6B FA 87 76 DC EC C5 B9 9A   ..u..>.k..v.....
ISAKMP:  35 4E 59 12 FF F1 94 4D FB C4 F2 6B 92 2E 22 34   5NY....M...k.."4
ISAKMP:  5D 2E B4 0D 42 92 BE 09 03 A7 C4 E7 0E 49 2D C5   ]...B........I-.
ISAKMP:  6D 83 33 8C F2 E1 03 2C 59 2F 96 77 CC 28 6B 8D   m.3....,Y/.w.(k.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  3A CD 73 45 F5 3E 72 A8 0E 2B 64 3E EB 1A 5B B1   :.sE.>r..+d>..[.
ISAKMP:  94 EB 4C 60 B5 83 CF AF 99 5B 01 D4 18 66 A6 82   ..L`.....[...f..
ISAKMP:  E9 A2 2D 86 BD 60 9B F6 93 ED AD 4C 4C F7 44 ED   ..-..`.....LL.D.
ISAKMP:  A6 65 0E 33 79 15 5F C6 36 27 A4 74 5A FF 93 0C   .e.3y._.6'.tZ...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  90 B9 A9 EC 9A 26 D2 9D E2 53 9C 34 83 67 6F 53   .....&...S.4.goS
ISAKMP:  5E 0F 79 CE                                       ^.y.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received 1 Proposal payload
Correctly, received 1 Transform payload
Received SA Attributes are same with
Encryption Algo = 1
Hash Algo = 2
Authentication Method = 1
Group Description = 2

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.12: Passed

>> IKE-IPV6-16.13
TEST_DESCRIPTION
IKE MUST support SIT_IDENTITY_ONLY for Situation field in the Security
Association Payload
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2407 s4.2 p3 IPSEC Situation Definition
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Situation field of SA set
        to SIT_IDENTITY_ONLY
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Situation field of SA
        set to SIT_IDENTITY_ONLY
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Situation field of SA set
to SIT_IDENTITY_ONLY to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x6CC9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  84 1E 93 45 E2 E5 0A 46                           ...E...F
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  70 58 22 09 C5 3B AF C9 5A 0D CD 70 FD 0F 24 99   pX"..;..Z..p..$.
ISAKMP:  F4 F4 F0 5A EB A8 63 F3 27 6C B7 28 59 2E 9A 48   ...Z..c.'l.(Y..H
ISAKMP:  BC F2 B9 2D D2 FA 7E 0D E9 39 42 B7 BF D9 D1 61   ...-..~..9B....a
ISAKMP:  CB D7 4E 49 C4 9D 51 F3 21 BA 73 3C CD AB DB A0   ..NI..Q.!.s<....
ISAKMP:  CE DA 7A 03 5A 2D DE B5 DF E2 59 D5 00 AB 99 A1   ..z.Z-....Y.....
ISAKMP:  5C F3 99 92 2C F3 57 AE 77 58 70 46 2D 45 66 51   \...,.W.wXpF-EfQ
ISAKMP:  3F 92 1E 23 00 31 E4 60 8D BC 63 10 EA 76 54 7E   ?..#.1.`..c..vT~
ISAKMP:  BC 6E 0F 4A 66 37 07 C8 FA EF 31 DA 89 B7 76 38   .n.Jf7....1...v8
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DA DE 21 13 E7 4E C4 F8 3C 85 DE E7 0D 31 C5 25   ..!..N..<....1.%
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x8005 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  84 1E 93 45 E2 E5 0A 46                           ...E...F
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9E C6 BB 4F F5 D6 AF FA                           ...O....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2D E9 D5 56 A0 1F F0 21 B7 FE 88 B7 5D A1 A7 CF   -..V...!....]...
ISAKMP:  35 BE B7 C8 29 A0 63 06 11 12 1D 7B A0 C6 6C A8   5...).c....{..l.
ISAKMP:  BF 41 4C 4B F0 94 42 BF 87 2C 00 A2 7E 37 34 75   .ALK..B..,..~74u
ISAKMP:  67 38 BA EC D8 6A A1 77 5C 93 95 92 96 B0 E5 F4   g8...j.w\.......
ISAKMP:  F9 13 DF BD A1 65 16 69 27 B1 07 E4 37 68 6F EA   .....e.i'...7ho.
ISAKMP:  3E 69 24 EF CA C3 86 7A 3B 70 35 45 2C 4B 1D E1   >i$....z;p5E,K..
ISAKMP:  03 04 F4 1E B0 1D 1E 40 06 8E CE F5 67 B3 49 11   .......@....g.I.
ISAKMP:  44 5A A0 E5 EA A3 3C AE 3A D8 BE C4 37 A3 FD 57   DZ....<.:...7..W
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  0E 53 99 95 83 BA 75 8D B4 23 15 35 B4 A5 94 65   .S....u..#.5...e
ISAKMP:  45 3A 0A 2D D9 2E D4 E1 24 31 E2 D2 9B 3F C2 AF   E:.-....$1...?..
ISAKMP:  1D D0 A3 47 48 A4 1A 06 37 D1 A4 70 5A 54 0D CC   ...GH...7..pZT..
ISAKMP:  30 AD 53 CE 3A 89 AA DF 53 B2 4A 5D C9 E6 89 4B   0.S.:...S.J]...K
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  B9 D7 DA D6 5A 14 B9 2E 80 EF 17 5C 06 6B 60 B8   ....Z......\.k`.
ISAKMP:  72 71 1C 5B                                       rq.[
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R>
Packet from DUT with situation field set to
SIT_IDENTITY_ONLY

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.13: Passed

>> IKE-IPV6-16.14
TEST_DESCRIPTION
The Proposal Payload fields are defined as follows:
Payload Length (2 octets) - Length in octets of the entire
Proposal payload, including generic payload header, the Proposal
payload, and all Transform payloads associated with this proposal.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s5.1 p58 General Message Processing
RFC 2408 s3.5 p28 Proposal Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Payload Length
        of Proposal to (PROPL_HLEN + Total length of all Transforms)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x2E62 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AE 02 DE 78 D8 71 61 3A                           ...x.qa:
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C8 1A C0 59 BE 92 B3 ED D3 7B 28 E8 96 6C 6B 84   ...Y.....{(..lk.
ISAKMP:  63 F1 53 05 9F A5 D0 4E 75 B0 B0 CA 19 7F 33 68   c.S....Nu.....3h
ISAKMP:  D7 34 96 1C 92 5F 17 DB FD 0C 5A 38 F9 F2 42 01   .4..._....Z8..B.
ISAKMP:  39 2D BD 6D CB 09 DA EA 0C 14 A1 8B B5 B1 0B 5C   9-.m...........\
ISAKMP:  CE 4F 16 03 6A 4C 1B A9 4F 6F 3F 03 81 EF C2 92   .O..jL..Oo?.....
ISAKMP:  EC AD E5 98 A7 E5 87 29 FA A8 F9 8A F6 FE AD 6B   .......).......k
ISAKMP:  86 CA 46 5D 3B E0 B4 A5 0B A0 C7 0A 7F 75 38 CE   ..F];........u8.
ISAKMP:  47 25 0C 31 02 E6 29 A0 0F BE AF F4 4B 1C A7 8C   G%.1..).....K...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F6 EF 52 18 06 88 C8 38 17 4A 4F 18 FF 47 69 29   ..R....8.JO..Gi)
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xE12E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AE 02 DE 78 D8 71 61 3A                           ...x.qa:
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  A1 C7 CB 04 E4 65 7E B3                           .....e~.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  CF CA AF 00 9B 0B 35 67 FC 49 7D CC 8F C5 73 52   ......5g.I}...sR
ISAKMP:  85 CB 6A 9E C4 DF C2 CF 08 D9 1E E9 0E 94 C4 8E   ..j.............
ISAKMP:  A4 6E CB E1 96 C1 8E 49 93 55 7D A3 22 7D C8 CD   .n.....I.U}."}..
ISAKMP:  3F 13 FF CF ED BB D3 8E 3A C8 EA 5F 01 27 55 0D   ?.......:.._.'U.
ISAKMP:  E7 CF 9A A6 F8 05 FE 70 81 65 0D B0 48 A5 82 F4   .......p.e..H...
ISAKMP:  4B EB 05 B3 97 49 1A 2C 98 A6 C7 7B 37 63 CB 8B   K....I.,...{7c..
ISAKMP:  DB DD B0 E4 6D A3 1D B3 33 C6 15 24 27 96 A4 EC   ....m...3..$'...
ISAKMP:  40 B2 A1 A3 AA A1 65 B8 35 02 30 C1 E7 AA 61 5A   @.....e.5.0...aZ
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  3A 75 DE 3E E7 86 C3 5F 10 90 CF 14 2C 49 E4 05   :u.>..._....,I..
ISAKMP:  0A 32 63 B4 AB F6 65 12 A0 3F 6E 85 DB A1 4C 82   .2c...e..?n...L.
ISAKMP:  5F 12 73 CF 8A F7 7D 21 08 BD 4D 39 81 96 9B EF   _.s...}!..M9....
ISAKMP:  45 D9 B2 AB 29 F6 32 51 8C BC 06 0B B3 73 5F 44   E...).2Q.....s_D
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  CC 0C 3A 81 19 9B E6 E1 83 A6 EA 27 DC 56 0D F6   ..:........'.V..
ISAKMP:  76 82 B1 85                                       v...
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.14: Passed

>> IKE-IPV6-16.15
TEST_DESCRIPTION
The Transform Payload fields are defined as follows:
Payload Length (2 octets) - Length in octets of the current
payload, including the generic payload header, Transform values,
and all SA Attributes.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s5.1 p58 General Message Processing
RFC 2408 s3.6 p30 Transform Payload              
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Payload Length
        of the Transform to (TRANS_HLEN + Total length of all
        SA Attributes)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x2305 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FA F5 48 03 2E 1C 7F 44                           ..H....D
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A9 85 E3 E3 D6 3A 83 07 28 9B 1A 71 4C A7 97 0A   .....:..(..qL...
ISAKMP:  7C 42 A3 F9 64 04 FB 7D 79 30 BE 01 09 13 07 D1   |B..d..}y0......
ISAKMP:  1F C9 AA F4 CB 47 12 2E 77 16 E0 9E 62 F0 6A 52   .....G..w...b.jR
ISAKMP:  A1 E9 1F D6 1E 33 03 1A 59 EA CA 06 11 77 64 D8   .....3..Y....wd.
ISAKMP:  A9 84 B5 E7 56 53 A3 E5 33 76 23 A7 C0 AB 1A 80   ....VS..3v#.....
ISAKMP:  DB 84 83 77 A0 2D 71 75 7D 31 F2 6B 54 8D 03 D2   ...w.-qu}1.kT...
ISAKMP:  F5 3B B0 55 BD 51 3F B0 D6 5C 33 0A 04 7D D6 DB   .;.U.Q?..\3..}..
ISAKMP:  9B AA 96 A7 EC 73 43 35 98 4B 2D 05 EE C7 F7 8B   .....sC5.K-.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4E 3D 91 DE 0C C2 B5 3C C0 4A 36 69 0A 26 47 3D   N=.....<.J6i.&G=
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x0FA1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FA F5 48 03 2E 1C 7F 44                           ..H....D
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9C 2F 27 7E 5C F5 B7 E4                           ./'~\...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  36 CA 23 10 CA 70 82 0E 69 3B FB 90 10 C0 27 01   6.#..p..i;....'.
ISAKMP:  56 EA EB 1D D7 7D 58 65 96 09 3A 30 1C 69 C2 88   V....}Xe..:0.i..
ISAKMP:  93 83 9C 11 6B C1 35 97 2A 77 C5 8E 4F 6D A1 81   ....k.5.*w..Om..
ISAKMP:  BF C3 E2 B9 7A 04 78 B2 D1 41 94 C1 A5 5F 6B 7C   ....z.x..A..._k|
ISAKMP:  BC 89 3E E9 29 DF 3E 32 BF 57 6D 81 70 1E DF BA   ..>.).>2.Wm.p...
ISAKMP:  1A 68 CD D8 A7 8D 75 47 EC D9 38 AF A3 A5 FA CF   .h....uG..8.....
ISAKMP:  CC C5 E6 1F 65 66 B9 8F F6 6A A7 5C 0F 6E 48 F5   ....ef...j.\.nH.
ISAKMP:  DE 3B E0 17 25 39 F8 36 A6 8A 0A 7A C9 D2 2B D1   .;..%9.6...z..+.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  C0 2B B6 71 1D 04 B2 3F 0F D7 20 D5 3D 3A 11 7B   .+.q...?.. .=:.{
ISAKMP:  6E AA E2 86 0D 4D 9F CD 4C FC 21 53 A4 BD 72 35   n....M..L.!S..r5
ISAKMP:  80 FC 52 A8 3D 64 CD A0 06 6A 24 EF 6A A7 1C 2A   ..R.=d...j$.j..*
ISAKMP:  CE 09 16 08 77 D6 0B 23 DE B3 DA 4B 7D B8 D1 D8   ....w..#...K}...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  4E 6D 9A 1E EF 3D 6D 6F 4B 85 9C AE BC B2 FC 5A   Nm...=moK......Z
ISAKMP:  4F C3 98 34                                       O..4
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.15: Passed

>> IKE-IPV6-16.16
TEST_DESCRIPTION
A DOI value of 0 during a Phase 1 exchange specifies a Generic ISAKMP SA
which can be used for any protocol during the Phase 2 exchange.
IKE MUST set the DOI field of Security Asociation Payload
to 0 in an outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408, s3.4 p27 Security Association Payload
RFC 2408, s5.4 p62 Security Association Payload Processing
RFC 2409  s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting DOI field in SA to 0 or 1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xD43B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7D 12 23 3F 71 B2 1D 3F                           }.#?q..?
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  52 79 8B E2 95 1E F4 BC 97 85 5F DF 6B 0C C4 05   Ry........_.k...
ISAKMP:  B7 99 87 21 F8 48 B6 4D 5E 53 95 BA C0 6A 2E 0C   ...!.H.M^S...j..
ISAKMP:  36 FF 37 15 A7 54 69 FE 8F 10 2D BA 04 D0 F7 50   6.7..Ti...-....P
ISAKMP:  89 71 2A F5 9D 1C ED 3E 80 80 E6 07 78 13 FD 40   .q*....>....x..@
ISAKMP:  EA AA EA F6 86 0D A4 DC 7B 8A 13 C5 28 7A DE 6F   ........{...(z.o
ISAKMP:  B2 54 52 B8 60 84 0D 2F B9 42 24 96 48 9C F6 CB   .TR.`../.B$.H...
ISAKMP:  F3 AA CA 1F B5 FC 5B DC D4 17 B9 93 E9 A9 10 0B   ......[.........
ISAKMP:  C6 20 59 7B 1C 65 81 EC A4 BB F3 BC 0E 79 6F 2F   . Y{.e.......yo/
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  93 F9 66 7B 61 B6 52 BE 21 00 73 8A 33 E9 F8 98   ..f{a.R.!.s.3...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x5E2A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7D 12 23 3F 71 B2 1D 3F                           }.#?q..?
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F5 83 86 F3 C5 64 86 59                           .....d.Y
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F6 63 E6 B7 42 16 0A 94 AB CA 1B 6B B3 7B 11 0E   .c..B......k.{..
ISAKMP:  59 C7 43 34 75 63 EA 7E 0B 07 CE 34 50 69 6B CE   Y.C4uc.~...4Pik.
ISAKMP:  44 34 3A 51 36 4D 7C 83 AA 04 DB 57 D6 51 F6 44   D4:Q6M|....W.Q.D
ISAKMP:  42 2E D9 ED 1D BA B3 AA DD 5E 8E 37 A9 CD 1B 12   B........^.7....
ISAKMP:  45 7B 5E 2B DB DE C7 2F 29 89 49 79 47 48 0E B0   E{^+.../).IyGH..
ISAKMP:  2B 4E 1C 8D 98 BE F8 A6 22 4C 9E F9 FE DC A3 17   +N......"L......
ISAKMP:  4F F6 F9 45 E1 E5 0A 59 32 CB 6D 7D AD 5D 57 3C   O..E...Y2.m}.]W<
ISAKMP:  F4 6D E3 15 9D D4 12 95 9C AC F2 66 D7 0A D4 D2   .m.........f....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  38 E3 39 B4 DA DC 2E E5 0E 52 E2 C4 00 AF 17 A6   8.9......R......
ISAKMP:  02 38 CF 18 00 77 6E 89 7F 6F 56 D5 38 4B 30 56   .8...wn..oV.8K0V
ISAKMP:  18 89 49 30 D7 7F CE 7F 9A 99 9D 33 0B 3C AA 90   ..I0.......3.<..
ISAKMP:  71 75 F9 07 98 25 36 87 C7 CD 60 2B 06 98 48 47   qu...%6...`+..HG
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  6A DA 31 86 0F 44 09 F6 41 72 F8 2B BA 38 E4 84   j.1..D..Ar.+.8..
ISAKMP:  BE 77 E7 07                                       .w..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT with DOI field of SA set to 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.16: Passed

>> IKE-IPV6-16.17
TEST_DESCRIPTION
the responder includes the Initiator and Responder Cookie fields
in the ISAKMP Header
During SA Payload exchange, the Responder Cookie field of the ISAKMP
Header MUST be present in an outbound ISAKMP packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.4 p18 Identifying Security Associations
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting CKY-R field in HDR to
        NON_ZERO_VAL (e.g. 2 )
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xEAB8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6F C1 73 68 0B 58 3C 69                           o.sh.X<i
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  CE C6 4C E1 C5 A4 79 C9 59 B9 E5 89 BC 98 39 83   ..L...y.Y.....9.
ISAKMP:  93 86 FB 34 55 4E 00 7D D8 2C A3 35 1F 5A 3E 37   ...4UN.}.,.5.Z>7
ISAKMP:  6F 98 94 1D FF A9 BB DF B1 8E 58 1A C0 85 B3 0A   o.........X.....
ISAKMP:  3B 73 E9 75 30 1C 0B CC 55 70 B0 3A BD 48 BA F2   ;s.u0...Up.:.H..
ISAKMP:  33 A2 BD 3D 19 AB 33 FA 41 80 C2 89 F8 C7 30 FD   3..=..3.A.....0.
ISAKMP:  78 35 E5 C1 C4 6D F7 CD 48 F3 02 A5 B1 7A D7 0B   x5...m..H....z..
ISAKMP:  82 7D C3 E9 00 4A 16 68 A2 7C 08 EC 79 5A ED 85   .}...J.h.|..yZ..
ISAKMP:  65 AE 9C 13 06 1F 3F FA 3F A3 9A 2C 3E 7E BC DC   e.....?.?..,>~..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E6 F2 B1 AE 4B 76 09 BF 04 C4 9F DA C0 1F BE 5D   ....Kv.........]
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x3529 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  6F C1 73 68 0B 58 3C 69                           o.sh.X<i
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  62 36 EA E0 52 F0 20 20                           b6..R.  
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B8 BA 3B AA 01 A4 C0 E8 84 F5 39 AF 85 35 12 35   ..;.......9..5.5
ISAKMP:  73 11 DC 17 18 F5 0C BE C3 42 69 8D 50 53 E0 92   s........Bi.PS..
ISAKMP:  1E FE C9 66 2F 8E F3 EB 2D D5 6D 0B 66 96 61 06   ...f/...-.m.f.a.
ISAKMP:  DC 11 5B E0 19 0E 33 C3 EE F1 53 1E 4A 3D 49 E2   ..[...3...S.J=I.
ISAKMP:  4D DD 72 63 F0 85 F5 9B 2E A6 D8 E0 8C F4 B7 56   M.rc...........V
ISAKMP:  20 B5 6B CF 08 C8 BF 04 E9 54 DC 78 00 88 61 7E    .k......T.x..a~
ISAKMP:  CC B2 EE D8 71 71 0C FC 15 37 0F BB 0C 37 E5 64   ....qq...7...7.d
ISAKMP:  3D 1E 9D 8D 17 76 81 6C BA 5E CA 96 C0 C7 50 0F   =....v.l.^....P.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AF F5 84 01 5B 6E 8F 9D E8 6D 42 37 DD 47 7D 54   ....[n...mB7.G}T
ISAKMP:  73 45 25 AA 48 38 EF 6D CF 5A B1 AF 20 DF 02 2B   sE%.H8.m.Z.. ..+
ISAKMP:  A4 FD A5 EA F2 8F 01 FA 84 7A 7C 61 8F BF 20 2E   .........z|a.. .
ISAKMP:  4C F5 EA 74 9B 89 92 3F E9 EA 27 EF 74 FC 5C B3   L..t...?..'.t.\.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  38 C5 32 DD 50 BD 4B 96 8F 91 40 9D CE A1 B4 62   8.2.P.K...@....b
ISAKMP:  A5 11 22 6C                                       .."l
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT with valid Cookies

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.17: Passed

>> IKE-IPV6-16.18
TEST_DESCRIPTION
The ISAKMP Header fields are defined as follows:
Length (4 octets) - Length of total message (header + payloads)
in octets.  Encryption can expand the size of an ISAKMP message.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s 5.1 p58 General Message Processing
RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Length of the HDR to
         (ISAKMP_HLEN + Total length of all Payloads)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x31BC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  30 85 D4 0E 66 27 AC 0F                           0...f'..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A6 4A 21 C2 8C 1E B5 F0 43 BC BE E6 A3 2A B8 80   .J!.....C....*..
ISAKMP:  2C A4 2C 62 2F F8 FB 56 D2 21 E2 EB 77 9D 3C A9   ,.,b/..V.!..w.<.
ISAKMP:  0A A6 44 2C 7B 5B ED 06 06 FE AD 14 C5 6E 2B 41   ..D,{[.......n+A
ISAKMP:  88 D2 BB A0 5F 77 4B 1A A6 A8 93 DA A8 57 8D D3   ...._wK......W..
ISAKMP:  AC 1F EE E3 9B B2 DD 0B E7 B9 01 36 4B 56 F0 E4   ...........6KV..
ISAKMP:  48 2C EF 7E D2 76 D9 7D 95 E0 73 C3 B9 47 A0 C5   H,.~.v.}..s..G..
ISAKMP:  CD 32 E2 0A 67 8D B8 51 C4 FF 83 F7 33 32 65 A8   .2..g..Q....32e.
ISAKMP:  74 A3 CF 19 C9 F9 0D 9D 8D 79 1A BF DC 4A 00 46   t........y...J.F
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  65 09 7D 43 7C 96 75 1D C5 34 90 90 AD 05 74 6A   e.}C|.u..4....tj
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xF689 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  30 85 D4 0E 66 27 AC 0F                           0...f'..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  8E 9B CF DF A3 32 15 49                           .....2.I
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5D 18 C0 17 12 44 C0 F7 BB C5 CC B4 75 68 79 0C   ]....D......uhy.
ISAKMP:  CD AA 54 A0 78 88 64 6D 0B B5 FC E2 5C D0 C8 4D   ..T.x.dm....\..M
ISAKMP:  BA 9B A9 47 52 D1 32 47 1E B8 C1 87 D6 31 0C 0A   ...GR.2G.....1..
ISAKMP:  6C 44 29 12 90 43 A1 D1 17 AD 98 BE 1C 1D B4 18   lD)..C..........
ISAKMP:  9F 05 4E 0E 14 8B 3A 1F 26 07 80 22 8C 5E 07 69   ..N...:.&..".^.i
ISAKMP:  22 97 BE DC 38 93 4B 0E 05 EA 2C F1 36 F2 CD A6   "...8.K...,.6...
ISAKMP:  B9 7B B0 2A 46 E3 93 D8 55 08 BD D3 3E 26 EC 74   .{.*F...U...>&.t
ISAKMP:  C6 BA F8 78 80 FF AE AD A5 D3 62 9B 00 4C 93 2F   ...x......b..L./
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  47 98 FE 83 38 B6 D3 B7 EB 5F 24 2A 14 49 99 60   G...8...._$*.I.`
ISAKMP:  48 86 F3 89 0C BB B1 43 32 74 43 07 D6 21 B4 CE   H......C2tC..!..
ISAKMP:  91 FB A4 7C 1D 8F 4C 0A 6C D8 26 C4 BF 86 CD 1F   ...|..L.l.&.....
ISAKMP:  09 E8 B6 30 B6 9E 87 49 F0 D6 7E 22 B4 63 6D 4C   ...0...I..~".cmL
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  1F B1 5D 8B EE 52 0F 30 23 CB A7 32 EF B1 20 C4   ..]..R.0#..2.. .
ISAKMP:  10 56 7B 28                                       .V{(
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet with
correct HDR payload length 348
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.18: Passed

>> IKE-IPV6-16.19
TEST_DESCRIPTION
Next Payload of SA Payload (1 octet) - This field MUST NOT contain the
values for the Transform payload
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.4 p27 Security Association Payload
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting NP field in SA not to
        Transform Payload
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x20C1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A9 A0 D0 68 57 BE 02 6A                           ...hW..j
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2F F6 11 6F 24 7D 9C 57 C6 7E 38 D8 CF 9E 6C 06   /..o$}.W.~8...l.
ISAKMP:  B1 6F 90 24 6C D4 8A E4 29 27 8F 0D E1 4E 96 0F   .o.$l...)'...N..
ISAKMP:  10 55 B1 3D D3 E1 36 92 34 ED 8A 28 00 A3 1F 01   .U.=..6.4..(....
ISAKMP:  83 E4 F7 5B AF 50 09 99 FB 57 E0 DB B1 8E 97 1B   ...[.P...W......
ISAKMP:  A6 10 93 C4 62 44 50 5D AE C6 75 8C BC 71 5C 81   ....bDP]..u..q\.
ISAKMP:  1A 4D A4 72 24 74 70 64 6A 8E EF F0 20 BA C3 BA   .M.r$tpdj... ...
ISAKMP:  F6 EB 75 51 84 EA DB 4A 73 22 9D E4 0C EB 5B BC   ..uQ...Js"....[.
ISAKMP:  2E 43 9B 6E CC D9 B0 10 E4 8A 92 F0 A3 FD FA 65   .C.n...........e
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  64 0F 07 25 8D 4F 86 75 10 7D 49 D7 77 4C 28 74   d..%.O.u.}I.wL(t
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xB455 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A9 A0 D0 68 57 BE 02 6A                           ...hW..j
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  DE 3E 12 50 B3 6C 55 E7                           .>.P.lU.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  54 25 61 78 E6 02 BF EE 10 B6 57 7D 92 26 30 D7   T%ax......W}.&0.
ISAKMP:  8E 09 BA 49 41 01 2F 3C 9D 22 28 A7 37 63 FF A1   ...IA./<."(.7c..
ISAKMP:  F3 0D 1A BB B1 BC 0A 22 CF C9 3C 57 87 27 1C B3   ......."..<W.'..
ISAKMP:  30 6A 2E 55 87 D0 0F 7C A2 73 56 47 16 04 EE F5   0j.U...|.sVG....
ISAKMP:  A4 1B A3 B0 A9 CF EE 2D 50 23 22 D0 16 14 70 2D   .......-P#"...p-
ISAKMP:  D0 41 B7 7C 16 AF AD 90 28 67 68 90 15 8E 0C 70   .A.|....(gh....p
ISAKMP:  43 66 06 02 40 72 4C 72 99 74 36 79 F7 A1 9C 5D   Cf..@rLr.t6y...]
ISAKMP:  09 76 06 F2 19 0F BC 2F A4 0B FE 4C 1E 84 95 5A   .v...../...L...Z
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  9A BA 4E 15 6F 84 61 41 69 02 E2 A3 9E 31 0A BB   ..N.o.aAi....1..
ISAKMP:  83 E6 49 E5 A0 F2 B2 72 FD 5A 23 C3 9D 0D D7 C6   ..I....r.Z#.....
ISAKMP:  20 3D FF 5C B9 33 0A 8E 4F 28 2B 98 C7 07 38 BB    =.\.3..O(+...8.
ISAKMP:  C6 5F 41 EB E5 E7 B8 BC CF 3A 33 F4 53 26 74 F4   ._A......:3.S&t.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  B1 0A B3 38 E7 E1 B1 3B E8 2A 3E 1B 00 F4 A2 A1   ...8...;.*>.....
ISAKMP:  01 24 8E 2B                                       .$.+
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with Next Payload of SA (4)(Should
be: 4) not set to Transform

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.19: Passed

>> IKE-IPV6-16.20
TEST_DESCRIPTION
In Phase 1, the SPI Size is irrelevant and MAY be from 0 to 16, if
SPI Size is non-zero the content of SPI field MUST be ignored
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.5 p29 Proposal Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the SPI Size in SA set
        to <SPI-SIZE>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R>
- CASE: <SPI-SIZE> = 0
- CASE: <SPI-SIZE> = 16
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:1 Set SPI Size to 0 in Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with the SPI Size in SA set to <SPI-SIZE> 0 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x5AC5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  21 BD 99 36 8A 23 9C 36                           !..6.#.6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E3 03 48 5A 16 E3 B8 B0 93 92 2B B9 8B A6 18 15   ..HZ......+.....
ISAKMP:  4F 33 0E 46 0F 19 B3 79 1A A4 E4 B7 AB 28 F6 80   O3.F...y.....(..
ISAKMP:  47 0F 28 BA C5 5E DB 70 EB 6E 5E 22 B8 92 AE 25   G.(..^.p.n^"...%
ISAKMP:  29 EB 55 BF 4E 79 A1 FF 5C 51 1C AC CF 71 57 0D   ).U.Ny..\Q...qW.
ISAKMP:  13 24 12 38 D2 7D EF 4B F3 2C 6C C8 FA AB 80 16   .$.8.}.K.,l.....
ISAKMP:  5A 9B 13 60 2B 21 45 ED E5 CB 75 CA 11 14 3E B3   Z..`+!E...u...>.
ISAKMP:  F7 03 D7 6B 5E AC 39 95 E3 D7 81 23 06 A5 02 92   ...k^.9....#....
ISAKMP:  01 4E DE B2 4B 49 8A 4D F2 8F 50 3F 14 9A AB BD   .N..KI.M..P?....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  3D 1C E5 C0 A4 AF 25 FF 23 DA 23 7F 92 D9 A9 7F   =.....%.#.#.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xAA36 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  21 BD 99 36 8A 23 9C 36                           !..6.#.6
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  5B 11 09 57 D2 E4 37 17                           [..W..7.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A7 60 DA D2 0F 9C 1C 08 3D BD 60 A7 ED F0 B9 49   .`......=.`....I
ISAKMP:  19 8C ED 34 B8 BD C7 84 47 0E 63 BA D8 35 07 43   ...4....G.c..5.C
ISAKMP:  8C 50 CB 97 79 63 07 F4 04 2A 06 11 C4 6E 6E F8   .P..yc...*...nn.
ISAKMP:  42 13 2B 0E E5 BA 6F A3 98 88 9A 74 84 7B 01 E1   B.+...o....t.{..
ISAKMP:  F3 02 EC 18 8E 9B 69 A1 89 EC 14 B0 29 68 44 84   ......i.....)hD.
ISAKMP:  C0 33 65 7B C7 E2 C9 1C 78 4E 5B E8 40 DC B3 C5   .3e{....xN[.@...
ISAKMP:  CA D2 DD C1 27 0D 4F 92 4C 9A 5D 66 33 84 B2 EC   ....'.O.L.]f3...
ISAKMP:  3E 07 5E 1F A7 30 48 B8 C7 95 94 B2 9C AF 76 37   >.^..0H.......v7
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  AD E1 7C A0 D0 6F CF 8A 69 82 4F 89 7E 7B FD AB   ..|..o..i.O.~{..
ISAKMP:  C4 B6 4C D9 9D FC 73 01 B8 2C A4 2A CD EA F6 EF   ..L...s..,.*....
ISAKMP:  EB ED 48 5F 5A A0 04 8E EB 3C 38 1B DA 61 E1 5C   ..H_Z....<8..a.\
ISAKMP:  43 AB CC 5A EE 22 34 29 EE 7F D1 85 4D EF 3F F7   C..Z."4)....M.?.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  D8 BA 25 5E 5B 5C AB 87 D4 00 3D 99 DA 07 49 0C   ..%^[\....=...I.
ISAKMP:  7E 23 78 2D                                       ~#x-
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:2 Set SPI Size to 16 in Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with the SPI Size in SA set to <SPI-SIZE> 16 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 272 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 272 
UDP: Checksum         = 0xA945 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F4 FA C1 32 17 B1 6E 73                           ...2..ns
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 264 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 60 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 48 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 16
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [16 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  46 94 98 E4 F1 66 E7 A8 3F 52 89 64 8C 62 33 5F   F....f..?R.d.b3_
ISAKMP:  60 B5 52 DA A6 1A 1B 45 08 D1 C0 5E 48 D2 1A C7   `.R....E...^H...
ISAKMP:  28 69 57 4A 0A D5 0A 22 CD 45 B1 65 77 8A B3 66   (iWJ...".E.ew..f
ISAKMP:  42 A9 C9 42 6B 1C 74 49 A5 9B 70 08 4B 0D 5A 00   B..Bk.tI..p.K.Z.
ISAKMP:  EA F2 B2 06 FC E8 EE A0 8B 21 30 43 5C 0C 08 0D   .........!0C\...
ISAKMP:  2B 23 29 7F 8F 4F 67 48 8D 4B 85 D0 11 C4 C2 CE   +#)..OgH.K......
ISAKMP:  51 67 41 E3 3F 12 09 08 D4 20 00 12 45 72 A5 30   QgA.?.... ..Er.0
ISAKMP:  C4 FE D2 86 F0 BE DA 62 CB 5D 05 1D A7 27 C0 52   .......b.]...'.R
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A6 4C DC 21 43 24 D0 EB 3C C3 27 B7 13 9E 93 79   .L.!C$..<.'....y
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 372 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 372 
UDP: Checksum         = 0x6B7E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F4 FA C1 32 17 B1 6E 73                           ...2..ns
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  97 FA 01 F7 01 8C 0E 80                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 364 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 16
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [16 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ISAKMP: --- Security Parameter Index End ---
ISAKMP:
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  16 2D 7E BA F6 5B 66 16 AE 74 E3 7F 4E FA EC A8   .-~..[f..t..N...
ISAKMP:  6C 53 73 5A 1C 06 28 08 C1 4C 1A 0A A5 E3 0B 94   lSsZ..(..L......
ISAKMP:  85 C0 3B CD 61 C6 A5 AE 09 C9 14 3E E0 FC 2C C6   ..;.a......>..,.
ISAKMP:  24 29 D4 64 92 DB 4B 49 A1 2B 43 11 27 99 3D D5   $).d..KI.+C.'.=.
ISAKMP:  8D 7E 3A 0C 3D 15 EF 9F 55 62 6C 1C B4 D4 BC BE   .~:.=...Ubl.....
ISAKMP:  1F D4 EC AB 6F 11 DE F7 1C 5F D1 3C E2 B8 14 3D   ....o...._.<...=
ISAKMP:  0C 6D 3B A2 D8 87 FA A5 B3 90 72 F3 74 BE 3D D8   .m;.......r.t.=.
ISAKMP:  A9 F6 A1 EF 86 0C 5A 23 88 C0 48 98 2F B7 E1 3E   ......Z#..H./..>
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  75 E4 A3 A9 67 F8 68 92 69 C5 A7 D1 A9 57 22 01   u...g.h.i....W".
ISAKMP:  8B 39 56 1B 87 20 BE 29 AE 62 FF ED DA 08 F9 C3   .9V.. .).b......
ISAKMP:  38 94 51 94 49 4D C9 6B CA DC 92 09 71 76 42 C6   8.Q.IM.k....qvB.
ISAKMP:  B5 AF 3C 28 CF FC 89 BC 4F 9E 65 E0 B5 8A 3E D0   ..<(....O.e...>.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  F5 C0 97 7D 25 96 C1 B3 31 D7 A5 29 BF 0C 94 26   ...}%...1..)...&
ISAKMP:  F0 55 0B AC                                       .U..
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.20: Passed

>> IKE-IPV6-16.21
TEST_DESCRIPTION
The existence of RESERVED fields within ISAKMP payloads are used
strictly to preserve byte alignment.  All RESERVED fields in the
ISAKMP protocol MUST be set to zero (0) when a packet is issued.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with RESERVED fields of
        SA, Proposal, Transform, KE, Nr, IDir and HASH_R all 
        set to 0 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x1B7F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD 9B 7A 7F 39 85 68 41                           ..z.9.hA
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3E 7D 70 88 DD 8D 39 70 A8 8E FB 76 D6 D0 03 BE   >}p...9p...v....
ISAKMP:  CB 96 6E F6 5D 5D 47 37 2E E4 C4 C4 67 31 7C EE   ..n.]]G7....g1|.
ISAKMP:  73 24 97 B3 2E 68 9A 36 0E 93 21 02 3D 2E DD EB   s$...h.6..!.=...
ISAKMP:  60 FF 9D 96 E0 85 34 B8 67 74 B9 14 8C FD F5 C9   `.....4.gt......
ISAKMP:  6D 62 25 52 E8 2C B1 1F 9E A2 29 1E 36 C7 A7 0A   mb%R.,....).6...
ISAKMP:  15 5E A5 CC D3 A2 9F 1B 9C AE 3F 02 03 24 F8 9A   .^........?..$..
ISAKMP:  63 9D 49 70 65 3B 6D EA 21 B7 16 6A DA 75 18 93   c.Ipe;m.!..j.u..
ISAKMP:  63 AA F6 A2 D6 8F BE 95 9B C1 DD CB 12 40 3A AF   c............@:.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6B E9 6B D9 3E 7D 6F 64 4C 98 F4 FA AE B1 E2 74   k.k.>}odL......t
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xD4E3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD 9B 7A 7F 39 85 68 41                           ..z.9.hA
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  59 02 9F CE 0A 5B 14 89                           Y....[..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  89 56 24 D3 54 90 11 1C 46 E8 85 DD 13 20 ED F3   .V$.T...F.... ..
ISAKMP:  5D 68 8D 6B F8 57 5F 4C 0B 8D 20 66 5F 12 D0 CE   ]h.k.W_L.. f_...
ISAKMP:  D3 16 A5 17 B1 01 4F D9 19 FA 62 EE 14 C6 24 5C   ......O...b...$\
ISAKMP:  D4 0A 65 DE 52 30 B6 51 60 1A 42 9A 71 09 AE 9F   ..e.R0.Q`.B.q...
ISAKMP:  14 7F B7 5D 57 4D 7F 03 E0 EF 3E F4 38 33 43 87   ...]WM....>.83C.
ISAKMP:  39 D2 C2 A6 D3 83 43 B9 7B 4C 20 3C F6 0C 37 A3   9.....C.{L <..7.
ISAKMP:  12 91 CB 8D F3 F4 89 C3 6B C9 7E EC 0D 0D 3F 28   ........k.~...?(
ISAKMP:  CB E8 59 5E C7 53 9F 6B 8F AE 59 1D 75 B1 86 CE   ..Y^.S.k..Y.u...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  E9 14 F6 08 0D 4E 3F EE EC 71 13 B5 8B 5F 8C 07   .....N?..q..._..
ISAKMP:  AC 03 99 0B 1B 22 97 F6 ED F9 F3 AB EC D8 C3 20   ....."......... 
ISAKMP:  68 F2 96 71 AF 8B 82 34 83 B4 7B 1A EB D8 9B 64   h..q...4..{....d
ISAKMP:  C6 90 98 6D DA 78 46 F4 E9 CD B6 3F C0 56 05 3F   ...m.xF....?.V.?
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  75 3B 0F 32 25 42 BC C7 C0 A0 F6 1F 35 2C 3C F5   u;.2%B......5,<.
ISAKMP:  2C 47 26 37                                       ,G&7
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R>
Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with RESERVED field of SA, Proposal,
Transform, KE, Nonce, ID, HASH_R set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.21: Passed

>> IKE-IPV6-16.22
TEST_DESCRIPTION
IKE MUST set the RESERVED field of Hash Payload to 0 in an outbound
ISAKMP Packet
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s2.5.2 p20 RESERVED Fields
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Authentication method is 
        Pre-shared key
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting RESERVED field
        to 0 in HASH_R
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Authentication method is
Pre-shared key Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x535D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  30 C4 F0 39 A2 E2 9C 3A                           0..9...:
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  92 53 5D D4 B2 C4 63 EA 02 8A B2 C5 8A F6 10 A6   .S]...c.........
ISAKMP:  42 A1 B8 49 03 70 C7 56 21 9B BA CB 83 96 E6 A8   B..I.p.V!.......
ISAKMP:  7A F8 0A 57 68 89 17 BC 84 1D 1B 6B F4 C2 59 F3   z..Wh......k..Y.
ISAKMP:  45 F9 B1 97 0D FE FE 46 3D 71 D6 24 3A 22 0B E9   E......F=q.$:"..
ISAKMP:  AA A9 B9 31 10 F7 EB D9 5F 70 88 09 4A DD CD 7B   ...1...._p..J..{
ISAKMP:  95 21 21 BF 7B 4E EB D3 75 5F E6 BC 42 FE 0A 1E   .!!.{N..u_..B...
ISAKMP:  7F D4 5A 1A 21 7C C1 23 7A 19 BE CB A0 04 32 5F   ..Z.!|.#z.....2_
ISAKMP:  35 05 4F 39 86 17 6E 29 75 21 49 DF 58 54 60 EC   5.O9..n)u!I.XT`.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  81 08 61 91 D0 D7 69 36 F3 6F A5 25 7F 86 F8 CF   ..a...i6.o.%....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xA7F8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  30 C4 F0 39 A2 E2 9C 3A                           0..9...:
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  87 21 40 52 8A 2F D1 31                           .!@R./.1
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  02 CE 62 A4 AB 14 60 61 43 B3 BE 90 91 24 CD B4   ..b...`aC....$..
ISAKMP:  77 FE 59 C9 E0 2E 7D 32 5C 92 46 21 30 24 B8 E2   w.Y...}2\.F!0$..
ISAKMP:  97 44 81 AE B0 9B F4 AE BC 47 60 8D 75 C1 9E 1B   .D.......G`.u...
ISAKMP:  F4 56 11 A2 41 21 2B 32 D3 5C B8 8B 92 F7 EF 4B   .V..A!+2.\.....K
ISAKMP:  9C 5B 04 AB 3F 05 2C 95 D5 4E 57 47 19 DB DB F6   .[..?.,..NWG....
ISAKMP:  3F 08 78 7E 95 CF C4 6C 1B 7E D9 65 73 99 8B B1   ?.x~...l.~.es...
ISAKMP:  29 B6 D5 4D DC 1E 74 14 60 01 E7 F1 96 06 F9 5D   )..M..t.`......]
ISAKMP:  5C 8A 36 04 4A 2F B4 E4 CC CA 2F C0 09 C4 92 84   \.6.J/..../.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  F0 C0 FD EE 13 54 47 80 F3 D2 F6 AD BA 6E 56 2D   .....TG......nV-
ISAKMP:  8F 7B B6 47 D8 51 C6 85 D8 79 82 49 F0 B7 5E AA   .{.G.Q...y.I..^.
ISAKMP:  28 BA 7C E6 7E B5 A5 34 09 2F 6A 76 D0 21 EE 97   (.|.~..4./jv.!..
ISAKMP:  E5 19 37 1C EF DA 7B B8 44 43 B1 D1 83 46 D9 3E   ..7...{.DC...F.>
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  8B EA D6 6E 44 A0 14 5D CF B1 0F 45 6C A8 AB 1A   ...nD..]...El...
ISAKMP:  A2 0D 5A E2                                       ..Z.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir, HASH_R>
packet from DUT with RESERVED field of HASH_R set to 0

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.22: Passed

>> IKE-IPV6-16.23
TEST_DESCRIPTION
IKE MUST set the Port field of Identification Payload to 0 or
UDP Port 500 in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Port field of 
         IDir to 0 or 500
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x7FC2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  05 84 97 03 DC FF 66 44                           ......fD
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DA 2B 54 58 04 D2 C9 EC 29 72 98 BD A7 2F 66 D0   .+TX....)r.../f.
ISAKMP:  ED 02 AC B2 20 5A 13 CC E3 78 53 74 0D 02 2E 9F   .... Z...xSt....
ISAKMP:  31 4D 90 28 0F F2 B6 8A 7E 50 D8 12 47 13 B5 BD   1M.(....~P..G...
ISAKMP:  C3 52 93 17 FE BD 9D 24 6B 2D 50 81 A5 79 21 35   .R.....$k-P..y!5
ISAKMP:  D1 A6 1E E6 47 5A B8 A4 88 04 CF F6 9D 1C 09 02   ....GZ..........
ISAKMP:  45 A9 64 6E 21 89 38 23 23 E7 F6 10 30 7C F8 32   E.dn!.8##...0|.2
ISAKMP:  1F ED C9 DA 71 DB 1E E0 A4 B1 0E F7 71 B1 B8 FB   ....q.......q...
ISAKMP:  26 C6 4F 7E 4F AF 27 89 9E FC 21 5B B8 6A F1 6E   &.O~O.'...![.j.n
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  17 48 7F ED 6D 87 E5 D0 12 16 6C 58 2F A6 3B 4F   .H..m.....lX/.;O
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x2C5E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  05 84 97 03 DC FF 66 44                           ......fD
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  60 BF 5A 56 56 27 5E DA                           `.ZVV'^.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  64 71 3C 43 44 1A 99 6E B4 C8 C8 3E FE 14 3B FC   dq<CD..n...>..;.
ISAKMP:  3C A4 38 B5 B9 DC 21 84 54 E2 5F 18 5B 54 37 CC   <.8...!.T._.[T7.
ISAKMP:  FA DA CB 5E 85 2A E3 23 59 0A 04 19 AE 7B 7D 82   ...^.*.#Y....{}.
ISAKMP:  27 D5 01 C0 77 E7 1F D3 BF 3C 49 50 D9 0D 1A F9   '...w....<IP....
ISAKMP:  AF 33 65 07 BD A1 26 8F DA 75 32 69 22 88 5C 3F   .3e...&..u2i".\?
ISAKMP:  89 C3 F5 F7 E9 3F 06 55 03 65 BF 8B A0 43 A3 2F   .....?.U.e...C./
ISAKMP:  BA A6 3E 89 23 6B E6 B6 55 04 06 75 40 78 E1 F7   ..>.#k..U..u@x..
ISAKMP:  87 55 9D 56 F7 24 F9 C5 70 46 D5 65 87 72 65 CE   .U.V.$..pF.e.re.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  94 60 17 D5 A1 C8 C0 D5 AA A2 AE 83 A1 0A F9 4C   .`.............L
ISAKMP:  B8 06 AD 23 BA 2B 6A F9 A2 33 2B 28 D0 3D D9 FA   ...#.+j..3+(.=..
ISAKMP:  EE 6E B4 B9 F6 51 04 7C 47 0E EA F5 8E C4 38 0C   .n...Q.|G.....8.
ISAKMP:  E4 98 F3 6D 72 F2 F5 E1 EE 88 34 4F 55 90 AD B0   ...mr.....4OU...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  E9 3F E0 FF CE 52 55 9F C1 C2 18 81 A3 E2 B6 59   .?...RU........Y
ISAKMP:  88 B1 D6 10                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received ISAKMP Packet from DUT with
ID Port Field set to (0) (Should be 0 or 500)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.23: Passed

>> IKE-IPV6-16.24
TEST_DESCRIPTION
IKE MUST set the Protocol ID field of Identification Payload to 0
or UDP Protocol(0x11) in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2407 s6.2 p19 Identification Payload Content
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Protocol ID         field of IDir to 0 or UDP(0x11)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x5CAD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E8 04 B0 49 A5 66 DD 4A                           ...I.f.J
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  42 BF 3F AC 83 BE 75 9D 82 3A BF 5C B9 47 9A D4   B.?...u..:.\.G..
ISAKMP:  69 CB 9D 0E E0 CA B9 ED EE A1 48 0B F5 26 EE B1   i.........H..&..
ISAKMP:  7F 13 30 FC A7 61 C0 BA 02 26 2E D9 64 64 16 89   ..0..a...&..dd..
ISAKMP:  E4 FB 1A 5A 4D 5E A2 54 85 EF A6 5D 62 91 F3 F7   ...ZM^.T...]b...
ISAKMP:  9C 80 42 4A 60 5C 50 B5 9C C8 25 48 D9 4F 1B 8E   ..BJ`\P...%H.O..
ISAKMP:  2C E0 F7 EA B4 A4 27 0D 66 90 FF 56 D0 0D B6 AA   ,.....'.f..V....
ISAKMP:  93 62 EE 51 CC 2B 37 0F 4A 22 CB D7 DA 4D 44 C5   .b.Q.+7.J"...MD.
ISAKMP:  43 44 6A DF 0F 2F 45 E0 24 D2 3E DA AD D3 81 15   CDj../E.$.>.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D5 45 0B 12 57 1A 22 16 25 A9 CB 20 37 99 F5 F4   .E..W.".%.. 7...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x24F2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E8 04 B0 49 A5 66 DD 4A                           ...I.f.J
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  AE A9 F2 6A 65 0B F7 BE                           ...je...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  EF B6 BE 19 48 C4 0E 0C 16 8E 6E EC 30 C3 21 2B   ....H.....n.0.!+
ISAKMP:  ED 36 CD C0 85 BF 45 F2 73 EC 58 CF DE 29 7B 12   .6....E.s.X..){.
ISAKMP:  DF 3C 55 D6 57 C1 B7 1B DC 0F 86 F6 68 54 27 A8   .<U.W.......hT'.
ISAKMP:  15 51 43 FC A8 3A AC 6F 86 42 C0 A4 76 64 31 77   .QC..:.o.B..vd1w
ISAKMP:  78 5D 7A C9 4B 13 10 8C 4E 72 2B 9A 95 1E 23 44   x]z.K...Nr+...#D
ISAKMP:  9B 8D 18 F0 1D F3 A6 2D 43 6A E5 EB BD B2 3B 2A   .......-Cj....;*
ISAKMP:  DC D8 03 65 46 4F 34 31 68 86 7F B8 5A A3 40 DE   ...eFO41h...Z.@.
ISAKMP:  3E 98 0B 58 77 D3 BC DA 42 63 DC A1 59 13 D9 C2   >..Xw...Bc..Y...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  DB 3C 7F 53 59 2A 14 52 2E BB 38 23 2B C2 D4 88   .<.SY*.R..8#+...
ISAKMP:  41 87 9A AE 6A F3 AA D3 3E 0D 29 DA 79 D0 35 39   A...j...>.).y.59
ISAKMP:  C3 83 6F D6 57 B7 4D 1C A0 72 10 41 6D D9 BB F7   ..o.W.M..r.Am...
ISAKMP:  B3 7C 3F 2D 11 2C 78 B5 2B 7C EF EF 15 21 2C 39   .|?-.,x.+|...!,9
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  AA DB B6 F7 69 E3 EE 64 32 82 1D A6 FE 7A 0C 6F   ....i..d2....z.o
ISAKMP:  40 05 87 65                                       @..e
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R>
Packet from DUT with ID Protocol Field set to (0)
 (Should be 0 or UDP)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.24: Passed

>> IKE-IPV6-16.25
TEST_DESCRIPTION
IKE MUST set the Payload Length field of the Nonce Payload
between 8 and 
256 bytes in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set Payload Length
        field to <PAYLOAD_LEN>
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> setting Payload Length
        of Nonce Payload to a number which lies in between 8 and 256
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet with Payload Length
field to <PAYLOAD_LEN> to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x2280 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  04 3A B2 06 EC A4 72 08                           .:....r.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  31 29 CD B5 A0 1A 02 D0 21 63 29 37 44 54 A1 62   1)......!c)7DT.b
ISAKMP:  72 F7 3B 5D 38 4C 1E 0F D6 80 F6 0B 65 44 0C 93   r.;]8L......eD..
ISAKMP:  17 95 63 EA 3D 6D 29 5E 59 ED 1F 3E B8 AC D7 F3   ..c.=m)^Y..>....
ISAKMP:  15 82 2F 64 99 74 8C 13 0B 21 A3 A2 AF 13 B7 B8   ../d.t...!......
ISAKMP:  67 7E 0C 3B C1 3F 18 8E 71 56 D6 F9 10 48 79 B3   g~.;.?..qV...Hy.
ISAKMP:  7B 50 60 4D D7 E2 E7 63 B1 94 A6 DE 5C 74 E9 1C   {P`M...c....\t..
ISAKMP:  18 E4 3F 60 95 30 02 1D 65 CF FA 8C BB 57 F6 78   ..?`.0..e....W.x
ISAKMP:  4F DA DF 74 18 A5 A3 D5 F9 DE BA 82 38 EB 71 BC   O..t........8.q.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  06 40 4D F6 EC 9F DC 33 48 CD 50 02 3E E8 24 04   .@M....3H.P.>.$.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0xE41A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  04 3A B2 06 EC A4 72 08                           .:....r.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  4F 75 4D 6F 6F 5D EB EA                           OuMoo]..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  41 AF D3 C8 77 E5 7C D2 15 DC 7D BA 95 77 6A 4A   A...w.|...}..wjJ
ISAKMP:  DE D3 C5 DC 05 88 87 76 8B 12 96 FC FA BF FB A3   .......v........
ISAKMP:  40 D7 EE BD 2C F4 C9 BA 10 77 92 5B F2 9B D9 D2   @...,....w.[....
ISAKMP:  99 E4 2B 00 B6 3E 5A 34 3B FD 8E 16 63 F7 99 37   ..+..>Z4;...c..7
ISAKMP:  25 76 93 B8 4D BA 58 43 6F B0 B3 20 C4 9D CC 7D   %v..M.XCo.. ...}
ISAKMP:  5A 47 4D 56 62 AE A2 7B 5E D7 D5 33 56 EB 59 82   ZGMVb..{^..3V.Y.
ISAKMP:  AB 74 80 D1 25 82 5F 27 D5 22 FD 30 D2 45 B5 71   .t..%._'.".0.E.q
ISAKMP:  67 4B 1C B5 B9 F1 62 C7 78 3D 25 AB 1E 84 92 E7   gK....b.x=%.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  27 7C BC D7 FD 28 63 EA 93 68 51 36 B7 FE AE CE   '|...(c..hQ6....
ISAKMP:  7F 8A 3A F5 38 1C 2B B4 3E F4 49 04 40 58 A1 FD   ..:.8.+.>.I.@X..
ISAKMP:  6E 62 00 17 70 03 10 DB 6F 7D F6 4A 6E 6C 01 08   nb..p...o}.Jnl..
ISAKMP:  D2 F8 E0 AF B4 3E BD 84 92 7B 82 0B AB C1 51 57   .....>...{....QW
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  9F DE 9F 10 55 CE 65 F1 CC 3F BF CE B7 0F A7 76   ....U.e..?.....v
ISAKMP:  CB 97 95 99                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R>
Packet from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.25: Passed

>> IKE-IPV6-16.26
TEST_DESCRIPTION
IKE MUST set the Exchange Type field of ISAKMP Header to
Aggressive in an outbound ISAKMP packet.
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2408 s3.1 p21 ISAKMP Header Format
RFC 2409 s5 p8 Exchanges
RFC 2409 s5.4 p16 Phase 1 Authenticated With a Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> 
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with Exchange Type field 
       in HDR set to Aggressive 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x2E3D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2E 2B 53 16 50 4E A1 17                           .+S.PN..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D5 D5 83 A9 D6 E3 4E A2 31 45 0B 30 F0 9E CD 2D   ......N.1E.0...-
ISAKMP:  DE DE 17 E6 8E 07 15 DA AE 0F 70 6F FC 72 F2 0C   ..........po.r..
ISAKMP:  FE F4 A0 42 CA 87 20 44 42 C4 BB CD CC F3 48 2F   ...B.. DB.....H/
ISAKMP:  37 06 06 72 D8 E5 40 39 9E 23 8D 7A 46 E7 7E 14   7..r..@9.#.zF.~.
ISAKMP:  7F FD 6E B0 00 1C 34 0B 76 CD 17 86 19 DF 10 EE   ..n...4.v.......
ISAKMP:  4E 41 CA 79 1E EB 58 18 98 E3 1F 03 C8 F1 27 E9   NA.y..X.......'.
ISAKMP:  DC B0 0A A0 05 2D C6 F6 67 91 EA 11 F5 C6 EF 7B   .....-..g......{
ISAKMP:  FE C8 9E CF 40 A9 18 87 2E D7 E8 2A C0 3F 1C A1   ....@......*.?..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  1E 6C 41 58 6F F5 03 67 11 E2 FD 6F 0E 7C F5 9F   .lAXo..g...o.|..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 356 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 356 
UDP: Checksum         = 0x6DB2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2E 2B 53 16 50 4E A1 17                           .+S.PN..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  79 EE 66 59 25 9B 20 82                           y.fY%. .
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 348 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E3 FF D4 43 02 74 C8 57 D5 B8 AD BF C1 97 69 E9   ...C.t.W......i.
ISAKMP:  9A 41 DA FE 41 B5 6A D2 16 0A 55 0A D1 29 1C 95   .A..A.j...U..)..
ISAKMP:  35 2A 28 86 D2 77 1A 29 77 01 8C 41 B6 87 E6 27   5*(..w.)w..A...'
ISAKMP:  2F C7 87 63 A2 EA D0 2B 32 96 3C 55 D2 26 74 85   /..c...+2.<U.&t.
ISAKMP:  BD BB A0 29 1A B8 89 C0 F8 30 21 03 AC 03 A0 DF   ...).....0!.....
ISAKMP:  E7 C4 54 AF 4B 8C 86 7A 15 DF 7A 2D D5 59 08 B5   ..T.K..z..z-.Y..
ISAKMP:  A6 E6 C9 19 89 52 F1 23 8A C5 57 39 0A D6 7B 10   .....R.#..W9..{.
ISAKMP:  D5 63 31 D0 68 B4 C7 01 31 01 5A CF 36 DB 7D 05   .c1.h...1.Z.6.}.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  83 12 63 F9 41 E0 8F F6 E4 32 53 09 2A 34 2D 80   ..c.A....2S.*4-.
ISAKMP:  5A FA DE 41 94 55 49 D7 FD 8E 7D C0 E7 60 08 09   Z..A.UI...}..`..
ISAKMP:  1D 3B A1 19 8A 88 69 F3 94 41 BB 73 7B 7B C9 7E   .;....i..A.s{{.~
ISAKMP:  53 E6 75 D6 39 B1 F9 B6 E0 82 AF E2 F4 6E 44 04   S.u.9........nD.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  7B C5 1D 42 6A 95 00 99 B9 FF 07 AB A5 B6 F9 E0   {..Bj...........
ISAKMP:  07 E4 95 97                                       ....
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT with Exchange Type in HDR set to Aggressive

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.26: Passed

>> IKE-IPV6-17.1
TEST_DESCRIPTION
Verify the Initiator and Responder "cookies".  If the cookie
validation fails, the message is discarded and the following
actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-COOKIE message type MAY be sent to the transmitting entity.
Note: Here we check DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and 
        CKY-R to <CKY-R>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R> packet
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:1 Set CKY-I to 0 and CKY-R to 0

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xDC6E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  58 47 B7 D7 E9 FF 18 BD 45 10 E2 09 FF 97 4A C7   XG......E.....J.
ISAKMP:  D2 BC 95 EA 4E 70 4D 01 76 2B F6 05 9F 89 58 92   ....NpM.v+....X.
ISAKMP:  14 DA 8C E7 E1 3F 69 67 CE B1 25 CA D5 AD 79 D5   .....?ig..%...y.
ISAKMP:  D6 8B AA FF F1 48 72 0C 4B 51 0C 6D AA 56 B3 83   .....Hr.KQ.m.V..
ISAKMP:  C6 05 36 05 4A 7C D8 38 75 97 02 F3 BB D4 1E 58   ..6.J|.8u......X
ISAKMP:  32 30 A4 86 6A 23 29 C8 55 A9 B9 57 A0 54 AA A3   20..j#).U..W.T..
ISAKMP:  CF 79 C8 62 6D 06 15 46 3E C4 6E A6 1B 34 17 39   .y.bm..F>.n..4.9
ISAKMP:  4C 3C 61 5E B4 85 4B E7 81 3B 7F 3B F9 B3 A7 9F   L<a^..K..;.;....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F4 D9 42 F7 3D 40 1F 8C 80 E4 79 B8 4E C0 84 D9   ..B.=@....y.N...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xAB57 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x3A76 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3A 3E 7F 99 1B 84 6B BF EB 40 57 85 B4 67 1D A2   :>....k..@W..g..
ISAKMP:  0C 27 F5 71 16 A0 14 65 48 C0 E8 40 03 1B FA C3   .'.q...eH..@....
ISAKMP:  03 25 80 9F D0 81 E5 C5 24 16 62 5D 15 8A 61 0E   .%......$.b]..a.
ISAKMP:  FE 33 7A 9F 39 40 7C 7F 44 66 BF 9D 01 5B 7B A9   .3z.9@|.Df...[{.
ISAKMP:  EF C3 F9 97 06 D1 37 8E E8 DB 5F CA 29 AA C7 73   ......7..._.)..s
ISAKMP:  FF 8B A1 B9 A7 74 BA 86 4F 40 45 0D 21 BD D9 7A   .....t..O@E.!..z
ISAKMP:  4A FB 69 83 E6 41 0E EA 51 DA AC 29 39 4F 70 13   J.i..A..Q..)9Op.
ISAKMP:  FA CF DD 29 8F E7 E0 2B D5 7D C4 A1 0B 20 9B 27   ...)...+.}... .'
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F5 11 4A 6B 42 1B 41 BA 8A 70 37 7D 30 FB 1C 28   ..JkB.A..p7}0..(
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA753 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.1: Passed

>> IKE-IPV6-17.2
TEST_DESCRIPTION
Verify the Initiator and Responder "cookies".  If the cookie
validation fails, the message is discarded and the following
actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-COOKIE message type MAY be sent to the transmitting entity.
Note: Here we check whether DUT sends the Notify message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p59 ISAKMP Header Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and 
        CKY-R to <CKY-R>
-  DUT: Notify INVALID-COOKIE
- CASE: <CKY-I> = 0, <CKY-R> = 0
- CASE: <CKY-I> = 0, <CKY-R> = NON_ZERO_VAL
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:1 Set CKY-I to 0 and CKY-R to 0

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x9537 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3D B2 1C 67 CB 14 94 7F D1 8E 92 76 80 8D BC 8B   =..g.......v....
ISAKMP:  BA A7 52 A8 B6 49 E2 0C 5F 34 73 B7 A4 B7 8B 00   ..R..I.._4s.....
ISAKMP:  33 08 62 1C 29 A7 8D 6B 34 DD 62 8D DE CA EF 61   3.b.)..k4.b....a
ISAKMP:  C0 48 1A 64 51 A9 97 FE 8F 5B 65 41 6C C3 2E 9E   .H.dQ....[eAl...
ISAKMP:  9F 6B 23 8E 86 CC 66 82 6F 29 5F 8A 72 6C 0B 9B   .k#...f.o)_.rl..
ISAKMP:  28 85 C1 02 35 9D 36 81 D5 FC 24 DD 8F 59 AA 92   (...5.6...$..Y..
ISAKMP:  E7 ED E5 2B 17 92 B7 B9 E0 97 95 6D 95 62 1A 7B   ...+.......m.b.{
ISAKMP:  D2 EF 48 28 5D 81 6F 47 B9 B8 24 DC A8 2A C0 51   ..H(].oG..$..*.Q
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  D9 45 3F C0 62 0D C5 4D 64 95 C5 C3 3D 4D B7 A3   .E?.b..Md...=M..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xAB57 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Case:2 Set CKY-I to 0 and CKY-R to non-zero

Sending <HDR,SA,KE,Ni,IDii> with CKY-I in HDR set to <CKY-I> and
CKY-R to <CKY-R> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x8137 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5C 4B DD B0 30 45 7B A8 A9 E7 41 B0 95 92 5D E6   \K..0E{...A...].
ISAKMP:  F1 E4 A4 C2 6E 3A B6 A8 34 16 0A AB D2 27 2F 73   ....n:..4....'/s
ISAKMP:  1E D3 40 D5 0B 27 26 2F E9 00 75 C7 B5 4F 2D 93   ..@..'&/..u..O-.
ISAKMP:  B7 3B 33 65 E6 A5 E1 57 52 7D 71 91 2B FA 3D 83   .;3e...WR}q.+.=.
ISAKMP:  DD 43 06 7C D9 B6 85 2B C4 4C CF 01 00 66 D4 60   .C.|...+.L...f.`
ISAKMP:  8A 94 89 F4 8D D9 C5 1C 94 48 39 0D 6A D4 03 5A   .........H9.j..Z
ISAKMP:  7B 88 51 2F 3C 72 72 25 2C 9E A3 64 DD 1C 30 79   {.Q/<rr%,..d..0y
ISAKMP:  0A 62 ED 66 AE CC 2E 9B 55 D6 29 F2 AD 3D 99 12   .b.f....U.)..=..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  35 15 06 A8 19 54 B6 39 52 3B 6F 9D 64 67 0A 5D   5....T.9R;o.dg.]
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA753 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  01 01 01 01 01 01 01 01                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 4 (Invalid Cookie)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message with Notify Type 4 (Invalid Cookie)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.2: Passed

>> IKE-IPV6-17.3
TEST_DESCRIPTION
The SA payload MUST precede all other payloads in a phase 1 exchange.
If the Next Payload field validation fails, the message is discarded
and the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-PAYLOAD-TYPE message type MAY be sent to the
transmitting entity.
Note: Here we check DUT discards the packet
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Send <HDR,KE,SA,Ni,IDii>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,KE,SA,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xDFE4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 95 7C 6D 50 A0 CC 2E                           L.|mP...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  15 2D 37 00 34 7E 28 AF B2 96 D5 93 CD 12 5C EC   .-7.4~(.......\.
ISAKMP:  92 50 3B BF C9 7F 1A F4 08 DF CD 0B EB C7 17 70   .P;............p
ISAKMP:  E7 15 88 01 2F CD F4 9B F7 44 6E E1 82 FC 2B 65   ..../....Dn...+e
ISAKMP:  A0 90 26 0D 4D C3 57 3C 54 21 21 0F C7 C2 39 6B   ..&.M.W<T!!...9k
ISAKMP:  83 86 3F FF 6D 54 B8 A5 FA AC D8 A6 E4 86 E2 FA   ..?.mT..........
ISAKMP:  31 62 1D D4 AC 8A 2E 26 51 2E 97 D1 00 5C BD DC   1b.....&Q....\..
ISAKMP:  AC CC 87 B8 0A B1 EF 6B 20 58 76 3D 2C 3C B0 DB   .......k Xv=,<..
ISAKMP:  E0 D6 BA 76 3B B6 DA 32 D8 AB 7E EC D0 34 CD E6   ...v;..2..~..4..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  46 A4 77 F2 BE C5 57 70 3D C7 44 13 01 A7 48 E3   F.w...Wp=.D...H.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x18E3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4C 95 7C 6D 50 A0 CC 2E                           L.|mP...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F9 E4 0B 24 95 23 4B 64                           ...$.#Kd
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xF223083E
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4C 95 7C 6D 50 A0 CC 2E F9 E4 0B 24 95 23 4B 64   L.|mP......$.#Kd
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.3: Passed

>> IKE-IPV6-17.4
TEST_DESCRIPTION
The SA payload MUST precede all other payloads in a phase 1 exchange.
If the Next Payload field validation fails, the message is discarded
and the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-PAYLOAD-TYPE message type MAY be sent to the
transmitting entity.
Note: Here we check DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Send <HDR,KE,SA,Ni,IDii>
-  DUT: Notify INVALID-PAYLOAD-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,KE,SA,Ni,IDii> Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xEAD6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7F 38 D0 4F D8 E9 B4 10                           .8.O....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7C 35 66 74 95 DC 5D 23 5B DB B3 83 67 24 E6 F8   |5ft..]#[...g$..
ISAKMP:  88 AC 98 ED B0 AB D1 47 69 1E E4 2F 7C F0 84 B0   .......Gi../|...
ISAKMP:  2E 24 6A 32 3A 0B 39 64 D1 9F BE D0 FD CE 07 19   .$j2:.9d........
ISAKMP:  51 89 3B 0A 98 36 82 46 04 53 BD DC 6D 8A C0 7E   Q.;..6.F.S..m..~
ISAKMP:  CC 3A 7C A8 B3 04 11 38 77 41 E1 F8 45 C7 5C 34   .:|....8wA..E.\4
ISAKMP:  A2 4E FD 05 3E 4C 0B 42 81 F9 AF 81 1A A0 23 79   .N..>L.B......#y
ISAKMP:  31 30 D0 93 84 CE 04 29 4F A3 C4 E0 84 9F 15 9E   10.....)O.......
ISAKMP:  21 73 E6 83 7E 09 24 A4 43 66 E3 05 34 57 8B F3   !s..~.$.Cf..4W..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  76 02 E1 8F F3 9A 01 BC FE 11 87 C0 09 5D 49 A3   v............]I.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0A1D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7F 38 D0 4F D8 E9 B4 10                           .8.O....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  0E 55 0A 88 4E 42 BE 3E                           .U..NB.>
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x83493F7
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  7F 38 D0 4F D8 E9 B4 10 0E 55 0A 88 4E 42 BE 3E   .8.O.....U..NB.>
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Received correct Notify Message ISAKMP_NOTIFY_ERROR_INVALID_PAYLOAD_TYPE from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.4: Passed

>> IKE-IPV6-17.5
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with  a Major Version number
larger than its own and MAY notify INVALID-MAJOR-VERSION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Major Version set to
        DUT_IKE_MAJ_VER + 1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Major Version set to
2 Packet to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x16B9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FE 1E 14 38 65 67 9D 79                           ...8eg.y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DC 16 08 FC B5 B9 35 F0 BC D1 48 F4 DE B2 73 E9   ......5...H...s.
ISAKMP:  F2 01 B7 FA 7F FA 82 B2 FF 4B FD E0 0B 62 91 C8   .........K...b..
ISAKMP:  F9 67 85 DD 78 8B 9B 75 F7 5B BF BD 51 A5 5E 94   .g..x..u.[..Q.^.
ISAKMP:  56 C7 F6 F3 27 4F 4A 74 0A E6 5B 69 B6 E5 B5 9A   V...'OJt..[i....
ISAKMP:  B8 07 E1 22 57 3E 42 27 FE 04 7F BC 26 CD EB 7E   ..."W>B'....&..~
ISAKMP:  DF 2A CF 8C 26 06 E3 DE BC D8 E3 45 7D 41 2B 13   .*..&......E}A+.
ISAKMP:  BD D3 C6 D9 47 AC 53 B8 98 06 3A BA 13 B6 09 43   ....G.S...:....C
ISAKMP:  17 44 BE 01 44 55 F1 DE C5 B7 5E CC 9D F4 E4 8E   .D..DU....^.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DB EA BC 57 73 54 69 57 E9 79 72 47 C3 55 33 BC   ...WsTiW.yrG.U3.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
DOI Specific Use on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 44 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 44 
UDP: Checksum         = 0x56FF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FE 1E 14 38 65 67 9D 79                           ...8eg.y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Invalid Payload
ISAKMP: Major Version            = 2
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 37 (DOI Specific Use)
ISAKMP: Flags                    = 0x20 (32)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 36 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Invalid Payload ----


Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.5: Passed

>> IKE-IPV6-17.7
TEST_DESCRIPTION
IKE SHOULD never accept inbound ISAKMP packets with  a Minor
Version number larger than its own and MAY notify
INVALID-MINOR-VERSION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Minor Version set to
        DUT_IKE_MIN_VER + 1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Minor Version set to 2
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xBCB9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D4 7C 2D 4E B2 DF E3 4F                           .|-N...O
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B6 81 8E 1E EC 12 40 96 60 86 03 8E 4D B3 03 0B   ......@.`...M...
ISAKMP:  64 1D 5A 7F 50 EE 69 60 44 26 FA D4 C0 9F E8 15   d.Z.P.i`D&......
ISAKMP:  EB 43 4E C2 AB BA 06 4F 10 05 6D E2 A5 A6 46 DB   .CN....O..m...F.
ISAKMP:  28 26 0E D0 13 F1 67 2F 75 37 80 A3 6D D4 06 9E   (&....g/u7..m...
ISAKMP:  E6 CC 80 E1 0E 13 7A 37 1C 75 23 47 7D E4 4B D6   ......z7.u#G}.K.
ISAKMP:  D8 43 DF 4C 25 08 04 79 9B 0A 64 FA 88 DC 5A 4D   .C.L%..y..d...ZM
ISAKMP:  0F 3A B7 00 6E 72 AC 11 12 F4 AD 03 56 54 19 D1   .:..nr......VT..
ISAKMP:  75 2D 2C 02 49 12 50 34 7E F5 0A 96 3F 3B 08 ED   u-,.I.P4~...?;..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6A 6F 15 5F A7 10 46 26 C3 09 F2 97 36 9A F4 82   jo._..F&....6...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x1359 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D4 7C 2D 4E B2 DF E3 4F                           .|-N...O
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.7: Passed

>> IKE-IPV6-17.8
TEST_DESCRIPTION
IKE SHOULD never accept ISAKMP packets with  a Minor Version
number larger than its own and MUST notify INVALID-MINOR-VERSION.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.1 p22 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Minor Version set to
        DUT_IKE_MIN_VER + 1
-  DUT: Notify with INVALID-MINOR-VERSION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Minor Version set to 2
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xF8D2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E1 ED 16 1D 4D 40 33 1E                           ....M@3.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6F 4C 29 A2 A8 C2 62 29 73 1E 0D CA 71 7E 5F DA   oL)...b)s...q~_.
ISAKMP:  53 37 7E 6B BF 2E 24 57 1D 30 02 8A BA 81 0F D1   S7~k..$W.0......
ISAKMP:  72 D6 2F C8 3F 6F ED F0 1F B2 60 54 3F A2 C3 7A   r./.?o....`T?..z
ISAKMP:  4A 5D E8 93 99 45 D8 62 27 D6 2C 31 9E 5D 46 62   J]...E.b'.,1.]Fb
ISAKMP:  D0 8B 63 A8 60 55 BA 3D 6E 5C 67 BE FF 16 AB 37   ..c.`U.=n\g....7
ISAKMP:  14 8E D0 13 84 CA 63 63 6B 5C D8 05 74 C6 8D 33   ......cck\..t..3
ISAKMP:  DD EB AC 62 1C A1 A2 88 F8 FC F5 B7 1C 3C A6 BA   ...b.........<..
ISAKMP:  B1 34 93 43 A7 BA D5 D7 8B 19 EB 81 4E 9F 44 6E   .4.C........N.Dn
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  FA 0E AF 83 94 85 60 5D DA 9E 05 A8 0D 00 0B C3   ......`]........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x32EA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E1 ED 16 1D 4D 40 33 1E                           ....M@3.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 2
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 6 (Invalid Minor Version)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Received correct Notify Message ISAKMP_NOTIFY_ERROR_INVALID_MINOR_VERSION from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.8: Passed

>> IKE-IPV6-17.9
TEST_DESCRIPTION
Check the Exchange Type field to confirm it is valid.  If the
Exchange Type field validation fails, the message is discarded
and the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-EXCHANGE-TYPE message type MAY be sent to the
transmitting entity.
Note: This test checks whether DUT discards the packet
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60  ISAKMP Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
        <prm_inv_aggr_exchange>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
<prm_inv_aggr_exchange> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x215D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  97 1A 67 5B 33 D3 F5 5C                           ..g[3..\
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 10 (ISAKMP Future Use)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5C 9C 99 E7 CF D1 80 61 5D 6A 53 43 29 7A F8 3C   \......a]jSC)z.<
ISAKMP:  DC 7A CC 1A 2B 6A 44 DE 60 B6 FB D1 8F A5 F3 5A   .z..+jD.`......Z
ISAKMP:  26 99 BC AE A3 37 05 B7 CB 16 C1 B7 D3 48 45 13   &....7.......HE.
ISAKMP:  FF B7 A1 E2 1E 6C F0 C4 CD 05 01 71 EB F8 8B BC   .....l.....q....
ISAKMP:  5F 72 0B C5 B7 1B 11 43 64 58 BA D6 0C 93 86 FA   _r.....CdX......
ISAKMP:  EC 62 55 9F C9 B4 62 8B D5 8B B7 97 C1 F4 7F 72   .bU...b........r
ISAKMP:  21 AC 9E DD 36 05 4E EE FB AF 83 B0 43 F3 43 EC   !...6.N.....C.C.
ISAKMP:  D4 79 FC 76 70 15 D2 66 6C 58 69 AC 3D F5 77 EB   .y.vp..flXi.=.w.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  91 7D 20 80 E8 CF 20 F1 61 6D F4 1E DE EB EE 80   .} ... .am......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x83AE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  97 1A 67 5B 33 D3 F5 5C                           ..g[3..\
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 7 (Invalid Exchange Type)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.9: Passed

>> IKE-IPV6-17.10
TEST_DESCRIPTION
Check the Exchange Type field to confirm it is valid.  If the
Exchange Type field validation fails, the message is discarded
and the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-EXCHANGE-TYPE message type MAY be sent to the
transmitting entity.
Note: This test checks whether DUT sends a Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60  ISAKMP Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
        <prm_inv_aggr_exchange>
-  DUT: Notify INVALID-EXCHANGE-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Exchange Type set to 
<prm_inv_aggr_exchange> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xD77D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5D 91 28 6A 3C E0 7B 7D                           ].(j<.{}
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 10 (ISAKMP Future Use)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 1 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (! Unknown Attribute for Exchange Type 10)
ISAKMP: SA Attribute Value       = 2 (! Unknown Attribute value)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  51 63 BD 71 DC CB AE 94 24 1B 8B 0F 44 D9 54 9C   Qc.q....$...D.T.
ISAKMP:  00 48 48 8E 1D D2 D5 0A 75 DE 4E 84 DA FE 49 A4   .HH.....u.N...I.
ISAKMP:  A2 A6 C3 35 7F 84 2A 46 99 41 F4 12 C0 61 CA 2F   ...5..*F.A...a./
ISAKMP:  0C DC C9 7C 66 69 17 45 1C E2 40 95 94 8C 55 9C   ...|fi.E..@...U.
ISAKMP:  38 40 E2 50 BF 76 11 E6 2B 3C 05 9E 0C 95 48 DA   8@.P.v..+<....H.
ISAKMP:  81 E9 6A CA 60 C7 68 F4 7E E1 10 03 4F E6 E0 51   ..j.`.h.~...O..Q
ISAKMP:  53 19 D3 81 EE 3E 66 46 52 2D 1B C1 08 6C 31 2A   S....>fFR-...l1*
ISAKMP:  AD EC CB 3D BD 6A 66 DE 61 05 06 EF F0 B1 F3 1E   ...=.jf.a.......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  5F C3 23 C0 FE 78 FB 22 EB CB 8C 05 5F E7 47 B2   _.#..x."...._.G.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x6CFB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  5D 91 28 6A 3C E0 7B 7D                           ].(j<.{}
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 7 (Invalid Exchange Type)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 7

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.10: Passed

>> IKE-IPV6-17.11
TEST_DESCRIPTION
Check the Message ID field to ensure it contains correct values.
If the Message ID validation fails, the message is discarded and
the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-MESSAGE-ID message type MAY be sent to the
transmitting entity.
Note: This test checks whether DUT discards the packet
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
        <prm_inv_ph1_msg_id>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
<prm_inv_ph1_msg_id> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xD18C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9E FE 48 59 58 A6 63 1A                           ..HYX.c.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E1 63 47 CD 96 29 C9 10 63 FF E0 50 0A D2 F1 77   .cG..)..c..P...w
ISAKMP:  72 E9 2C F2 71 46 C9 01 8F C7 94 F0 D9 4A 74 61   r.,.qF.......Jta
ISAKMP:  D4 4D 09 E9 37 B6 C4 A1 37 CF F7 91 13 54 55 25   .M..7...7....TU%
ISAKMP:  69 C8 F0 F5 81 B2 CA C4 E9 D0 C4 0B 60 C3 5D 3E   i...........`.]>
ISAKMP:  D7 F2 FF 32 84 2B 5A 26 3C 97 3C 23 1C 37 24 31   ...2.+Z&<.<#.7$1
ISAKMP:  3A BD F2 4D 70 E6 C0 56 22 3B 5A 80 27 09 C7 4C   :..Mp..V";Z.'..L
ISAKMP:  A3 FE 2C 4A 5B 58 D4 79 EC BA A1 B7 3C 7F C9 39   ..,J[X.y....<..9
ISAKMP:  87 39 92 2F D3 DD ED 8B C7 C6 13 B0 BB 36 C3 51   .9./.........6.Q
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  78 84 0B B2 0B 49 51 FE 9B 5E 24 90 06 33 BE 5F   x....IQ..^$..3._
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x0830 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9E FE 48 59 58 A6 63 1A                           ..HYX.c.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.11: Passed

>> IKE-IPV6-17.12
TEST_DESCRIPTION
Check the Message ID field to ensure it contains correct values.
If the Message ID validation fails, the message is discarded and
the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-MESSAGE-ID message type MAY be sent to the
transmitting entity.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.2 p60 ISAKMP Header Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
        <prm_inv_ph1_msg_id>
-  DUT: Notify INVALID-MESSAGE_ID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Message Id field in HDR set to 
<prm_inv_ph1_msg_id> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x7479 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1A B1 68 16 FB 00 A3 17                           ..h.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  31 82 9D D1 AD A1 84 4D 18 9B E7 C2 0C 06 4E EF   1......M......N.
ISAKMP:  E9 DF D3 F9 81 FD 33 C1 1A D6 7C D0 7C 8A FD DE   ......3...|.|...
ISAKMP:  05 3A 55 C5 B0 CC 86 37 B5 83 89 82 51 98 DC FD   .:U....7....Q...
ISAKMP:  14 6F E8 D9 E3 0E 96 A5 A4 D3 22 A5 F7 12 55 01   .o........"...U.
ISAKMP:  DF 4B 3C 4A DB 69 10 16 AC 02 AE 7D 03 DD AE 27   .K<J.i.....}...'
ISAKMP:  AA 4B 06 94 A1 F1 5E BB 62 94 75 7E 12 03 06 E7   .K....^.b.u~....
ISAKMP:  77 AD EB 9D 86 FB 7F 6E D0 9E A1 0C AB 0E 9B 52   w......n.......R
ISAKMP:  D4 59 61 63 05 0B EE 21 04 D2 2B F7 4B F7 CC 40   .Yac...!..+.K..@
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4E 81 A1 4A 20 2E E2 A0 CC 12 EA 85 E2 02 9F F1   N..J ...........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x8A68 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1A B1 68 16 FB 00 A3 17                           ..h.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 9 (Invalid Message ID)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 9

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.12: Passed

>> IKE-IPV6-17.13
TEST_DESCRIPTION
Length of ISAKMP Header (4 octets) - Length of total message
(header + payloads) in octets.
Note: This test checks that DUT discards the message with
invalid length
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
        (ISAKMP_HLEN+Total length of all payloads)+1 
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
(ISAKMP_HLEN+Total length of all payloads)+1 (249) to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x8A8C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  59 E5 94 17 4A F3 67 18                           Y...J.g.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 249 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A0 62 F8 56 E1 E0 5C 5E A2 34 55 7E C0 C2 11 0F   .b.V..\^.4U~....
ISAKMP:  E4 D3 D4 2E F5 B5 CA B9 7E 4F E8 87 EB 5D 94 1C   ........~O...]..
ISAKMP:  A6 F5 DC 7D 66 F4 6D 5B CF 58 0C F1 01 78 CF DF   ...}f.m[.X...x..
ISAKMP:  99 E2 A9 73 5D 51 DD 28 BB 38 9D AB CD 54 F8 72   ...s]Q.(.8...T.r
ISAKMP:  FB 14 02 CF F2 BC 5B 9C 7C E8 C7 0E 10 42 BE 2F   ......[.|....B./
ISAKMP:  E7 09 54 17 A2 93 61 DF A0 4D 5A DA A6 12 31 1A   ..T...a..MZ...1.
ISAKMP:  E7 31 99 0D 53 AA 39 8F E3 4F 94 93 67 E7 39 A2   .1..S.9..O..g.9.
ISAKMP:  F0 02 F7 77 D9 03 F6 F4 E9 58 7B F4 F8 6A 4E 5B   ...w.....X{..jN[
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A6 04 E0 11 41 4E 39 A2 0B 3D 9C D1 28 43 DD B7   ....AN9..=..(C..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x0B35 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  59 E5 94 17 4A F3 67 18                           Y...J.g.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.13: Passed

>> IKE-IPV6-17.14
TEST_DESCRIPTION
If the ISAKMP message length and the value in the Payload Length
field of the ISAKMP Header are not the same, then
the ISAKMP message MUST be rejected.  The receiving entity (initiator
or responder) MUST do the following:
An Informational Exchange with a Notification payload containing
the UNEQUAL-PAYLOAD-LENGTHS message type MAY be sent to the
transmitting entity.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.1 p25 ISAKMP Header Format
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
        (ISAKMP_HLEN+Total length of all payloads)+1 
-  DUT: Notify UNEQUAL-PAYLOAD-LENGTHS
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Length in the Header set to 
(ISAKMP_HLEN+Total length of all payloads)+1 (249) to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xBC08 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  68 36 D6 62 CE 6B D4 23                           h6.b.k.#
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 249 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  81 4C F6 00 36 EC A2 23 3E 72 3E EE 5A 34 E0 11   .L..6..#>r>.Z4..
ISAKMP:  C8 F4 94 3D D7 05 59 E1 DB 83 9C 3D 5B 24 4A FF   ...=..Y....=[$J.
ISAKMP:  B0 9E D7 19 CD D6 68 D6 4A B1 AE 7D B2 B9 3F B5   ......h.J..}..?.
ISAKMP:  58 A7 93 09 F8 5A 7D A8 97 40 D6 E4 D7 9C A8 6A   X....Z}..@.....j
ISAKMP:  BE 48 85 E8 F9 3B 13 A9 47 E4 41 93 E6 FA E8 1B   .H...;..G.A.....
ISAKMP:  06 B0 69 BD 7D A7 2D 38 8E B3 92 A0 68 F0 5F 5D   ..i.}.-8....h._]
ISAKMP:  86 B3 D3 1F AE 5D AD CF 28 E2 8B C4 D4 1F 72 79   .....]..(.....ry
ISAKMP:  01 05 C8 26 CF E9 7A EF 39 F6 90 5A E5 47 CB 31   ...&..z.9..Z.G.1
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  10 A3 D3 D4 07 94 4F EC FA FC 81 5F 50 BB 33 F9   ......O...._P.3.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xCA14 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  68 36 D6 62 CE 6B D4 23                           h6.b.k.#
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 30

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.14: Passed

>> IKE-IPV6-17.15
TEST_DESCRIPTION
If the Next Payload field validation fails, the message is discarded
and the following actions are taken:
An Informational Exchange with a Notification payload containing
the INVALID-PAYLOAD-TYPE message type MAY be sent to the
transmitting entity.
if NP field of the SA Payload contains Proposal or Transform Payloads.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s3.1 p22 ISAKMP Header Format
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the NP field of SA Payload to <NP>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
- CASE: <NP> = Proposal (2)
- CASE: <NP> = Transform (3)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Next Payload of SA Payload is Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 2 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x97BD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  50 19 79 68 65 DE BF 69                           P.yhe..i
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x27FE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  50 19 79 68 65 DE BF 69                           P.yhe..i
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  BD 6A 07 E1 03 E4 B3 DC                           .j......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x76C4339B
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  50 19 79 68 65 DE BF 69 BD 6A 07 E1 03 E4 B3 DC   P.yhe..i.j......
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Next Payload of SA Payload is Transform Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 3 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x183A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  74 FA C4 7D 13 48 B5 7E                           t..}.H.~
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6E28 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  74 FA C4 7D 13 48 B5 7E                           t..}.H.~
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  38 81 65 CF 60 69 7D 3A                           8.e.`i}:
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD06D6F0D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  74 FA C4 7D 13 48 B5 7E 38 81 65 CF 60 69 7D 3A   t..}.H.~8.e.`i}:
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.15: Passed

>> IKE-IPV6-17.16
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP packet if NP field 
of the SA Payload contains Proposal or Transform Payloads.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s3.1 p22 ISAKMP Header Format
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the NP field of SA Payload to <NP>
-  DUT: Notify INVALID-PAYLOAD-TYPE
- CASE: <NP> = Proposal (2)
- CASE: <NP> = Transform (3)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Next Payload of SA Payload is Proposal Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 2 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xB703 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F4 E2 61 5B 2D 08 62 5D                           ..a[-.b]
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0CB8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F4 E2 61 5B 2D 08 62 5D                           ..a[-.b]
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FA A5 64 57 84 F4 62 43                           ..dW..bC
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6476E129
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  F4 E2 61 5B 2D 08 62 5D FA A5 64 57 84 F4 62 43   ..a[-.b]..dW..bC
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Next Payload of SA Payload is Transform Payload

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms with the NP field of SA Payload to 3 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x16D4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FE E7 D3 6E C9 F8 7C 30                           ...n..|0
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF2DD (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FE E7 D3 6E C9 F8 7C 30                           ...n..|0
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  3F 15 27 71 EF 97 9E E7                           ?.'q....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x5F7B3CA5
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  FE E7 D3 6E C9 F8 7C 30 3F 15 27 71 EF 97 9E E7   ...n..|0?.'q....
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.16: Passed

>> IKE-IPV6-17.17
TEST_DESCRIPTION
Determine if the Domain of Interpretation (DOI) is supported.  If
the DOI determination fails, the message is discarded and the
following actions are taken:
An Informational Exchange with a Notification payload
containing the DOI-NOT-SUPPORTED message type MAY be sent to
the transmitting entity.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s5.4 p62 Security Association Payload Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to 
        <prm_inv_ph1_doi>    
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to
<prm_inv_ph1_doi> 10 to DUT 2000::5
from interface 2000::1
!Invalid Domain of Interpretation received 10
!Invalid Domain of Interpretation received 10

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xB7C3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  50 C0 BA 38 D0 5A EF 38                           P..8.Z.8
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 10
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2D 36 B7 CA 2F 8B C7 AC AA 03 E9 1F DA 6E FE E5   -6../........n..
ISAKMP:  9F E5 97 78 D9 64 50 FC 0C 0D 19 FB F3 BA A5 A9   ...x.dP.........
ISAKMP:  77 C8 52 2C F7 C1 2E 1B 7D E7 D3 97 E9 8C 46 56   w.R,....}.....FV
ISAKMP:  89 75 D0 EB 21 0C A2 F5 EB 89 74 38 CD CA 27 4E   .u..!.....t8..'N
ISAKMP:  2C AE E1 97 DF 9D B3 66 64 56 7D 9A 73 A9 96 D9   ,......fdV}.s...
ISAKMP:  B6 A9 08 5D 04 67 B8 B6 14 B9 8C B1 5F 76 69 66   ...].g......_vif
ISAKMP:  48 32 A9 77 79 B1 EC 84 62 20 06 85 95 AB 1C 88   H2.wy...b ......
ISAKMP:  A8 36 2D 52 84 08 F7 41 FB 8F 88 90 47 07 E3 E9   .6-R...A....G...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  78 8D 38 D7 B3 24 0F 68 32 89 9F 03 9D 2D DC A8   x.8..$.h2....-..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD400 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  50 C0 BA 38 D0 5A EF 38                           P..8.Z.8
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  5D 8B 72 24 AE 26 D5 EF                           ].r$.&..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x86511311
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 2 (DOI Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  50 C0 BA 38 D0 5A EF 38 5D 8B 72 24 AE 26 D5 EF   P..8.Z.8].r$.&..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.17: Passed

>> IKE-IPV6-17.18
TEST_DESCRIPTION
Determine if the Domain of Interpretation (DOI) is supported.  If
the DOI determination fails, the message is discarded and the
following actions are taken:
An Informational Exchange with a Notification payload
containing the DOI-NOT-SUPPORTED message type MAY be sent to
the transmitting entity.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.4 p27 Security Association Payload
          RFC 2408 s5.4 p62 Security Association Payload Processing
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to 
        <prm_inv_ph1_doi>    
-  DUT: Notify DOI-NOT-SUPPORTED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with DOI field of SA Payload set to
<prm_inv_ph1_doi> 10 to DUT 2000::5
from interface 2000::1
!Invalid Domain of Interpretation received 10
!Invalid Domain of Interpretation received 10

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x8598 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FD EA 19 26 06 74 7F 27                           ...&.t.'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 10
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2A 9F D1 7F 8D 66 EF D7 BD 00 9E A8 6E AC DE 72   *....f......n..r
ISAKMP:  E3 9C 89 2A 0F E6 C0 5E 8D 9A 3E 68 14 DF 20 E3   ...*...^..>h.. .
ISAKMP:  BD 24 30 ED 81 70 64 B5 C2 95 60 DB BB 26 EC A8   .$0..pd...`..&..
ISAKMP:  E5 D0 8F 72 AE B9 17 8E 73 54 A8 04 2B 3E 72 0F   ...r....sT..+>r.
ISAKMP:  52 3F B4 D5 9A 2A 17 4D C0 85 48 E7 8F 57 21 D5   R?...*.M..H..W!.
ISAKMP:  75 AB A8 C2 D8 66 C3 AD 8F 25 D3 61 1B 26 43 27   u....f...%.a.&C'
ISAKMP:  4A C8 38 25 F9 CF B0 7E B2 70 7D DC B4 32 62 A6   J.8%...~.p}..2b.
ISAKMP:  4E 3C 18 0B 47 85 06 C4 A9 0A 24 8D 67 75 A4 10   N<..G.....$.gu..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E0 D9 56 8A FA 6F 91 27 55 36 44 39 B9 94 59 48   ..V..o.'U6D9..YH
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF8BB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FD EA 19 26 06 74 7F 27                           ...&.t.'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D7 C0 A6 B3 51 21 5A EB                           ....Q!Z.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x8077A27A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 2 (DOI Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  FD EA 19 26 06 74 7F 27 D7 C0 A6 B3 51 21 5A EB   ...&.t.'....Q!Z.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 2

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.18: Passed

>> IKE-IPV6-17.19
TEST_DESCRIPTION
Determine if the given situation can be protected.  If the
Situation determination fails, the message is discarded and the
following actions are taken:
An Informational Exchange with a Notification payload
containing the SITUATION-NOT-SUPPORTED message type MAY be
sent to the transmitting entity.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.2 p3 IPSEC Situation Definition
          RFC 2408 s5.4 p62 Security Association Payload Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Situation field
        set to <Situation>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
- CASE: <Situation> = 0x00
- CASE: <Situation> = 0x03
- CASE: <Situation> = 0x05
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Situation of SA Payload is set to 0x00

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x9896 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  15 C4 4E 00 D1 4A E6 41                           ..N..J.A
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 00                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6E E4 68 46 66 1E 5C 63 F4 D1 4D CD 7A B2 E2 6F   n.hFf.\c..M.z..o
ISAKMP:  1E 4C 33 76 39 A5 D9 D8 FC 05 66 14 11 86 82 6F   .L3v9.....f....o
ISAKMP:  20 29 8A 50 12 E4 53 DC 81 66 BD 41 4B CA 03 81    ).P..S..f.AK...
ISAKMP:  D3 DE F5 DE 3F DA C6 7C 2F 06 4F A6 BC 23 31 59   ....?..|/.O..#1Y
ISAKMP:  B7 49 7B C0 DC 23 C5 E8 62 8B 36 15 5F E3 36 F1   .I{..#..b.6._.6.
ISAKMP:  DA 48 F2 E9 94 DF 1B D3 8F C2 86 68 B8 69 92 EC   .H.........h.i..
ISAKMP:  9C 63 E1 15 6F 80 E4 F4 13 FB 42 D5 1E C8 5F 76   .c..o.....B..._v
ISAKMP:  3D B2 A9 D6 A8 12 F6 2F AB CA 9C 56 0B 93 0F 96   =....../...V....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6C BD D6 8E 95 F5 8A 11 1A 53 29 9E 7A E2 BC 88   l........S).z...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xBE74 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  15 C4 4E 00 D1 4A E6 41                           ..N..J.A
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  61 3E 8C 83 CB ED 47 DE                           a>....G.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xFF84B250
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  15 C4 4E 00 D1 4A E6 41 61 3E 8C 83 CB ED 47 DE   ..N..J.Aa>....G.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Situation of SA Payload is set to 0x03

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xF11E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3F 50 A0 09 33 55 E5 4A                           ?P..3U.J
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 03                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  99 EB DD 1A 8E 58 56 B8 60 F8 A0 E2 C7 A8 E7 2C   .....XV.`......,
ISAKMP:  4E 51 4C D7 97 87 89 95 D2 1B 26 48 72 D1 B5 9D   NQL.......&Hr...
ISAKMP:  E7 81 1A DA DF 4F 24 00 68 35 0A 65 41 B1 F2 3F   .....O$.h5.eA..?
ISAKMP:  20 AA B3 40 34 3B 59 0A 77 57 37 26 D9 62 82 6F    ..@4;Y.wW7&.b.o
ISAKMP:  A5 E0 48 C1 DD F9 C4 32 3E B4 25 97 1B CA 68 7D   ..H....2>.%...h}
ISAKMP:  4C 84 44 02 CD BB CD 86 03 16 A9 9A AC E4 12 40   L.D............@
ISAKMP:  E3 8C 1C 88 95 62 E7 DA 78 F3 18 6A D4 69 EA B9   .....b..x..j.i..
ISAKMP:  B8 A1 44 CB 6D DA 9B A9 2E 27 4B B4 F4 B0 C3 8A   ..D.m....'K.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7E 67 15 1B 25 ED 62 45 A8 89 5D F8 D3 F9 7E 06   ~g..%.bE..]...~.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6154 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3F 50 A0 09 33 55 E5 4A                           ?P..3U.J
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7C 95 6D F5 97 88 40 33                           |.m...@3
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x9FEB3447
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  3F 50 A0 09 33 55 E5 4A 7C 95 6D F5 97 88 40 33   ?P..3U.J|.m...@3
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Situation of SA Payload is set to 0x05

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xD175 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7A 03 32 0F 00 64 52 62                           z.2..dRb
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 05                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F7 B6 6E 2E 82 E4 83 C9 22 6A 1A F2 43 BA 84 18   ..n....."j..C...
ISAKMP:  8A 3C D1 AA 44 DD 7F F0 F6 5F 44 81 1D 62 64 9E   .<..D...._D..bd.
ISAKMP:  7E 2C 3C 16 49 C7 E7 2F A6 58 02 34 91 4A 44 9F   ~,<.I../.X.4.JD.
ISAKMP:  64 51 A3 51 17 1F A9 3A B0 26 55 51 14 D7 FD 88   dQ.Q...:.&UQ....
ISAKMP:  24 EA ED E3 8F D1 5B 65 E3 E6 86 C0 72 89 9F 01   $.....[e....r...
ISAKMP:  50 FE B9 41 7A F6 94 48 11 3E 1B 78 C7 0A F2 DF   P..Az..H.>.x....
ISAKMP:  2E B4 87 28 16 38 51 B7 7E 1B B5 B8 4F 79 5E 5D   ...(.8Q.~...Oy^]
ISAKMP:  C2 D1 57 88 30 96 40 82 88 83 15 0C A4 C5 A0 33   ..W.0.@........3
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 2F 05 F4 A8 3B C3 6A A2 46 99 62 FB F2 D9 65   ./...;.j.F.b...e
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xDD45 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7A 03 32 0F 00 64 52 62                           z.2..dRb
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  BF 37 3B BB B0 59 A5 CF                           .7;..Y..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD0445C93
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  7A 03 32 0F 00 64 52 62 BF 37 3B BB B0 59 A5 CF   z.2..dRb.7;..Y..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.19: Passed

>> IKE-IPV6-17.20
TEST_DESCRIPTION
Determine if the given situation can be protected.  If the
Situation determination fails, the message is discarded and the
following actions are taken:
An Informational Exchange with a Notification payload
containing the SITUATION-NOT-SUPPORTED message type MAY be
sent to the transmitting entity.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.2 p3 IPSEC Situation Definition
          RFC 2408 s5.4 p62 Security Association Payload Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Situation field set to
        <Situation>
-  DUT: Notify SITUATION-NOT-SUPPORTED
- CASE: <Situation> = 0x00
- CASE: <Situation> = 0x03
- CASE: <Situation> = 0x05
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Situation of SA Payload is set to 0x00

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x725C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  96 D1 65 78 91 5D 07 79                           ..ex.].y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 00                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  97 51 B5 22 E4 58 12 6C 5B CF 24 A9 F6 07 B9 D6   .Q.".X.l[.$.....
ISAKMP:  DF 27 F4 3C 95 DB 6A B3 21 25 8C 01 6B 5B 41 59   .'.<..j.!%..k[AY
ISAKMP:  CC 00 95 83 76 A2 10 68 88 BE 52 02 A8 3F AB 85   ....v..h..R..?..
ISAKMP:  04 91 62 D9 E7 27 F6 0A 0D D6 B8 9B E1 FD B5 20   ..b..'......... 
ISAKMP:  CA 22 5E A4 41 E3 D8 60 12 44 E5 BB 8A 40 57 6E   ."^.A..`.D...@Wn
ISAKMP:  5C 4E 4E 17 60 07 01 16 E6 F1 79 D6 85 80 AD F0   \NN.`.....y.....
ISAKMP:  49 98 3C 09 CC 91 DD 98 9C 5E 8F E0 98 7D D2 8D   I.<......^...}..
ISAKMP:  A3 05 5C A5 A7 19 7A 06 C5 77 06 E3 F8 82 CC D9   ..\...z..w......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  27 F5 B1 15 13 E1 88 18 1B F1 34 11 7C 3A 9D 57   '.........4.|:.W
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3E42 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  96 D1 65 78 91 5D 07 79                           ..ex.].y
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  53 09 C1 83 DF 27 64 28                           S....'d(
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA6A3EB26
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  96 D1 65 78 91 5D 07 79 53 09 C1 83 DF 27 64 28   ..ex.].yS....'d(
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 3

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Situation of SA Payload is set to 0x03

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xC0D3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7A DC BA 3E 7B 50 68 7F                           z..>{Ph.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 03                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  7C B7 D7 BF 9D C5 C7 68 C3 F3 42 44 1F C8 95 CA   |......h..BD....
ISAKMP:  2E 2B E4 33 23 62 23 26 25 3B 86 ED 9F 9E AA F2   .+.3#b#&%;......
ISAKMP:  88 C2 4E 8F 24 CE 5C A5 49 5C 22 71 5D 01 B5 42   ..N.$.\.I\"q]..B
ISAKMP:  AA D4 13 6C 73 99 69 C4 F7 FF D0 94 15 13 36 09   ...ls.i.......6.
ISAKMP:  EA 95 16 C2 F8 5D 52 A7 28 62 AF 08 41 BD 64 E5   .....]R.(b..A.d.
ISAKMP:  70 B9 4F E1 E5 F3 EA 8C 4D 5E 1A D5 DD AC B4 CC   p.O.....M^......
ISAKMP:  65 C7 18 E1 30 C5 05 0E 72 DD AB 1E 5B 94 3C 14   e...0...r...[.<.
ISAKMP:  FC AA 95 83 1F DB 70 55 6C A5 72 29 27 D4 6D 59   ......pUl.r)'.mY
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  5D 3B B6 D3 DE 92 74 66 5A BF 70 E9 5C EE 6B 7F   ];....tfZ.p.\.k.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x39BA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7A DC BA 3E 7B 50 68 7F                           z..>{Ph.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  0E 52 4B E8 ED 49 68 13                           .RK..Ih.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x825B5CED
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  7A DC BA 3E 7B 50 68 7F 0E 52 4B E8 ED 49 68 13   z..>{Ph..RK..Ih.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 3

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Situation of SA Payload is set to 0x05

Sending <HDR,SA,KE,Ni,IDii> with the Situation field
set to <Situation>  to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xB143 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE 5A 25 29 41 D5 57 6A                           .Z%)A.Wj
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 05                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  87 64 B6 BF 7C 6C 80 87 6F 73 41 47 B1 67 36 F1   .d..|l..osAG.g6.
ISAKMP:  72 69 94 04 07 65 9A B1 BC C0 33 0C FB 64 D5 36   ri...e....3..d.6
ISAKMP:  21 1F 54 AB C0 76 2E 02 FC 47 90 A1 6E 1D 0D 56   !.T..v...G..n..V
ISAKMP:  30 3D 8C D2 94 7A 4D AB B1 8F F7 F3 97 8C 19 BA   0=...zM.........
ISAKMP:  DE A3 94 CD A7 20 A7 58 C0 07 FD 6F 1A 3F 0C 16   ..... .X...o.?..
ISAKMP:  D6 7B BE 4C 1C 93 AD 94 51 0C 79 7C C3 F9 D2 CF   .{.L....Q.y|....
ISAKMP:  74 30 67 10 AD BD 86 B4 64 3B CB 7C 08 77 64 FB   t0g.....d;.|.wd.
ISAKMP:  43 85 43 EE 8B AE A2 66 9B A4 8A 71 02 EC DD A0   C.C....f...q....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DC E1 41 83 E4 73 28 F2 07 E7 FC FF A8 8D EC BE   ..A..s(.........
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xC2C3 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CE 5A 25 29 41 D5 57 6A                           .Z%)A.Wj
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  6C 99 8C 5A 75 EA 77 1F                           l..Zu.w.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xB9A7481A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 3 (Situation Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  CE 5A 25 29 41 D5 57 6A 6C 99 8C 5A 75 EA 77 1F   .Z%)A.Wjl..Zu.w.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 3

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.20: Passed

>> IKE-IPV6-17.21
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing only
one Proposal Payload if NP field is not 0 and MAY notify
INVALID-PAYLOAD-TYPE.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.5 p28 Proposal Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal.
        Set the NP field of Proposal Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal
with the NP field of Proposal Payload to 1
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xB441 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  82 E3 65 30 68 76 A7 3B                           ..e0hv.;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4F C3 A9 F7 B1 D2 45 01 FC 95 76 17 FD 36 E3 D8   O.....E...v..6..
ISAKMP:  BB E5 58 16 66 61 CE C4 84 4D B2 86 94 33 31 AD   ..X.fa...M...31.
ISAKMP:  A2 4D 7B 47 53 9F 71 29 DF A0 06 BF 70 47 D4 C7   .M{GS.q)....pG..
ISAKMP:  C1 D4 A1 B2 A6 F7 9E BD E2 50 24 30 65 12 8E 0D   .........P$0e...
ISAKMP:  0A 1E 2E 04 44 ED B1 CC 86 93 5C 86 FA 8B E9 41   ....D.....\....A
ISAKMP:  25 2C 8F 30 3D 78 09 B3 2D 22 3D D3 C0 14 74 0B   %,.0=x..-"=...t.
ISAKMP:  EF A7 97 95 B5 71 1F 05 E3 77 2D 08 95 CA 12 AB   .....q...w-.....
ISAKMP:  49 A7 FE B0 30 65 7E 67 FC 26 B3 F2 67 1C D3 D0   I...0e~g.&..g...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6F EB F9 9C 51 81 8F 42 BB 23 BE 00 E7 21 5D 27   o...Q..B.#...!]'
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x4396 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  82 E3 65 30 68 76 A7 3B                           ..e0hv.;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D5 02 1E 28 F8 4C 10 E4                           ...(.L..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x9DB6E079
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  82 E3 65 30 68 76 A7 3B D5 02 1E 28 F8 4C 10 E4   ..e0hv.;...(.L..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.21: Passed

>> IKE-IPV6-17.22
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP packet containing only one Proposal Payload if NP field is not 0.
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.5 p28 Proposal Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal.
        Set the NP field of Proposal Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Notify INVALID-PAYLOAD-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal
with the NP field of Proposal Payload to 1
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xA950 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  82 B5 95 52 F5 36 66 54                           ...R.6fT
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  84 AA 67 DB 64 14 01 AF 91 79 41 D4 1A B4 E9 71   ..g.d....yA....q
ISAKMP:  36 7A C5 81 79 6C 29 3D 66 BF 8C 2A 2C 92 CC 95   6z..yl)=f..*,...
ISAKMP:  52 36 42 B3 26 E5 E3 27 60 F4 77 51 81 D4 9C FC   R6B.&..'`.wQ....
ISAKMP:  1B 9B 9B FA D5 4D 2D 0C E1 F8 E0 E7 F0 E5 71 E1   .....M-.......q.
ISAKMP:  9E 60 F5 B5 3F F4 6A 9A 76 4B 62 2F 4C 8C 61 5E   .`..?.j.vKb/L.a^
ISAKMP:  31 0E E1 1F 6D B6 70 31 87 0D 38 F9 66 6F 1B F0   1...m.p1..8.fo..
ISAKMP:  03 8E 03 54 CA 65 60 30 59 7C 04 37 D3 18 62 1D   ...T.e`0Y|.7..b.
ISAKMP:  63 D2 A8 24 1E 00 88 62 95 16 1D CC A3 25 06 B7   c..$...b.....%..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  76 85 77 D9 15 8E E4 4A 3C C4 3A 32 F9 EB 0A AD   v.w....J<.:2....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x92B9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  82 B5 95 52 F5 36 66 54                           ...R.6fT
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  2B 73 CB C3 31 6D 3E F3                           +s..1m>.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE6497AB1
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  82 B5 95 52 F5 36 66 54 2B 73 CB C3 31 6D 3E F3   ...R.6fT+s..1m>.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.22: Passed

>> IKE-IPV6-17.23
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing a
Proposal Payload 
with Payload Length not equal to (PROPL_HLEN+Total length of all
Transforms).
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
        Payload set to 
        (PROPL_HLEN+Total length of all the Transform Payloads) + 1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
Payload set to (PROPL_HLEN+Total length of all the Transform
Payloads) + 1 (33) to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x0FEE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F8 0A A0 3A 73 B4 C9 7A                           ...:s..z
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 33 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  8A CF 8F 84 1E CA 8B 56 22 D9 6C 88 C5 FE 79 DF   .......V".l...y.
ISAKMP:  09 10 3A 91 2A 20 26 F6 30 53 67 93 86 F3 BA 31   ..:.* &.0Sg....1
ISAKMP:  17 2A BB BB 3C 45 B7 3E 8C 01 F2 3F FD 41 F2 98   .*..<E.>...?.A..
ISAKMP:  86 26 91 2E 60 DC 49 AD BC F1 23 8E 56 C3 AD 4B   .&..`.I...#.V..K
ISAKMP:  83 AB 78 22 34 65 59 0E 50 D5 25 A1 00 5C DD 11   ..x"4eY.P.%..\..
ISAKMP:  93 A1 E6 C1 C0 47 7E F7 FA 03 65 C2 34 94 4C D1   .....G~...e.4.L.
ISAKMP:  DA 16 ED 4A AD 6E 33 3E 46 6E D9 4A 2B FD BA B5   ...J.n3>Fn.J+...
ISAKMP:  A4 41 F3 0E 26 A4 63 8A 1C 3D 0C 34 A7 07 56 1E   .A..&.c..=.4..V.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  CA A4 4F C7 79 B5 83 6F C3 01 0D 68 6E 3C F1 3A   ..O.y..o...hn<.:
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x0B7B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F8 0A A0 3A 73 B4 C9 7A                           ...:s..z
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  56 9F 8F D0 BD AE 58 D5                           V.....X.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6883911D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  F8 0A A0 3A 73 B4 C9 7A 56 9F 8F D0 BD AE 58 D5   ...:s..zV.....X.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.23: Passed

>> IKE-IPV6-17.24
TEST_DESCRIPTION
IKE MUST notify UNEQUAL-PAYLOAD-LENGTHS for an incoming ISAKMP packet with Proposal Payload Length not equal to
(PROPL_HLEN+Total length of all Transforms)
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
        Payload set to 
        (PROPL_HLEN+Total length of all the Transform Payloads)+1
-  DUT: Notify UNEQUAL-PAYLOAD-LENGTHS
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with Payload Length in Proposal
Payload set to (PROPL_HLEN+Total length of all the Transform
Payloads) + 1 (33) to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xF344 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  39 75 91 0D 10 64 BA 4E                           9u...d.N
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 33 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9B FE 19 34 53 4B 6D 8F 78 9A 4E 67 A6 9E C4 A6   ...4SKm.x.Ng....
ISAKMP:  8D 48 50 76 ED 3C E0 59 A8 C2 C9 CF 2F 99 28 68   .HPv.<.Y..../.(h
ISAKMP:  74 05 27 79 D6 ED 91 FE 81 97 3F 70 D6 22 66 37   t.'y......?p."f7
ISAKMP:  7F 7C 94 D3 3F DD DE DA F6 AF AC ED 19 61 39 B6   .|..?........a9.
ISAKMP:  9A A4 F6 0F 84 83 92 C8 69 0B 14 40 E0 36 F3 70   ........i..@.6.p
ISAKMP:  1C 91 8E FB 12 A3 6C 4A 54 66 4C 95 FA EE E9 A2   ......lJTfL.....
ISAKMP:  5C D1 E2 F3 37 89 89 DE 7E BA ED 93 A2 E0 93 EA   \...7...~.......
ISAKMP:  E1 66 36 89 BD 8D C5 03 00 96 4F 48 09 4B 4F 0C   .f6.......OH.KO.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E5 87 23 DD 48 F5 AA 66 44 7C FF 2C 4D 4D 86 D2   ..#.H..fD|.,MM..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD06A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  39 75 91 0D 10 64 BA 4E                           9u...d.N
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  62 12 8C 17 69 BC 67 95                           b...i.g.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x906F9FB0
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  39 75 91 0D 10 64 BA 4E 62 12 8C 17 69 BC 67 95   9u...d.Nb...i.g.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 30

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.24: Passed

>> IKE-IPV6-17.25
TEST_DESCRIPTION
Determine if the Protocol is supported.  If the Protocol-ID field
is invalid, the payload is discarded and the following actions
are taken:
An Informational Exchange with a Notification payload
containing the INVALID-PROTOCOL-ID message type MAY be sent
to the transmitting entity.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.5 p63 Proposal Payload Processing
          RFC 2407 s4.1 p6  IPSEC Security Protocol Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Protocol-Id field in
        the Proposal
        Payload set to <prm_inv_ph1_proto_id>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with the Protocol-Id field in the Proposal Payload set to <prm_inv_ph1_proto_id> 10
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x3F49 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D8 55 98 54 5C 55 1A 15                           .U.T\U..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 10 (!Unknown Protocol)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  66 B2 6B BF 22 D1 A0 30 D6 3F B2 55 3C BE BD 66   f.k."..0.?.U<..f
ISAKMP:  10 78 F0 9E 9B 52 B8 F4 47 92 4A 57 89 B3 36 85   .x...R..G.JW..6.
ISAKMP:  F2 8F 86 EB F1 E2 48 ED FD CE 1B C4 4F 9A 45 76   ......H.....O.Ev
ISAKMP:  A5 0B 3D 76 49 D1 F7 73 44 E0 BD 61 6E C5 BD BF   ..=vI..sD..an...
ISAKMP:  3E 0B 8E 78 A5 1B 83 D6 DE EF A4 43 2D 3D 8A D3   >..x.......C-=..
ISAKMP:  39 BE 11 05 61 47 9C AA D3 CE E3 08 5A 32 9F 03   9...aG......Z2..
ISAKMP:  68 7E AF FD BE 08 98 81 97 9A A9 D9 60 1A 42 CE   h~..........`.B.
ISAKMP:  FB 5A C5 86 DB 69 EC 06 3F FB B0 FA 77 38 1A B6   .Z...i..?...w8..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B8 36 42 F9 AE A2 9B B7 89 2B 67 06 13 6D 09 F3   .6B......+g..m..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3ADB (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D8 55 98 54 5C 55 1A 15                           .U.T\U..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  81 B9 E6 44 86 80 2F 1F                           ...D../.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x93CAD1F5
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 10 (Invalid Protocol ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  D8 55 98 54 5C 55 1A 15 81 B9 E6 44 86 80 2F 1F   .U.T\U.....D../.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.25: Passed

>> IKE-IPV6-17.26
TEST_DESCRIPTION
Determine if the Protocol is supported.  If the Protocol-ID field
is invalid, the payload is discarded and the following actions
are taken:
An Informational Exchange with a Notification payload
containing the INVALID-PROTOCOL-ID message type MAY be sent
to the transmitting entity.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.5 p63 Proposal Payload Processing
          RFC 2407 s4.1 p6  IPSEC Security Protocol Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the Protocol-Id field in the
        Proposal
        Payload set to <prm_inv_ph1_proto_id> 
-  DUT: Notify INVALID-PROTOCOL-ID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with the Protocol-Id field 10
in the Proposal to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x6306 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7D 6A 20 4A 72 D4 E8 4A                           }j Jr..J
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 10 (!Unknown Protocol)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3A D5 6C 99 90 E2 FB 2F 0D 07 D0 1C A5 C5 37 47   :.l..../......7G
ISAKMP:  F3 BF CC AE 2C BC 4A 39 B1 2D DA AB A7 41 3E 17   ....,.J9.-...A>.
ISAKMP:  5B A1 A0 91 51 C0 A6 0F 30 29 E8 E7 2A 81 44 F9   [...Q...0)..*.D.
ISAKMP:  9E 11 C9 26 BE E9 20 F0 69 60 1A EF 9C E4 96 57   ...&.. .i`.....W
ISAKMP:  7C 39 B3 EB E6 55 7F 32 53 38 4B 25 FF 50 8B 2E   |9...U.2S8K%.P..
ISAKMP:  AC 1A 6C F8 89 FA CE 22 90 18 A3 FA DB 82 2A 7F   ..l...."......*.
ISAKMP:  59 6E B4 90 6E AF 27 47 1E A5 CB 0A 64 03 7D F7   Yn..n.'G....d.}.
ISAKMP:  7E 4D 9A 61 02 A3 B9 43 52 E1 5E 61 42 C3 B9 32   ~M.a...CR.^aB..2
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A 68 15 DA 7B 63 CB C1 35 5B 9C 85 18 AE 3C 39   *h..{c..5[....<9
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3180 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  7D 6A 20 4A 72 D4 E8 4A                           }j Jr..J
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9C 57 1D EA EC F8 41 AF                           .W....A.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x315083B5
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 10 (Invalid Protocol ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  7D 6A 20 4A 72 D4 E8 4A 9C 57 1D EA EC F8 41 AF   }j Jr..J.W....A.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 10

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.26: Passed

>> IKE-IPV6-17.27
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing one
Transform Payload if the value of NP field is not 0 and MAY
notify INVALID-PAYLOAD-TYPE. 
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Transform.
        Set the NP field of Transform Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Do not send <HDR,SA,KE,Nr,IDir, HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Transform
with the NP field of Transform Payload to 1
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xA57D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  79 6A BE 37 55 DB DF 38                           yj.7U..8
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  1E D3 D3 64 B0 31 65 92 60 C0 31 04 CB 39 F3 FA   ...d.1e.`.1..9..
ISAKMP:  67 D0 55 2D A5 46 3B 5F 19 60 35 F9 0E DD 10 1A   g.U-.F;_.`5.....
ISAKMP:  6E 55 0C D6 EF A3 1B 34 83 DC ED 72 95 FA 8B F9   nU.....4...r....
ISAKMP:  3B 4B 6B DE 2C FF F9 7B BB E5 34 74 03 1F 2A FF   ;Kk.,..{..4t..*.
ISAKMP:  24 02 8C B9 55 73 A2 1B F2 48 77 AE 10 FB FD 74   $...Us...Hw....t
ISAKMP:  E6 BB 56 85 9C DA D8 1E 9B B2 31 68 8B F1 05 CB   ..V.......1h....
ISAKMP:  49 E1 B0 D6 5C 05 5B 68 1D EC EB 3A 7A 4A 52 83   I...\.[h...:zJR.
ISAKMP:  1B 4D 31 C3 D1 BE 3A CB 67 C8 CA 1E EA 67 57 A3   .M1...:.g....gW.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A4 0A 22 03 0D 03 21 9E 3C 4D 39 85 A4 39 63 1F   .."...!.<M9..9c.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x2D59 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  79 6A BE 37 55 DB DF 38                           yj.7U..8
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C8 78 96 73 A4 12 57 6A                           .x.s..Wj
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x62788BF9
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  79 6A BE 37 55 DB DF 38 C8 78 96 73 A4 12 57 6A   yj.7U..8.x.s..Wj
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.27: Passed

>> IKE-IPV6-17.28
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP
packet containing one Transform Payload if the value of NP field
is not 0.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Transform.
        Set the NP field of Transform Payload to NON_ZERO_VAL (e.g. 10)
-  DUT: Notify INVALID-PAYLOAD-TYPE
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Transform
with the NP field of Transform Payload to 1
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x7387 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BE 38 50 59 49 4B E8 2C                           .8PYIK.,
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  1B FE C9 79 F7 AD 68 5F 4D E6 D8 E2 0B 31 FC A8   ...y..h_M....1..
ISAKMP:  E7 38 E8 3B 68 DF 2C 55 DA 40 D7 AA 4B 49 03 1B   .8.;h.,U.@..KI..
ISAKMP:  06 87 C2 E3 C1 38 51 E0 87 B0 79 B2 00 7E 97 5C   .....8Q...y..~.\
ISAKMP:  69 A5 55 40 84 EB 9B CD 78 C7 AB 50 BD D6 FC BF   i.U@....x..P....
ISAKMP:  90 C9 D2 3C 26 26 19 5D 77 64 8C DE D9 19 F4 60   ...<&&.]wd.....`
ISAKMP:  77 C8 AF A4 1D 2C 51 84 26 1C 2A E3 3E A4 3F 0F   w....,Q.&.*.>.?.
ISAKMP:  8C 01 41 9B 10 DE FC BA 0F 25 DE B8 A3 38 9A E7   ..A......%...8..
ISAKMP:  37 9F 94 1C 25 BB 2E 67 25 F9 81 6E 69 B2 7C 60   7...%..g%..ni.|`
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  32 D6 9E 1A 73 B0 CB 26 30 B7 F5 DB 40 BD B0 47   2...s..&0...@..G
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x2E9D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BE 38 50 59 49 4B E8 2C                           .8PYIK.,
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  41 36 89 90 0D B2 88 45                           A6.....E
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x61D2D809
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  BE 38 50 59 49 4B E8 2C 41 36 89 90 0D B2 88 45   .8PYIK.,A6.....E
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-17.28: Passed

>> IKE-IPV6-18.1
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet with two Transforms,if
NP of first Transform is not 3 or NP of second is not 0 and MAY
notify INVALID-PAYLOAD-TYPE.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a 
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
        Set the NP field of first Transform to <NP1> and that of
        second Transform to <NP2>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <NP1> = 0, <NP2> = 0
- CASE: <NP1> = 1, <NP2> = 1
- CASE: <NP1> = 3, <NP2> = 2
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Next Payload of first Transform Payload is
set to 0 and Next Payload of second Transform Payload
is se to 0

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 0 and that of
second Transform to 0 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xEE50 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 4F 5F 16 B4 4B FE 17                           .O_..K..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B7 94 FA 99 98 FD 26 B2 66 0A 07 B7 B4 EA F9 D0   ......&.f.......
ISAKMP:  D0 D3 F9 44 4E 33 8C 1E 44 A7 84 A9 81 62 97 90   ...DN3..D....b..
ISAKMP:  F6 BA 62 56 2F D1 8B ED B5 E5 B9 D0 3F B8 4B E9   ..bV/.......?.K.
ISAKMP:  3F 69 D5 EB B5 F6 0B 70 A0 FE A8 7F 4B FD D2 97   ?i.....p....K...
ISAKMP:  DD AD 89 E5 CD D5 82 24 9B 9C 26 40 FE 19 65 75   .......$..&@..eu
ISAKMP:  A4 47 E1 F9 30 68 89 BB 70 31 A0 75 C3 16 0F 8A   .G..0h..p1.u....
ISAKMP:  38 E4 3A 51 FC E9 AE EF 3A 39 6F 8B 20 72 80 BD   8.:Q....:9o. r..
ISAKMP:  64 CB 79 33 C4 F6 0E 91 FB 64 30 85 A2 B3 64 5E   d.y3.....d0...d^
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7D 28 82 A0 47 CD B1 03 6B 6F DC 54 D8 D2 D2 A8   }(..G...ko.T....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xA0E0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D5 4F 5F 16 B4 4B FE 17                           .O_..K..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  99 D1 40 6E 35 E0 76 D8                           ..@n5.v.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xC718668C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  D5 4F 5F 16 B4 4B FE 17 99 D1 40 6E 35 E0 76 D8   .O_..K....@n5.v.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Next Payload of first Transform Payload is
set to 1 and Next Payload of second Transform Payload
is se to 1

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 1 and that of
second Transform to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xF06C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FA 6A 31 6D 9E 55 94 6D                           .j1m.U.m
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  08 E1 1E BE C5 35 85 7A 52 DE 73 0C D2 EB 7F 89   .....5.zR.s.....
ISAKMP:  21 35 7B E6 3A F8 64 99 77 04 66 42 12 9B 34 1B   !5{.:.d.w.fB..4.
ISAKMP:  58 9E 03 61 A5 AF B9 92 59 DB B3 87 7A C5 11 86   X..a....Y...z...
ISAKMP:  0E C1 39 35 B0 ED 32 73 A1 45 8D D1 07 20 8C 33   ..95..2s.E... .3
ISAKMP:  73 29 2B 46 95 1A 00 05 5E 30 D5 7E 4C 31 AF 16   s)+F....^0.~L1..
ISAKMP:  0B F0 E8 A2 DA 43 FF A9 50 08 4A 3A 3B 17 44 91   .....C..P.J:;.D.
ISAKMP:  3A E0 AF DC 8E D1 7F C2 90 76 85 EB 16 F1 B7 34   :........v.....4
ISAKMP:  D0 53 A2 FA 1C 2D C5 55 2E E2 EE 2D 7E 63 0A 84   .S...-.U...-~c..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  0F F0 A8 B0 0A 0E 3D 92 50 ED 89 B3 8D 01 69 97   ......=.P.....i.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xFA8B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  FA 6A 31 6D 9E 55 94 6D                           .j1m.U.m
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  45 E1 A9 C6 CD BE 84 D1                           E.......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD8C9950D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  FA 6A 31 6D 9E 55 94 6D 45 E1 A9 C6 CD BE 84 D1   .j1m.U.mE.......
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Next Payload of first Transform Payload is
set to 3 and Next Payload of second Transform Payload
is se to 2

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 3 and that of
second Transform to 2 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x6593 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BD 2C 54 23 A2 E8 34 64                           .,T#..4d
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D4 42 4F A5 28 EA D8 E4 8E 9C 26 12 44 CB E9 6A   .BO.(.....&.D..j
ISAKMP:  79 ED CB BD 23 7F C0 96 CB 86 8B 34 FD B4 29 3C   y...#......4..)<
ISAKMP:  37 3A 0F 23 11 21 79 CA BF 0D 90 E5 30 29 9B 80   7:.#.!y.....0)..
ISAKMP:  73 04 F2 9C 6D BE E4 0B 00 9A A8 89 A0 5D 45 71   s...m........]Eq
ISAKMP:  BA A2 53 5C F5 B1 74 6B C4 6B 69 65 27 2C C6 51   ..S\..tk.kie',.Q
ISAKMP:  11 A8 B4 9B B3 79 35 20 F6 41 87 68 AD DA 21 4A   .....y5 .A.h..!J
ISAKMP:  3C DB 96 38 B4 42 CF 5A 85 36 1D C7 15 31 FE 8B   <..8.B.Z.6...1..
ISAKMP:  C9 D4 28 3F 68 F5 76 A9 9D 70 83 D1 19 B5 2B 64   ..(?h.v..p....+d
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B9 68 E7 06 7A 9E E6 FA F5 0D 0F 23 00 5C 62 7C   .h..z......#.\b|
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD802 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  BD 2C 54 23 A2 E8 34 64                           .,T#..4d
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  AA 92 35 B5 C3 F3 09 F0                           ..5.....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x842F2047
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  BD 2C 54 23 A2 E8 34 64 AA 92 35 B5 C3 F3 09 F0   .,T#..4d..5.....
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.1: Passed

>> IKE-IPV6-18.2
TEST_DESCRIPTION
IKE MUST notify INVALID-PAYLOAD-TYPE for an incoming ISAKMP
packet with two Transforms,if NP of first Transform is not 3 or
NP of second is not 0.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s3.6 p30 Transform Payload
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the NP 
        field of first Transform to <NP1> and that of second
        Transform to <NP2>
-  DUT: Notify INVALID-PAYLOAD-TYPE
- CASE: <NP1> = 0, <NP2> = 0
- CASE: <NP1> = 1, <NP2> = 1
- CASE: <NP1> = 3, <NP2> = 2
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Next Payload of first Transform Payload is
set to 0 and Next Payload of second Transform Payload is set
to 0

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 0 and that of
second Transform to 0 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x870E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  75 55 71 47 95 FE 7E 08                           uUqG..~.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  FB 3F CC 9C 45 CD 85 AE 94 25 70 DA 06 46 AC 5C   .?..E....%p..F.\
ISAKMP:  AD 51 41 F4 9E 19 22 9F EC 72 65 06 F0 B0 27 5A   .QA..."..re...'Z
ISAKMP:  D2 6A 74 FA 79 E4 C0 E8 E4 83 00 8C BC 18 49 B7   .jt.y.........I.
ISAKMP:  8F FB 32 BA 81 48 F1 A3 F0 3F C2 91 CD 00 07 25   ..2..H...?.....%
ISAKMP:  BD D2 29 11 D3 B2 3A D0 3B 79 51 44 08 B2 17 BD   ..)...:.;yQD....
ISAKMP:  4B 34 6F 93 28 CE 91 EB D8 A1 FF C2 4C 08 FE 1F   K4o.(.......L...
ISAKMP:  CE CF 88 D4 AB 99 7D 47 B5 57 84 5C F1 24 DB FE   ......}G.W.\.$..
ISAKMP:  0D 73 FE 7B 76 96 F1 8C C7 A9 6B 5F A0 4D 65 AE   .s.{v.....k_.Me.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  02 E9 34 90 D6 01 C2 C8 9C B7 F2 43 A4 3D F1 B1   ..4........C.=..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x488E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  75 55 71 47 95 FE 7E 08                           uUqG..~.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B4 D6 2D D4 96 32 81 B9                           ..-..2..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x1F3057D6
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  75 55 71 47 95 FE 7E 08 B4 D6 2D D4 96 32 81 B9   uUqG..~...-..2..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Next Payload of first Transform Payload is
set to 1 and Next Payload of second Transform Payload is set
to 1

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 1 and that of
second Transform to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x7791 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A4 40 40 66 D6 58 ED 27                           .@@f.X.'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  57 7F 13 87 65 53 56 94 E4 8D 98 91 26 40 B0 33   W...eSV.....&@.3
ISAKMP:  EE BF 34 76 07 E2 A7 31 97 22 51 77 70 E6 4D 5B   ..4v...1."Qwp.M[
ISAKMP:  BF A2 A7 77 1E 80 1C E9 00 80 79 53 A7 50 71 12   ...w......yS.Pq.
ISAKMP:  ED 59 60 C4 F0 F1 00 AE 22 CE 8E C4 0C 8D 24 02   .Y`.....".....$.
ISAKMP:  39 53 6B DC 1A 48 BE 61 03 D9 EE D2 1E CF AE 2F   9Sk..H.a......./
ISAKMP:  1E 0C 25 16 5F D1 40 5B EC 32 1D AD 4E 59 23 EF   ..%._.@[.2..NY#.
ISAKMP:  7F C6 3E E4 6E 0B DF 0F AE 4B 4B 68 5B 6B EE 00   ..>.n....KKh[k..
ISAKMP:  BD 17 8D 92 DA CE 18 EA A0 B7 F3 F5 73 9F 2D 31   ............s.-1
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  87 F9 A6 43 5C 1F 56 E0 64 32 9D BF EE 5F D6 D6   ...C\.V.d2..._..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x54F9 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A4 40 40 66 D6 58 ED 27                           .@@f.X.'
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  09 56 05 5E 7B F7 20 3B                           .V.^{. ;
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x529C5C58
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A4 40 40 66 D6 58 ED 27 09 56 05 5E 7B F7 20 3B   .@@f.X.'.V.^{. ;
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Next Payload of first Transform Payload is
set to 3 and Next Payload of second Transform Payload is set
to 2

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two Transforms.
Set the NP field of first Transform to 3 and that of
second Transform to 2 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xD110 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A7 15 40 12 5A C0 BF 53                           ..@.Z..S
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 2
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5F A5 91 74 80 80 E8 64 2A 75 12 D3 72 88 89 CE   _..t...d*u..r...
ISAKMP:  4D 2D A0 E8 C3 BB A6 BD 34 77 71 EE F9 B7 8E 49   M-......4wq....I
ISAKMP:  C8 85 56 0D 57 FB 5C B3 BF 5C 67 D9 93 3C 21 3B   ..V.W.\..\g..<!;
ISAKMP:  B6 A7 17 95 4A EB AE FA C9 E1 24 D8 26 A2 62 35   ....J.....$.&.b5
ISAKMP:  44 B8 AF EA 0E 88 01 68 56 71 7A A7 11 0E 7C 5F   D......hVqz...|_
ISAKMP:  B1 12 D9 13 51 ED 61 9B 05 16 2B DB 60 A1 EA A9   ....Q.a...+.`...
ISAKMP:  0F 94 CA 2A 2F C8 AC A9 7B DD F7 E9 E0 74 0D 24   ...*/...{....t.$
ISAKMP:  20 0D 8A 6E 4A 60 B1 13 34 2B 57 30 63 4C 7F 70    ..nJ`..4+W0cL.p
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  31 25 A4 EF D1 5B E1 A7 C0 16 66 24 A7 0E F4 9C   1%...[....f$....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x4FD1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A7 15 40 12 5A C0 BF 53                           ..@.Z..S
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C5 B6 AC 8F F3 68 62 35                           .....hb5
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x55B8723F
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 1 (Invalid Payload Type)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A7 15 40 12 5A C0 BF 53 C5 B6 AC 8F F3 68 62 35   ..@.Z..S.....hb5
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.2: Passed

>> IKE-IPV6-18.3
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing a
Transform with its Payload length not equal to(TRANS_HLEN+Total
length of all SA Attributes).
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.6 p29 Transform Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload
        containing one Transform Payload. Set Payload Length
        of Transform Payload equal to (TRANS_HLEN+Total length
        of all SA Attributes)+1
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload
containing one Transform Payload with Payload Length
of Transform Payload equal to (TRANS_HLEN+Total length
of all SA Attributes)+1 25 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x2D15 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD 2A FE 4C 77 AB 29 4E                           .*.Lw.)N
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 25 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C5 79 A6 D3 4B AD 41 9C CC 14 19 B0 00 0D B0 27   .y..K.A........'
ISAKMP:  CE 6B 18 70 66 03 30 01 57 30 01 D1 2D 7C DD 68   .k.pf.0.W0..-|.h
ISAKMP:  2E 0F C2 93 55 24 87 D9 93 CC B4 0D 6A 48 FC 4F   ....U$......jH.O
ISAKMP:  B6 20 BE BD 79 87 75 EF 2A 24 E2 FA 5E 09 B6 E8   . ..y.u.*$..^...
ISAKMP:  C1 C5 00 45 20 94 23 83 3D 1D B9 29 76 3C 08 D6   ...E .#.=..)v<..
ISAKMP:  CC 05 FF 68 44 5E AF 53 80 FE C6 DC D6 00 DE B8   ...hD^.S........
ISAKMP:  2E 66 F4 93 1D E1 91 FE EE AF A1 C0 AD 72 C9 69   .f...........r.i
ISAKMP:  E8 89 28 50 4E 84 4A D3 A1 E3 39 CF A1 73 C1 DF   ..(PN.J...9..s..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  FF D3 F6 61 A5 AC 70 AF 79 2A 0F 5C D6 EC F3 D8   ...a..p.y*.\....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x5D8A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD 2A FE 4C 77 AB 29 4E                           .*.Lw.)N
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  13 F2 9F 85 D7 66 8A D6                           .....f..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xCCF85B1D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  DD 2A FE 4C 77 AB 29 4E 13 F2 9F 85 D7 66 8A D6   .*.Lw.)N.....f..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.3: Passed

>> IKE-IPV6-18.4
TEST_DESCRIPTION
IKE MUST notify UNEQUAL-PAYLOAD-LENGTHS for an incoming packet
with Transform
Payload length not equal to(TRANS_HLEN+Total length of all SA Attributes).
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.1 p58 General Message Processing
          RFC 2408 s3.6 p29 Transform Payload
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal Payload
        containing one Transform Payload. Set Payload Length
        of Transform Payload equal to (TRANS_HLEN+Total length of
        all SA Attributes)+1
-  DUT: Notify UNEQUAL-PAYLOAD-LENGTHS
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal Payload
containing one Transform Payload with Payload Length
of Transform Payload equal to (TRANS_HLEN+Total length
of all SA Attributes)+1 25 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x853F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D9 07 A2 48 32 0C CE 08                           ...H2...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 25 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9E 46 C6 91 17 E6 7F D4 5B 23 63 A9 CC 61 C7 F2   .F......[#c..a..
ISAKMP:  00 29 3C AF D4 E9 14 56 DB 07 DF EE A1 BF 74 BE   .)<....V......t.
ISAKMP:  BE 03 9D CB DD F7 F0 B9 6F 24 8A 2A 8D 46 23 64   ........o$.*.F#d
ISAKMP:  D9 9A 7D 45 8F 85 95 20 52 60 40 93 7C 6E CB 1E   ..}E... R`@.|n..
ISAKMP:  F7 DD 75 99 84 EB 4E 6F 54 46 13 BE 85 1F BA BE   ..u...NoTF......
ISAKMP:  77 15 75 BB 13 1E A3 CE CA 4F 1B EC 45 12 8A 9B   w.u......O..E...
ISAKMP:  19 9B B2 AE E4 E5 6E C4 E7 FD 0C 95 09 42 81 74   ......n......B.t
ISAKMP:  D7 94 69 8E 75 F4 46 C9 26 E9 B8 96 5C 76 8C 47   ..i.u.F.&...\v.G
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  FA FF 2B EF 8B 43 53 3C F7 B6 7F FA 2E 36 B1 4E   ..+..CS<.....6.N
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xFE19 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D9 07 A2 48 32 0C CE 08                           ...H2...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D1 4D E6 10 E4 EF 96 CA                           .M......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6FE8DEED
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  D9 07 A2 48 32 0C CE 08 D1 4D E6 10 E4 EF 96 CA   ...H2....M......
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly received Notify Message 30

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.4: Passed

>> IKE-IPV6-18.5
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with 2 Transforms not
containing monotonic Transform number and MAY notify
INVALID-TRANSFORM-ID.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s4.2 p47 Security Association Establishment
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and two
        Transforms. Set the Transform number of first to 1 and that of
        second to <Transform>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <Transform> = 0
- CASE: <Transform> = 3
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Transform Number of first Transform Payload is
set to 1 and Transform Number of second Transform
Payload is set to 0

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms containing Transform number of first to 1 and that of
 second to 0 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0x91FA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EB 9A DD 0D A3 FA 09 4F                           .......O
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 0
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F9 18 1F D9 5B CB B3 01 BF E5 FF 4E CF AC A7 81   ....[......N....
ISAKMP:  F3 99 47 20 AA 37 12 44 BB F6 95 FF 3D 3A F9 1B   ..G .7.D....=:..
ISAKMP:  95 E2 1C 4F 38 D8 C1 3C A9 32 B4 7A 2F 95 02 97   ...O8..<.2.z/...
ISAKMP:  75 AD 93 A7 BD B9 F4 68 67 8F DE 50 4E B2 C7 F0   u......hg..PN...
ISAKMP:  A5 53 8C BB 4E 6C 48 9F 89 A5 DE C9 97 71 4F AC   .S..NlH......qO.
ISAKMP:  6D C0 9C F1 16 9D A5 A0 79 78 B5 9A 16 36 F5 66   m.......yx...6.f
ISAKMP:  0C 61 FB BD 13 4A 3A E8 F4 AC F7 39 EF 5C FD E3   .a...J:....9.\..
ISAKMP:  0B 40 EF D1 79 4F 3A AF B6 5B 19 97 C1 85 41 98   .@..yO:..[....A.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  10 7D B7 5C A7 78 C3 8A C9 EF 08 52 D2 E2 95 91   .}.\.x.....R....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF1BE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  EB 9A DD 0D A3 FA 09 4F                           .......O
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9B 53 7B 07 2F 09 DF 4C                           .S{./..L
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD534ADC0
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  EB 9A DD 0D A3 FA 09 4F 9B 53 7B 07 2F 09 DF 4C   .......O.S{./..L
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Transform Number of first Transform Payload is
set to 1 and Transform Number of second Transform
Payload is set to 3

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms containing Transform number of first to 1 and that of
 second to 3 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xBBAE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E6 4C 99 32 BF 11 91 73                           .L.2...s
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 3
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9E C9 F7 E9 0C 30 45 43 D6 7E 55 0C 34 CF 0A 08   .....0EC.~U.4...
ISAKMP:  30 D4 AB 49 A2 9A 1D D5 72 BC EC 18 99 E6 F7 04   0..I....r.......
ISAKMP:  CA 72 23 20 03 8A 16 02 8B A6 3E 41 15 51 61 4D   .r# ......>A.QaM
ISAKMP:  07 FF 02 6E F7 8F 5C 85 A9 0F DB EA 2E 84 1B B7   ...n..\.........
ISAKMP:  44 35 8E 1E BB AF 64 1E B8 BE BD 49 F8 99 37 48   D5....d....I..7H
ISAKMP:  94 ED 5D 46 4A A1 F4 5E 1E 31 3C 67 C5 6B 8D A9   ..]FJ..^.1<g.k..
ISAKMP:  9E BA 75 1E 26 4A F6 F5 66 A8 D8 16 0D B7 91 F0   ..u.&J..f.......
ISAKMP:  DD DA B6 7B CE 70 24 A4 64 D2 58 29 E0 4F BB 75   ...{.p$.d.X).O.u
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7C DB 4D 9B 9C 72 07 89 F7 B7 53 FB C1 85 AD F3   |.M..r....S.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF994 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  E6 4C 99 32 BF 11 91 73                           .L.2...s
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  9E 3C 4A 4A E4 4A BB 41                           .<JJ.J.A
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x23C5DC70
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  E6 4C 99 32 BF 11 91 73 9E 3C 4A 4A E4 4A BB 41   .L.2...s.<JJ.J.A
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Transform Number of first Transform Payload is
set to 1 and Transform Number of second Transform
Payload is set to 3

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and two
Transforms containing Transform number of first to 1 and that of
 second to 3 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 280 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 280 
UDP: Checksum         = 0xC87B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  13 3B 42 55 7B 06 3E 16                           .;BU{.>.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 272 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 56 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 2
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Transform Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 3
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  48 34 E0 0B 8E E9 A9 D1 5F 1E 62 1C 1A 58 0E 2D   H4......_.b..X.-
ISAKMP:  F8 AD 8F 4E E2 CB 3F 5A F2 CE 84 1E 18 8F ED E8   ...N..?Z........
ISAKMP:  A7 63 47 0E 45 DD A8 46 0F 0B 2F 04 A9 F9 17 36   .cG.E..F../....6
ISAKMP:  A1 FB 07 9C 63 4E 62 19 BE E7 D6 A8 07 A0 C1 8F   ....cNb.........
ISAKMP:  71 8C 2A 64 95 F7 88 12 DF 83 EF 9A 04 02 C9 27   q.*d...........'
ISAKMP:  3B 18 EE B2 0D C3 EB 98 97 DD 49 90 A1 64 E2 78   ;.........I..d.x
ISAKMP:  68 DA 58 80 5F E2 67 8D 3E 5A B9 5F 83 D7 51 E8   h.X._.g.>Z._..Q.
ISAKMP:  33 E4 05 4B 52 EF 49 CB 67 5C 2C 53 03 63 61 EF   3..KR.I.g\,S.ca.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  BD B9 5D E3 49 75 C7 8A 7A 87 C5 3B 9F 90 6D 4B   ..].Iu..z..;..mK
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x7634 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  13 3B 42 55 7B 06 3E 16                           .;BU{.>.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  B8 C9 C2 35 47 40 03 F9                           ...5G@..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xC161C899
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  13 3B 42 55 7B 06 3E 16 B8 C9 C2 35 47 40 03 F9   .;BU{.>....5G@..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.5: Passed

>> IKE-IPV6-18.7
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with a Proposal
containing a 
Transform-Id not supported by the Protocol and MAY notify
INVALID-TRANSFORM-ID.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.6 p64 Transform Payload Processing
          RFC 2407 s4.2 p7  IPSEC ISAKMP Transform Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal with the
        protocol-Id as PROTO_ISAKMP and one Transform. Set the
        Transform-Id to <prm_inv_ph1_trans_id> 
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal with the
protocol-Id as PROTO_ISAKMP and one Transform containing
Transform-Id 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x1654 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3D 77 1C 61 DC EF BB 60                           =w.a...`
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 10 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  4D F3 D9 A9 98 ED 25 FE 6F 8D B6 A1 47 70 7F EA   M.....%.o...Gp..
ISAKMP:  60 3B 7F 51 93 58 91 52 71 09 4E B7 6A 77 BF 2E   `;.Q.X.Rq.N.jw..
ISAKMP:  0F AE 48 76 12 44 9F 30 72 CB 06 CA BC 72 F5 A3   ..Hv.D.0r....r..
ISAKMP:  8C 86 70 2E 35 17 3A D9 B9 03 26 51 76 9F AD A8   ..p.5.:...&Qv...
ISAKMP:  74 7B A0 C4 FA 8F 27 D9 B3 DB 14 40 B3 F8 8C 44   t{....'....@...D
ISAKMP:  51 3C 3A 59 3B 43 78 A0 52 B8 D0 21 2A F1 91 41   Q<:Y;Cx.R..!*..A
ISAKMP:  5D 18 DD 90 DA 08 90 B1 99 54 34 52 EA 40 59 74   ]........T4R.@Yt
ISAKMP:  14 AC 50 1D 51 CE FB CE 09 2C 17 E0 FF 8A DD 24   ..P.Q....,.....$
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  3D 45 3A 2A 28 F6 EF 12 CD 56 9A 70 E7 43 63 19   =E:*(....V.p.Cc.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE587 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  3D 77 1C 61 DC EF BB 60                           =w.a...`
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  BA 63 8C 68 DC F0 82 55                           .c.h...U
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7D1E16E2
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 12 (Invalid Transform ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  3D 77 1C 61 DC EF BB 60 BA 63 8C 68 DC F0 82 55   =w.a...`.c.h...U
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.7: Passed

>> IKE-IPV6-18.8
TEST_DESCRIPTION
IKE MUST notify INVALID-TRANSFORM-ID for an incoming ISAKMP packet with a 
Proposal containing a Transform-Id not supported by the Protocol.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.6 p64 Transform Payload Processing
          RFC 2407 s4.2 p7  IPSEC ISAKMP Transform Identifier
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal with the
        protocol-Id as PROTO_ISAKMP and one Transform. Set the
        Transform-Id to <prm_inv_ph1_trans_id> 
-  DUT: Notify INVALID-TRANSFORM-ID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal with the
protocol-Id as PROTO_ISAKMP and one Transform containing
Transform-Id 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xA094 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD 9C A1 1E 9F 15 11 5F                           ......._
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 10 (! Unknown Transform)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A1 54 40 08 8B E7 B1 66 72 0E EA 17 61 87 E6 F3   .T@....fr...a...
ISAKMP:  CB 36 67 B3 BD B4 2E 92 4B 30 C7 4D A8 63 28 39   .6g.....K0.M.c(9
ISAKMP:  E9 52 69 22 5B 68 F3 54 E7 AF C9 83 C6 9C 16 32   .Ri"[h.T.......2
ISAKMP:  55 3E D7 12 1C 87 43 DC DE A1 71 63 F2 C5 2E 8F   U>....C...qc....
ISAKMP:  8C 65 95 CA 05 6F 4A 4B 9F AB 20 A7 D7 66 E1 FC   .e...oJK.. ..f..
ISAKMP:  DA EA 4C 6F FB 67 0B C8 DB 59 BD B3 2F 27 E0 D3   ..Lo.g...Y../'..
ISAKMP:  35 9D 70 FD 06 7D 31 1C 02 33 3B 26 74 A9 34 8B   5.p..}1..3;&t.4.
ISAKMP:  0C 9E 41 78 6A B2 E7 A5 67 1B 26 A3 0B A3 60 79   ..Axj...g.&...`y
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  C5 73 1C E0 A5 A7 19 C3 B2 0B D6 88 70 3F F7 4A   .s..........p?.J
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x4D03 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DD 9C A1 1E 9F 15 11 5F                           ......._
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  48 2D B8 A9 33 5F 74 70                           H-..3_tp
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x525F5AEF
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 12 (Invalid Transform ID)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  DD 9C A1 1E 9F 15 11 5F 48 2D B8 A9 33 5F 74 70   ......._H-..3_tp
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 12

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.8: Passed

>> IKE-IPV6-18.9
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet with a Transform
Payload containing SA Attribute not supported by DOI and MAY notify
ATTRIBUTES-NOT-SUPPORTED.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.6 p64 Transform Payload Processing
          RFC 2409 App. A p64 Attribute Classes
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with one Proposal and one
        Transform. Set the Protocol-Id to PROTO_ISAKMP and
        Transform-Id as KEY_IKE containing an 
        SA Attribute with Attribute Class <prm_inv_attrib_class>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with one Proposal and one
Transform containing Protocol-Id to PROTO_ISAKMP and
Transform-Id as KEY_IKE, containing an 
SA Attribute with Attribute Class 20 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 255 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 255 
UDP: Checksum         = 0x3E52 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C5 11 97 79 A9 A9 A4 28                           ...y...(
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 247 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 20 (! Unknown Attribute)
ISAKMP: SA Attribute Value       = 2 (! Unknown Value)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  9F AA 1E 5A B5 67 75 99 8F 5A 9A 7B F7 BA 06 64   ...Z.gu..Z.{...d
ISAKMP:  8F 47 8D 00 FF B8 28 F7 4D 73 9E C1 D6 8A 8F 74   .G....(.Ms.....t
ISAKMP:  9A 1C 40 0D 3E CF 51 30 AA 73 C7 44 F3 7B F2 5C   ..@.>.Q0.s.D.{.\
ISAKMP:  6B B2 A1 AA 80 AF 31 EE 80 EE F0 04 B8 EF 41 26   k.....1.......A&
ISAKMP:  31 8A 2E C4 F7 99 72 53 F5 4B 7A A7 03 AB FD 78   1.....rS.Kz....x
ISAKMP:  A8 B9 CA 06 65 DA 80 FB 1F 9B 27 4E A0 88 B3 D8   ....e.....'N....
ISAKMP:  AC 6F E5 5B AE 59 CF EF 84 0B 41 9E DE 80 F2 D2   .o.[.Y....A.....
ISAKMP:  A3 A8 50 70 84 0B 70 53 61 20 C7 2F 06 3C CD 17   ..Pp..pSa ./.<..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 19 bytes
ISAKMP: --- Nonce Data [15 bytes] ---
ISAKMP:  18 7E 92 58 35 54 1F F8 CA 76 15 CE B8 50 AE      .~.X5T...v...P.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xAB65 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  C5 11 97 79 A9 A9 A4 28                           ...y...(
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  63 14 11 72 B0 8F FE 5A                           c..r...Z
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x58380AC2
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  C5 11 97 79 A9 A9 A4 28 63 14 11 72 B0 8F FE 5A   ...y...(c..r...Z
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.9: Passed

>> IKE-IPV6-18.12
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet containing
multiple instances of 
same Attribute class and MAY notify ATTRIBUTE-NOT-SUPPORTED.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.5.2 p15, p16 Attribute Parsing Requirement
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
        SA Life type 
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
SA Life type to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 264 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 264 
UDP: Checksum         = 0x798E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2C 85 F2 02 CA 39 4E 04                           ,....9N.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 256 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 2 (Kilobytes)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  5F C2 E2 4D 83 8B D6 B8 65 33 FA 6D EC C8 56 6E   _..M....e3.m..Vn
ISAKMP:  6D 4C A9 66 5F 28 E4 41 FF E9 84 DF 1B 69 56 56   mL.f_(.A.....iVV
ISAKMP:  B4 7C C8 9D 48 0B B3 C6 3D 92 38 71 32 70 81 1D   .|..H...=.8q2p..
ISAKMP:  2F CF 4D CC 4E B2 FC B0 CE 56 9B 6B 8F 4B FC BD   /.M.N....V.k.K..
ISAKMP:  01 1F 04 2A 6A EF 77 35 90 C1 19 68 88 B3 AE E5   ...*j.w5...h....
ISAKMP:  A9 EB 49 CF 4F FF 6F 8F 77 F7 63 3F D4 87 94 BE   ..I.O.o.w.c?....
ISAKMP:  2B 47 AE 94 0D 97 C9 F8 C1 05 EA 57 2F B8 8E 74   +G.........W/..t
ISAKMP:  2B 07 39 03 1B C0 E7 E8 07 CA 95 A3 13 05 E0 EB   +.9.............
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  46 59 2C CE 73 FC D5 86 52 CE 03 7C F1 42 FB D4   FY,.s...R..|.B..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x767B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2C 85 F2 02 CA 39 4E 04                           ,....9N.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  2E EA A4 5F FC ED A0 84                           ..._....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD9B20ACB
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 13 (Attributes Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  2C 85 F2 02 CA 39 4E 04 2E EA A4 5F FC ED A0 84   ,....9N...._....
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.12: Passed

>> IKE-IPV6-18.13
TEST_DESCRIPTION
IKE MUST notify ATTRIBUTE-NOT-SUPPORTED for an incoming ISAKMP packet 
containing multiple instances of same Attribute class. 
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s4.5.2 p15, p16 Attribute Parsing Requirement
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
        SA Life type 
-  DUT: Notify ATTRIBUTE-NOT-SUPPORTED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with two SA  Attributes of class
SA Life type to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 264 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 264 
UDP: Checksum         = 0x3C5A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1D 1B B8 61 BE 15 42 22                           ...a..B"
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 256 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 2 (Kilobytes)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  99 DC 5F 74 E6 A9 EB A9 25 54 87 56 0C 85 48 74   .._t....%T.V..Ht
ISAKMP:  58 1D FA F6 31 20 D8 51 CD 3E 1B A2 2A 0A B3 6D   X...1 .Q.>..*..m
ISAKMP:  D8 9A 10 D8 D7 5A 41 80 16 99 26 94 5E DD 06 58   .....ZA...&.^..X
ISAKMP:  40 2D FB 3E 76 4C 41 87 61 B3 FD A3 30 F1 A7 7E   @-.>vLA.a...0..~
ISAKMP:  FE 45 A9 3B 19 4E AE AB 71 F2 93 D3 F0 D3 22 0D   .E.;.N..q.....".
ISAKMP:  5F FA 00 39 4F F6 02 D0 B9 10 11 7C F8 78 62 73   _..9O......|.xbs
ISAKMP:  15 E2 56 49 FE 36 20 17 F2 AC 7B 80 E5 6E 14 53   ..VI.6 ...{..n.S
ISAKMP:  D7 D8 19 5E 9A DB E2 6F 0E F0 F0 DB BE 4B 6A 5F   ...^...o.....Kj_
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B2 A4 4A 65 C5 70 4E BE 6D 2B 1D 6E 6E E1 AF E2   ..Je.pN.m+.nn...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x4682 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  1D 1B B8 61 BE 15 42 22                           ...a..B"
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  3F AA 4D C5 BE 79 25 92                           ?.M..y%.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xCA060B15
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 13 (Attributes Not Supported)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  1D 1B B8 61 BE 15 42 22 3F AA 4D C5 BE 79 25 92   ...a..B"?.M..y%.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 13

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.13: Passed

>> IKE-IPV6-18.14
TEST_DESCRIPTION
There MUST not be multiple Proposal Payloads for a single SA Payload
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p9 Exchanges
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with 2 Proposals
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with 2 Proposals to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x200A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  75 AE C4 0C 1A 62 02 0D                           u....b..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 2
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AE 6F FE 1E 58 7B C4 68 B1 A6 A8 3A FF AC C3 28   .o..X{.h...:...(
ISAKMP:  ED FC 5C 9F 05 B0 2A 24 BB 16 53 29 04 6A 34 49   ..\...*$..S).j4I
ISAKMP:  89 B4 69 D1 7F 4E 0C 66 3C 4B F1 55 83 20 93 5A   ..i..N.f<K.U. .Z
ISAKMP:  82 A3 0C 56 53 B9 CC 89 4A 8C A8 46 44 12 94 C3   ...VS...J..FD...
ISAKMP:  5D 35 3F 59 10 D6 58 1E 2D E1 B6 15 C5 98 AC 2E   ]5?Y..X.-.......
ISAKMP:  63 D5 2B 23 8E AE 3A F2 F8 4B 7D 00 E1 A4 27 3C   c.+#..:..K}...'<
ISAKMP:  9A 18 41 48 EC F3 04 0B 5D 0F 52 0C A4 64 C9 FB   ..AH....].R..d..
ISAKMP:  27 AF 43 3C 17 F8 01 4D 88 74 A8 70 EC 66 12 69   '.C<...M.t.p.f.i
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  61 1B CF E5 26 80 75 E0 46 B6 FB 90 86 E5 AE A3   a...&.u.F.......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x357D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  75 AE C4 0C 1A 62 02 0D                           u....b..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E3 61 A3 D5 6C 43 B6 93                           .a..lC..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x8D0AE701
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  75 AE C4 0C 1A 62 02 0D E3 61 A3 D5 6C 43 B6 93   u....b...a..lC..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.14: Passed

>> IKE-IPV6-18.15
TEST_DESCRIPTION
There MUST not be multiple Proposal Payloads for a single SA Payload
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p9 Exchanges
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with 2 Proposals
-  DUT: Notify PAYLOAD-MALFORMED
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> with 2 Proposals to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 288 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 288 
UDP: Checksum         = 0x1A16 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A7 13 95 59 D3 59 F9 1A                           ...Y.Y..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 280 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 76 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Proposal Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:

ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 2
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2D FF 1D DD 22 7A F7 3D 04 A2 B0 B0 31 F9 1F 87   -..."z.=....1...
ISAKMP:  F9 42 8A 42 C5 D1 28 AA EF 61 DF CD BE 44 E5 15   .B.B..(..a...D..
ISAKMP:  67 9C 25 31 52 17 C3 37 2B BB EA 4E 6E CF 2D A6   g.%1R..7+..Nn.-.
ISAKMP:  13 B4 B0 89 76 70 CD 8D FA DE F4 E0 C8 65 88 55   ....vp.......e.U
ISAKMP:  B4 60 C9 73 3E 9C 98 8A E3 95 8F 6A 63 65 BE 4E   .`.s>......jce.N
ISAKMP:  D5 87 1A 1B 78 BD 6D C2 31 A7 A3 0B E9 F4 EA F9   ....x.m.1.......
ISAKMP:  90 51 A4 01 5D A5 E4 39 76 E7 00 4A 00 92 E5 31   .Q..]..9v..J...1
ISAKMP:  C6 4F 7B 72 A9 3D FB 48 8F D2 27 95 02 70 BA 65   .O{r.=.H..'..p.e
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F2 F5 49 FA FD F6 9E 7B F3 E0 6E 06 D8 6E B4 DF   ..I....{..n..n..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x8E96 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A7 13 95 59 D3 59 F9 1A                           ...Y.Y..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  5E FC DA E0 5C AB 84 1F                           ^...\...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD5C2FE8D
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A7 13 95 59 D3 59 F9 1A 5E FC DA E0 5C AB 84 1F   ...Y.Y..^...\...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.15: Passed

>> IKE-IPV6-18.16
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if remaining
bits of Flags in HDR
is not set to 0 and MAY notify INVALID_FLAGS.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC2408 s3.1 p23 ISAKMP Header Format 
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the REMAINING_BITS set
        to <REM_BITS>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <REM_BITS> = {1,0,0,0,0}
- CASE: <REM_BITS> = {0,1,0,0,0}
- CASE: <REM_BITS> = {0,0,1,0,0}
- CASE: <REM_BITS> = {0,0,0,1,0}
- CASE: <REM_BITS> = {0,0,0,0,1} 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Set Remaining Bits to 1,0,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x80 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x5323 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  67 56 62 35 2E 51 DE 76                           gVb5.Q.v
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x80 (128)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C5 60 B6 F7 C4 B7 30 69 4B 1E EC CC AF 57 E1 31   .`....0iK....W.1
ISAKMP:  3A BD B4 F2 A3 2F 99 3E A7 38 49 63 B0 93 02 87   :..../.>.8Ic....
ISAKMP:  07 0F 3A E0 FC F4 CE 67 6B BE 31 C3 AC BE 62 72   ..:....gk.1...br
ISAKMP:  59 D2 22 EE A4 E9 36 41 EF 29 3A B2 05 84 52 05   Y."...6A.):...R.
ISAKMP:  15 C3 7D F9 A9 F4 FF 9F 60 53 02 3F 7D 2F 46 91   ..}.....`S.?}/F.
ISAKMP:  76 27 04 17 2D 87 50 56 45 FE 53 EA FC A2 C8 62   v'..-.PVE.S....b
ISAKMP:  FB 1B 06 50 4A 1C E1 C3 37 43 71 BE 44 48 72 59   ...PJ...7Cq.DHrY
ISAKMP:  8C AE 90 A6 7C F6 5F 88 8F A3 FF 89 97 52 66 38   ....|._......Rf8
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A 50 71 FF 52 7D 6A 50 10 67 3D 4D FB 12 3F AE   *Pq.R}jP.g=M..?.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xD4FF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  67 56 62 35 2E 51 DE 76                           gVb5.Q.v
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Set Remaining Bits to 0,1,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x40 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x37F1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  44 FD 36 0D 35 41 02 0D                           D.6.5A..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x40 (64)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  C2 A0 33 CA 17 FC FC 7A B0 B7 FE 73 DE C6 18 12   ..3....z...s....
ISAKMP:  B6 25 5F 0F C9 AA 25 8E 95 DE 11 73 7F C2 E2 E2   .%_...%....s....
ISAKMP:  6A 7C 3C F1 2C DB B8 FF E4 86 77 2B B9 DC 8C 01   j|<.,.....w+....
ISAKMP:  BC B9 9E 52 24 F7 20 CD 13 2B 3D 79 5D 49 32 F8   ...R$. ..+=y]I2.
ISAKMP:  D6 66 4F 83 55 2F 5A 58 9F 38 3E 70 ED D1 6C E8   .fO.U/ZX.8>p..l.
ISAKMP:  7A 28 AA 77 FB 72 D7 51 D1 C6 A1 B3 F0 05 A7 3B   z(.w.r.Q.......;
ISAKMP:  82 D0 DF 44 2F 61 C4 8A 5D A7 D9 1F 9E 2D FA A7   ...D/a..]....-..
ISAKMP:  2A E8 FD 81 2C 24 08 8F 7B 26 9A 59 7C 2F 08 A8   *...,$..{&.Y|/..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  61 2A D3 E5 29 F8 F4 DF CB 88 30 95 8B EF 13 63   a*..).....0....c
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xF8FA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  44 FD 36 0D 35 41 02 0D                           D.6.5A..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Set Remaining Bits to 0,0,1,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x20 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x75CC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D8 7F AA 07 F9 5C 24 49                           .....\$I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x20 (32)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  12 93 A2 17 06 87 F8 E0 3A 47 9B 20 82 8A 7A 06   ........:G. ..z.
ISAKMP:  A3 5C 08 DF 3B B1 23 C8 7F CC 7A 50 0C C9 C3 6C   .\..;.#...zP...l
ISAKMP:  22 24 59 9A C0 52 A6 4C 6B 3F 9F E9 76 71 31 88   "$Y..R.Lk?..vq1.
ISAKMP:  00 74 E0 42 D1 63 F7 05 B1 64 F2 9A 0C A0 F3 4A   .t.B.c...d.....J
ISAKMP:  46 29 F9 5E 5F 5F 02 E4 9C D2 C6 B6 B5 BE A8 32   F).^__.........2
ISAKMP:  75 10 4C 95 46 84 F4 C6 E0 C1 A2 E9 9C DF D6 F7   u.L.F...........
ISAKMP:  E9 AC 79 3B 53 F5 26 22 A9 D8 DF F9 85 B3 00 1D   ..y;S.&"........
ISAKMP:  78 50 C9 06 79 26 DE 4D 0E CA 2D 1B FB C2 3D CD   xP..y&.M..-...=.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 62 03 59 54 5C 49 C6 F2 2F 59 85 CE 93 70 48   .b.YT\I../Y...pH
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x0B26 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D8 7F AA 07 F9 5C 24 49                           .....\$I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:4 Set Remaining Bits to 0,0,0,1,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x4E1A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F5 50 12 91 B5 82 53                           ..P....S
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x10 (16)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E3 FA 6C 66 8B A7 B7 45 F5 8E EC 18 2C 69 4B 86   ..lf...E....,iK.
ISAKMP:  8B 56 B4 6B 1A 1C F2 64 73 57 9F 9D 3C 4E DB CA   .V.k...dsW..<N..
ISAKMP:  34 A2 45 86 F2 75 DF EC DD C8 16 7D 75 E4 C5 27   4.E..u.....}u..'
ISAKMP:  47 56 3E C9 E5 D1 B5 7B 9F A0 BC 2E 4C 5C 94 72   GV>....{....L\.r
ISAKMP:  41 C2 EA F6 A9 BB 3D 8F F0 21 CA 6B 91 BF D0 C5   A.....=..!.k....
ISAKMP:  D8 BA E3 37 F2 CE FD 93 E1 87 65 4B 23 64 BE D4   ...7......eK#d..
ISAKMP:  58 17 56 81 A7 07 A3 94 8B 0C 6E CC 1A D9 E3 87   X.V.......n.....
ISAKMP:  AB FC FA 6A 43 47 46 97 A9 D2 2F 1E 77 DB 5A 6D   ...jCGF.../.w.Zm
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  40 E2 E8 B3 F6 3A 7B 9D 6B BA 95 18 FE 92 39 2F   @....:{.k.....9/
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x6842 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE F5 50 12 91 B5 82 53                           ..P....S
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:5 Set Remaining Bits to 0,0,0,0,1

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x08 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x66E8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F7 15 DD 66 81 4E DE 67                           ...f.N.g
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x08 (8)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F0 9A 2B A8 8E 72 D4 3B 97 B4 30 33 7B 44 6D 76   ..+..r.;..03{Dmv
ISAKMP:  2B 57 F5 D1 55 8C A8 4B E7 40 68 43 0D 63 36 43   +W..U..K.@hC.c6C
ISAKMP:  03 3E D4 A7 79 36 B6 F1 0F 23 F9 0A AF 47 F4 B8   .>..y6...#...G..
ISAKMP:  5A 91 19 04 85 19 CA C3 2E 5D 78 1B 00 B8 48 9E   Z........]x...H.
ISAKMP:  69 B6 35 B2 83 D7 94 07 24 8D E5 0C A5 E9 3C 60   i.5.....$.....<`
ISAKMP:  E5 1B 0B 4C AD 8C 47 59 6D 1D B2 C3 7A 71 69 8C   ...L..GYm...zqi.
ISAKMP:  49 BB E0 80 39 81 21 40 0A 4E 9B B4 6D 31 CA 4A   I...9.!@.N..m1.J
ISAKMP:  79 8E 37 F8 3E A5 4C 5F B2 9F A7 9E B2 F4 E2 35   y.7.>.L_.......5
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E1 D7 6D 1B 7C 25 4E CB 89 56 7A 06 DA B3 7F A7   ..m.|%N..Vz.....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x7720 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F7 15 DD 66 81 4E DE 67                           ...f.N.g
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.16: Passed

>> IKE-IPV6-18.17
TEST_DESCRIPTION
IKE MUST notify INVALID_FLAGS for an incoming ISAKMP packet if
REMAINING_BITS 
in HDR is not set to 0.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC2408 s3.1 p23 ISAKMP Header Format 
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with the REMAINING_BITS set
        to <REM_BITS>
-  DUT: Notify INVALID_FLAGS
- CASE: <REM_BITS> = {1,0,0,0,0}
- CASE: <REM_BITS> = {0,1,0,0,0}
- CASE: <REM_BITS> = {0,0,1,0,0}
- CASE: <REM_BITS> = {0,0,0,1,0}
- CASE: <REM_BITS> = {0,0,0,0,1} 
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Set Remaining Bits to 1,0,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x80 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xA279 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4A DC A4 03 5A 68 3E 45                           J...Zh>E
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x80 (128)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  19 6D 6F 8D 50 C9 67 57 0D 4F AB 52 30 23 88 8D   .mo.P.gW.O.R0#..
ISAKMP:  B6 32 EB D5 ED 77 22 9C 8C A7 21 57 F2 FF 2B C0   .2...w"...!W..+.
ISAKMP:  1F EB 79 06 21 4C 9B BA C4 10 35 F1 F7 C0 3B 65   ..y.!L....5...;e
ISAKMP:  24 D7 AC 50 CC C8 1E A7 CE 75 36 3A 63 9A 5F FA   $..P.....u6:c._.
ISAKMP:  0A 3B F7 72 A8 91 65 7C F3 DA C4 73 0B 73 CA A7   .;.r..e|...s.s..
ISAKMP:  D1 AA E7 C3 61 F3 72 B3 78 ED D0 64 31 49 47 D2   ....a.r.x..d1IG.
ISAKMP:  6D 17 2A D6 3C DE 6C 91 0A 0C FE 61 40 03 2C EA   m.*.<.l....a@.,.
ISAKMP:  26 43 A1 1F F8 A1 75 60 B7 23 32 EA DD A0 B1 DE   &C....u`.#2.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7E 5F 43 FD BB 21 21 87 4B 73 2D D7 34 FE 71 57   ~_C..!!.Ks-.4.qW
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x23C6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4A DC A4 03 5A 68 3E 45                           J...Zh>E
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Set Remaining Bits to 0,1,0,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x40 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x596E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  76 4D 16 4A 2E 73 E0 49                           vM.J.s.I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x40 (64)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  D2 14 0A DD D0 3A F9 82 F8 21 65 2E BE 78 8F 2D   .....:...!e..x.-
ISAKMP:  CA E3 6E E4 00 D6 A5 96 9B 29 A4 7E 6A 16 45 02   ..n......).~j.E.
ISAKMP:  D6 8D AB B8 4A 7B 10 36 0B E6 51 6E 3F AB 8B 9A   ....J{.6..Qn?...
ISAKMP:  BF 26 79 06 81 0A 66 71 3B 48 6A D9 58 DE A1 53   .&y...fq;Hj.X..S
ISAKMP:  7F 41 7C 10 2C 1F 6D BE 80 8C D1 48 5F 1B F4 AE   .A|.,.m....H_...
ISAKMP:  9B 1D 3F 77 E5 7D 74 4D 1A 86 81 7D DC 33 38 B4   ..?w.}tM...}.38.
ISAKMP:  50 B2 C6 40 14 48 00 85 5B D1 86 05 F5 B1 61 41   P..@.H..[.....aA
ISAKMP:  B6 76 1C A1 BB 91 23 F0 B2 E0 5B 71 55 C0 F3 B0   .v....#...[qU...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  19 87 BE A9 FC 0C 87 F8 E2 7F D2 AD 79 74 81 BE   ............yt..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x0FFF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  76 4D 16 4A 2E 73 E0 49                           vM.J.s.I
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Set Remaining Bits to 0,0,1,0,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x20 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x3097 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B5 B6 2B 52 FA 97 45 54                           ..+R..ET
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x20 (32)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  71 5E DF A1 07 39 EC 5D 8C 39 12 86 D7 CF 65 30   q^...9.].9....e0
ISAKMP:  EB 0A E1 30 DE 59 F3 62 89 A0 7F 23 36 0C 7A CE   ...0.Y.b...#6.z.
ISAKMP:  EC ED 4D 94 0C 9D CB 20 01 E9 1E 71 2D 1A 54 59   ..M.... ...q-.TY
ISAKMP:  7D 04 98 38 DC B2 E4 F6 56 62 10 B3 69 54 19 CA   }..8....Vb..iT..
ISAKMP:  5A 0D DD F3 A2 16 F4 B0 DC C4 19 CE DB 07 A1 EA   Z...............
ISAKMP:  F1 FF B5 81 94 DE 4A FB 10 19 8D B9 29 EA 5D F9   ......J.....).].
ISAKMP:  5B D0 36 E7 6A 2D 52 37 E1 2B 07 4A 5C C6 A3 F4   [.6.j-R7.+.J\...
ISAKMP:  A9 B3 16 C6 36 D3 8B 27 9C 3B 48 87 45 FE 4C 5D   ....6..'.;H.E.L]
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7B 0C 7D BF AD 30 F9 37 8B 35 70 4B 98 9E E3 6F   {.}..0.7.5pK...o
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x8A5E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B5 B6 2B 52 FA 97 45 54                           ..+R..ET
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:4 Set Remaining Bits to 0,0,0,1,0

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x446F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  72 D1 63 7D 7C 77 96 47                           r.c}|w.G
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x10 (16)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  AC A2 9B B8 EC 60 13 B3 E8 20 23 44 63 77 2B 61   .....`... #Dcw+a
ISAKMP:  9A DD 12 AA 5F 82 23 AB 3D 3B 64 BF FF AB 3D 4E   ...._.#.=;d...=N
ISAKMP:  3F CF 62 0A 3D 25 9E 94 5B 26 16 13 8A B1 3A 66   ?.b.=%..[&....:f
ISAKMP:  4D 8C 54 26 0B 88 58 1B 56 12 05 F5 7B F9 9E A2   M.T&..X.V...{...
ISAKMP:  79 27 B8 D3 B9 DA 62 60 47 E8 68 47 54 E3 28 33   y'....b`G.hGT.(3
ISAKMP:  C9 86 A1 3F A7 7E EA 61 18 5B EC 6F 50 27 CA 25   ...?.~.a.[.oP'.%
ISAKMP:  72 06 A3 0C 03 57 EF 6D B7 11 11 16 97 E9 FE 45   r....W.m.......E
ISAKMP:  FF C6 48 F3 90 7D CC 7B A8 6B D4 92 21 72 61 81   ..H..}.{.k..!ra.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F4 12 72 C4 C5 07 E7 99 77 48 63 EC A1 CE F3 77   ..r.....wHc....w
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xC245 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  72 D1 63 7D 7C 77 96 47                           r.c}|w.G
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:5 Set Remaining Bits to 0,0,0,0,1

Sending <HDR,SA,KE,Ni,IDii> with the flag set
to 0x08 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xC1FA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD E0 0F 23 5C 83 F1 23                           ...#\..#
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x08 (8)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  A5 0B E2 B2 C5 AB 2D 33 32 7E 85 BD 22 FC 47 75   ......-32~..".Gu
ISAKMP:  AB BE ED A5 1B B0 88 D3 C7 99 09 BD 8F 6D D1 E1   .............m..
ISAKMP:  7A 25 A0 9E BE 1E E3 56 CC 08 11 2B 1F CD 88 8B   z%.....V...+....
ISAKMP:  1B 93 D1 E1 41 57 B9 7E 3A BF CD 63 9A 02 05 AB   ....AW.~:..c....
ISAKMP:  AB E7 B9 E7 58 FD 58 AC AB 89 98 B9 25 74 7F B5   ....X.X.....%t..
ISAKMP:  2E F8 99 7B 74 F9 00 7E E5 29 A4 8D 16 FD 75 8D   ...{t..~.)....u.
ISAKMP:  E4 A1 12 8F AD 24 FD 00 DF AB F7 08 F4 7F 00 70   .....$.........p
ISAKMP:  CC C4 22 E6 5B D3 02 F9 86 A4 17 3E C7 61 1E BB   ..".[......>.a..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A3 8A FA FD 97 B3 B4 7C A2 44 82 FE 04 4F 21 8E   .......|.D...O!.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0xA0A8 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD E0 0F 23 5C 83 F1 23                           ...#\..#
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 8 (Invalid Flags)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 8

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.17: Passed

>> IKE-IPV6-18.20
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet if Port field of
Identification Payload is other than 0 or 500 and MAY notify
INVALID-ID-INFORMATION.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set ID Port field of IDii to an
        invalid <prm_inv_id_port>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing ID Port field of IDii to an
invalid 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xEC32 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F5 7F 6B 08 C2 7B 47 09                           ..k..{G.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E2 03 C3 FD 45 96 96 A2 0A 51 87 83 B3 F2 6F 72   ....E....Q....or
ISAKMP:  05 80 D6 3C C2 72 30 66 72 30 7B C6 58 E8 5A A1   ...<.r0fr0{.X.Z.
ISAKMP:  9D 10 81 FD DF 5C 88 20 85 DD 86 6E 50 A2 C4 00   .....\. ...nP...
ISAKMP:  52 2D 24 B4 D8 CD EB BB 3B C1 11 95 23 34 A2 18   R-$.....;...#4..
ISAKMP:  0E 0E 7A 2A 70 25 46 01 49 35 21 5D 02 7F C0 1E   ..z*p%F.I5!]....
ISAKMP:  77 23 19 6B 57 E8 84 86 2C DA 3F 71 85 50 AA 5E   w#.kW...,.?q.P.^
ISAKMP:  44 52 50 7F 47 CA D5 67 FB 3D D0 EF 53 CF F0 F5   DRP.G..g.=..S...
ISAKMP:  D6 D9 94 B3 4A A7 B2 BE 95 D3 B6 17 30 68 C5 7C   ....J.......0h.|
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  8A 20 EB 73 F3 3D 1D 98 E1 6F 35 BA E6 43 1F 43   . .s.=...o5..C.C
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xA446 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F5 7F 6B 08 C2 7B 47 09                           ..k..{G.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C9 1B E6 AD 21 37 DB 09                           ....!7..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x68817101
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  F5 7F 6B 08 C2 7B 47 09 C9 1B E6 AD 21 37 DB 09   ..k..{G.....!7..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.20: Passed

>> IKE-IPV6-18.21
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP
packet if Port 
field of Identification Payload is other than 0 or 500.
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set ID Port field of IDii to an
        invalid <prm_inv_Id_port>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing ID Port field of IDii to an
invalid 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x31DC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  28 E6 94 1A B5 27 D1 1A                           (....'..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E9 26 CC 60 A3 CC 23 B2 18 FD A4 66 85 68 09 8A   .&.`..#....f.h..
ISAKMP:  DE 18 96 A4 37 BE 22 FF 6A DE 72 66 A8 44 48 AF   ....7.".j.rf.DH.
ISAKMP:  2A C6 F0 EA D6 32 98 AA 31 63 F1 88 33 7B 88 BB   *....2..1c..3{..
ISAKMP:  AA 46 A1 01 A2 93 AE BF 56 01 74 DB 61 D4 70 9B   .F......V.t.a.p.
ISAKMP:  A6 96 16 2E 15 2F DA F2 B1 38 32 E2 64 8D 2C 16   ...../...82.d.,.
ISAKMP:  D6 8B FD FF 3F C0 C2 2F B8 1F 4A D7 81 E8 46 52   ....?../..J...FR
ISAKMP:  BA 87 44 37 6E B9 9E 6A 89 9C 49 B9 94 50 77 9E   ..D7n..j..I..Pw.
ISAKMP:  4E 6F B8 9D F3 A9 A8 DC 95 26 D4 C1 8F EB F5 E9   No.......&......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4A 40 2C B5 38 33 07 77 D3 76 DF 4D 95 82 B8 34   J@,.83.w.v.M...4
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 10
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF29D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  28 E6 94 1A B5 27 D1 1A                           (....'..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  57 7A E3 DF 50 F4 00 F3                           Wz..P...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x604AB607
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  28 E6 94 1A B5 27 D1 1A 57 7A E3 DF 50 F4 00 F3   (....'..Wz..P...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 18

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.21: Passed

>> IKE-IPV6-18.22
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with Protocol ID field of ID Payload other
than 0 or UDP protocol (0x11) and MAY notify INVALID-ID-INFORMATION.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set Protocol-ID field of IDii
        to an invalid <prm_inv_id_proto>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing Protocol-ID field of IDii
to an invalid <prm_inv_id_proto> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x657E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  90 B7 9F 6B 9D A8 93 6C                           ...k...l
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  76 EB 23 79 9A 40 D5 88 2E AC 37 B2 C1 5E 37 B8   v.#y.@....7..^7.
ISAKMP:  9C DE 2E 34 E6 A0 CE C0 38 EF 6D 7E 92 F1 BB 32   ...4....8.m~...2
ISAKMP:  2E 31 88 FF 47 D3 E2 C6 5C 1F 2D E8 C9 B7 53 27   .1..G...\.-...S'
ISAKMP:  09 82 48 E7 E8 46 F8 19 96 42 EE 20 18 9D 36 6E   ..H..F...B. ..6n
ISAKMP:  FC 03 77 31 3B 37 42 35 DF B6 FE 50 0F 9F 67 34   ..w1;7B5...P..g4
ISAKMP:  D3 9B 9A 13 CB 36 57 87 DA 0A 65 81 7D 74 9E 28   .....6W...e.}t.(
ISAKMP:  36 F7 B0 87 2B 03 C6 30 0D 31 22 0B 20 61 22 AA   6...+..0.1". a".
ISAKMP:  AC 96 41 4F BB 34 0D 82 F5 09 18 45 16 BE 58 27   ..AO.4.....E..X'
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7D 95 03 BF E1 12 E6 9D 09 02 F1 EE AA 99 A5 13   }...............
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xCD3E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  90 B7 9F 6B 9D A8 93 6C                           ...k...l
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  64 84 B1 19 A1 D3 F2 13                           d.......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x657861C6
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  90 B7 9F 6B 9D A8 93 6C 64 84 B1 19 A1 D3 F2 13   ...k...ld.......
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.22: Passed

>> IKE-IPV6-18.23
TEST_DESCRIPTION
IKE MUST notify INVALID-ID-INFORMATION for an incoming ISAKMP packet
with Protocol ID field of ID Payload other than 0 or
UDP protocol (0x11).
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2407 s6.2 p19 Identification Payload content
          RFC 2409 s5.4 p16 Phase 1 Authenticated With a
          Pre-Shared Key
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set Protocol-ID field of IDii to an
        invalid <prm_inv_id_proto>
-  DUT: Notify INVALID-ID-INFORMATION
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing Protocol-ID field of IDii
to an invalid <prm_inv_id_proto> 10 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xD120 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  57 9C 42 0D 21 0D B3 0D                           W.B.!...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  DE 39 2C 46 DD 3E E2 E7 E6 C9 73 FB E1 12 43 01   .9,F.>....s...C.
ISAKMP:  2F 7D FE 9D D8 8C FF F3 60 98 37 70 81 C7 26 15   /}......`.7p..&.
ISAKMP:  A0 81 CC DF 7A 7A 9E 0B C3 7E F0 6C B4 C0 38 92   ....zz...~.l..8.
ISAKMP:  E1 0D E9 25 78 9D 45 9D 5B D4 6E DC C7 9B 3B C0   ...%x.E.[.n...;.
ISAKMP:  E4 25 FD C5 C4 A8 00 28 26 B8 E7 75 1A 6A 25 A8   .%.....(&..u.j%.
ISAKMP:  C0 E8 9E 78 55 76 D5 DE 34 72 8A F4 97 8E C6 F4   ...xUv..4r......
ISAKMP:  D0 A8 EF 84 37 D1 B9 61 20 B6 66 3E B8 1D DE 81   ....7..a .f>....
ISAKMP:  F3 9A F7 8D 66 08 DC 27 80 DD BE 0B CD 9A 29 81   ....f..'......).
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  20 CD 5C 1E C4 82 7E 83 66 4F 0E 20 32 EE F3 05    .\...~.fO. 2...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 10
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xFEBF (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  57 9C 42 0D 21 0D B3 0D                           W.B.!...
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  64 A5 EF D9 31 46 15 EA                           d...1F..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x21BC7695
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 18 (Invalid ID Information)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  57 9C 42 0D 21 0D B3 0D 64 A5 EF D9 31 46 15 EA   W.B.!...d...1F..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 18

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.23: Passed

>> IKE-IPV6-18.24
TEST_DESCRIPTION
IKE MUST not respond to an incoming packet with non zero value
in the RESERVED field of any Payload and MAY notify
BAD-PROPOSAL-SYNTAX or PAYLOAD-MALFORMED.  
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.3 p61 Generic Payload Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set the RESERVED field of <Payload>
        to a NON_ZERO_VAL (e.g. 2)
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <Payload> = SA 
- CASE: <Payload> = Proposal
- CASE: <Payload> = Transform
- CASE: <Payload> = KE
- CASE: <Payload> = Ni
- CASE: <Payload> = IDii
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Set RESERVED field of SA to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> SA Payload set to 1 to  DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x504E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  54 DB D3 1B A4 C1 17 1C                           T.......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  E9 9C EE 27 BA 1E 0D C5 AF 97 DC B4 B3 41 56 D6   ...'.........AV.
ISAKMP:  C0 3E A0 7E F2 28 1E C0 CD 37 68 EA F4 EF 9A 72   .>.~.(...7h....r
ISAKMP:  E6 38 C2 11 68 EC 65 F4 62 52 CD 10 20 90 16 A6   .8..h.e.bR.. ...
ISAKMP:  4E F4 8F 04 C5 96 05 C7 25 B2 23 90 DB FA BB F9   N.......%.#.....
ISAKMP:  53 06 A2 98 58 99 8F BD 98 2F BD 45 DC 2E 9F 5D   S...X..../.E...]
ISAKMP:  EA FC 40 F8 8C 29 88 93 8D A2 12 76 38 D2 2D 9C   ..@..).....v8.-.
ISAKMP:  B7 56 F7 2F 79 19 A6 C3 67 94 1E E7 3B 33 4E C3   .V./y...g...;3N.
ISAKMP:  9E F8 CC DF 6F B0 73 C9 AF BC 69 80 AA AF 7F BC   ....o.s...i.....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  2A D7 56 33 E7 DF 3B 6F D5 28 85 07 CD EF 38 9C   *.V3..;o.(....8.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x266B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  54 DB D3 1B A4 C1 17 1C                           T.......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7F 98 7C 41 46 9C A8 0C                           ..|AF...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xAB813B5F
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  54 DB D3 1B A4 C1 17 1C 7F 98 7C 41 46 9C A8 0C   T.........|AF...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:2 Set RESERVED field of Proposal Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> Proposal Payload set to 1 to  DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x304C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F4 23 97 1B 53 C2 D1 5C                           .#..S..\
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  31 1B 9D 81 41 81 06 AB 8E CA 70 7E 36 BD F3 1E   1...A.....p~6...
ISAKMP:  BE 77 9A 61 1F 00 7C 5F 2F AC 51 93 9C 14 66 36   .w.a..|_/.Q...f6
ISAKMP:  FD 2E 0B 92 6D 3C 49 69 8A C4 12 2B 79 1C 2E B8   ....m<Ii...+y...
ISAKMP:  3F 9D E7 16 56 FB 0D BC FA EA 40 8D 39 2F 12 E5   ?...V.....@.9/..
ISAKMP:  D3 57 CB A5 12 F7 F5 48 53 31 9F 16 4C B5 D3 F0   .W.....HS1..L...
ISAKMP:  63 0D A6 9A BF 8D D2 08 B6 A7 BF B3 D8 93 7F 32   c..............2
ISAKMP:  6D 81 5D F2 B6 5C 0E B3 BE 5E 87 AE FD 74 3B DF   m.]..\...^...t;.
ISAKMP:  F8 55 42 75 25 83 AA 68 D4 AB 95 29 B1 A7 75 6A   .UBu%..h...)..uj
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  7C 90 03 2E 71 5B 11 CB 98 13 86 80 0D 54 C9 69   |...q[.......T.i
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD748 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  F4 23 97 1B 53 C2 D1 5C                           .#..S..\
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  45 1A 39 45 29 3E A0 DA                           E.9E)>..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x1D53C3B1
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  F4 23 97 1B 53 C2 D1 5C 45 1A 39 45 29 3E A0 DA   .#..S..\E.9E)>..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Set RESERVED field of Transform Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> Transform Payload set to 1 to  DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xEE54 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CB EC 9E 79 26 7E 5F 3B                           ...y&~_;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  3F 23 A8 A1 42 79 AE 03 A9 C9 FA 61 38 80 FE CD   ?#..By.....a8...
ISAKMP:  12 CB C3 33 B5 2E 89 53 7B 86 D6 13 9E 18 AC 52   ...3...S{......R
ISAKMP:  9D D0 EC B6 F1 9C 31 80 D5 68 48 7A 48 47 2A 0B   ......1..hHzHG*.
ISAKMP:  0D 34 E3 5C F0 3A 7E C8 65 EB A3 2C DB 5D 56 EB   .4.\.:~.e..,.]V.
ISAKMP:  56 8F 45 88 F3 E6 B3 69 21 3F C5 1C 0D 7A 64 3D   V.E....i!?...zd=
ISAKMP:  2E B1 B0 87 6E 54 4E 93 1F 9C 0E 96 EF 9E 6E 51   ....nTN.......nQ
ISAKMP:  25 B5 D0 03 F4 55 10 C3 4E 2C E8 EA 1A 1B 9D 6C   %....U..N,.....l
ISAKMP:  23 BB 0D 2D BB 3F 50 0E AE 50 DF C4 FD 05 10 F6   #..-.?P..P......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B6 F6 97 29 BC 89 8B 88 9E 17 2C 61 0C 17 69 05   ...)......,a..i.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x3BBC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  CB EC 9E 79 26 7E 5F 3B                           ...y&~_;
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  86 36 9E B4 02 D7 A9 14                           .6......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xFA2DF223
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  CB EC 9E 79 26 7E 5F 3B 86 36 9E B4 02 D7 A9 14   ...y&~_;.6......
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:4 Set RESERVED field of KE Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> KE Payload set to 1 to  DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xA1AE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  02 FB 7E 44 96 DC 75 06                           ..~D..u.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  50 AE 9A 20 75 88 9D A0 84 8D 12 8F 29 53 B6 34   P.. u.......)S.4
ISAKMP:  4A 58 43 CF B3 33 7B 93 E4 87 C7 B3 40 D4 A2 82   JXC..3{.....@...
ISAKMP:  3B 65 6E 0E 12 70 0B D5 4B EC 3C 6C E6 E0 B3 A0   ;en..p..K.<l....
ISAKMP:  5C 2F AF F3 DE 46 57 EE 15 55 D8 C4 B0 69 62 8B   \/...FW..U...ib.
ISAKMP:  82 A8 94 E7 59 06 3A B4 20 18 B5 DE 61 13 F9 15   ....Y.:. ...a...
ISAKMP:  98 29 07 6B 2C 13 D5 01 79 D2 2E 1C B2 A2 5E 04   .).k,...y.....^.
ISAKMP:  80 D0 1D EF 08 74 3B FF 06 50 B6 54 9D 8E 26 CA   .....t;..P.T..&.
ISAKMP:  7E 86 26 60 80 A8 1E 89 A2 D0 6F 15 51 3B 5F 15   ~.&`......o.Q;_.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E2 86 70 72 F1 00 81 A6 1A A0 75 25 BE 50 A5 FC   ..pr......u%.P..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x746E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  02 FB 7E 44 96 DC 75 06                           ..~D..u.
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  14 FD 1E 18 FB 3C 13 87                           .....<..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x387D5F18
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  02 FB 7E 44 96 DC 75 06 14 FD 1E 18 FB 3C 13 87   ..~D..u......<..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:5 Set RESERVED field of Nonce Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> Nonce Payload set to 1 to  DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x72EA (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4D DF 83 45 84 93 0A 35                           M..E...5
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  39 83 B1 0F 36 42 2B 06 1F 5D 21 A2 C1 3C 43 3B   9...6B+..]!..<C;
ISAKMP:  29 F0 80 A3 25 AB FC 04 48 45 D5 F7 65 86 C9 08   )...%...HE..e...
ISAKMP:  61 5E 6F C0 1A E9 D7 54 41 C0 CB 74 41 8D 06 BD   a^o....TA..tA...
ISAKMP:  8A 6D 0E 51 CB 60 58 8D 85 F6 19 B0 87 B7 EC 5B   .m.Q.`X........[
ISAKMP:  74 85 77 D9 19 19 6C 2F C8 C9 9B 29 25 B4 9D E8   t.w...l/...)%...
ISAKMP:  EB 6C 3D 48 F8 8E F0 0D 79 96 AC 3C 48 74 3C 6B   .l=H....y..<Ht<k
ISAKMP:  47 75 D8 D7 CC 0D 74 C4 1F 36 00 7C BE 5F AF 77   Gu....t..6.|._.w
ISAKMP:  69 A5 90 C6 B5 F7 D5 5A 27 3E 98 F3 BE 47 65 69   i......Z'>...Gei
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  F4 38 21 EE B1 05 ED F3 76 DF 18 D4 19 02 04 EC   .8!.....v.......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xFE85 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  4D DF 83 45 84 93 0A 35                           M..E...5
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  AF E2 D6 85 03 B3 62 1C                           ......b.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xA0D67254
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  4D DF 83 45 84 93 0A 35 AF E2 D6 85 03 B3 62 1C   M..E...5......b.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:6 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> ID Payload set to 1 to  DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xD589 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A9 3A 6B 0E 1E B5 8B 0E                           .:k.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  B6 32 7C 19 9C 5D 06 24 7E 03 2F 7F 16 D1 C5 81   .2|..].$~./.....
ISAKMP:  C1 2C D4 4F BC 88 3E A0 4D 5D EC 98 0D 01 23 49   .,.O..>.M]....#I
ISAKMP:  D4 48 20 2E 6C 36 F3 9D 76 E0 86 7A C6 8D 1E C8   .H .l6..v..z....
ISAKMP:  5C 96 C1 FB 5E 3B 47 32 FE 52 62 AD 4D 03 F6 B5   \...^;G2.Rb.M...
ISAKMP:  D8 EF 79 F8 DD C8 F4 D4 4B 6A 53 E2 B6 79 80 D2   ..y.....KjS..y..
ISAKMP:  50 A3 60 07 85 55 94 57 F9 AD 9A 27 08 BA B9 5E   P.`..U.W...'...^
ISAKMP:  43 78 EF BF 72 22 32 11 1D A8 C4 39 74 F4 96 EE   Cx..r"2....9t...
ISAKMP:  58 D0 11 85 3E 02 A3 08 67 F5 BA 54 E5 2F 24 7D   X...>...g..T./$}
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B1 9A 35 30 D4 0E 46 A7 EF 9E F3 EF 30 0D 7B E6   ..50..F.....0.{.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x11CC (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A9 3A 6B 0E 1E B5 8B 0E                           .:k.....
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E0 85 F3 3C F8 06 A9 67                           ...<...g
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x6689CB29
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A9 3A 6B 0E 1E B5 8B 0E E0 85 F3 3C F8 06 A9 67   .:k........<...g
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.24: Passed

>> IKE-IPV6-18.25
TEST_DESCRIPTION
IKE MUST notify BAD-PROPOSAL-SYNTAX or PAYLOAD-MALFORMED for an
incoming ISAKMP
packet with non zero value in the RESERVED field of any Payload.  
Note: This test checks whether DUT sends the Notify Message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2408 s5.3 p61 Generic Payload Header Processing
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>. Set the RESERVED field of <Payload>
        to a NON_ZERO_VAL (e.g. 2)
-  DUT: Notify BAD-PROPOSAL-SYNTAX or PROPOSAL-MALFORMED
- CASE: <Payload> = SA 
- CASE: <Payload> = Proposal
- CASE: <Payload> = Transform
- CASE: <Payload> = KE
- CASE: <Payload> = Ni
- CASE: <Payload> = IDii
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:1 Set RESERVED field of SA to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> SA Payload to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x6B47 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A1 73 DA 62 B6 DD 83 63                           .s.b...c
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  2F 35 A4 F2 44 CB 52 7B 08 90 EF F1 AB 2E DA BE   /5..D.R{........
ISAKMP:  5C 19 56 02 B6 1B E0 B9 24 1C 4C 41 1A 01 7D 82   \.V.....$.LA..}.
ISAKMP:  AC 7C F1 10 C7 E8 BD B1 51 DB EC 65 DE 2F 55 2F   .|......Q..e./U/
ISAKMP:  E5 A6 5A 97 AC 84 E5 52 AE 18 5F 9D B4 2C 92 A9   ..Z....R.._..,..
ISAKMP:  98 5A A4 A5 20 66 AA 31 CE 64 A6 9D 07 A0 5C F5   .Z.. f.1.d....\.
ISAKMP:  AE 16 1F 39 AF 7A 38 BA 14 FB FD 79 18 00 C7 91   ...9.z8....y....
ISAKMP:  77 BB E5 2B BF 32 96 48 2F C5 85 F5 F3 49 A3 75   w..+.2.H/....I.u
ISAKMP:  51 3A 59 02 43 E2 62 A0 E6 A3 64 26 51 1D 24 94   Q:Y.C.b...d&Q.$.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  BB 18 97 A0 6D 4B F3 57 8A 78 8C C0 8E 1E 6D C4   ....mK.W.x....m.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xF4D0 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A1 73 DA 62 B6 DD 83 63                           .s.b...c
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  E3 8A F8 F0 83 80 E9 3D                           .......=
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xE819CE6C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A1 73 DA 62 B6 DD 83 63 E3 8A F8 F0 83 80 E9 3D   .s.b...c.......=
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Set RESERVED field of Proposal Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> Proposal Payload to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xB566 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D3 BD 01 6B E4 03 C8 2B                           ...k...+
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  BE C3 1F 5E D5 4F 53 6E 31 FF B3 76 36 31 9C B1   ...^.OSn1..v61..
ISAKMP:  82 C0 75 0C 03 59 DC 24 D8 4E B8 AA BA FD CA 87   ..u..Y.$.N......
ISAKMP:  7D 59 28 0D BC B2 13 C5 E3 48 21 85 CE A7 14 9A   }Y(......H!.....
ISAKMP:  E1 0D 26 21 38 C5 C8 65 E4 29 EE 9B 71 0E 29 23   ..&!8..e.)..q.)#
ISAKMP:  5B DC 17 FE AE E3 40 B0 B0 D8 A6 AB DB B0 57 FE   [.....@.......W.
ISAKMP:  DA 80 3E 3B 89 30 DD FD 39 2A 21 21 D5 DA 43 C3   ..>;.0..9*!!..C.
ISAKMP:  2F F6 20 BE 25 A0 25 29 EC 82 AA A4 E1 57 CA BE   /. .%.%).....W..
ISAKMP:  5D D8 B8 3E 83 9F C9 01 A5 F8 06 A6 8A C7 BA 0C   ]..>............
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  B3 68 9C D1 76 5F A0 73 AA AD F8 42 43 60 5D 09   .h..v_.s...BC`].
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xFCE7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  D3 BD 01 6B E4 03 C8 2B                           ...k...+
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  04 2D A9 0B A2 06 6A 30                           .-....j0
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x30E106A2
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  D3 BD 01 6B E4 03 C8 2B 04 2D A9 0B A2 06 6A 30   ...k...+.-....j0
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:3 Set RESERVED field ofTransform Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> Transform Payload to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0xE77C (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  42 24 D0 29 58 C7 E9 69                           B$.)X..i
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F5 EF CD 17 51 8C CF 04 9B 2A 90 77 CD 89 BA 10   ....Q....*.w....
ISAKMP:  6D 03 FD 3B DF 57 73 2C 7B 86 E4 04 9A CA 23 3A   m..;.Ws,{.....#:
ISAKMP:  B7 AF 01 C8 85 7B 28 CE 42 66 12 FC 37 AF 9C BB   .....{(.Bf..7...
ISAKMP:  A0 7D 58 FA 0B 49 78 66 44 45 78 A3 6D FF 71 D0   .}X..IxfDEx.m.q.
ISAKMP:  57 25 BE F5 D4 29 10 3F BB 69 59 EE E5 B5 0B 63   W%...).?.iY....c
ISAKMP:  F7 BD 14 CB 00 44 14 E1 7E 93 F1 D1 41 E7 9A FA   .....D..~...A...
ISAKMP:  15 FD 29 16 F9 D9 D5 E8 7D A9 5C 45 C3 30 BE CF   ..).....}.\E.0..
ISAKMP:  77 7C 81 B8 B2 17 BD A4 F0 8B 33 2B 18 0C 55 75   w|........3+..Uu
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  76 8A 2E E6 67 59 84 4C E5 72 1C 86 C8 B7 ED 90   v...gY.L.r......
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x2973 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  42 24 D0 29 58 C7 E9 69                           B$.)X..i
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F5 A3 DD 2E 25 11 CB 8C                           ....%...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xC97B872C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  42 24 D0 29 58 C7 E9 69 F5 A3 DD 2E 25 11 CB 8C   B$.)X..i....%...
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:4 Set RESERVED field of KE Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> KE Payload to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x4C1F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  30 01 D3 2F 5B 97 87 71                           0../[..q
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  6B 82 92 72 4E 59 35 5F B8 04 13 D8 6A 2A 99 DE   k..rNY5_....j*..
ISAKMP:  13 40 A1 5C B8 F8 B1 E2 59 E2 38 A6 A3 4B 5F 5D   .@.\....Y.8..K_]
ISAKMP:  85 2A 40 AF A2 46 33 BA F1 87 12 1C 3C DC 3D 06   .*@..F3.....<.=.
ISAKMP:  C2 0A F7 48 6C 8E 06 F7 A9 15 E9 2C 76 04 71 C7   ...Hl......,v.q.
ISAKMP:  1B 2A C8 54 F1 46 60 CA 49 35 CB 19 1D 36 E8 94   .*.T.F`.I5...6..
ISAKMP:  18 53 05 72 A7 B9 55 6A EA A2 DB B0 31 E6 CE 24   .S.r..Uj....1..$
ISAKMP:  54 B5 7F 05 AB 90 18 EB D2 DA 60 23 23 FB B6 BF   T.........`##...
ISAKMP:  43 6D 97 88 0D CC A9 18 13 B7 42 F9 0D 22 B4 D7   Cm........B.."..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6F 28 2C 9F AB 0C 0E 4A CF D9 FF 56 54 29 84 08   o(,....J...VT)..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x344E (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  30 01 D3 2F 5B 97 87 71                           0../[..q
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  71 6E 8D DC 9F 7A 1A 06                           qn...z..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x5786E01B
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  30 01 D3 2F 5B 97 87 71 71 6E 8D DC 9F 7A 1A 06   0../[..qqn...z..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:5 Set RESERVED field of Nonce Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> Nonce Payload to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x1021 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  92 E2 80 4E AC 65 9F 4F                           ...N.e.O
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  85 96 59 B6 57 1D B9 26 B2 E1 34 27 A7 C3 D7 62   ..Y.W..&..4'...b
ISAKMP:  A0 E6 4F FA A2 1F AC 95 05 8D EF 6D 9D DE 40 07   ..O........m..@.
ISAKMP:  68 45 19 4E 76 C1 96 57 90 4C 63 A9 EA 14 16 2C   hE.Nv..W.Lc....,
ISAKMP:  4A 24 CA 1A DB 3C 71 EE 07 38 C5 63 74 46 D2 06   J$...<q..8.ctF..
ISAKMP:  F4 DB 45 28 62 AC 9B 0C 97 90 6A 4C 91 35 34 41   ..E(b.....jL.54A
ISAKMP:  6A 98 66 71 44 24 F4 BB D7 0D 65 AD DB E0 F6 10   j.fqD$....e.....
ISAKMP:  38 09 0C 0A C6 41 D7 94 59 62 73 00 66 21 F1 8A   8....A..Ybs.f!..
ISAKMP:  3C 0E 25 40 D6 F3 3A 7B C4 32 C6 0F 0B AF 9E 81   <.%@..:{.2......
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  4B 7D 13 71 FD EF F6 DE C8 5D 78 69 6C F5 E2 04   K}.q.....]xil...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x90D1 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  92 E2 80 4E AC 65 9F 4F                           ...N.e.O
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  5E 5F 20 F2 E1 7D B2 5C                           ^_ ..}.\
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x14CB203A
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  92 E2 80 4E AC 65 9F 4F 5E 5F 20 F2 E1 7D B2 5C   ...N.e.O^_ ..}.\
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case:6 Set RESERVED field of ID Payload
to non-zero value

Sending <HDR,SA,KE,Ni,IDii> containing the RESERVED field of
<Payload> ID Payload to 1 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 256 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 256 
UDP: Checksum         = 0x6A82 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD 4E C4 67 AE A5 10 28                           .N.g...(
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 248 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  F4 68 2C 97 E2 F9 92 D1 6C 08 AD 9E 9D BE B1 E2   .h,.....l.......
ISAKMP:  0F 18 A5 90 ED 3E D0 93 94 C7 5C 41 8A 6E 86 09   .....>....\A.n..
ISAKMP:  3E C4 74 5D A4 EA 88 8D 72 0D 34 D4 61 A4 56 8E   >.t]....r.4.a.V.
ISAKMP:  A0 AF 21 6B 9B 35 C7 5D 90 1B 0F 66 CF 77 61 8A   ..!k.5.]...f.wa.
ISAKMP:  5E 26 A8 39 17 CC 79 48 DF 95 CC 10 78 38 14 A5   ^&.9..yH....x8..
ISAKMP:  9B EE BA AF B2 D3 26 33 7B DE 01 31 9D 58 BD B7   ......&3{..1.X..
ISAKMP:  79 AF 88 42 3C B2 F3 CB CA 17 7F 5B 8D 63 0A 18   y..B<......[.c..
ISAKMP:  9B 33 71 E7 A6 7A 1A A9 21 EC E1 96 F1 39 68 B3   .3q..z..!....9h.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  DC 40 EA C6 A8 A7 3C 4D 49 81 3F 73 61 DF 85 32   .@....<MI.?sa..2
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 1
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x488D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  AD 4E C4 67 AE A5 10 28                           .N.g...(
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  C6 CA 2D CC A4 75 3F A2                           ..-..u?.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x82F2CC15
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 16 (Payload Malformed)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  AD 4E C4 67 AE A5 10 28 C6 CA 2D CC A4 75 3F A2   .N.g...(..-..u?.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Receive expected Notification from DUT
2000::5 (on interface 2000::1)
Correctly received Notify Message 16

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.25: Passed

>> IKE-IPV6-18.26
TEST_DESCRIPTION
IKE MUST not respond to an incoming ISAKMP packet with a Nonce
Payload if Length of Nonce Payload is not between 8 and 256 bytes
and MAY notify PAYLOAD-MALFORMED.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s5 p8 Exchanges
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>.Set the value of the Payload Length
        field of Nonce Payload to <prm_inv_nonce_len> which is
        less than 8 or greater than 256
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_aggressive.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_resp.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii> containing the value of the
Payload Length field of Nonce Payload to <prm_inv_nonce_len> 7
which is less than 8 or greater than 256 to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 243 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 243 
UDP: Checksum         = 0x0B7A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  81 E7 B6 15 F8 46 71 44                           .....FqD
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 167 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 2 (1024-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 132 bytes
ISAKMP: --- Key Exchange Data [128 bytes] ---
ISAKMP:  11 A8 4C 79 B7 09 02 BE B3 3B F5 09 A2 40 6D 72   ..Ly.....;...@mr
ISAKMP:  7B C0 2D 13 3F 4E 34 32 22 D2 3B 94 45 E8 6F 12   {.-.?N42".;.E.o.
ISAKMP:  4C E8 F9 A4 4D C1 72 74 D1 CB B5 7D A0 7C 9B 59   L...M.rt...}.|.Y
ISAKMP:  DF 64 81 33 F8 82 F7 CE BF 49 A6 42 2E 64 1A 8F   .d.3.....I.B.d..
ISAKMP:  EC D5 0B 39 13 3E 2E C2 DF D6 1E 26 93 2C 1F 21   ...9.>.....&.,.!
ISAKMP:  C8 31 6A F2 38 96 63 1B 6C 12 CB 90 DA 70 CE B7   .1j.8.c.l....p..
ISAKMP:  79 95 49 E0 43 0A D1 D0 B1 7B A1 FE 19 7B 9B C0   y.I.C....{...{..
ISAKMP:  E8 E2 C6 5A C0 40 55 15 CC 4B 8A 8B B3 2B 4B 49   ...Z.@U..K...+KI
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 7 bytes
ISAKMP: --- Nonce Data [3 bytes] ---
ISAKMP:  81 6C F4                                          .l.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 48 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 48 
UDP: Checksum         = 0x09B5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  81 E7 B6 15 F8 46 71 44                           .....FqD
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 40 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 12 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 0
ISAKMP: SPI Size                 = 0
ISAKMP: Notify Message Type      = 30 (Unequal Payload Length)
ISAKMP:--- SPI [0 bytes] ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly did not receive Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP1024 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.26: Passed
Executing system command:
  "./DocScriptQ35/IKEIPV6/IKEIPV6postsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipike
ipd: kill ipike ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar set -o ipike.strict_lifetime_policy "0"
sysvar: ipike.strict_lifetime_policy=0 ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          108
Number of tests passed:       108
Number of tests failed:       0
Number of tests inconclusive: 0
