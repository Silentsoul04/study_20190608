ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5792080 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlrip_Compatibility rip 16 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlrip_Compatibility.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           "./DocScriptQ35/RIP/reboot-command.exp $ANVL_DUTHOSTNAME"
Post suite Command                       "./DocScriptQ35/RIP/RIPpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
Post Test Command                        "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
RIP Suite Setup Command                  "./DocScriptQ35/RIP/rip-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Flush Routes Command                 "./DocScriptQ35/RIP/rip-flush-routes-command.exp $ANVL_DUTHOSTNAME"
RIP Version                              2-Broadcast
RIP DUT Supports all Versions            True
RIP Host Routes Accepted                 True
RIP Default Route Supported              True
RIP Poison Reverse Supported             True
RIP Default Route Enable Command         "./DocScriptQ35/RIP/rip-default-route-enable-command.exp $ANVL_DUTHOSTNAME"
RIP Default Route Disable Command        "./DocScriptQ35/RIP/rip-default-route-disable-command.exp $ANVL_DUTHOSTNAME"
RIP Compatibility Send Command           "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Compatibility Receive Command        "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Set Authentication Command           "./DocScriptQ35/RIP/rip-set-authentication-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Reset Authentication Command         "./DocScriptQ35/RIP/rip-reset-authentication-command.exp $ANVL_DUTHOSTNAME"
RIP Router List Command                  "./DocScriptQ35/RIP/rip-router-list-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Poison Reverse Command               "./DocScriptQ35/RIP/rip-poison-reverse-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Reset Router List Command            "./DocScriptQ35/RIP/rip-reset-router-list-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Set Host Route Command               "./DocScriptQ35/RIP/rip-set-host-route-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Static Route Add Command             "./DocScriptQ35/RIP/rip-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Static Route Delete Command          "./DocScriptQ35/RIP/rip-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
RIP Tolerance Factor                     1                   # (0x00000001)
RIP Tolerance Time                       10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlrip_Compatibility.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        
IP First Unused Net                      50.0.0.0
IP Number Unused Nets                    100                 # (0x00000064)
IP Unused Net Mask                       255.0.0.0

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255
  IP First Unused Address                  30.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255
  IP First Unused Address                  40.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.0 40.1.1.0 3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask 255.255.255.0 up
-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2 nopoison 
   ok
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask 255.255.255.0 up
-> cmd ripctrl ifclose gei1
   ok
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 nopoison 
   ok
-> cmd ipd kill iprip
ipd: kill iprip ok
-> cmd sysvar get iprip.drop.hostroute 
sysvar: iprip.drop.hostroute=0
-> cmd sysvar set -co iprip.drop.hostroute "1"
sysvar: iprip.drop.hostroute=1 ok
-> cmd ipd start iprip
ipd: start iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

00:1B:21:7D:57:BA < 00:15:17:C8:90:28 ARP Rsp 30.1.1.150

Device Under Test found at 30.1.1.5 as 00:15:17:C8:90:28
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
RFC 2453:  'RIP Version 2'
(G. Malkin, Bay Networks, November 1998)

ANVL Test Suite Required Setup:
This suite expects to be running against an IP router that is set up
to accept and advertise RIP routes.   There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.  All tests require at least one interface to be
configured and connected to the machine running ANVL.  Some of the
tests require two interfaces.  Some of the tests require RIP v2 to be
implemented.  Some of the tests require support for setting the
version Compatibility Switch ('RIP Version 2', RFC 2453,
Page 34, Section 5.1.)

This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> RIP-16.1
TEST_DESCRIPTION
The switch has four settings: RIP-1, in which only RIP-1 messages are
sent; RIP-1 compatibility, in which RIP-2 messages are broadcast;
RIP-2, in which RIP-2 messages are multicast; and "none", which
disables the sending of RIP messages.
CASE: Only RIP-1 messages are sent
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility switch
TEST_METHOD
- ANVL: Configure DUT Compatibility Switch to RIP-1 mode (only RIP-1
        messages are sent)
-  DUT: Send a regular update
- ANVL: Verify update is RIP-1 and sent to the broadcast address
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Compatibility Send Switch to RIP-1 mode (only RIP-1 messages are sent)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=1
cmd ripctrl ifclose gei0 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2 out v1
   ok
-> cmd ripctrl ifclose gei1 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 out v1
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Received RIP v1 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xD2DC (53980)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x68D7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x9193 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Verifying the receieved IP packet
---------------------------------

 Expected RIP version = 1
 Recieved RIP version = 1

Expected IP Address = 30.1.1.255
Received IP Address = 30.1.1.255

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.1: Passed

>> RIP-16.2
TEST_DESCRIPTION
The switch has four settings: RIP-1, in which only RIP-1 messages are
sent; RIP-1 compatibility, in which RIP-2 messages are broadcast;
RIP-2, in which RIP-2 messages are multicast; and "none", which
disables the sending of RIP messages.
CASE: RIP-2 messages are broadcast
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility switch
TEST_METHOD
- ANVL: Configure DUT Compatibility Switch to RIP-1 compatibility mode
        (RIP-2 messages are broadcast)
-  DUT: Send a regular update
- ANVL: Verify update is RIP-2 and sent to the broadcast address
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xD2EA (53994)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x68C9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x738B (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Verifying the receieved IP packet
---------------------------------

 Expected RIP version = 2
 Recieved RIP version = 2

Expected IP Address = 30.1.1.255
Received IP Address = 30.1.1.255

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.2: Passed

>> RIP-16.3
TEST_DESCRIPTION
The switch has four settings: RIP-1, in which only RIP-1 messages are
sent; RIP-1 compatibility, in which RIP-2 messages are broadcast;
RIP-2, in which RIP-2 messages are multicast; and "none", which
disables the sending of RIP messages.
CASE: RIP-2 messages are multicast
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility switch
TEST_METHOD
- ANVL: Configure DUT Compatibility Switch to RIP-2 mode (RIP-2
        messages are multicast)
-  DUT: Send a regular update
- ANVL: Verify update is RIP-2 and sent to the multicast address
        (224.0.0.9)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Compatibility Send Switch to RIP-2 (RIP-2 messages are multicast)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=2
cmd ripctrl ifclose gei0 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei0 multicast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 multicast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Received RIP v2 Response (regular update) from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xCFD3 (53203)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 1
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xEAD6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0xB381 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 40.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 30.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Verifying the receieved IP packet
---------------------------------

 Expected RIP version = 2
 Recieved RIP version = 2

 Expected IP Address = 224.0.0.9
 Recieved IP Address = 224.0.0.9

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.3: Passed

>> RIP-16.4
TEST_DESCRIPTION
The switch has four settings: RIP-1, in which only RIP-1 messages are
sent; RIP-1 compatibility, in which RIP-2 messages are broadcast;
RIP-2, in which RIP-2 messages are multicast; and "none", which
disables the sending of RIP messages.
CASE: No RIP messages are sent
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility switch
TEST_METHOD
- ANVL: Configure DUT Compatibility Switch to 'none' (disables the
        sending of RIP messages)
-  DUT: Send do not send a regular update
- ANVL: Verify no update is sent
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Compatibility Send Switch to 'none' (no RIP messages are sent)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Waiting (up to 40.000 seconds) for RIP Response on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=0
cmd ripctrl ifclose gei0 
   failed : invalid interface [-1064]
-> cmd ripctrl ifclose gei1 
   failed : invalid interface [-1064]
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Correctly no RIP update is received

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.4: Passed

>> RIP-16.5
TEST_DESCRIPTION
For completeness, routers should also implement a receive control
switch which would determine whether to accept RIP-1 only.
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility Switch
TEST_METHOD
- ANVL: Configure DUT Receive Control Switch to accept RIP-1
        messages only
- ANVL: Send RIP updates
-  DUT: Accept update if correct version and send update containing
        advertised route on other interface
- ANVL: Verify if DUT correctly accepted or ignored RIP update
- CASE: RIP-1 sent to broadcast address
- CASE: RIP-2 sent to broadcast address
- CASE: RIP-2 sent to multicast address
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Receive Control Switch to accept RIP-1 messages only
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   failed : invalid interface [-1064]
-> go version = 1
cmd ripctrl ifopen gei0 broadcast in v1
   ok
-> cmd ripctrl ifclose gei1
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 broadcast in v1
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending RIP version 1 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B22 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xDBCD (56269)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4BD2 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0x0554 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response contained advertised route
Sending RIP version 2 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0002 (2)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 51.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0xDBCF (56271)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4BBC (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 72 
UDP: Checksum         = 0xB740 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response did not contain advertised route
Sending RIP version 2 update to 224.0.0.9

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7B16 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 52.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0xDBD1 (56273)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4BBA (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 72 
UDP: Checksum         = 0xB740 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response did not contain advertised route

Setting DUT Receive Control Switch to accept both RIP-1 and RIP-2 messages
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifopen gei0 broadcast 
   ok
-> cmd ripctrl ifclose gei1
   ok
-> cmd ripctrl ifopen gei1 broadcast 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.5: Passed

>> RIP-16.6
TEST_DESCRIPTION
For completeness, routers should also implement a receive control
switch which would determine whether to accept RIP-2 only
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility Switch
TEST_METHOD
- ANVL: Configure DUT Receive Control Switch to accept RIP-2
        messages only
- ANVL: Send RIP updates
-  DUT: Accept update if correct version and send update containing
        advertised route on other interface
- ANVL: Verify if DUT correctly accepted or ignored RIP update
- CASE: RIP-1 sent to broadcast address
- CASE: RIP-2 sent to broadcast address
- CASE: RIP-2 sent to multicast address
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Receive Control Switch to accept RIP-2 messages only
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   failed : invalid interface [-1064]
-> go version = 2
cmd ripctrl ifopen gei0 broadcast in v2
   ok
-> cmd ripctrl ifclose gei1
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 broadcast in v2
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending RIP version 1 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 53.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xFEBF (65215)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x28F4 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x5F8B (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response did not contain advertised route
Sending RIP version 2 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 54.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xAD79 (44409)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7A3A (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x4887 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 54.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response contained advertised route
Sending RIP version 2 update to 224.0.0.9

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7B13 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 55.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x8C03 (35843)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9BB0 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x4787 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 55.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response contained advertised route

Setting DUT Receive Control Switch to accept both RIP-1 and RIP-2 messages
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifopen gei0 broadcast 
   ok
-> cmd ripctrl ifclose gei1
   ok
-> cmd ripctrl ifopen gei1 broadcast 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.6: Passed

>> RIP-16.7
TEST_DESCRIPTION
For completeness, routers should also implement a receive control
switch which would determine whether to accept both
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility Switch
TEST_METHOD
- ANVL: Send RIP updates
-  DUT: Accept update and send update containing advertised route on
        other interface
- ANVL: Verify if DUT correctly accepted or ignored RIP update
- CASE: RIP-1 sent to broadcast address
- CASE: RIP-2 sent to broadcast address
- CASE: RIP-2 sent to multicast address
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Receive Control Switch to accept both RIP-1 and RIP-2 messages
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei0 broadcast 
   ok
-> cmd ripctrl ifclose gei1
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 broadcast 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending RIP version 1 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 56.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x509C (20636)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xD703 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 52 
UDP: Checksum         = 0xFF53 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 56.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response contained advertised route
Sending RIP version 2 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B1B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 57.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 172 bytes
IP: Identification         = 0xAE01 (44545)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x793A (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 152 
UDP: Checksum         = 0x3845 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 54.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 55.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 56.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 57.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response contained advertised route
Sending RIP version 2 update to 224.0.0.9

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7B10 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 58.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x7F40 (32576)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA873 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x4487 (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 58.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 6 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response contained advertised route

Setting DUT Compatibility Send Switch to RIP-1 compatibility mode (RIP-2 messages are broadcast)

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> RIP_SEND_VERSION=3
cmd ripctrl ifclose gei0 
   ok
-> cmd ripctrl ifopen gei0 broadcast  in-multi  in v2
   ok
-> cmd ripctrl ifclose gei1 
   ok
-> cmd ripctrl ifopen gei1 broadcast  in-multi  in v2 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Receive Control Switch to accept both RIP-1 and RIP-2 messages
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifopen gei0 broadcast 
   ok
-> cmd ripctrl ifclose gei1
   ok
-> cmd ripctrl ifopen gei1 broadcast 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.7: Passed

>> RIP-16.8
TEST_DESCRIPTION
For completeness, routers should also implement a receive control
switch which would determine whether to accept none.
TEST_REFERENCE
RFC 2453 s5.1 p34 Compatibility Switch
TEST_METHOD
- ANVL: Configure DUT Receive Control Switch to accept no RIP
        messages
- ANVL: Send RIP updates
-  DUT: Do not accept update
- ANVL: Verify DUT correctly ignored RIP update
- CASE: RIP-1 sent to broadcast address
- CASE: RIP-2 sent to broadcast address
- CASE: RIP-2 sent to multicast address
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/RIP/pre.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifclose gei1
   ok
-> exit
Au revoir!
Connection closed by foreign host.

Setting DUT Receive Control Switch to accept no RIP messages
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei0 broadcast in no
   ok
-> cmd ripctrl ifclose gei1
   failed : invalid interface [-1064]
-> cmd ripctrl ifopen gei1 broadcast in no
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
Sending RIP version 1 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B19 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 1
RIP: Unused         = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Unused         = 0x0000 
RIP: IP Address     = 59.0.0.0
RIP: Unused         = 0x00000000 
RIP: Unused         = 0x00000000 
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0xAF14 (44820)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x789F (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x5F8B (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response did not contain advertised route
Sending RIP version 2 update to 30.1.1.255

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B18 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 60.0.0.0
RIP: Subnet Mask    = 0.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 192 bytes
IP: Identification         = 0xAF16 (44822)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7811 (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 172 
UDP: Checksum         = 0xD5EF (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 54.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 55.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 56.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 57.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 58.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response did not contain advertised route
Sending RIP version 2 update to 224.0.0.9

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:00:00:09
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7B0D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 224.0.0.9
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 32 
UDP: Checksum         = 0x0000 
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 61.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 0.0.0.0
RIP: Metric         = 5 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Waiting (up to 40.000 seconds) for RIP Response on net 40.1.1.0
Received RIP v2 Response (regular update) from 40.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 192 bytes
IP: Identification         = 0xAF18 (44824)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x780F (Correct)
IP: Source Address         = 40.1.1.5
IP: Destination Address    = 40.1.1.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 520 (route)
UDP: Destination Port = 520 (route)
UDP: Length           = 172 
UDP: Checksum         = 0xD5EF (Correct)
UDP:
RIP: ---- RIP Packet ----
RIP:
RIP: Command        = Response (0x02)
RIP: Version        = 2
RIP: Routing Domain = 0x0000 
RIP:
RIP:  --- Tuple 1 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 128.224.166.0
RIP: Subnet Mask    = 255.255.254.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP:  --- Tuple 2 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 50.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 3 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 54.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 4 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 55.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 5 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 56.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 6 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 57.0.0.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 7 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 58.0.0.0
RIP: Subnet Mask    = 255.0.0.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 16 Infinity
RIP:
RIP:  --- Tuple 8 ---
RIP:
RIP: Address Family = IP (0x0002)
RIP: Route Tag      = 0x0000 
RIP: IP Address     = 30.1.1.0
RIP: Subnet Mask    = 255.255.255.0
RIP: Next Hop       = 40.1.1.5
RIP: Metric         = 1 
RIP:
RIP: ---- End RIP Packet ----
RIP:

Response did not contain advertised route

Setting DUT Receive Control Switch to accept both RIP-1 and RIP-2 messages

Setting DUT Receive Control Switch to accept both RIP-1 and RIP-2 messages
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/RIP/rip-compatibility-receive-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ripctrl ifclose gei0
   ok
-> cmd ripctrl ifopen gei0 broadcast 
   ok
-> cmd ripctrl ifclose gei1
   ok
-> cmd ripctrl ifopen gei1 broadcast 
   ok
-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
Executing system command:
  "./DocScriptQ35/RIP/after.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd reconfigure iprip
ipd: reconfigure iprip ok
-> exit
Au revoir!
Connection closed by foreign host.
<< RIP-16.8: Passed
Executing system command:
  "./DocScriptQ35/RIP/RIPpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -o iprip.drop.hostroute "0"
sysvar: iprip.drop.hostroute=0 ok
-> cmd ripctrl ifclose gei0
   ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> cmd ripctrl ifclose gei1
   ok
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          8
Number of tests passed:       8
Number of tests failed:       0
Number of tests inconclusive: 0
