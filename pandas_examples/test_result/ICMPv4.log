ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5775092 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlicmp icmp 1-5.3 7.1-10 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlicmp.prm 

Reboot Time                              60                  # (0x0000003C)
Reboot Command                           ""
Post suite Command                       ""
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
ICMP Suite Setup Command                 "./DocScriptQ35/ICMP/icmp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
ICMP Unused UDP Port                     1000                # (0x000003E8)
ICMP DUT Supports ICMP Destination Unreachable Message True
ICMP DUT Supports ICMP Time Exceeded Message True
ICMP DUT Supports ICMP Timestamp Message True
ICMP Invalid ICMP Type                   255                 # (0x000000FF)
IP DUT Static Route Add Command          "./DocScriptQ35/ICMP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT Static Route Delete Command       "./DocScriptQ35/ICMP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT MTU Set Command                   "./DocScriptQ35/ICMP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT MTU Reset Command                 "./DocScriptQ35/ICMP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT Background Echo Request Send Command "./DocScriptQ35/ICMP/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT is a Router                       True
IP High MTU                              1500                # (0x000005DC)
IP Low MTU                               100                 # (0x00000064)
IP Initial Reassembly Timeout value      70.000000
IP Unrecognized Option Type              32                  # (0x00000020)
IP DUT Supports IP Timestamp Option      True
IP DUT Supports IP Loose Source And Record Route Option True
IP DUT Supports MTU Configuration        True
IP Listen Time                           5                   # (0x00000005)
IP Tolerance Factor                      1                   # (0x00000001)
IP Tolerance Time                        2                   # (0x00000002)
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
PPP Delay After NCP                      0                   # (0x00000000)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlicmp.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Gateway                               30.1.1.5
  IP Broadcast Address                     30.1.1.255
  IP First Unused Address                  30.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Gateway                               40.1.1.5
  IP Broadcast Address                     40.1.1.255
  IP First Unused Address                  40.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/icmp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask  255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask  255.255.255.0 up
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

00:1B:21:7D:57:BA < 00:15:17:C8:90:28 ARP Rsp 30.1.1.150

Device Under Test found at 30.1.1.5 as 00:15:17:C8:90:28
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite ICMP
RFC 792: 'INTERNET CONTROL MESSAGE PROTOCOL'
(J. Postel, ISI, September 1981)
RFC 1122: 'Requirements for Internet Hosts -- Communications Layers'
(Robert Braden, USC/Informations Sciences Institute, October 1989)
RFC 1812: 'Requirements for IP Version 4 Routers'
(F. Baker, Editor, Cisco Systems, June 1995)

ANVL Test Suite Required Setup:
This suite expects to be running against an IP Node(Host/Router). Many
of the tests can be run against a single interface (Host) and remaining
tests require that the machine ANVL is running on is connected to 2
interfaces that are connected to the router under test.

The ANVL config file must contain at least one IP interface
configuration with DUT configured as ANVL's default gateway.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> ICMP-1.1
TEST_DESCRIPTION
A host must respond to all ICMP Echo Requests sent to it,by 
sending an ICMP Echo Reply back to the sender of ICMP Echo Request.
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)

Waiting (up to 7.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE535 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x8874 (34932)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB3AC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED35 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-1.1: Passed

>> ICMP-1.2
TEST_DESCRIPTION
An IP router must forward all the ICMP Echo Requests and replies 
to and from the networks it is connected to.
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-1>
-  DUT: Forward the ICMP Echo Request
- ANVL: Verify that the received ICMP Echo Request remains
        unmodified
- ANVL: Send an ICMP Echo Reply to <DIface-1>, containing:
        - IP Source Address field set to address of host-2
        - IP Destination Address field set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Forward the ICMP Echo Reply
- ANVL: Verify that the received ICMP Echo Reply remains
        unmodified 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)

Waiting (up to 7.000 seconds) for ICMP Echo Request Message on net 40.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3190 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE534 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0002 (2)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3290 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE534 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0002 (2)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <DIface-1>

Received ICMP Echo Request correctly remains unmodified

Sending an ICMP Echo Reply to <DIface-1> (40.1.1.5),
containing:
- IP Source Address field set to address of host-2
  (40.1.1.150)
- IP Destination Address field set to address of host-1
  (30.1.1.150)

Waiting (up to 7.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3190 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED33 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3290 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED33 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Reply on <DIface-0>

Received ICMP Echo Reply correctly remains unmodified

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-1.2: Passed

>> ICMP-1.3
TEST_DESCRIPTION
DUT sends Timestamp Reply for Timestamp Message.
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
- ANVL: Send an ICMP Timestamp Message to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Timestamp Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Timestamp Message to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)

Waiting (up to 7.000 seconds) for ICMP Timestamp Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C39 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 13 (Timestamp)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x5298 (Correct)
ICMP:
ICMP: ---- ICMP Timestamp Data ----
ICMP:
ICMP: Identifier          = 0x0004 (4)
ICMP: Sequence Number     = 0x0000 (0)
ICMP: Originate Timestamp = 43163089
ICMP: Receive Timestamp   = 0
ICMP: Transmit Timestamp  = 0
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x8875 (34933)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB3C3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 14 (Timestamp Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA260 (Correct)
ICMP:
ICMP: ---- ICMP Timestamp Data ----
ICMP:
ICMP: Identifier          = 0x0004 (4)
ICMP: Sequence Number     = 0x0000 (0)
ICMP: Originate Timestamp = 43163089
ICMP: Receive Timestamp   = 251800
ICMP: Transmit Timestamp  = 251800
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected ICMP Timestamp Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-1.3: Passed

>> ICMP-1.5
TEST_DESCRIPTION
DUT sends ICMP Echo Request
TEST_REFERENCE
ANVL, setup verification
TEST_METHOD
- ANVL: Cause DUT to send an ICMP Echo Request through <DIface-0>,
        containing:
        - IP Destination Address field set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send an ICMP Echo Request message 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Causing DUT to send 1 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 30.1.1.150
ICMP Echo Data size 16
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0 1 16

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 7.000 seconds) for ICMP Echo Request Message on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping -c 1 -s 36 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x385F (14431)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x03CA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x77CF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x07AA (1962)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [28 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B               0123456789:;
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Request from DUT

Pinging 30.1.1.150 (30.1.1.150) with 36 bytes of data:

--- 30.1.1.150 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1016 ms
exit
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-1.5: Passed

>> ICMP-1.6
TEST_DESCRIPTION
If G2 and the host identified by the internet source address of
the datagram are on the same network, a redirect message is sent
to the host.
(Note: here gateway address must be specified)
TEST_REFERENCE
RFC 792 p13 Redirect Message
TEST_METHOD
 SETUP: Configure DUT to add static route for host with address
        different from <host-2> via gateway <RTR> and outgoing interface
        <DIface-0>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of the host with
          address different from that of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Redirect Message 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Causing DUT to add a static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> Des:::40.1.1.160
NET:::255.255.255.255
GATEWAY:::30.1.1.160
cmd route add -host 40.1.1.160 30.1.1.160
    add host 40.1.1.160: gateway 30.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       4     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       2     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
40.1.1.160                      30.1.1.160                    UGHS     0     gei0   0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       64    gei2   0    
vxTarget                        vxTarget                      UH       162   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       2712  lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to 40.1.1.160 (address different from
  address of host-2 (40.1.1.150))

Waiting (up to 7.000 seconds) for ICMP Redirect Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3186 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.160
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE531 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0005 (5)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x2FD5 (12245)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0C2A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 5 (Redirect)
ICMP: Code             = 1 (Redirect Datagram for the Host)
ICMP: Checksum         = 0xDB5D (Correct)
ICMP:
ICMP: ---- ICMP Redirect Data ----
ICMP:
ICMP: Gateway Address     = 30.1.1.160
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 64 bytes
ICMP: IP: Identification         = 0x0000 (0)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 63
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0x3286 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 40.1.1.160
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 E5 31 00 05 00 00                           ...1....
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Redirect Message on <DIface-0>

Causing DUT to delete static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -host  40.1.1.160
    delete host 40.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       6     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       2     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       68    gei2   0    
vxTarget                        vxTarget                      UH       179   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       2712  lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-1.6: Passed

>> ICMP-2.1
TEST_DESCRIPTION
To avoid the infinite regress of messages about messages etc., no
ICMP messages are sent about ICMP messages.
TEST_REFERENCE
RFC 792 p1 Introduction
TEST_METHOD
- ANVL: Cause DUT to send an ICMP Echo Request through <DIface-0>,
        containing:
        - IP Destination Address field set to address of host-1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send an ICMP Echo Request message 
- ANVL: Send an ICMP Parameter Problem Message to <DIface-0>,
        containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 11 
            - flg field set to zero
            - one timestamp value
        - ICMP Pointer field set to 20 (pointing option type)
        - ICMP Data field set to "Internet header + 64 bits of
          original data datagram"
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Parameter Problem Message 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Causing DUT to send 1 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 30.1.1.150
ICMP Echo Data size 16
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 0 1 16

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 7.000 seconds) for ICMP Echo Request Message on net 30.1.1.0
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ping -c 1 -s 36 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x9028 (36904)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xAC00 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x7BE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x77BB (30651)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [28 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B               0123456789:;
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Request from DUT

Sending an ICMP Paramter Problem Message to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
  - IP Options, containing:
    - One Internet Timestamp option, containing:
      - length field set to 12
      - pointer field set to 11
      - flg field set to zero
      - one timestamp value
- ICMP Pointer field set to 20 (pointing option type)
- ICMP Data field set to "Internet header + 64 bits of
  original data datagram"

Waiting (up to 7.000 seconds) for No ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 68 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0589 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 11
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43180533
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0x5886 (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 20
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x9028 (36904)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xAC00 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x7BE *Should be 0x8044*
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x77BB (30651)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Pinging 30.1.1.150 (30.1.1.150) with 36 bytes of data:

--- 30.1.1.150 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 1017 ms
exit
-> 
Ignoring unexpected ICMP Destination Unreachable from 30.1.1.5 to 30.1.1.150

Correctly did not receive ICMP Parameter Problem Message on
<DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-2.1: Passed

>> ICMP-2.2
TEST_DESCRIPTION
Also ICMP messages are only sent about errors in handling fragment
zero of fragmented datagrams.
(Note: This test tests that ICMP error message is sent on receiving
       the fragment having Fragment Offset field set to zero)
TEST_REFERENCE
RFC 792 p1 Introduction
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 10
            - pointer field set to 9
            - one timestamp value
        - first half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send one ICMP Parameter Problem message 
- ANVL: Verify that the received ICMP Parameter Problem Message
        contains:
        - Pointer field set to 22 (Basic IP Header length (20) + 
                                   third octet (pointer field of 
                                   timestamp option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Fragment Offset field set to zero
- IP Flags field, containing:
  - MF bit set to 1
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 10
    - pointer field set to 9
    - one timestamp value
- first half of the constructed ICMP packet (24 octets)

Waiting (up to 7.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB8B3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 10
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43192536
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE530 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0006 (6)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 84 bytes
IP: Identification         = 0xC3A9 (50089)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x785D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xC2AD (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 22
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB8B3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 10
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43192536
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE530 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0006 (6)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field in ICMP Parameter Protocol Message is correctly
set to 22

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-2.2: Passed

>> ICMP-2.3
TEST_DESCRIPTION
Also ICMP messages are only sent about errors in handling fragment
zero of fragmented datagrams.
(Note: This test tests that ICMP error message is not sent on
       receiving non zero fragment i.e Fragment Offset field set
       to non-zero value)
TEST_REFERENCE
NEGATIVE
RFC 792 p1 Introduction
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 12
            - pointer field set to 9
            - one timestamp value
        - first half of the constructed ICMP packet
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags first, containing:
          - MF bit set to zero
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 10
            - pointer field set to 9
            - one timestamp value
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Parameter Problem messages 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Fragment Offset field set to zero
- IP Flags field, containing:
  - MF bit set to 1
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 12
    - pointer field set to 9
    - one timestamp value
- first half of the constructed ICMP packet (24 octets)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xA526 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43197539
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE52F 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0007 (7)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Fragment Offset field set to length of data
  sent in first IP packet in unit of 8 octets
- IP Flags field, containing:
  - MF bit set to 0
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 10
    - pointer field set to 9
    - one timestamp value
- remaining half of the constructed ICMP packet

Waiting (up to 7.000 seconds) for No ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 52 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xC528 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 10
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43197540
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---


Correctly did not receive ICMP Parameter Problem Message on <DIface-0>

Waiting (up to 66.000 seconds) for DUT to finish IP packets processing


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-2.3: Passed

>> ICMP-2.4
TEST_DESCRIPTION
An ICMP error message MUST NOT be sent as the result of receiving
a datagram destined to an IP broadcast.
TEST_REFERENCE
RFC 1122 s3.2.2 p39 Internet Control Message Protocol -- ICMP
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to <broadcast-address>
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 10
            - pointer field set to 9
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Parameter Problem Message 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to broadcast address (255.255.255.255)
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 10
    - pointer field set to 9
    - one timestamp value

Waiting (up to 7.000 seconds) for No ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB365 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 10
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43275543
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE52E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0008 (8)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Correctly did not receive ICMP Parameter Problem Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-2.4: Passed

>> ICMP-2.5
TEST_DESCRIPTION
If an ICMP message of unknown type is received, it MUST be silently 
discarded.
TEST_REFERENCE
NEGATIVE
RFC 1122 s3.2.2 p38 Internet Control Message Protocol -- ICMP
TEST_METHOD
- ANVL: Send an ICMP Message to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - Type field set to <InvalidICMPType>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send any ICMP Message 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Type field set to 255 (<InvalidICMPType>)

Waiting (up to 7.000 seconds) for No ICMP Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C45 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 255 (*Unknown Type 255*)
ICMP: Code             = 0 (*Unknown*)
ICMP: Checksum         = 0xF6 (Correct)
ICMP:
ICMP: --- Trailing Data [4 bytes] ---
ICMP:  00 09 00 00                                       ....
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Correctly did not receive any ICMP Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-2.5: Passed

>> ICMP-3.1
TEST_DESCRIPTION
If, in the destination host, the IP module cannot deliver the
datagram because the indicated protocol module or process port is
not active, the destination host may send a destination unreachable
message to the source host.
TEST_REFERENCE
RFC 792 p5 Destination Unreachable Message
TEST_METHOD
- ANVL: Send a UDP Packet to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Protocol field set to <ipTypeUDP>
        - UDP Destination Port set to <UnusedUDPPort>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Destination Unreachable message 
- ANVL: Verify that the received Destination Unreachable message
        contains:
        - Code value set to 3 (port unreachable)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending a UDP Packet to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Protocol field set to UDP
- UDP Destination Port set to 1000

Waiting (up to 7.000 seconds) for ICMP Destination Unreachable Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3C35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 1000 (1000)
UDP: Length           = 8 
UDP: Checksum         = 0xBD59 (Correct)
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x352A (13610)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x06F9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 3 (Destination Unreachable)
ICMP: Code             = 3 (Port Unreachable)
ICMP: Checksum         = 0x3BB3 (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Unused           = 0x00000000
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 28 bytes
ICMP: IP: Identification         = 0x0000 (0)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 64
ICMP: IP: Protocol               = UDP (17)
ICMP: IP: Header Checksum        = 0x3C35 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 30.1.1.5
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  00 00 03 E8 00 08 BD 59                           .......Y
ICMP: IP: --- 64 bits of datagram End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Destination Unreachable message on
<DIface-0>

Code field of ICMP Destination Unreachable Message is
correctly set to 3 (Port Unreachable)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-3.1: Passed

>> ICMP-3.2
TEST_DESCRIPTION
Another case is when a datagram must be fragmented to be forwarded
by a gateway yet the Don't Fragment flag is on.  In this case the
gateway return a destination unreachable message.
TEST_REFERENCE
RFC 792 p5 Destination Unreachable Message
TEST_METHOD
 SETUP: Configure DUT to set MTU on <DIface-0> to <HighMTU>
 SETUP: Configure DUT to set MTU on <DIface-1> to <LowMTU>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP Total Length field set to greater than <LowMTU>
        - IP Flags field, containing:
          - DF bit set to 1
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send an ICMP Destination Unreachable Message 
- ANVL: Verify that the received ICMP Destination Unreachable 
        Message contains:
        - Code field set to 4 (fragmentation needed and DF set)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


Causing DUT to set MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to set MTU to 100 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 100

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-mtu-set-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 100 up
-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP Total Length field set to 110 (greater than <LowMTU> (100))
- IP Flags field, containing:
  - DF bit set to 1

Waiting (up to 7.000 seconds) for ICMP Destination Unreachable Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 110 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF161 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF7F5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000A (10)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [82 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF                                             ..
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 138 bytes
IP: Identification         = 0x042A (1066)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x37A7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 3 (Destination Unreachable)
ICMP: Code             = 4 (Fragmentation Needed and DF Set)
ICMP: Checksum         = 0xFC97 (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Next-Hop MTU      = 100
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 110 bytes
ICMP: IP: Identification         = 0x0000 (0)
ICMP: IP: Flags                  = 2
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.1.                  = Don't Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 64
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0xF161 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 40.1.1.150
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 F7 F5 00 0A 00 00                           ........
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [82 bytes] ---
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF   ................
ICMP:  FF FF                                             ..
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Destination Unreachable Message on <DIface-0>

Code field of ICMP Destination Unreachable Message is
correctly set to 4 (Fragmentation Needed and DF Set)

Causing DUT to Reset MTU to 1500 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to Reset MTU to 1500 on <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 1500

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-mtu-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1 mtu 1500 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-3.2: Passed

>> ICMP-4.1
TEST_DESCRIPTION
If the gateway processing a datagram finds the time to live field
is zero it may notify the source host via the time exceeded
message.
TEST_REFERENCE
RFC 792 p7 Time Exceeded Message
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP TTL field set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Time Exceeded Message 
- ANVL: Verify that the received ICMP Time Exceeded Message 
        contains:
        - Code field set to 0 (time to live exceeded in transit)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP TTL field set to zero

Waiting (up to 7.000 seconds) for ICMP Time Exceeded Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 0
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7190 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE52B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000B (11)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x8274 (33396)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB98A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 11 (Time Exceeded)
ICMP: Code             = 0 (Time To Live Exceeded in Transit)
ICMP: Checksum         = 0xF4FF (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Unused           = 0x00000000
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 64 bytes
ICMP: IP: Identification         = 0x0000 (0)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 0
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0x7190 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 40.1.1.150
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 E5 2B 00 0B 00 00                           ...+....
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Time Exceeded Message on <DIface-0>

Code field of ICMP Time Exceeded Message is
correctly set to 0 (Time To Live Exceeded in Transit)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-4.1: Passed

>> ICMP-4.2
TEST_DESCRIPTION
If a host reassembling a fragmented datagram cannot complete the
reassembly due to missing fragments within its time limit it
discards the datagram.
TEST_REFERENCE
RFC 792 p7 Time Exceeded Message
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - first half of the constructed ICMP packet
- ANVL: Wait for <FragReassemlyTimeout> seconds
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Identification field set to <id>
        - Fragment Offset field set to data size sent in first 
          IP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0> 
-  DUT: Discard the fragments and do not send ICMP Echo Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 223
- IP Fragment Offset field set to zero
- IP Flags field, containing:
  - MF bit set to 1
- first half of the constructed ICMP packet (24 octets)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DF (223)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1B56 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE52A 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000C (12)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 72.000 seconds) for fragment reassembly

Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Identification field set to 223
- IP Fragment Offset field set to length of data
  sent in first IP packet in unit of 8 octets
- IP Flags field, containing:
  - MF bit set to 0
- last half of the constructed ICMP packet

Waiting (up to 7.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x00DF (223)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3B57 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Ignoring unexpected ICMP Time Exceeded from 30.1.1.5 to 30.1.1.150

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Correctly did not receive ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-4.2: Passed

>> ICMP-4.3
TEST_DESCRIPTION
If a host reassembling a fragmented datagram cannot complete the
reassembly due to missing fragments within its time limit it may
send a time exceeded message.
TEST_REFERENCE
RFC 792 p7 Time Exceeded Message
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Fragment Offset field set to zero
        - Flags field, containing:
          - MF bit set to 1
        - first half of the constructed ICMP packet
- ANVL: Wait for <FragReassemlyTimeout> seconds
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send an ICMP Time Exceeded message 
- ANVL: Verify that the received ICMP Time Exceeded message 
        contains:
        - Code field set to 1 (fragment reassembly time exceeded)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Fragment Offset field set to zero
- IP Flags field, containing:
  - MF bit set to 1
- first half of the constructed ICMP packet (24 octets)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D3 (211)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x1B62 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE529 
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000D (13)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Waiting (up to 72.000 seconds) for fragment reassembly

Waiting (up to 7.000 seconds) for ICMP Time Exceeded Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x116B (4459)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2AA8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 11 (Time Exceeded)
ICMP: Code             = 1 (Fragment Reassembly Time Exceeded)
ICMP: Checksum         = 0xD9AC (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Unused           = 0x00000000
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 44 bytes
ICMP: IP: Identification         = 0x00D3 (211)
ICMP: IP: Flags                  = 1
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..1                  = More Fragments
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 64
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0x1B62 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 30.1.1.5
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 E5 29 00 0D 00 00                           ...)....
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [16 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Time Exceeded Message on <DIface-0>

Code field of ICMP Time Exceeded Message is correctly set to
1 (Fragment Reassembly Time Exceeded)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-4.3: Passed

>> ICMP-4.4
TEST_DESCRIPTION
If fragment zero is not available then no time exceeded need be
sent at all.
TEST_REFERENCE
RFC 792 p7 Time Exceeded Message
TEST_METHOD
- ANVL: Construct an ICMP Echo Request. Send an IP packet to
        <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - Fragment Offset field set to half of the constructed 
          ICMP packet in unit of 8-octets
        - Flags field, containing:
          - MF bit set to zero
        - last half of the constructed ICMP packet
- ANVL: Wait for <FragReassemlyTimeout> seconds
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Time Exceeded message 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an IP packet to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Fragment Offset field set to half of the constructed
  ICMP packet in unit of 8-octets
- IP Flags field, containing:
  - MF bit set to zero
- last half of the constructed ICMP packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0003 (24 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C26 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet (continuation [20 bytes]) ----
ICMP:
ICMP: --- Data [20 bytes] ---
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Waiting (up to 72.000 seconds) for fragment reassembly

Waiting (up to 7.000 seconds) for No ICMP Time Exceeded Message on net 30.1.1.0

Correctly did not receive ICMP Time Exceeded Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-4.4: Passed

>> ICMP-4.5
TEST_DESCRIPTION
Unused field in Time Exceeded Message is set to zero and
it contains the exactly same Internet Header and 64 bits of
Original Datagram.
TEST_REFERENCE
RFC 792 p7 Time Exceeded Message
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of host-2
        - IP TTL field set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Time Exceeded Message 
- ANVL: Verify that the received ICMP Time Exceeded Message 
        contains:
        - Unused field set to zero
        - Data field contains exactly same IP header and 64 bits
          of Original Data sent to the DUT 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of host-2 (40.1.1.150)
- IP TTL field set to zero

Waiting (up to 7.000 seconds) for ICMP Time Exceeded Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 0
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x7116 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE527 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000F (15)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0xE611 (58897)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x55ED (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 11 (Time Exceeded)
ICMP: Code             = 0 (Time To Live Exceeded in Transit)
ICMP: Checksum         = 0xF4FF (Correct)
ICMP:
ICMP: ---- ICMP Data ----
ICMP:
ICMP: Unused           = 0x00000000
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 64 bytes
ICMP: IP: Identification         = 0x007A (122)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 0
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0x7116 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 40.1.1.150
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 E5 27 00 0F 00 00                           ...'....
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Time Exceeded Message on <DIface-0>

Unused field of ICMP Time Exceeded Message is correctly set to zero

Data field of ICMP Time Exceeded Message is correctly set to
exactly same IP header and 64 bits of Original Data sent to the DUT
45 00 00 40 00 7A 00 00 00 01 71 16 1E 01 01 96   E..@.z....q.....
28 01 01 96 08 00 E5 27 00 0F 00 00               (......'....

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-4.5: Passed

>> ICMP-5.1
TEST_DESCRIPTION
If the gateway or host processing a datagram finds a problem with
the header parameters such that it cannot complete processing the
datagram it must discard the datagram.
TEST_REFERENCE
RFC 792 p9 Parameter Problem Message
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 10
            - pointer field set to 9
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Discard the ICMP Echo Request and do not send ICMP Echo
        Reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 10
    - pointer field set to 9
    - one timestamp value

Waiting (up to 7.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x19DE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 10
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43569044
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE526 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0010 (16)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Ignoring unexpected ICMP Parameter Problem from 30.1.1.5 to 30.1.1.150

Correctly did not receive ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-5.1: Passed

>> ICMP-5.2
TEST_DESCRIPTION
If the gateway or host processing a datagram finds a problem with
the header parameters such that it cannot complete processing the
datagram it may notify the source host via the parameter problem
message.
TEST_REFERENCE
RFC 792 p9 Parameter Problem Message
TEST_METHOD
- ANVL: Send an IP packet to <DIface-0>, containing:
        - Source Address field set to address of host-1
        - Destination Address field set to address of DUT
        - IP Options, containing:
          - One Internet Timestamp option, containing:
            - length field set to 10
            - pointer field set to 9
            - one timestamp value
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message 
- ANVL: Verify that the received ICMP Parameter Problem 
        Message contains:
        - Pointer field set to 22 (Basic IP Header length (20) + 
                                   Length of Type field (1) +
                                   Length of Length field (1)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - One Internet Timestamp option, containing:
    - length field set to 10
    - pointer field set to 9
    - one timestamp value

Waiting (up to 7.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xEAFA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 10
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43581047
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE525 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0011 (17)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 104 bytes
IP: Identification         = 0x311B (12571)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0AD8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xDDFF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 22
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 8 (32 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 76 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xEAFA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 10
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43581047
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP: --- Padding [1 bytes] ---
IP:  00                                                .
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE525 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0011 (17)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Pointer field in ICMP Parameter Protocol Message is
correctly set to 22

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-5.2: Passed

>> ICMP-5.3
TEST_DESCRIPTION
Unused filed in Parameter Problem Message is set to zero and
it contains the exactly same Internet Header and 64 bits of
Original Datagram.
TEST_REFERENCE
RFC 792 p9 Parameter Problem Message
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - IP Options, containing:
          - Two Internet Timestamp options, each containing:
            - length field set to 12 
            - pointer field set to 9  
            - flg field set to zero 
            - one timestamp value  
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Parameter Problem Message 
- ANVL: Verify that the received ICMP Parameter Problem Message 
        contains:
        - Unused field set to zero
        - Data field contains exactly same IP header and 64 bits
          of Original Data sent to the DUT 
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- IP Options, containing:
  - Two Internet Timestamp options, each containing:
    - length field set to 12
    - pointer field set to 9 (one timestamp sent by ANVL)
    - flg field set to zero
    - one timestamp value

Waiting (up to 7.000 seconds) for ICMP Parameter Problem Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 11 (44 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x72B8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43586051
IP OPT: TimeStamp          = 0
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43586051
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE524 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0012 (18)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 116 bytes
IP: Identification         = 0x311C (12572)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0ACB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 12 (Parameter Problem)
ICMP: Code             = 0 (Pointer Indicates the Error)
ICMP: Checksum         = 0xD3FF (Correct)
ICMP:
ICMP: ---- ICMP Parameter Problem Data ----
ICMP:
ICMP: Pointer          = 32
ICMP: Unused           = 0x000000
ICMP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 11 (44 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x72B8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43586051
IP OPT: TimeStamp          = 0
IP OPT:
IP OPT: Type               = 0x44 (Internet Timestamp)
IP OPT: Length             = 12
IP OPT: Pointer            = 9
IP OPT: Overflow           = 0
IP OPT: Flag               = 0 (Time stamps only)
IP OPT: TimeStamp          = 43586051
IP OPT: TimeStamp          = 0
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE524 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0012 (18)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Parameter Problem Message on <DIface-0>

Unused field of ICMP Parameter Problem Message is correctly
set to zero

Data field of ICMP Parameter Problem Message is correctly set to
exactly same IP header and 64 bits of Original Data sent to the DUT
4B 00 00 58 00 00 00 00 40 01 72 B8 1E 01 01 96   K..X....@.r.....
1E 01 01 05 44 0C 09 00 02 99 12 03 00 00 00 00   ....D...........
44 0C 09 00 02 99 12 03 00 00 00 00 08 00 E5 24   D..............$
00 12 00 00                                       ....

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-5.3: Passed

>> ICMP-7.1
TEST_DESCRIPTION
If G2 and the host identified by the internet source address of
the datagram are on the same network, a redirect message is sent
to the host.
(Note: here gateway address must be specified)
TEST_REFERENCE
RFC 792 p13 Redirect Message
TEST_METHOD
 SETUP: Configure DUT to add static route for host with address
        different from <host-2> via gateway <RTR> and outgoing interface
        <DIface-0>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of the host with
          address different from that of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Redirect Message 
- ANVL: Verify that the received ICMP Redirect Message contains:
        - Gateway Internet Address field set to address of RTR
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Causing DUT to add a static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> Des:::40.1.1.160
NET:::255.255.255.255
GATEWAY:::30.1.1.160
cmd route add -host 40.1.1.160 30.1.1.160
    add host 40.1.1.160: gateway 30.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       20    gei0   0    
30.1.1.5                        30.1.1.5                      UH       15    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
40.1.1.160                      30.1.1.160                    UGHS     0     gei0   0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       152   gei2   0    
vxTarget                        vxTarget                      UH       267   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       7720  lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to 40.1.1.160 (address different from
  address of host-2 (40.1.1.150))

Waiting (up to 7.000 seconds) for ICMP Redirect Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3186 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.160
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE523 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0013 (19)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x7CF3 (31987)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xBF0B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 5 (Redirect)
ICMP: Code             = 1 (Redirect Datagram for the Host)
ICMP: Checksum         = 0xDB5D (Correct)
ICMP:
ICMP: ---- ICMP Redirect Data ----
ICMP:
ICMP: Gateway Address     = 30.1.1.160
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 64 bytes
ICMP: IP: Identification         = 0x0000 (0)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 63
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0x3286 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 40.1.1.160
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 E5 23 00 13 00 00                           ...#....
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Redirect Message on <DIface-0>

Gateway Internet Address field of ICMP Redirect Message
is correctly set to 30.1.1.160

Causing DUT to delete static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -host  40.1.1.160
    delete host 40.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       22    gei0   0    
30.1.1.5                        30.1.1.5                      UH       15    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       153   gei2   0    
vxTarget                        vxTarget                      UH       284   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       9900  lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-7.1: Passed

>> ICMP-7.2
TEST_DESCRIPTION
If G2 and the host identified by the internet source address of
the datagram are on the same network, a redirect message is sent
to the host and the gateway forwards the original datagram's data
to its internet destination.
TEST_REFERENCE
RFC 792 p13 Redirect Message
TEST_METHOD
 SETUP: Configure DUT to add static route for host with address
        different from <host-2> via gateway <RTR> and outgoing interface
        <DIface-0>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of the host with
          address different from that of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <RTR-0>
-  DUT: Send ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Causing DUT to add a static route on DUT for
Destination Address 90.0.3.10
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
90.0.3.10 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> Des:::90.0.3.10
NET:::255.255.255.255
GATEWAY:::30.1.1.160
cmd route add -host 90.0.3.10 30.1.1.160
    add host 90.0.3.10: gateway 30.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       22    gei0   0    
30.1.1.5                        30.1.1.5                      UH       15    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
90.0.3.10                       30.1.1.160                    UGHS     0     gei0   0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       158   gei2   0    
vxTarget                        vxTarget                      UH       301   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       11980 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to 90.0.3.10 (address different from
  address of host-2 (40.1.1.150))

Waiting (up to 7.000 seconds) for ICMP Echo Request Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xFE1C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 90.0.3.10
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE522 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0014 (20)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Ignoring unexpected ICMP Redirect from 30.1.1.5 to 30.1.1.150
Received ARP Request for 30.1.1.160 from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.160
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 30.1.1.160

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:02:03:04:05:06
ARP: Source Protocol Address      = 30.1.1.160
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:02:03:04:05:06
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3286 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.160
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE523 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0013 (19)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected forwarded ICMP Echo Request on <RTR-0>

Causing DUT to delete static route on DUT for
Destination Address 90.0.3.10
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
90.0.3.10 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -host  90.0.3.10
    delete host 90.0.3.10
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       23    gei0   0    
30.1.1.5                        30.1.1.5                      UH       15    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       159   gei2   0    
vxTarget                        vxTarget                      UH       318   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       14152 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-7.2: Passed

>> ICMP-7.3
TEST_DESCRIPTION
For datagrams with the IP source route options and the gateway
address in the destination address field, a redirect message is
not sent even if there is a better route to the ultimate
destination than the next address in the source route.
TEST_REFERENCE
RFC 792 p13 Redirect Message
TEST_METHOD
 SETUP: Configure DUT to add static route for host with address
        different from <host-2> via gateway <RTR> and outgoing interface
        <DIface-0>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of <DIface-0>
        - IP Options, containing:
          - One Loose Source and Record Route option,
            containing:
            - length field set to 7
            - pointer field set to 4
            - route data, containing:
              - address of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Redirect Message 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Causing DUT to add a static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> Des:::40.1.1.160
NET:::255.255.255.255
GATEWAY:::30.1.1.160
cmd route add -host 40.1.1.160 30.1.1.160
    add host 40.1.1.160: gateway 30.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       23    gei0   0    
30.1.1.5                        30.1.1.5                      UH       15    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
40.1.1.160                      30.1.1.160                    UGHS     0     gei0   0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       161   gei2   0    
vxTarget                        vxTarget                      UH       335   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       16244 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of <DIface-0> (30.1.1.5)
- IP Options, containing:
  - One Loose Source and Record Route option,
    containing:
    - length field set to 7
    - pointer field set to 4
    - route data, containing:
      - address of host-2

Waiting (up to 7.000 seconds) for No ICMP Redirect Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 7 (28 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x11E8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP: ---- Options ----
IP OPT:
IP OPT: Type               = 0x83 (Loose Source and Record Route)
IP OPT: Length             = 7
IP OPT: Pointer            = 4
IP OPT: Route Data         = 40.1.1.160
IP OPT:
IP OPT: Type               = 0x00 (End of Option List)
IP OPT:
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE521 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0015 (21)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Ignoring unexpected ICMP Destination Unreachable from 30.1.1.5 to 30.1.1.150

Correctly did not receive ICMP Redirect Message on <DIface-0>

Causing DUT to delete static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -host  40.1.1.160
    delete host 40.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       24    gei0   0    
30.1.1.5                        30.1.1.5                      UH       16    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       166   gei2   0    
vxTarget                        vxTarget                      UH       352   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       18384 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-7.3: Passed

>> ICMP-7.4
TEST_DESCRIPTION
Redirect Message contains the exactly same Internet Header and
64 bits of Original Datagram.
TEST_REFERENCE
RFC 792 p13 Redirect Message
TEST_METHOD
 SETUP: Configure DUT to add static route for host with address
        different from <host-2> via gateway <RTR> and outgoing interface
        <DIface-0>
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of the host with
          address different from that of host-2
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Redirect Message 
- ANVL: Verify that the received ICMP Redirect Message contains:
        - Data field contains exactly same IP header and 64 bits
          of Original Data sent to the DUT 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Causing DUT to add a static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> Des:::40.1.1.160
NET:::255.255.255.255
GATEWAY:::30.1.1.160
cmd route add -host 40.1.1.160 30.1.1.160
    add host 40.1.1.160: gateway 30.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       24    gei0   0    
30.1.1.5                        30.1.1.5                      UH       16    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
40.1.1.160                      30.1.1.160                    UGHS     0     gei0   0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       168   gei2   0    
vxTarget                        vxTarget                      UH       369   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       20416 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to 40.1.1.160 (address different from
  address of host-2 (40.1.1.150))

Waiting (up to 7.000 seconds) for ICMP Redirect Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3186 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.160
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE520 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0016 (22)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x06
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....1..             = High Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x9D5C (40284)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x9EA2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 5 (Redirect)
ICMP: Code             = 1 (Redirect Datagram for the Host)
ICMP: Checksum         = 0xDB5D (Correct)
ICMP:
ICMP: ---- ICMP Redirect Data ----
ICMP:
ICMP: Gateway Address     = 30.1.1.160
ICMP:
ICMP: IP: ---- IP Packet ----
ICMP: IP:
ICMP: IP: Version                = 4
ICMP: IP: Internet Header Length = 5 (20 bytes)
ICMP: IP: Type Of Service        = 0x00
ICMP: IP:  |01234567
ICMP: IP:  |000.....             = Precedence (Routine)
ICMP: IP:  |...0....             = Normal Delay
ICMP: IP:  |....0...             = Normal Throughput
ICMP: IP:  |.....0..             = Normal Reliability
ICMP: IP:  |......0.             = Normal Monetary Cost
ICMP: IP:  |.......0             = Must Be Zero 
ICMP: IP: Total Length           = 64 bytes
ICMP: IP: Identification         = 0x0000 (0)
ICMP: IP: Flags                  = 0
ICMP: IP:  |012
ICMP: IP:  |0..                  = Reserved 
ICMP: IP:  |.0.                  = May Fragment
ICMP: IP:  |..0                  = Last Fragment
ICMP: IP: Fragment Offset        = 0x0000 (0 bytes)
ICMP: IP: Time to Live           = 63
ICMP: IP: Protocol               = ICMP (1)
ICMP: IP: Header Checksum        = 0x3286 (Correct)
ICMP: IP: Source Address         = 30.1.1.150
ICMP: IP: Destination Address    = 40.1.1.160
ICMP: IP:
ICMP: IP: ---- End of IP Header ----
ICMP: IP:
ICMP: IP: --- 64 bits of datagram [8 bytes] ---
ICMP: IP:  08 00 E5 20 00 16 00 00                           ... ....
ICMP: IP: --- 64 bits of datagram End ---
ICMP: --- Trailing Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Trailing Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Redirect Message on <DIface-0>

Data field of ICMP Redirect Message is correctly set to
exactly same IP header and 64 bits of Original Data sent to the DUT
45 00 00 40 00 00 00 00 3F 01 32 86 1E 01 01 96   E..@....?.2.....
28 01 01 A0 08 00 E5 20 00 16 00 00               (...... ....

Causing DUT to delete static route on DUT for
Destination Address 40.1.1.160
Gateway Address 30.1.1.160
outgoing interface <DIface-0>
Netmask 255.255.255.255
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.160 30.1.1.160 0 255.255.255.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/ICMP/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -host  40.1.1.160
    delete host 40.1.1.160
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
0.0.0.0/0                       128.224.166.1                 UGS      0     gei2   0    
30.1.1.0/24                     30.1.1.5                      UC       25    gei0   0    
30.1.1.5                        30.1.1.5                      UH       16    lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       5     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       76    lo0    0    
128.224.166.0/23                vxTarget                      UC       169   gei2   0    
vxTarget                        vxTarget                      UH       386   lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       22572 lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       0     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       0     gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-7.4: Passed

>> ICMP-8.1
TEST_DESCRIPTION
The data received in the echo message must be returned in the echo
reply message.
TEST_REFERENCE
RFC 792 p15 Echo or Echo Reply Message
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - Data field set to "AUTOMATED NETWORK VALIDATION "
          "LIBRARY"
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply 
- ANVL: Verify that the received ICMP Echo Reply contains:
        - Data field set to "AUTOMATED NETWORK VALIDATION "
          "LIBRARY"
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Data field set to "AUTOMATED NETWORK VALIDATION LIBRARY"

Waiting (up to 7.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA701 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0017 (23)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 55 54 4F 4D 41 54 45 44 20 4E 45 54 57 4F 52   AUTOMATED NETWOR
ICMP:  4B 20 56 41 4C 49 44 41 54 49 4F 4E 20 4C 49 42   K VALIDATION LIB
ICMP:  52 41 52 59                                       RARY
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x55D3 (21971)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE64D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xAF01 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0017 (23)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 55 54 4F 4D 41 54 45 44 20 4E 45 54 57 4F 52   AUTOMATED NETWOR
ICMP:  4B 20 56 41 4C 49 44 41 54 49 4F 4E 20 4C 49 42   K VALIDATION LIB
ICMP:  52 41 52 59                                       RARY
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Data field of ICMP Echo Reply is correctly set to
41 55 54 4F 4D 41 54 45 44 20 4E 45 54 57 4F 52   AUTOMATED NETWOR
4B 20 56 41 4C 49 44 41 54 49 4F 4E 20 4C 49 42   K VALIDATION LIB
52 41 52 59                                       RARY

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-8.1: Passed

>> ICMP-8.2
TEST_DESCRIPTION
The identifier and sequence number may be used by the echo sender
to aid in matching the replies with the echo requests.
TEST_REFERENCE
RFC 792 p15 Echo or Echo Reply Message
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - Identifier field set to <idfr>
        - Sequence Number field set to <seqno>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Echo Reply 
- ANVL: Verify that the received ICMP Echo Reply contains:
        - Identifier field set to <idfr>
        - Sequence Number field set to <seqno>
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Identifier field set to 24
- Sequence Number field set to 0

Waiting (up to 7.000 seconds) for ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0018 (24)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x55D4 (21972)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE64C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED1E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0018 (24)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Received expected ICMP Echo Reply on <DIface-0>

Identifier field of ICMP Echo Reply is correctly set to 24

Sequence Number field of ICMP Echo Reply is correctly set to 0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-8.2: Passed

>> ICMP-8.3
TEST_DESCRIPTION
A node should not send ICMP Echo Reply if ICMP Checksum is 
incorrect.
TEST_REFERENCE
NEGATIVE
RFC 792 p15 Echo or Echo Reply Message
TEST_METHOD
- ANVL: Send an ICMP Echo Request to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - Checksum field set to <invalidChecksum>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Echo Reply 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Echo Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Checksum field set to 0xE51E

Waiting (up to 7.000 seconds) for No ICMP Echo Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE51E *Should be 0xE51D*
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0000 (0)
ICMP: Sequence Number  = 0x0019 (25)
ICMP:
ICMP: --- Data [36 bytes] ---
ICMP:  41 75 74 6F 6D 61 74 65 64 20 4E 65 74 77 6F 72   Automated Networ
ICMP:  6B 20 56 61 6C 69 64 61 74 69 6F 6E 20 4C 69 62   k Validation Lib
ICMP:  72 61 72 79                                       rary
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


Correctly did not receive ICMP Echo Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-8.3: Passed

>> ICMP-9.1
TEST_DESCRIPTION
The data received (a timestamp) in the message is returned in the
reply together with an additional timestamp.
TEST_REFERENCE
RFC 792 p17 Timestamp or Timestamp Reply Message
TEST_METHOD
- ANVL: Send an ICMP Timestamp Message to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - Originate Timestamp field set to <origTimestampValue>
        - Receive Timestamp field set to zero
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Timestamp Reply 
- ANVL: Verify that the received ICMP Timestamp Reply contains:
        - Originate Timestamp field set to <origTimestampValue>
        - Receive Timestamp field set to non-zero
        - Transmit Timestamp field set to non-zero
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Timestamp Message to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Originate Timestamp field set to 43650087
- Receive Timestamp field set to zero
- Transmit Timestamp field set to zero

Waiting (up to 7.000 seconds) for ICMP Timestamp Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C39 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 13 (Timestamp)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE424 (Correct)
ICMP:
ICMP: ---- ICMP Timestamp Data ----
ICMP:
ICMP: Identifier          = 0x001A (26)
ICMP: Sequence Number     = 0x0000 (0)
ICMP: Originate Timestamp = 43650087
ICMP: Receive Timestamp   = 0
ICMP: Transmit Timestamp  = 0
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x55D5 (21973)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE663 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 14 (Timestamp Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x585A (Correct)
ICMP:
ICMP: ---- ICMP Timestamp Data ----
ICMP:
ICMP: Identifier          = 0x001A (26)
ICMP: Sequence Number     = 0x0000 (0)
ICMP: Originate Timestamp = 43650087
ICMP: Receive Timestamp   = 738650
ICMP: Transmit Timestamp  = 738650
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected ICMP Timestamp Message Reply on <DIface-0>

Originate Timestamp field of ICMP Timestamp Reply is correctly
set to 43650087

Receive Timestamp field of ICMP Timestamp Reply is correctly
set to 738650 (non zero value)

Transmit Timestamp field of ICMP Timestamp Reply is correctly
set to 738650 (non zero value)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-9.1: Passed

>> ICMP-9.2
TEST_DESCRIPTION
The identifier and sequence number may be used by the echo sender
to aid in matching the replies with the requests.
TEST_REFERENCE
RFC 792 p17 Timestamp or Timestamp Reply Message
TEST_METHOD
- ANVL: Send an ICMP Timestamp Message to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to address of DUT
        - Identifier field set to <idfr>
        - Sequence Number field set to <seqno>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Send ICMP Timestamp Reply 
- ANVL: Verify that the received ICMP Timestamp Reply contains:
        - Identifier field set to <idfr>
        - Sequence Number field set to <seqno>
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Timestamp Message to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to address of DUT (30.1.1.5)
- Identifier field set to 27
- Sequence Number field set to 0

Waiting (up to 7.000 seconds) for ICMP Timestamp Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3C39 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 13 (Timestamp)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xD098 (Correct)
ICMP:
ICMP: ---- ICMP Timestamp Data ----
ICMP:
ICMP: Identifier          = 0x001B (27)
ICMP: Sequence Number     = 0x0000 (0)
ICMP: Originate Timestamp = 43655090
ICMP: Receive Timestamp   = 0
ICMP: Transmit Timestamp  = 0
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x55D6 (21974)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xE662 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 14 (Timestamp Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x1DBE (Correct)
ICMP:
ICMP: ---- ICMP Timestamp Data ----
ICMP:
ICMP: Identifier          = 0x001B (27)
ICMP: Sequence Number     = 0x0000 (0)
ICMP: Originate Timestamp = 43655090
ICMP: Receive Timestamp   = 743650
ICMP: Transmit Timestamp  = 743650
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Received expected ICMP Timestamp Reply on <DIface-0>

Identifier field of ICMP Timestamp Reply is correctly set to 27

Sequence Number field of ICMP Timestamp Reply is correctly set to 0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-9.2: Passed

>> ICMP-9.3
TEST_DESCRIPTION
An ICMP Timestamp Request message to an IP broadcast address MAY 
be silently discarded.
TEST_REFERENCE
RFC 1812 s4.3.3.8 p60 Timestamp and Timestamp Reply
TEST_METHOD
- ANVL: Send an ICMP Timestamp Message to <DIface-0>, containing:
        - IP Source Address field set to address of host-1
        - IP Destination Address field set to <broadcast-address>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Discard the ICMP Timestamp Message and do not send 
        Timestamp Reply
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Timestamp Message to <DIface-0> (30.1.1.5),
containing:
- IP Source Address field set to address of host-1 (30.1.1.150)
- IP Destination Address field set to broadcast address (255.255.255.255)

Waiting (up to 7.000 seconds) for No ICMP Timestamp Reply Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 01:00:5E:7F:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x5B3F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 13 (Timestamp)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xBD0C (Correct)
ICMP:
ICMP: ---- ICMP Timestamp Data ----
ICMP:
ICMP: Identifier          = 0x001C (28)
ICMP: Sequence Number     = 0x0000 (0)
ICMP: Originate Timestamp = 43660093
ICMP: Receive Timestamp   = 0
ICMP: Transmit Timestamp  = 0
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---


Correctly did not receive ICMP Timestamp Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-9.3: Passed

>> ICMP-10.1
TEST_DESCRIPTION
A host SHOULD NOT implement these messages.
A router SHOULD NOT originate or respond to these messages.
TEST_REFERENCE
NEGATIVE
RFC 1122 s3.2.2.7 p43 Information Request/Reply: RFC-792
RFC 1812 s4.3.3.7 p59 Information Request/Reply
TEST_METHOD
- ANVL: Send an ICMP Information Request to <DIface-0>, 
        containing:
        - IP Source Address field set to network portion of IP
          address of host-1
        - IP Destination Address field set to zero
        - Identifier field set to <idfr>
        - Sequence Number field set to <seqno>
- ANVL: Listen (for upto <ListenTime> seconds) on <DIface-0>
-  DUT: Do not send ICMP Information Reply 
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Sending an ICMP Information Request to <DIface-0> (30.1.1.5), containing:
- IP Source Address field set to 30.1.1.0 (network portion of IP
  address of host-1 (30.1.1.150))
- IP Destination Address field set to 0.0.0.0
- Identifier field set to 29
- Sequence Number field set to 0

Waiting (up to 7.000 seconds) for No ICMP Message on net 30.1.1.0

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x5BE1 (Correct)
IP: Source Address         = 30.1.1.0
IP: Destination Address    = 0.0.0.0
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 15 (Information Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF0E2 (Correct)
ICMP:
ICMP: ---- ICMP Information Data ----
ICMP:
ICMP: Identifier       = 0x001D (29)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Correctly did not receive ICMP Information Reply on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< ICMP-10.1: Passed

Number of tests run:          31
Number of tests passed:       31
Number of tests failed:       0
Number of tests inconclusive: 0
