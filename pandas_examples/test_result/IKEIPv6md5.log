ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6712336 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_dh1_md5 ike-ipv6 2.19 4.9 4.10 7.7 16.9 16.10 14.5 18.11 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_dh1_md5.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IKEIPV6/IKEIPV6postsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IKE SA Down Command                      "./DocScriptQ35/IKEIPV6/ike-sa-down-command.exp $ANVL_DUTHOSTNAME"
IKE Certificate Data                     "abcdefghijklmnop"
IKE Certificate Type                     2                   # (0x00000002)
IKE Signature Data                       "ABCDEFGHIJKLMNOP"
IKE Retransmit Count                     5                   # (0x00000005)
IKE Unique Cookie Test Count             3                   # (0x00000003)
IKE Test Timeout                         3                   # (0x00000003)
IKE DUT Major Version                    1                   # (0x00000001)
IKE DUT Minor Version                    1                   # (0x00000001)
IKE Non Zero Value                       1                   # (0x00000001)
IKE Nonce Payload Invalid Length         7                   # (0x00000007)
IKE ID Payload Invalid Port              10                  # (0x0000000A)
IKE ID Payload Invalid Protocol          10                  # (0x0000000A)
IKE Invalid Exchange Type                10                  # (0x0000000A)
IKE Invalid Message ID                   10                  # (0x0000000A)
IKE Invalid DOI                          10                  # (0x0000000A)
IKE Invalid Protocol ID                  10                  # (0x0000000A)
IKE Invalid Transform ID                 10                  # (0x0000000A)
IKE Invalid Attribute Class              20                  # (0x00000014)
IKE Invalid SPI                          210                 # (0x000000D2)
IKE DUT Supports Certificate Payload Processing True
IKE DUT Supports Main Mode As Initiator  True
IKE DUT Supports Main Mode As Responder  True
IKE DUT Supports Quick Mode As Initiator True
IKE DUT Supports Quick Mode As Responder True
IKE DUT Supports Aggressive Mode As Initiator True
IKE DUT Supports Aggressive Mode As Responder True
IKE DUT Supports New Group Mode As Initiator False
IKE DUT Supports New Group Mode As Responder False
IKE DUT Supports Sending of Notification Message True
IKE DUT Supports Traffic Processing before CONNECTED Notify False
IKEIPV6 Suite Setup Command              "./DocScriptQ35/IKEIPV6/ikeipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 ISAKMP SA Initiate Command       "./DocScriptQ35/IKEIPV6/ikeipv6-isakmp-sa-initiate-dh1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 IPSec SA Initiate Command        "./DocScriptQ35/IKEIPV6/ikeipv6-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Another IPSec SA Initiate Command "./DocScriptQ35/IKEIPV6/ikeipv6-another-ipsec-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Restart Command                  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Specify DES MD5 Attribute Command "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Specify DES SHA Attribute Command "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Combined SA Initiate Command     "./DocScriptQ35/IKEIPV6/ikeipv6-combined-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Two SA Initiate Command          "./DocScriptQ35/IKEIPV6/ikeipv6-two-sa-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Aggressive Mode Initiate Command "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-dh1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 Aggressive Mode Configure Command "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKEIPV6 New Group Mode Initiate Command  "./DocScriptQ35/IKEIPV6/ikeipv6-new-group-mode-initiate-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSecV6 DUT Uses Wildcard Identification False
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlikev6_dh1_md5.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         2000::5
  IPV6 ANVL Address                        2000::1
  IPV6 Gateway                             2000::5
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Version                               6                 # (0x00000006)
  IPV6 DUT Address                         2111::5
  IPV6 ANVL Address                        2111::1
  IPV6 Gateway                             2111::5
  IPV6 Subnet Mask                         64                # (0x00000040)
  IPV6 First Unused Address                ::
  IPV6 Number Unused Addresses             0                 # (0x00000000)
  IPV6 First Unused Interface Prefix       ::
  IPV6 Number Unused Interface Prefixes    0                 # (0x00000000)
  IPV6 Unused Interface Prefix Len         0                 # (0x00000000)
  IP Encapsulation Type                    Ethernet
  IP Broadcast Address                     0.0.0.0

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Encapsulation                   v6Ov6
  IPSec Configuration                      Auto
  IPSec IPv6 Remote Host Address           2000::1
  IPSec IPv6 Local Host Address            2111::1
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          MD5
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                ESP_DES
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Encapsulation Mode          TUNNEL
  IKE IPSec SA Authentication Algorithm    HMAC_SHA
  IKE Alternative ISAKMP SA Encryption Algorithm DES_CBC
  IKE Alternative ISAKMP SA Hashing Algorithm SHA
  New Group Description                    32768             # (0x00008000)
  New Group Prime                          "FFFDFF6FF2FF3FFFC90FDAA22168C234C6C6628B86DC6CD129064E088A676C74020B6EA636139B62564A06798634646D6F6569B3CD3A431B302B0A6DF25F14676FE6366D66516245E4656576665E6EC6F66662E9A6"
  New Group Generator                      "3"
  New Group Modulus Length                 680               # (0x000002A8)
  IKE Pre-Shared Key                       abcdef

# Configuration File End.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet6 add 2000::5 prefixlen 64 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet6 add 2111::5 prefixlen 64 up
-> cmd ifconfig -a
lo0	Link type:Local loopback
	inet 127.0.0.1  mask 255.255.255.255
	inet6 unicast fe80::1%lo0  prefixlen 64  automatic
	inet6 unicast ::1  prefixlen 128
	UP RUNNING LOOPBACK MULTICAST NOARP ALLMULTI 
	MTU:1500  metric:1  VR:0  ifindex:1
	RX packets:1235663 mcast:3388 errors:0 dropped:0
	TX packets:1235663 mcast:3388 errors:0
	collisions:0 unsupported proto:0
	RX bytes:91934649 (91 M)  TX bytes:91934649 (91 M)

gei2	Link type:Ethernet  HWaddr 00:25:90:04:e2:de
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 128.224.166.238  mask 255.255.254.0  broadcast 128.224.167.255
	inet6 unicast fe80::225:90ff:fe04:e2de%gei2  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:2
	RX packets:367893 mcast:17481 errors:0 dropped:1921
	TX packets:71956 mcast:1117 errors:0
	collisions:0 unsupported proto:0
	RX bytes:24956125 (24 M)  TX bytes:7403060 (7403 k)

gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	inet6 unicast 2000::5  prefixlen 64  tentative
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:57
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:2 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:180

gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	inet6 unicast 2111::5  prefixlen 64  tentative
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:58
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:2 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:180

-> cmd sysvar set -co ipike.strict_lifetime_policy "1"
sysvar: ipike.strict_lifetime_policy=1 ok
-> cmd sysvar get ipike.strict_lifetime_policy 
sysvar: ipike.strict_lifetime_policy=1
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg ok
-> cmd sysvar get ipike.filename
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp.cfg
-> cmd ipd reconfigure ipike
ipd: reconfigure ipike failed: not started
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response

Neighbor Discovery for 2000::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BA IPv6 ff02::1:ff00:5 < 2000::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5
00:1B:21:7D:57:BA < 00:15:17:C8:90:28 IPv6 2000::1 < 2000::5 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 2000::5 as 00:15:17:C8:90:28

Neighbor Discovery for 2111::5
33:33:FF:00:00:05 < 00:1B:21:7D:57:BB IPv6 ff02::1:ff00:5 < 2111::1 ICMPv6 type 135 (Neighbor Solicitation)
Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5
00:1B:21:7D:57:BB < 00:15:17:C8:90:29 IPv6 2111::1 < 2111::5 ICMPv6 type 136 (Neighbor Advertisement)
Device Under Test found at 2111::5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite Internet Key Exchange (IKE)
RFC 2407: 'The Internet IP Security Domain of Interpretation
for ISAKMP'
(D. Piper Network Alchemy, November 1988)
RFC 2408: 'Internet Security Association and Key Management
Protocol (ISAKMP)'
(D. Maughan National Security Agency,
M. Schertler Securify, Inc.
M. Schneider National Security Agency,
J. Turner RABA Technologies, Inc., November 1998)
RFC 2409: The Internet Key Exchange (IKE)
(D. Harkins, D. Carrel, Cisco Systems, November 1998


ANVL Test Suite Required Setup:
This suite expects to be running against an IPSec gateway. The
testing requires that the machine on which ANVL is running
be connected to 2 interfaces that are connected
to the device under test.

The ANVL config file must contain 2 IP interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IKE-IPV6-2.19
TEST_DESCRIPTION
IKE MUST support DES_CBC, MD5, Authentication via pre-shared keys and
MODP over default group number one
.Main mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 IntroductionTEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using Main Mode
        with SA Attributes = {Encryption algo: DES_CBC, Hash algo: MD5,
        Auth Method: Authentication via pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA> with requested SA Attributes
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike failed: not started
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Main Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-isakmp-sa-initiate-dh1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_init_des_md5.cfg" 
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_init_des_md5.cfg ok
-> cmd sysvar get ipike.filename 
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_init_des_md5.cfg
-> cmd ipd reconfigure ipike 
Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0x5D6D (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  9F 23 F0 A2 E5 30 08 ED                           .#...0..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)
Correctly received Encryption Algorithm = 1
Correctly received Group Descryption = 1
Correctly received Hash Algorithm = 1
Correctly received Authentication Method = 1
Correctly received <HDR,SA> Packet from
DUT with requested SA attributes 

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
ipd: reconfigure ipike ok
-> e
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ixit
Au revoir!
Connection closed by foreign host.
kev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-2.19: Passed

>> IKE-IPV6-4.9
TEST_DESCRIPTION
IKE MUST support DES_CBC, MD5, Authentication via pre_shared
keys and MODP over default group number one.
Main mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA> Packet with 1 Proposal Payload containing the
        protocol PROTO_ISAKMP and Transform Payload containing the
        Transform KEY_IKE with SA Attributes =
        {Encryption algorithm: DES_CBC, Hash algorithm: MD5,
        Authentication Method: Authentication via pre_shared keys,
        Group: MODP over group number one}
-  DUT: Send <HDR,SA> Packet with the same Proposal Payload containing
        the same Transform Payload with the SA Attributes sent by
        the initiator
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA> Packet with 1 Proposal Payload containing the
protocol PROTO_ISAKMP and Transform Payload containing the
Transform KEY_IKE with SA Attributes =
{Encryption algorithm: DES_CBC, Hash algorithm: MD5,
Authentication Method: Authentication via pre_shared keys,
Group: MODP over group number one} to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 80 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0x6451 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  34 9E 59 53 E0 E1 E2 6A                           4.YS...j
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0x68C4 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  34 9E 59 53 E0 E1 E2 6A                           4.YS...j
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  15 0D EC 96 D9 52 B6 D9                           .....R..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-4.9: Passed

>> IKE-IPV6-4.10
TEST_DESCRIPTION
IKE MUST support DES_CBC, SHA, Authentication via pre_shared
keys and MODP over default group number one.
Main mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA> Packet  with 1 Proposal Payload containing
        the protocol PROTO_ISAKMP and Transform Payload containing
        the Transform KEY_IKE with SA Attributes = 
        {Encryption algorithm: DES_CBC, Hash algorithm: SHA,
        Authentication Method: Authentication via pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA> Packet with the same Proposal Payload containing
        the same Transform Payload with the SA Attributes sent by
        the initiator
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes  = {DES, SHA}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA> Packet with 1 Proposal Payload containing the
protocol PROTO_ISAKMP and Transform Payload containing the
Transform KEY_IKE with SA Attributes =
{Encryption algorithm: DES_CBC, Hash algorithm: SHA,
Authentication Method: Authentication via pre_shared keys,
Group: MODP over group number one} to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 80 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 80 
UDP: Checksum         = 0xEE52 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  85 D9 D2 20 C5 31 AA 0F                           ... .1..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 72 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Identity Protection Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 108 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 108 
UDP: Checksum         = 0xEDC6 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  85 D9 D2 20 C5 31 AA 0F                           ... .1..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  83 65 13 45 2C 1F D4 05                           .e.E,...
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 100 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Correctly, received <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)
Received SA Attributes are same with
Encryption Algo = 1
Hash Algo = 2
Authentication Method = 1
Group Description = 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-4.10: Passed

>> IKE-IPV6-7.7
TEST_DESCRIPTION
IKE will not respond to an ISAKMP packet without one of the
following 4 mandatory SA attributes: Encryption algorithm,
Hash algorithm, Authentication method, Group value.
Main mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA> Packet with Proposal Payload containing the
        protocol PROTO_ISAKMP, Transform Payload containing the
        Transform KEY_IKE with SA Attributes as <SA  Attributes>
-  DUT: Do not send <HDR,SA> packet
- CASE: <SA  Attributes> = { Encryption Algorithm:  DES_CBC,
                             Hash Algorithm:        MD5,
                             Authentication Method: Pre-shared keys }
- CASE: <SA  Attributes> = { Encryption Algorithm:  DES_CBC,
                             Hash Algorithm:        MD5,
                             Group: MODP over group number one }
- CASE: <SA  Attributes> = { Encryption Algorithm:  DES_CBC,
                             Authentication Method: Pre-shared keys
                             Group: MODP over group number one}
- CASE: <SA  Attributes> = { Hash Algorithm: MD5,
                             Authentication Method: Pre-shared keys
                             Group: MODP over group number one}
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 1: Group Description Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0xACDE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  09 F4 08 6D 8D FF E8 6D                           ...m...m
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xD478 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  09 F4 08 6D 8D FF E8 6D                           ...m...m
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  85 65 AB 40 4B 55 4F 1C                           .e.@KUO.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xB2BC7AFB
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  09 F4 08 6D 8D FF E8 6D 85 65 AB 40 4B 55 4F 1C   ...m...m.e.@KUO.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 2: Authentication Method Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0xC6E5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  57 15 E8 4C 3F 56 F0 0D                           W..L?V..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x53F2 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  57 15 E8 4C 3F 56 F0 0D                           W..L?V..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  FF 8C CA 28 98 0D 9C 58                           ...(...X
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x775E04E8
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  57 15 E8 4C 3F 56 F0 0D FF 8C CA 28 98 0D 9C 58   W..L?V.....(...X
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 3: Hash Algorithm Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0xA864 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE E4 4A 1F 9A 22 CA 1F                           ..J.."..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x90C7 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  DE E4 4A 1F 9A 22 CA 1F                           ..J.."..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  D7 4F 2E 42 BD 9C 87 1A                           .O.B....
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x7B79EE9C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  DE E4 4A 1F 9A 22 CA 1F D7 4F 2E 42 BD 9C 87 1A   ..J.."...O.B....
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
Case 4: Encryption Algorithm Attribute is absent

Sending <HDR,SA> Packet with Proposal Payload containing the
protocol PROTO_ISAKMP, Transform Payload containing the
Transform KEY_IKE with SA Attributes as <SA  Attributes>
to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 76 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 76 
UDP: Checksum         = 0x53AE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A4 AF 54 1C F9 D2 EF 5C                           ..T....\
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 2 (Identity Protection Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 68 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x770A (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  A4 AF 54 1C F9 D2 EF 5C                           ..T....\
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  0B E9 AD F2 15 19 F1 73                           .......s
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xECB40175
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  A4 AF 54 1C F9 D2 EF 5C 0B E9 AD F2 15 19 F1 73   ..T....\.......s
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA> Packet from DUT
2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-7.7: Passed

>> IKE-IPV6-14.5
TEST_DESCRIPTION
IKE MUST support DES_CBC,MD5,Authentication via pre_shared keys
and MODP over default group number one.
Aggressive mode/DUT initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Externally cause DUT to initiate an ISAKMP SA using 
        Aggressive Mode with SA Attributes = {Encryption algo: DES_CBC,
        Hash algo: MD5, Auth Method: Authentication via pre_shared
        keys, Group: MODP over group number one }
-  DUT: Send <HDR,SA,KE,Ni,IDii> with requested SA Attributes 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to initiate ISAKMP SA (Aggressive Mode) with 2000::1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2000::1 abcdef

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-aggressive-mode-dh1-md5-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Waiting (up to 20.000 seconds) for ISAKMP Packet

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_aggressive_dh1_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_aggressive_dh1_md5.cfg ok
-> cmd ipd recoReceived ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 300 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 300 
UDP: Checksum         = 0xDEE5 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  56 F8 07 FF 14 95 E8 B9                           V.......
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 292 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 1 (Seconds)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 28800  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  38 B0 07 0D BE BE 7F 30 3B 4C D8 7D F4 29 32 EB   8......0;L.}.)2.
ISAKMP:  AA 5B 5E 36 FD 47 79 A9 50 E2 76 AC D3 A4 99 0A   .[^6.Gy.P.v.....
ISAKMP:  DA F4 F6 12 1B 24 59 12 00 8B 72 DA D7 76 10 23   .....$Y...r..v.#
ISAKMP:  89 03 54 27 F2 B3 A3 55 4E 3B C9 DF 37 49 40 0C   ..T'...UN;..7I@.
ISAKMP:  05 F7 36 2C 5D EE 0F 2F 67 89 A2 4D 90 93 E4 74   ..6,]../g..M...t
ISAKMP:  A6 0B 7C CF 54 10 65 87 5C 47 2C 07 27 F7 EF FF   ..|.T.e.\G,.'...
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  9F 38 C3 1B 87 65 9B 33 A6 EB C3 B4 EF A5 4A 78   .8...e.3......Jx
ISAKMP:  B4 78 D1 84 10 8D 4B 7B 4F 26 DB DA 08 4A 97 7B   .x....K{O&...J.{
ISAKMP:  52 EA 59 4D 2F 2A 21 CC CB C3 1B BD E6 10 4E 66   R.YM/*!.......Nf
ISAKMP:  74 41 7E 59 E1 64 B3 F1 A4 42 B3 E3 B3 6B 2B F5   tA~Y.d...B...k+.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received <HDR,SA,KE,Ni,IDii> Packet from DUT
2000::5 (on interface 2000::1)
Correctly, received <HDR,SA,KE,Ni,IDii> Packet from DUT with
4 mandatory SA Attrbitues as requested

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
nfigure ipike
ipd: reconfigure ipike ok
-> 
-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-14.5: Passed

>> IKE-IPV6-16.9
TEST_DESCRIPTION
IKE MUST support DES_CBC,MD5,Authentication via pre_shared keys and
MODP over default group number one
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>  with one Proposal Payload containing
        the protocol PROTO_ISAKMP and Transform Payload containing the
        Transform KEY_IKE with SA Attributes =         {Encryption algo: DES_CBC,
        Hash algo: MD5, Auth Method:         Authentication via pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the same
        Proposal Payload containing the same Transform Payload
        with the SA Attributes sent by the initiator
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii>  with one Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload cantaining the
Transform KEY_IKE with SA Attributes = {Encryption algo: DES_CBC,
Hash algo: MD5, Auth Method: Authentication via pre_shared keys,
Group: MODP over group number one } to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 224 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 224 
UDP: Checksum         = 0xAF9F (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  12 5B 03 43 B7 6C 9A 03                           .[.C.l..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 216 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  16 9A 20 89 8D E3 11 4C 87 F7 34 7D 56 A8 4E A6   .. ....L..4}V.N.
ISAKMP:  E5 B1 15 F8 68 E5 2F 9C 28 49 08 B6 71 BD 44 7B   ....h./.(I..q.D{
ISAKMP:  4C DD DC CE 8E 51 24 B8 BE 69 A5 5F F8 D5 86 72   L....Q$..i._...r
ISAKMP:  D9 4F F3 5D 15 D6 A0 01 3D 65 59 C5 21 8B 91 41   .O.]....=eY.!..A
ISAKMP:  49 0F 7A 7F A9 2E C6 BC 15 C5 E4 13 07 F7 64 FC   I.z...........d.
ISAKMP:  A0 48 3B 11 A5 95 FD 87 37 60 B3 F0 43 18 C0 6E   .H;.....7`..C..n
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  A1 22 CB 1A 32 3A 76 36 7E E7 8D 71 87 0B 71 34   ."..2:v6~..q..q4
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received Neighbor Solicitation from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:01
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = ff02::1:ff00:1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x9192 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x5C4A (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 2
ICMPv6:  |012
ICMPv6:  |0..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..0              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::1
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 320 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 320 
UDP: Checksum         = 0xE07B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  12 5B 03 43 B7 6C 9A 03                           .[.C.l..
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  7C 75 84 9E A7 59 A6 F0                           |u...Y..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 312 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  CA CC D8 24 C5 49 9B 05 26 78 34 05 6A 18 EC B0   ...$.I..&x4.j...
ISAKMP:  0C 3A CC 4F DE 8A A5 FE B7 B9 A5 D0 D7 D5 67 D5   .:.O..........g.
ISAKMP:  51 50 39 F9 B2 E0 E7 78 20 2B CB D3 2A 60 EC AA   QP9....x +..*`..
ISAKMP:  38 6B 5B FA 9E 78 D7 C6 C7 D2 A5 D4 50 96 18 87   8k[..x......P...
ISAKMP:  56 C6 0A 16 00 F9 B7 18 19 CF 57 10 3C 54 67 10   V.........W.<Tg.
ISAKMP:  C7 63 C0 96 44 B1 A0 D0 0C F1 DF 34 80 EC 0E 96   .c..D......4....
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  E3 75 67 60 6F 9B A0 54 42 7F DF 71 3A C7 76 53   .ug`o..TB..q:.vS
ISAKMP:  4D 1A BD 81 AF 0E 6F FC 23 8D D8 CF 96 79 9C D5   M.....o.#....y..
ISAKMP:  A0 94 88 74 22 E8 AA C5 4D 86 F8 F5 8E 87 66 46   ...t"...M.....fF
ISAKMP:  48 05 6E 57 1F 92 53 44 E3 5C A7 36 CC BA 94 36   H.nW..SD.\.6...6
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Hash Data [16 bytes] ---
ISAKMP:  5D 5A 5E 8C 39 FA E5 87 54 49 B8 17 3B 4D AF 60   ]Z^.9...TI..;M.`
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Received SA Attributes are same with
Encryption Algo = 1
Hash Algo = 1
Authentication Method = 1
Group Description = 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.9: Passed

>> IKE-IPV6-16.10
TEST_DESCRIPTION
IKE MUST support DES_CBC,SHA,Authentication via pre_shared keys and
MODP over default group number one
Aggressive mode/ANVL initiated/Positive
TEST_REFERENCE
RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii>  with one Proposal Payload containing
        the protocol PROTO_ISAKMP and Transform Payload cantaining the
        Transform KEY_IKE with SA Attributes =         {Encryption algo: DES_CBC,
        Hash algo: SHA, Auth Method:         Authentication via pre_shared keys,
        Group: MODP over group number one }
-  DUT: Send <HDR,SA,KE,Nr,IDir, HASH_R> with the same
        Proposal Payload containing the same Transform Payload
        with the SA Attributes sent by the initiator
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes  = {DES, SHA}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY SHA DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-sha-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Sending <HDR,SA,KE,Ni,IDii>  with one Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload cantaining the
Transform KEY_IKE with SA Attributes = {Encryption algo: DES_CBC,
Hash algo: SHA, Auth Method: Authentication via pre_shared keys,
Group: MODP over group number one } to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 224 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 224 
UDP: Checksum         = 0xD279 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  42 38 BF 0D 98 1B 90 7C                           B8.....|
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 216 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 44 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  60 80 5E A4 A4 DD 6B 9D 3D 94 B9 E7 62 EF 63 49   `.^...k.=...b.cI
ISAKMP:  E0 28 58 4B 05 DB 6D F8 EA 3F 09 2A 8B 7A 25 2B   .(XK..m..?.*.z%+
ISAKMP:  50 A8 34 15 EE 8B C5 B9 B9 E0 84 ED 04 07 34 CF   P.4...........4.
ISAKMP:  68 F8 1D 2D 23 C1 C9 09 43 28 BE 74 A2 DC 3D 29   h..-#...C(.t..=)
ISAKMP:  98 98 E5 C9 EA FE E2 3F 5A 7C 06 D8 D1 DF C3 63   .......?Z|.....c
ISAKMP:  AD 22 D4 96 65 B7 33 E0 29 22 D0 9F F4 1E D7 33   ."..e.3.)".....3
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  C6 18 23 37 8C A0 6D E0 1C 8B 6F B1 48 C9 BC 93   ..#7..m...o.H...
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Aggressive Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 324 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 324 
UDP: Checksum         = 0x2648 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  42 38 BF 0D 98 1B 90 7C                           B8.....|
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  F9 21 71 F8 36 B0 63 7C                           .!q.6.c|
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 316 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 52 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 32 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 2 (SHA)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 11 (Life Type)
ISAKMP: SA Attribute Value       = 0 (! Unknown Value)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 12 (Life Duration)
ISAKMP: SA Attribute Value       = 0  
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  E9 01 0D 95 AF 17 70 49 B8 C5 99 3B F0 16 B4 C7   ......pI...;....
ISAKMP:  E5 28 78 85 E8 75 BC 85 57 CF 82 58 1B A9 3E F0   .(x..u..W..X..>.
ISAKMP:  12 E2 D8 57 02 B6 F0 B2 13 D8 7F 3A 1A 0F 44 7B   ...W.......:..D{
ISAKMP:  86 0C 14 77 A9 44 3C A9 70 41 03 1E 80 A7 4B CF   ...w.D<.pA....K.
ISAKMP:  75 E3 03 F6 EA 98 A8 A6 88 40 EE F8 8E 15 61 58   u........@....aX
ISAKMP:  D8 5B 6D AB B8 46 C2 58 D0 C0 17 A7 68 2C 3D E1   .[m..F.X....h,=.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 68 bytes
ISAKMP: --- Nonce Data [64 bytes] ---
ISAKMP:  B8 97 0D 2F 7F 1A 7E 71 EB DF 8C 22 F6 C1 82 55   .../..~q..."...U
ISAKMP:  49 C4 1F F5 11 25 A0 D4 E7 32 03 63 CC A6 63 AB   I....%...2.c..c.
ISAKMP:  4E 68 55 EB 7C D7 54 F6 D9 4F 0E 73 75 20 27 AC   NhU.|.T..O.su '.
ISAKMP:  6E F9 07 00 A0 87 5D 97 47 8D 47 46 DC 89 93 57   n.....].G.GF...W
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Hash Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 0
ISAKMP: Port                     = 0
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: Next Payload             = Vendor Id Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: --- Hash Data [20 bytes] ---
ISAKMP:  90 7C B9 C6 3F 0D A7 9E 09 3B E4 B7 41 D7 0A 54   .|..?....;..A..T
ISAKMP:  2F 2D 26 97                                       /-&.
ISAKMP: --- Hash Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Hash Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Vendor Id Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Vendor ID Data [16 bytes] ---
ISAKMP:  AF CA D7 13 68 A1 F1 C9 6B 86 96 FC 77 57 01 00   ....h...k...wW..
ISAKMP: --- Vendor ID Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Vendor Id Payload ----
ISAKMP:

Received Responder's <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)
Received SA Attributes are same with
Encryption Algo = 1
Hash Algo = 2
Authentication Method = 1
Group Description = 1

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-16.10: Passed

>> IKE-IPV6-18.11
TEST_DESCRIPTION
IKE MUST not respond to an ISAKMP packet without any one of
the following four- Enc. algo, Hash algo, Auth. method, Group value
mandatory SA attributes.
Note: This test checks whether DUT discards the message
Aggressive mode/ANVL initiated/Negative
TEST_REFERENCE
NEGATIVE: RFC 2409 s4 p7 Introduction
TEST_METHOD
- ANVL: Send <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
        the protocol PROTO_ISAKMP and Transform Payload containing
        the Transform KEY_IKE 
        with SA Attributes as <SA  Attributes>
-  DUT: Do not send <HDR,SA,KE,Nr,IDir,HASH_R>
- CASE: <SA  Attributes> ={Encryption Algo: DES_CBC, Hash Algo: MD5,
        Auth Method: Authentication via pre_shared keys}
- CASE: <SA  Attributes> ={Encryption Algo: DES_CBC, Hash Algo:
        MD5,Group: MODP over group number one}
- CASE: <SA  Attributes> ={Encryption Algo: DES_CBC,
        Auth Method:Authentication via pre_shared keys,
        Group: MODP over group number one}
- CASE: <SA  Attributes> ={Hash Algo: MD5,
        Auth Method:Authentication via pre_shared keys, 
        Group: MODP over group number one}
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

Executing system command:
  "./DocScriptQ35/IKEIPV6/pre_Combined_SA.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_sha.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:1 Group Description Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 220 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 220 
UDP: Checksum         = 0x0458 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0F CE AC 73 14 E0 E7 34                           ...s...4
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 212 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  5F 74 30 D4 AA E9 41 FA 05 6F D5 79 91 54 70 35   _t0...A..o.y.Tp5
ISAKMP:  FA 2A 1C A7 74 A3 9A 00 92 12 19 A3 6B 2E 53 77   .*..t.......k.Sw
ISAKMP:  84 91 FF E3 90 57 47 D7 D5 37 5B C8 AC DB DE F3   .....WG..7[.....
ISAKMP:  B7 39 DE 37 34 BB 1A EE AB 38 51 73 B3 F2 8E C9   .9.74....8Qs....
ISAKMP:  A0 9C A9 AC E2 38 69 FD 51 22 AA 2D A3 A7 1F 18   .....8i.Q".-....
ISAKMP:  79 15 AB BF A9 C3 84 B1 A7 A0 EF 1E C0 7C 06 F0   y............|..
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  6D 5E 85 02 2C A2 A2 C3 83 C2 8E 85 AD 03 8C 37   m^..,..........7
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xE11B (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  0F CE AC 73 14 E0 E7 34                           ...s...4
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  13 9F 2D 28 2F C3 5A CA                           ..-(/.Z.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xD110F079
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  0F CE AC 73 14 E0 E7 34 13 9F 2D 28 2F C3 5A CA   ...s...4..-(/.Z.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:2 Authentication Method Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 220 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 220 
UDP: Checksum         = 0xF1EE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  11 54 B8 57 39 99 31 46                           .T.W9.1F
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 212 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  9E AF 1B 18 6E 7B 2C D3 A5 99 1E B8 95 A8 19 A5   ....n{,.........
ISAKMP:  81 04 52 E6 39 2B 8C E1 4A 78 05 F3 0F 44 5A E7   ..R.9+..Jx...DZ.
ISAKMP:  02 2F F9 6D 91 88 EA A7 42 A0 98 53 DA 01 0E 1D   ./.m....B..S....
ISAKMP:  AF 74 BB 12 60 A6 08 9A 2E D2 52 7A 0B B1 F8 76   .t..`.....Rz...v
ISAKMP:  36 21 24 1E 0A 96 A8 1F D9 F0 0D 46 AC 5D 4A 78   6!$........F.]Jx
ISAKMP:  4B 43 25 1C 83 AB 5F 39 F2 37 0E 22 E3 2D E6 47   KC%..._9.7.".-.G
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  42 A0 4A 98 9C 58 00 52 8E F6 87 C9 78 35 5E 9C   B.J..X.R....x5^.
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xB335 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  11 54 B8 57 39 99 31 46                           .T.W9.1F
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  20 11 F5 C7 8F 8D 00 EC                            .......
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x5F15E1F6
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  11 54 B8 57 39 99 31 46 20 11 F5 C7 8F 8D 00 EC   .T.W9.1F .......
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:3 Hash Algorithm Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 220 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 220 
UDP: Checksum         = 0x20AE (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2A 07 FB 62 4D 41 EC 63                           *..bMA.c
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 212 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 1 (Encryption Algorithm)
ISAKMP: SA Attribute Value       = 1 (DES-CBC)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  3B F2 16 E7 0B 19 29 06 53 02 BF 4E 41 DF 52 6F   ;.....).S..NA.Ro
ISAKMP:  21 CC 09 6F 10 F6 6D 5C 0F 1A 9A 3E A2 5A AE EA   !..o..m\...>.Z..
ISAKMP:  1F 89 17 1A 5D F6 BF 2E 6A 37 7E 36 5E 6D 69 46   ....]...j7~6^miF
ISAKMP:  58 8F 41 83 AD AC B0 31 41 60 53 CF E1 0B F1 03   X.A....1A`S.....
ISAKMP:  E0 1F 8D 47 E9 00 6B B4 E6 25 88 16 B0 97 C7 DD   ...G..k..%......
ISAKMP:  37 15 66 B6 DB C2 35 7F 82 65 4A 9F 54 C3 49 09   7.f...5..eJ.T.I.
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  E8 7E EF A9 51 79 CA 11 BE DC DF 42 0E B6 DF 91   .~..Qy.....B....
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0xFF81 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  2A 07 FB 62 4D 41 EC 63                           *..bMA.c
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  2E 3C 19 75 77 56 3D 05                           .<.uwV=.
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0xAC36480C
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  2A 07 FB 62 4D 41 EC 63 2E 3C 19 75 77 56 3D 05   *..bMA.c.<.uwV=.
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Externally causing DUT to accept packet exchange
using SA Attributes = {DES, MD5}
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.
 Case:4 Encryption Algorithm Attribute is absent

Sending <HDR,SA,KE,Ni,IDii> with Proposal Payload containing
the protocol PROTO_ISAKMP and Transform Payload containing
the Transform KEY_IKE
with SA Attributes as <SA Attributes> to DUT 2000::5
from interface 2000::1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 220 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = 2000::5
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 220 
UDP: Checksum         = 0xD405 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B8 7C 25 78 D5 19 FA 78                           .|%x...x
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  00 00 00 00 00 00 00 00                           ........
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = SA Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 4 (Aggressive Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x0
ISAKMP: Length                   = 212 bytes
ISAKMP:
ISAKMP: ---- ISAKMP SA Payload ----
ISAKMP:
ISAKMP: Next Payload             = Key Exchange Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 40 bytes
ISAKMP: DOI                      = 1
ISAKMP: --- Situation [4 bytes] ---
ISAKMP:  00 00 00 01                                       ....
ISAKMP: --- Situation End ---
ISAKMP:
ISAKMP: ---- ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: Proposal Number          = 1
ISAKMP: Protocol-Id              = 1 (ISAKMP)
ISAKMP: SPI Size                 = 0
ISAKMP: Number of Transforms     = 1
ISAKMP: --- Security Parameter Index [0 bytes] ---
ISAKMP: ---- ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: Transform Number         = 1
ISAKMP: Transform-Id             = 1 (Key IKE)
ISAKMP: RESERVED2                = 0
ISAKMP:
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 4 (Group Description)
ISAKMP: SA Attribute Value       = 1 (768-bit MODP group)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 2 (Hash Algorithm)
ISAKMP: SA Attribute Value       = 1 (MD5)
ISAKMP: 
ISAKMP: SA Attribute Format      = 1 (TV)
ISAKMP: SA Attribute Type        = 3 (Authentication Method)
ISAKMP: SA Attribute Value       = 1 (Pre-shared Key)
ISAKMP: 
ISAKMP: ---- End ISAKMP Transform Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP Proposal Payload ----
ISAKMP:
ISAKMP: ---- End ISAKMP SA Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: Next Payload             = Nonce Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 100 bytes
ISAKMP: --- Key Exchange Data [96 bytes] ---
ISAKMP:  24 3A 9C 23 7F FE 2F 0C 04 2E 94 76 A1 CD F2 DD   $:.#../....v....
ISAKMP:  F6 0D B4 6A 69 95 A5 6C C4 C6 25 88 2A AA D7 66   ...ji..l..%.*..f
ISAKMP:  B3 4F EE E7 BC FB EA 9E 2D 7A D6 CE B2 51 45 8B   .O......-z...QE.
ISAKMP:  BF 8A D9 49 EC 3C CC 6D C0 53 13 52 D5 15 60 66   ...I.<.m.S.R..`f
ISAKMP:  CE 5F A6 CD 96 5C 70 F0 18 57 41 3C 68 7F 8A A3   ._...\p..WA<h...
ISAKMP:  EA 12 A2 A5 62 FD 14 86 D9 51 F5 5B E9 22 D6 4C   ....b....Q.[.".L
ISAKMP: --- Key Exchange Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Key Exchange Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: Next Payload             = Identification Payload
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 20 bytes
ISAKMP: --- Nonce Data [16 bytes] ---
ISAKMP:  44 38 AD 87 6E C0 F7 AC 22 79 29 88 BB 6C D7 83   D8..n..."y)..l..
ISAKMP: --- Nonce Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Nonce Payload ----
ISAKMP:
ISAKMP: ---- ISAKMP Identification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 24 bytes
ISAKMP: ID Type                  = 5
ISAKMP: Proto ID                 = 17
ISAKMP: Port                     = 500
ISAKMP: --- Identification Data [16 bytes] ---
ISAKMP:  20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01    ...............
ISAKMP: --- Identification Data End ---
ISAKMP:
ISAKMP: ---- End ISAKMP Identification Payload ----
ISAKMP:


Waiting (up to 10.000 seconds) for ISAKMP Packet

Received ISAKMP packet from 2000::5 with Exchange type
Informational Exchange on interface 2000::1


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 64 (bytes)
IPv6: Next Header          = UDP (17)
IPv6: Hop Limit            = 64
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 500 (500)
UDP: Destination Port = 500 (500)
UDP: Length           = 64 
UDP: Checksum         = 0x6401 (Correct)
UDP:
ISAKMP:
ISAKMP: ---- ISAKMP HEADER ----
ISAKMP: --- Initiator Cookie [8 bytes] ---
ISAKMP:  B8 7C 25 78 D5 19 FA 78                           .|%x...x
ISAKMP: --- Initiator Cookie End ---
ISAKMP:
ISAKMP: --- Responder Cookie [8 bytes] ---
ISAKMP:  3D 46 08 DA 68 77 FA 19                           =F..hw..
ISAKMP: --- Responder Cookie End ---
ISAKMP:
ISAKMP: Next Payload             = Notification Payload
ISAKMP: Major Version            = 1
ISAKMP: Minor Version            = 0
ISAKMP: Exchange Type            = 5 (Informational Exchange)
ISAKMP: Flags                    = 0x00 (0)
ISAKMP:  |012
ISAKMP:  |0..                    = Encryption bit Unset
ISAKMP:  |.0.                    = Commit bit Unset
ISAKMP:  |..0                    = Authentication Only bit Unset
ISAKMP: Message Id               = 0x20307959
ISAKMP: Length                   = 56 bytes
ISAKMP:
ISAKMP: ---- ISAKMP Notification Payload ----
ISAKMP:
ISAKMP: Next Payload             = Payload NONE
ISAKMP: RESERVED                 = 0
ISAKMP: Payload Length           = 28 bytes
ISAKMP: DOI                      = 1
ISAKMP: Protocol-Id              = 1
ISAKMP: SPI Size                 = 16
ISAKMP: Notify Message Type      = 14 (No Proposal Chosen)
ISAKMP: --- SPI [16 bytes] ---
ISAKMP:  B8 7C 25 78 D5 19 FA 78 3D 46 08 DA 68 77 FA 19   .|%x...x=F..hw..
ISAKMP: --- SPI End ---
ISAKMP:
ISAKMP: --- Notification Data [0 bytes] ---
ISAKMP: ---- End ISAKMP Notification Payload ----
ISAKMP:

Correctly, did not receive <HDR,SA,KE,Nr,IDir,HASH_R> Packet
from DUT 2000::5 (on interface 2000::1)

Clearing ISAKMP and IPSec SAs on the DUT and restarting
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
6 0 2000::5 2111::5 64 64 2111::1 2000::1 TUNNEL PRESHARED-KEY MD5 DES_CBC MODP768 SHA DES_CBC HMAC_SHA ESP_DES MODP1024 ESP abcdef

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IKEIPV6/ikeipv6-specify-des-md5-attribute-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipike.filename "/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg"
sysvar: ipike.filename=/romfs/ANVL_ikev1_ipv6_resp_des_md5.cfg ok
-> cmd ipd kill ipike
ipd: kill ipike ok
-> cmd ipd start ipike
ipd: start ipike ok
-> exit
Au revoir!
Connection closed by foreign host.

Neighbor Discovery for 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xC041 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BA
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2000::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2000::5
IPv6: Destination Address  = 2000::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8D92 (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2000::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:28
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:28

Neighbor Discovery for 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 33:33:FF:00:00:05
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::1
IPv6: Destination Address  = ff02::1:ff00:5
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 135 (Neighbor Solicitation)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0xBE1E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Solicitation Message ----
ICMPv6: 
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Source Link-Layer Address (1)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:1B:21:7D:57:BB
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

Waiting for Neighbor Advertisement response
Received Neighbor Advertisement from 2111::5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x86DD (IPV6)
ETHER:
IPv6: ---- IPv6 Packet ----
IPv6: 
IPv6: Version              = 6
IPv6: Traffic Class        = 0
IPv6:  |01234567
IPv6:  |000000..           = 0 DSCP (Differentiated Services Codepoint)
IPv6:  |......00           = 0 ECN (Explicit Congestion Notification)
IPv6: Flow Label           = 0
IPv6: Payload Length       = 32 (bytes)
IPv6: Next Header          = ICMPV6 (58)
IPv6: Hop Limit            = 255
IPv6: Source Address       = 2111::5
IPv6: Destination Address  = 2111::1
IPv6: 
ICMPv6: ---- ICMPv6 Packet ----
ICMPv6: 
ICMPv6: Type               = 136 (Neighbor Advertisement)
ICMPv6: Code               = 0 (0)
ICMPv6: Checksum           = 0x8A5E (Correct)
ICMPv6: 
ICMPv6: ---- Neighbor Advertisement Message ----
ICMPv6: 
ICMPv6: Flags              = 7
ICMPv6:  |012
ICMPv6:  |1..              = Router
ICMPv6:  |.1.              = Solicited
ICMPv6:  |..1              = Override
ICMPv6: Reserved           = 0
ICMPv6: Target Address     = 2111::5
ICMPv6: 
ICMPv6: ---- Link Layer Address Options ----
ICMPv6: 
ICMPv6: Type               = Target Link-Layer Address (2)
ICMPv6: Length             = 1 (in units of 8 octets)
ICMPv6: Link Layer Address = 00:15:17:C8:90:29
ICMPV6: ---- End of ICMPV6 Options ----
ICMPV6: 
ICMPv6: ---- End of ICMPv6 Packet ----

IPv6 DUT is still alive at: 00:15:17:C8:90:29
<< IKE-IPV6-18.11: Passed
Executing system command:
  "./DocScriptQ35/IKEIPV6/IKEIPV6postsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipike
ipd: kill ipike ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> cmd sysvar set -o ipike.strict_lifetime_policy "0"
sysvar: ipike.strict_lifetime_policy=0 ok
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          8
Number of tests passed:       8
Number of tests failed:       0
Number of tests inconclusive: 0
