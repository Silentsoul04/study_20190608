ANVL version 8.80.1.28 (Linux). Copyright (c) (2019) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197416 kB RAM. Free Memory 6728076 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecesp ipsec-esp 1-7.4 8-11.1 11.3 11.5 11.8 24 25.3-25.4 26.2-26.4 27-29.3 31-34 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecesp.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/IPSEC-ESP/IPSECESPpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
IPSec ESP Anti Replay Window Size        32                  # (0x00000020)
IPSec ESP DUT Supports Configurable Lifetime True
IPSec ESP SA Lifetime Seconds            120                 # (0x00000078)
IPSec ESP SA Lifetime Bytes              1024                # (0x00000400)
IPSec ESP DUT Supports Transport Mode    True
IPSec DUT Supports Configurable Outbound SPD True
IPSec DUT Supports Anti Replay           True
IPSec Wait Time                          10                  # (0x0000000A)
IPSec DUT Supports Configurable Inbound SPD True
IPSec DUT Supports Explicit Congestion Notification True
IPSec DUT Supports Traffic Flow Confidentiality True
IPSec DUT ECN Configure Command          "./DocScriptQ35/IPSEC-ESP/ipsec-ecn-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for ICMP Type And Code Command "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-icmp-type-code-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Outbound SPD Policy for Host Command "./DocScriptQ35/IPSEC-ESP/ipsec-add-outbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec DUT Verify Audit Log for Bad SPI Command "./DocScriptQ35/IPSEC-ESP/ipsec-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP DUT TFC Configure Command      "./DocScriptQ35/IPSEC-ESP/ipsec-dut-tfc-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP Set SA Lifetime Seconds Command "./DocScriptQ35/IPSEC-ESP/ipsec-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP Suite Setup Command            "./DocScriptQ35/IPSEC-ESP/ipsec-esp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP Reset IP Security Command      "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP Set SA Lifetime Bytes Command  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP DUT Mode Configure Command     "./DocScriptQ35/IPSEC-ESP/ipsec-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ESP Reset SA with Anti Replay Command "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Inbound SPD for Protocol and Port Command "./DocScriptQ35/IPSEC-ESP/ipsec-set-inbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for Protocol Command "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Inbound SPD for Host Command   "./DocScriptQ35/IPSEC-ESP/ipsec-set-inbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Inbound SPD for Protocol Command "./DocScriptQ35/IPSEC-ESP/ipsec-set-inbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Inbound SPD Policy for Subnet Command "./DocScriptQ35/IPSEC-ESP/ipsec-add-inbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Inbound SPD Policy for Host Command "./DocScriptQ35/IPSEC-ESP/ipsec-add-inbound-spd-policy-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set DF Bit processing Command      "./DocScriptQ35/IPSEC-ESP/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Reset DF Bit processing Command    "./DocScriptQ35/IPSEC-ESP/ipsec-reset-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec DUT Send Ping Command              "./DocScriptQ35/IPSEC-ESP/ipsec-dut-send-ping-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for Host Command  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Add Outbound SPD Policy for Subnet Command "./DocScriptQ35/IPSEC-ESP/ipsec-add-outbound-spd-policy-for-subnet-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Set Outbound SPD for Protocol and Port Command "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec Remove ANVL from SA Command        "./DocScriptQ35/IPSEC-ESP/ipsec-remove-anvl-from-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ANVL Clear SPD Command             "./DocScriptQ35/IPSEC-ESP/ipsec-anvl-clear-spd-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec ANVL Clear SA Command              "./DocScriptQ35/IPSEC-ESP/ipsec-anvl-clear-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IPSec DF Bit Processing                  COPY
IPSec DUT Supports Configurable DF Bit   True
IPSec Check Mode Command                 "./DocScriptQ35/IPSEC-ESP/ipsec-check-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IKE Listen Time                          10                  # (0x0000000A)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvlipsecesp.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP Encapsulation Type                    Ethernet
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255

IPSec Interface                          eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:00:00:00:00:00
  IPSec IP Remote Host Address             30.1.1.150
  IPSec IP Local Host Address              40.1.1.150
  IPSec IP Encapsulation                   v4Ov4
  IPSec Configuration                      Manual
  IPSec IPv6 Remote Host Address           ::
  IPSec IPv6 Local Host Address            ::
  IPSec ANVL SPI                           768               # (0x00000300)
  IPSec DUT SPI                            770               # (0x00000302)
  IPSec Authentication Algorithm           HMAC_MD5_96
  IPSec Authentication Key                 66306630663066306630663066302222
  IKE ISAKMP SA Encryption Algorithm       DES_CBC
  IKE ISAKMP SA Hashing Algorithm          SHA
  IKE ISAKMP SA Authentication Method      PRESHARED_KEY
  IKE ISAKMP SA Group Description          MODP768
  IKE IPSec SA Transform ID                ESP_DES
  IKE IPSec SA Group Description           MODP1024
  IKE IPSec SA Authentication Algorithm    HMAC_MD5
  IPSec Encryption Algorithm               DES_CBC
  IPSec Encryption Key                     8000000000000000
  IPSec Encryption IV                      0202020202020202
  IKE Pre-Shared Key                       abcdefghijklmnopqrstuvwx

# Configuration File End.
%% VALIDATE CFG GLOBAL WARNING: 
! The current mode is not
! Automatic Mode.
! Therefore the following tests cannot be run: 24.2 28.1 
%% VALIDATE CFG GLOBAL WARNING: 
! The current Encryption algorithm is not
! NULL Encryption algorithm.
! Therefore the following tests cannot be run: 8.4 8.6 
%% VALIDATE PRM GLOBAL WARNING: 
! The DUT does not support 64-bit Extended Sequence Number.
! Therefore the following tests cannot be run: 31.1 31.2 31.3 
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "1"
sysvar: ipnet.inet.AcceptSourceRoute=1 ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask 255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask 255.255.255.0 up
-> cmd ifconfig -a
lo0	Link type:Local loopback
	inet 127.0.0.1  mask 255.255.255.255
	inet6 unicast fe80::1%lo0  prefixlen 64  automatic
	inet6 unicast ::1  prefixlen 128
	UP RUNNING LOOPBACK MULTICAST NOARP ALLMULTI 
	MTU:1500  metric:1  VR:0  ifindex:1
	RX packets:740731 mcast:3388 errors:0 dropped:0
	TX packets:740731 mcast:3388 errors:0
	collisions:0 unsupported proto:0
	RX bytes:55124562 (55 M)  TX bytes:55124562 (55 M)

gei2	Link type:Ethernet  HWaddr 00:25:90:04:e2:de
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 128.224.166.238  mask 255.255.254.0  broadcast 128.224.167.255
	inet6 unicast fe80::225:90ff:fe04:e2de%gei2  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:2
	RX packets:308706 mcast:17481 errors:0 dropped:1770
	TX packets:39472 mcast:1117 errors:0
	collisions:0 unsupported proto:0
	RX bytes:20636317 (20 M)  TX bytes:4145091 (4145 k)

gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 30.1.1.5  mask 255.255.255.0  broadcast 30.1.1.255
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:35
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:10 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:648

gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet 40.1.1.5  mask 255.255.255.0  broadcast 40.1.1.255
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:36
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:10 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:648

-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

00:1B:21:7D:57:BA < 00:15:17:C8:90:28 ARP Rsp 30.1.1.150

Device Under Test found at 30.1.1.5 as 00:15:17:C8:90:28
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite IPSec Encapsulating Security Payload
RFC 4301: 'Security Architecture for the Internet Protocol'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)
RFC 2403: 'The Use of HMAC-MD5-96 within ESP and AH'
(C. Madson Cisco Systems Inc., R. Glenn NIST, November 1998)
RFC 2404: 'The Use of HMAC-SHA-1-96 within ESP and AH'
(C. Madson Cisco Systems Inc., R. Glenn NIST, November 1998)
RFC 2405: 'The ESP DES-CBC Cipher Algorithm With Explicit IV
(C. Madson Cisco Systems Inc., N. Doraswamy Bay Networks, Inc.,
November 1998)
RFC 4303: 'IP Encapsulating Security Payload'
(S. Ken BBN Corp, R. Atkinson @Home Network, November 1998)


ANVL Test Suite Required Setup:
RFC 4106: 'The Use of Galois/Counter Mode (GCM)in IPsec
Encapsulating Security Payload
(J. Viega Secure Software, Inc., D. McGrew Cisco Systems,
Inc., June 2005)
This suite expects to be running against an IPSec gateway. The
testing requires that the machine ANVL is running on is connected
to 2 interfaces that are connected to the device under test.

The ANVL config file must contain 2 IP interfaces
and also one IPSec interface on one of 2 ports 
The DUT should be configured exactly as it is indicated in the
configuration file. There are a number of parameters
controlling this suite that need to be setup for a completely
automated run.


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> IPSEC-ESP-1.1
TEST_DESCRIPTION
IPSec MUST accept an IPv4-datagram which is properly secured using
ESP protocol.
When any combined mode algorithm is employed, the algorithm itself
is expected to return both decrypted plaintext and a pass/fail
indication for the integrity check
Note - Combined mode algorithm include only GCM & GMAC
TEST_REFERENCE
RFC 4303 s2 p5 Encapsulating Security Payload Packet Format
RFC 4303 Section 2 Page 6 Encapsulating Security Payload Packet Format
Note - Indirect reference to RFC 4106 & 4543
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
-  DUT: Forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1389  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1390  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1391  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1392  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1393  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1009] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1010] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1008] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1011] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0002 (2)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BCE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  02 02 02 02 02 02 02 02                           ........
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  46 C5 B3 B4 AE F5 29 83 72 13 9E 04               F.....).r...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0001 (1)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0001 (1)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected unsecured IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-1.1: Passed

>> IPSEC-ESP-1.2
TEST_DESCRIPTION
IPSec MUST accept a proper incoming ESP-secured IP-datagram if the
Next Header and Pad Length fields are right aligned within a
4-byte word
TEST_REFERENCE
RFC 4303 s2.4 p14 Padding (for Encryption)
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host with
        Pad Length and Next Header field right aligned within a
        4-byte word, with default padding of Pad Length equal to
        <padlength>
-  DUT: Forward the ICMP Echo Request to Local Host
- CASE: <padlength> = 0
- CASE: <padlength> = 3
- CASE: <padlength> = 247
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1394  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1395  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1396  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1397  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1398  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1013] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1014] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1012] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1015] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Pad Length to 0 in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BCC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  36 97 26 55 31 94 BE F6                           6.&U1...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 46 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED47 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0002 (2)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [18 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP:  00 B1                                             ..
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F5 2F AE 18 4F 6A CE A4 31 34 E2 50               ./..Oj..14.P
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 46 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x329F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED47 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0002 (2)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [18 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP:  00 B1                                             ..
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Received expected unsecured IP packet on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 3 in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BCA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  24 69 7C 08 23 A5 C3 84                           $i|.#...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 43 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEE17 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [15 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20      ANVL TEST DATA 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 4F 99 20 97 2C DD EA 36 44 00 4A               RO. .,..6D.J
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 43 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEE17 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0003 (3)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [15 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20      ANVL TEST DATA 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [3 bytes] ---
ETHER:  00 00 00                                          ...
ETHER: --- Padding End ---

Received expected unsecured IP packet on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 247 in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 336 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AD8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  49 C3 29 0D E2 C3 21 33                           I.)...!3
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 39 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6299 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0004 (4)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [11 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44                  ANVL TEST D
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [247 bytes] ---
ESP:  01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10   ................
ESP:  11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20   ............... 
ESP:  21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30   !"#$%&'()*+,-./0
ESP:  31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40   123456789:;<=>?@
ESP:  41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50   ABCDEFGHIJKLMNOP
ESP:  51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60   QRSTUVWXYZ[\]^_`
ESP:  61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70   abcdefghijklmnop
ESP:  71 72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 7F 80   qrstuvwxyz{|}~..
ESP:  81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F 90   ................
ESP:  91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F A0   ................
ESP:  A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF B0   ................
ESP:  B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF C0   ................
ESP:  C1 C2 C3 C4 C5 C6 C7 C8 C9 CA CB CC CD CE CF D0   ................
ESP:  D1 D2 D3 D4 D5 D6 D7 D8 D9 DA DB DC DD DE DF E0   ................
ESP:  E1 E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE EF F0   ................
ESP:  F1 F2 F3 F4 F5 F6 F7                              .......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 247 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  3C 33 8C A6 CD C4 46 6F 51 3A 45 AA               <3....FoQ:E.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 39 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x32A2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6299 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0004 (4)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [11 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44                  ANVL TEST D
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [7 bytes] ---
ETHER:  00 00 00 00 00 00 00                              .......
ETHER: --- Padding End ---

Received expected unsecured IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-1.2: Passed

>> IPSEC-ESP-1.3
TEST_DESCRIPTION
A compliant Host implementation MUST support IPsec(Transport mode)
between a pair of Hosts.
(Note: Both DUT and ANVL acting as Host)
TEST_REFERENCE
rfc 4301, s3.1, p8  What IPsec does
TEST_METHOD
- ANVL: Send an secured ICMP echo request to <DIface-0>
- ANVL: Listen upto <ParamListenTime> for ESP-secured ICMP
        echo reply.
-  DUT: Send an secured echo reply
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1399  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1400  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1401  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1402  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1403  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1017] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1018] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1016] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1019] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.5 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1404  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1405  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1406  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1407  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1408  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1021] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1023] :: use src=30.1.1.150/32:any dst=30.1.1.5/32:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1020] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1022] :: use src=30.1.1.5/32:any dst=30.1.1.150/32:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BD7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D2 E5 DD 60 A5 3C 67 F8                           ...`.<g.
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0005 (5)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  25 F9 62 5E BC 58 C6 96 58 6B EF DB               %.b^.X..Xk..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv4 Packet

Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x212F (8495)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x1AB1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  3B F2 C9 D8 A8 7E E2 65                           ;....~.e
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF5F5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0005 (5)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6A 85 D9 45 12 B5 FA AD FC B2 7B CB               j..E......{.
ESP: --- Authentication Data End ---
ESP:


Received expected secured packet on interface eth3 (30.1.1.150)
(Local host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-1.3: Passed

>> IPSEC-ESP-1.4
TEST_DESCRIPTION
In Transport mode, ESP is inserted after the IP header and before the
next layer protocol.
(Note: This is basic test for Transport Mode)
TEST_REFERENCE
rfc 4303, s3.1.1, p18, Transport mode processing
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from <AIface-0> to
        <DIface-0>
-  DUT: Send a ESP-secured ICMP Echo Reply to <AIface-0>.
- ANVL: Verify that the ESP Header is placed in between the original IP
        header and the payload data.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1409  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1410  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1411  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1412  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1413  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1025] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1026] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1024] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1027] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.5 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1414  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1415  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1416  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1417  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1418  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1029] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1031] :: use src=30.1.1.150/32:any dst=30.1.1.5/32:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1028] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1030] :: use src=30.1.1.5/32:any dst=30.1.1.150/32:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BD6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  71 7E A3 77 45 B2 5E 7D                           q~.wE.^}
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0006 (6)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9E 17 86 07 F4 10 BE 8B CB F3 08 35               ...........5
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv4 Packet

Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x4A3D (19005)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xF1A2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B5 8F 6E B5 4F 0F C1 A0                           ..n.O...
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF5F4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0006 (6)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C0 32 AF EB B0 A2 C0 1D 2F AB DA 8B               .2....../...
ESP: --- Authentication Data End ---
ESP:


ESP Header in received packet is correctly placed after
IP Header and before next layer protocol (ICMP)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-1.4: Passed

>> IPSEC-ESP-2.1
TEST_DESCRIPTION
If integrity selected,IPSec MUST discard incoming ESP-secured IP datagram
if AuthData field of ESP Header is incorrectly computed.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.4.1 p30 Integrity Check Value Verification
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
        containing an incorrectly computed ICV in the AuthData
        field of ESP Header
-  DUT: Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1419  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1420  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1421  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1422  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1423  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1033] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1034] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1032] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1035] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BC4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BD 6F FD 22 77 0F 0B 47                           .o."w..G
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3199 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0007 (7)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  00 CE 32 3D 32 14 4D 84 CF 43 81 37               ..2=2.M..C.7
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-2.1: Passed

>> IPSEC-ESP-2.2
TEST_DESCRIPTION
IPSec MUST discard incoming ESP-secured IP-datagram if it contains a
reserved value between 0 and 255 in the SPI field of ESP Header, since
0 is reserved for local,implementation-specific use and 1 through 255
are reserved by Internet Assigned Numbers Authority (IANA)
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.1 p11 Security Parameter Index
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
        containing SPI <invalid-SPI> in ESP Header
-  DUT: Do not forward the ICMP Echo Request to Local Host
- CASE: <invalid-SPI> = 0
- CASE: <invalid-SPI> = 1
- CASE: <invalid-SPI> = 255
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1424  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1425  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1426  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1427  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1428  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1037] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1038] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1036] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1039] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the SPI Value in ESP Header to 0:
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BC2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000000 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  25 D6 09 EE 72 6F 37 1D                           %...ro7.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3197 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0008 (8)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AA D2 88 AA 9D A4 A1 4A 62 79 18 A2               .......Jby..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the SPI value in ESP Header to 1:
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BC0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000001 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B2 84 89 01 06 A4 CB EA                           ........
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3195 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0009 (9)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  33 4F 9B DF 8F A8 7E 4B 30 5E F1 EC               3O....~K0^..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the SPI Value in ESP Header to 255:
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BBE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x000000FF 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F2 C9 CA DA B0 A4 97 E3                           ........
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3193 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDF0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000A (10)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0B E5 68 69 FD D3 8D E1 03 96 CF 79               ..hi.......y
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-2.2: Passed

>> IPSEC-ESP-2.4
TEST_DESCRIPTION
IPSec Should not discard an incoming ESP-secured IP datagram
secured using a new SA if the Sequence Number in ESP Header is
not 1.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.2 p12 Sequence Number
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host containing
        the value 2 in the Sequence Number field of the ESP Header
-  DUT: Forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1429  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1430  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1431  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1432  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1433  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1041] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1042] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1040] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1043] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Set the Sequence Number to 2 in ESP Header
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BBC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B6 2A 8D E3 7E 06 20 A6                           .*..~. .
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3191 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000B (11)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DF 17 A8 8E A9 17 49 04 FF 13 09 8C               ......I.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3291 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000B (11)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, received IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-2.4: Passed

>> IPSEC-ESP-2.5
TEST_DESCRIPTION
IPSec MUST discard an incoming ESP-secured IP-datagram containing
zero-length Payload Data in the ESP Header.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.3 p13 Payload Data
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
        containing zero-length Payload Data in ESP header
-  DUT: Do not forward the ICMP Echo Response to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1434  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1435  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1436  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1437  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1438  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1045] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1046] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1044] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1047] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted IPv4 packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 48 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BEA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  47 0C DB 74 21 8E 9B DA A7 D3 F1 5C               G..t!......\
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for  IP Packet
Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-2.5: Passed

>> IPSEC-ESP-2.6
TEST_DESCRIPTION
IPSec MUST discard an incoming ESP-secured IP-datagram containing
Pad Length and Next Header field NOT right aligned within a
4-byte word.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.4 p14 Padding (for Encryption)
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host with
        Pad Length and Next Header field NOT right aligned within a
        4-byte word in ESP trailer
-  DUT: Do not forward the ICMP Echo Request, to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1439  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1440  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1441  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1442  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1443  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1049] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1050] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1048] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1051] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 97 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BB7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: --- Bad Encrypted Payload Data [57 bytes] ---
ESP:  BC 03 1F 99 E2 F9 EE 5F 6E 55 68 6A 9D 30 7C E1   ......._nUhj.0|.
ESP:  3E E6 F6 35 D0 BB 51 16 B6 C3 E8 5B A3 D7 67 8E   >..5..Q....[..g.
ESP:  AD DB B0 12 11 CD 78 DB 2E A7 92 DA 5C 94 D9 9B   ......x.....\...
ESP:  D9 0E 72 80 7C 1F 3C 3A 00                        ..r.|.<:.
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  79 7F 2C EE D5 55 95 FC 7F A8 30 8E               y.,..U....0.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-2.6: Passed

>> IPSEC-ESP-2.7
TEST_DESCRIPTION
If Padding bytes are needed but the encryption algorithm does not
specify the padding contents, IPSec SHOULD discard an ESP secured incoming
IP-datagram if the Padding in ESP Trailer is not a monotonic sequence of
increasing integers starting from 1.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.4 p15 Padding (for Encryption)
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host with
        Padding field in ESP Trailer set to <padding>
-  DUT: Do not forward the ICMP Echo Request to Local Host
- CASE: <padding> = 0,0,0,... (all zeros)
- CASE: <padding> = 1,1,1,    (all ones)
- CASE: <padding> = 2,3,... (not starting from 1)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1444  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1445  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1446  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1447  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1448  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1053] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1054] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1052] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1055] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Padding bits to 0,0,... in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 336 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AC6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  0E 72 80 7C 1F 3C 3A 00                           .r.|.<:.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 31 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3198 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x60A4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000D (13)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [3 bytes] ---
ICMP:  41 4E 56                                          ANV
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [255 bytes] ---
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ESP:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00      ...............
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 255 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CE 66 E4 1E D0 19 35 0F B5 C9 D0 E6               .f....5.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly did not receive IP packet on interface
eth4 (40.1.1.150)  (Local Host)


Case: Set the Padding bits to 1,1,... in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 336 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AC4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  34 B7 26 F6 76 4F 0B F3                           4.&.vO..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 31 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3196 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x60A3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000E (14)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [3 bytes] ---
ICMP:  41 4E 56                                          ANV
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [255 bytes] ---
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01      ...............
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 255 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  95 12 39 4E 0E 1C 3F 12 4B 41 0C B9               ..9N..?.KA..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly did not receive IP packet on interface
eth4 (40.1.1.150)  (Local Host)


Case: Set the Padding bits to 2,3,4,... in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 336 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AC2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  96 26 B9 06 04 A6 C0 D9                           .&......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 31 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3194 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x60A2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x000F (15)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [3 bytes] ---
ICMP:  41 4E 56                                          ANV
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [255 bytes] ---
ESP:  02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10 11   ................
ESP:  12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21   .............. !
ESP:  22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31   "#$%&'()*+,-./01
ESP:  32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 40 41   23456789:;<=>?@A
ESP:  42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51   BCDEFGHIJKLMNOPQ
ESP:  52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F 60 61   RSTUVWXYZ[\]^_`a
ESP:  62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71   bcdefghijklmnopq
ESP:  72 73 74 75 76 77 78 79 7A 7B 7C 7D 7E 7F 80 81   rstuvwxyz{|}~...
ESP:  82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F 90 91   ................
ESP:  92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F A0 A1   ................
ESP:  A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF B0 B1   ................
ESP:  B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF C0 C1   ................
ESP:  C2 C3 C4 C5 C6 C7 C8 C9 CA CB CC CD CE CF D0 D1   ................
ESP:  D2 D3 D4 D5 D6 D7 D8 D9 DA DB DC DD DE DF E0 E1   ................
ESP:  E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE EF F0 F1   ................
ESP:  F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF 00      ...............
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 255 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  75 A0 80 F8 BA 50 88 E2 9F EA D8 A0               u....P......
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly did not receive IP packet on interface
eth4 (40.1.1.150)  (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-2.7: Passed

>> IPSEC-ESP-3.1
TEST_DESCRIPTION
IPSec configured in Tunnel Mode MUST discard an incoming ESP-secured
IP datagram, if it is secured in Transport mode.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.1 p19 ESP Header Location
TEST_METHOD
- ANVL: Send a Transport Mode ESP-Secured ICMP Echo Request from
        Remote Host
-  DUT: Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1449  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1450  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1451  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1452  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1453  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1057] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1058] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1056] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1059] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BC1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  50 C5 F3 BE D5 F7 D8 D2                           P.......
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDEA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0010 (16)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  57 8D 74 F6 AC 74 7D 32 81 15 25 AE               W.t..t}2..%.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly did not receive IP packet on interface eth4 (40.1.1.150)(Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-3.1: Passed

>> IPSEC-ESP-3.2
TEST_DESCRIPTION
IPSec MUST discard an incoming ESP-secured IP datagram, if the
Protocol field in the outer IP-Header does not contain ESP (50).
TEST_REFERENCE
NEGATIVE: RFC 4303 s2 p5 ESP Packet Format
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host with
        Protocol field in outer IP-Header containing the value <proto>
-  DUT: Do not forward the ICMP Echo Request to Local Host
- CASE: <proto> = 49
- CASE: <proto> = 52
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1454  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1455  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1456  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1457  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1458  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1061] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1062] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1060] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1063] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Protocol to 49 in Outer IP
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = *UNKNOWN* (49)
IP: Header Checksum        = 0x3BB0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
IP: --- Trailing Data [76 bytes] ---
IP:  00 00 03 00 00 00 00 08 86 F1 22 7D 46 D4 07 64   .........."}F..d
IP:  64 DB 9B 77 A3 52 03 A5 8B 89 57 93 6E 73 87 B1   d..w.R....W.ns..
IP:  CE BE 20 7E 58 63 5D F3 E1 D4 73 60 85 6A 6C 38   .. ~Xc]...s`.jl8
IP:  73 46 D8 CE 8C 91 8E 41 E4 62 E4 36 42 3F 50 C1   sF.....A.b.6B?P.
IP:  1A A5 3B DA C5 7C 4F A0 09 AA 16 6B               ..;..|O....k
IP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Protocol to 52 in Outer IP
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = *UNKNOWN* (52)
IP: Header Checksum        = 0x3BAB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
IP: --- Trailing Data [76 bytes] ---
IP:  00 00 03 00 00 00 00 09 E4 62 E4 36 42 3F 50 C1   .........b.6B?P.
IP:  21 70 B9 B5 46 27 EA D9 DD F1 34 C4 44 A4 7A AF   !p..F'....4.D.z.
IP:  92 89 D6 4F 73 65 8E 16 A9 CF 84 29 37 F3 6D 11   ...Ose.....)7.m.
IP:  D0 24 6B DD 52 7C C5 6D CF 39 97 C2 2F C7 7F D5   .$k.R|.m.9../...
IP:  11 5E 57 3A A1 71 A0 23 E9 D7 7E 3F               .^W:.q.#..~?
IP: --- Trailing Data End ---

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-3.2: Passed

>> IPSEC-ESP-4.1
TEST_DESCRIPTION
IPSec MUST discard incoming ESP-secured IP-datagram if the Fragment 
Offset field in IP-Header is nonzero.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.1 p27 Reassembly
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host with
        Offset field in IP-Header set to 1
-  DUT: Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1459  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1460  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1461  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1462  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1463  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1065] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1066] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1064] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1067] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0001 (8 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BAA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  CF 39 97 C2 2F C7 7F D5                           .9../...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3180 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0013 (19)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8C 4E 4F 02 F0 5C E5 71 8B 2F ED 4F               .NO..\.q./.O
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-4.1: Passed

>> IPSEC-ESP-4.2
TEST_DESCRIPTION
IPSec MUST discard incoming ESP-secured IP-datagram if the More
Fragments flag in IP-Header set.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.1 p27 Reassembly
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
        with More Fragments flag in IP-Header set
-  DUT: Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1464  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1465  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1466  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1467  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1468  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1069] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1070] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1068] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1071] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x1BA9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A5 2D 69 7A 86 E8 07 8C                           .-iz....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDE6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0014 (20)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4B D5 99 6A F8 88 BD 20 03 A0 60 57               K..j... ..`W
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-4.2: Passed

>> IPSEC-ESP-5.1
TEST_DESCRIPTION
IPSec MUST discard an incoming IP-datagram, if the AuthData field
in ESP Header does not contain a 96 bit ICV.
TEST_REFERENCE
NEGATIVE: RFC 2403 s2 p2 Algorithm and Mode
          RFC 2404 s2 p2 Algorithm and Mode
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host with
        Authentication Data of length 88 bits (!= 96 bits)
-  DUT: Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1469  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1470  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1471  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1472  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1473  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1073] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1074] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1072] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1075] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 95 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BA8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
ESP: --- Bad Encrypted Payload Data [55 bytes] ---
ESP:  6B CD 17 F9 81 35 4B 66 6F 41 2D 05 AB E6 83 27   k....5KfoA-....'
ESP:  07 F1 E7 28 8A BD DA 9D F1 BC 76 2D E1 0C 15 E0   ...(......v-....
ESP:  02 08 D8 1F 28 EE B8 2F 57 01 39 ED E1 A7 D5 C2   ....(../W.9.....
ESP:  5C 42 CA EF 4A C7 49                              \B..J.I
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  37 BE 88 A2 F7 8C CE E4 C5 20 FF 76               7........ .v
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, no IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-5.1: Passed

>> IPSEC-ESP-6.1
TEST_DESCRIPTION
IPSec MUST discard an incoming IP-datagram containing 8 bytes of
Payload Data in ESP Header .
TEST_REFERENCE
NEGATIVE: RFC 2405 s3 p2 ESP Payload
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
        containing 8 bytes of Payload Data in ESP Header
-  DUT: Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1474  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1475  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1476  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1477  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1478  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1077] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1078] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1076] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1079] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted IPv4 packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 56 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BCD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  5C 42 CA EF 4A C7 49 37                           \B..J.I7
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2E 9B 2E 87 25 4B 8C 35 E9 ED E0 2E               ....%K.5....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for  IP Packet
Correctly, no IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-6.1: Passed

>> IPSEC-ESP-6.2
TEST_DESCRIPTION
IPSec MUST discard an incoming IP-datagram containing Next Header field
NOT right aligned within a 8-byte word.
TEST_REFERENCE
NEGATIVE: RFC 4303 s2.4 p14 Padding (for Encryption)
          RFC 2405 s3.1 p3 Block Size and Padding
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host with
        Payload Data, Padding, Pad Length and Next Header field NOT
        right aligned within a 8-byte word in ESP Trailer.
        The padding field
        will be such that the Payload Data, Padding, Pad Length and
        Next Header field will be out of (8-byte) alignment by
        <shift> bytes
-  DUT: Do not forward the ICMP Echo Request to Local Host
- CASE: <shift> = 1
- CASE: <shift> = 2
- CASE: <shift> = 3
- CASE: <shift> = 4
- CASE: <shift> = 5
- CASE: <shift> = 6
- CASE: <shift> = 7
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1479  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1480  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1481  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1482  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1483  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1081] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1082] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1080] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1083] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Pad Length to 1 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 89 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BAA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
ESP: --- Bad Encrypted Payload Data [49 bytes] ---
ESP:  1A 6E 43 51 CC D1 C3 72 51 74 28 FC D6 80 DF 4B   .nCQ...rQt(....K
ESP:  8B C9 98 D8 97 0E 17 C4 42 90 E1 9F AC 3A B7 9A   ........B....:..
ESP:  BF 02 C3 F7 E9 71 AC 4F 1A A9 4A 46 89 C2 09 E7   .....q.O..JF....
ESP:  00                                                .
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A0 FF 26 DF 51 7A 4D 8D 1D 62 F9 66               ..&.QzM..b.f
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 2 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 90 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BA7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
ESP: --- Bad Encrypted Payload Data [50 bytes] ---
ESP:  A9 4A 46 89 C2 09 E7 00 D0 51 17 BD 34 36 44 77   .JF......Q..46Dw
ESP:  40 89 D6 E2 F1 74 A3 37 2C 2E E5 31 1D 36 E2 E7   @....t.7,..1.6..
ESP:  4A 67 73 8B D5 9A 52 33 6B 31 37 27 FB 06 75 5C   Jgs...R3k17'..u\
ESP:  00 00                                             ..
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F8 A8 4C 78 6D C8 97 2A F5 0A BC D4               ..Lxm..*....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 3 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 91 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BA4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
ESP: --- Bad Encrypted Payload Data [51 bytes] ---
ESP:  37 27 FB 06 75 5C 00 00 C1 D0 9F 87 79 9F EB 55   7'..u\......y..U
ESP:  67 AE D5 33 14 F5 7D 41 A6 66 A9 24 23 DC 85 DC   g..3..}A.f.$#...
ESP:  FA 46 AD C2 F7 C6 BD D1 53 E6 2E 08 64 1A 05 34   .F......S...d..4
ESP:  00 00 00                                          ...
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  36 72 AC 46 D2 4D 9D F9 A5 10 35 06               6r.F.M....5.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 4 in ESP Trailer

Setting Pad Length to a misaligned value  - packet will not be decoded fully.

Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 92 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3BA1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
ESP: --- Bad Encrypted Payload Data [52 bytes] ---
ESP:  08 64 1A 05 34 00 00 00 0B 4B EF 25 A2 4D B9 7F   .d..4....K.%.M..
ESP:  94 5F FE 28 23 2A 41 2E 66 D9 51 DD D4 75 8E B3   ._.(#*A.f.Q..u..
ESP:  03 42 75 07 3D EC 95 17 BE CC CA E1 35 DD 9F 91   .Bu.=.......5...
ESP:  00 00 00 00                                       ....
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  30 2C 80 F3 2A E3 E2 C0 8E 41 82 57               0,..*....A.W
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 5 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 93 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B9E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
ESP: --- Bad Encrypted Payload Data [53 bytes] ---
ESP:  35 DD 9F 91 00 00 00 00 B3 69 D8 06 34 1D 95 93   5........i..4...
ESP:  54 43 34 5A E6 C2 F0 28 1B DE AB 2B 97 72 29 0B   TC4Z...(...+.r).
ESP:  C3 EE E6 36 F8 56 FF 4A A3 15 65 1B CC 19 06 3D   ...6.V.J..e....=
ESP:  00 00 00 00 00                                    .....
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  75 6C B1 EE 8C D6 15 B9 4D 48 88 9C               ul......MH..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 6 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 94 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B9B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
ESP: --- Bad Encrypted Payload Data [54 bytes] ---
ESP:  19 06 3D 00 00 00 00 00 DE 42 24 56 56 0A 5E 37   ..=......B$VV.^7
ESP:  8C C9 96 2C 88 EA 0F FF 6E 29 1E AB 23 CC C2 A6   ...,....n)..#...
ESP:  69 DD E3 07 EA 2B CB D4 BE 5F 17 B3 28 E9 C4 97   i....+..._..(...
ESP:  00 00 00 00 00 00                                 ......
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  25 4D 31 85 4C 07 97 90 60 5D A1 51               %M1.L...`].Q
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)


Case: Set the Pad Length to 7 in ESP Trailer

Setting Pad Length to a misaligned value - packet will not be decoded fully.

Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 95 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B98 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
ESP: --- Bad Encrypted Payload Data [55 bytes] ---
ESP:  C4 97 00 00 00 00 00 00 CD 00 74 78 13 E5 63 61   ..........tx..ca
ESP:  F2 B4 6E D1 8F DF 2E 40 F9 3A EF 7A 23 97 24 47   ..n....@.:.z#.$G
ESP:  60 8F 1B 34 A4 83 49 01 9C F9 4E 04 CD 95 A6 FF   `..4..I...N.....
ESP:  00 00 00 00 00 00 00                              .......
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  94 EF E7 3A 58 BB 90 52 BE 64 1B 23               ...:X..R.d.#
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-6.2: Passed

>> IPSEC-ESP-7.1
TEST_DESCRIPTION
IPSec MUST discard incoming ESP-secured IP datagram with Sequence
Number in ESP Header less than *left* edge of replay window, while
using Authentication.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host containing
        the value 1 in the Sequence Number field of the ESP Header
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
        containing the value (<window-size> + 2) in the Sequence
        Number field of the ESP header
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host
        containing the value 2 in the Sequence Number field of the
        ESP Header
-  DUT: Do not forward the corresponding ICMP Echo Request to
        Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1484  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1485  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1486  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1487  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1488  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1085] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1086] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1084] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1087] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP Echo-Request with Sequence Number: 1
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B95 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  FF 00 00 00 00 00 00 00                           ........
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001D (29)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  29 80 CB F5 D9 16 B7 2F D6 60 BA 63               )....../.`.c
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x326A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001D (29)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending encrypted ICMP Echo-Request with Sequence Number: 34
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B93 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000022 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  86 47 50 01 52 AD A8 B0                           .GP.R...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3168 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001E (30)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  EB 8C 0F E6 A0 A1 7B C7 6A 2A F3 74               ......{.j*.t
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3268 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001E (30)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending encrypted ICMP Echo-Request with Sequence Number: 2
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B91 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  92 57 A3 E2 67 C9 44 31                           .W..g.D1
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3166 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x001F (31)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C2 54 E1 A7 1A DB EB AE 19 D8 C6 8F               .T..........
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-7.1: Passed

>> IPSEC-ESP-7.2
TEST_DESCRIPTION
IPSec MUST accept all IP datagrams containing distinct Sequence Numbers
in the ESP Header that fall within anti-replay window, while using ESP
Authentication.
TEST_REFERENCE
RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host containing
        the value 1 in the Sequence Number field of the ESP Header
-  DUT: Forward the corresponding ICMP Echo Request
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host containing
        the value <window-size> in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Send (<window-size> - 2) ESP-secured ICMP Echo Requests from
        Remote Host, with Sequence Numbers from 2 to
        (<window-size> - 1)
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1489  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1490  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1491  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1492  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1493  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1089] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1090] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1088] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1091] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP Echo-Request with Sequence Number: 1
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B8F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  2C D8 0A 77 38 F1 CE E4                           ,..w8...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3164 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0020 (32)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  04 3D 5A FC 41 DC 61 79 35 50 64 F5               .=Z.A.ay5Pd.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3264 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDDA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0020 (32)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending encrypted ICMP Echo-Request with Sequence Number: 32
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B8D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000020 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  13 74 5E 28 00 BA 88 C7                           .t^(....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3162 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0021 (33)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C6 4C EC ED CB 95 BF 46 41 E1 A3 77               .L.....FA..w
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3262 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0021 (33)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending Authenticated ICMP Echo-Request with Sequence Number: 2
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B8B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  9E 7E 99 06 B5 95 59 CE                           .~....Y.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3160 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0022 (34)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  97 CB 34 25 2A 58 BF 3A F3 36 27 7B               ..4%*X.:.6'{
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3260 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0022 (34)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 2
Sending Authenticated ICMP Echo-Request with Sequence Number: 3
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B89 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  9D C1 32 7C 95 B9 A9 39                           ..2|...9
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x315E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0023 (35)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DC E6 F3 86 34 DB 17 39 98 E1 3D C2               ....4..9..=.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x325E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0023 (35)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 3
Sending Authenticated ICMP Echo-Request with Sequence Number: 4
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B87 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  72 34 34 E1 34 38 07 96                           r44.48..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x315C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0024 (36)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  3F 1A A0 E0 51 4F AA 88 C0 22 4A F8               ?...QO..."J.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x325C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0024 (36)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 4
Sending Authenticated ICMP Echo-Request with Sequence Number: 5
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B85 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F8 6F 5D D0 A1 27 34 D0                           .o]..'4.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x315A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0025 (37)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  24 17 6D 7E F1 23 35 FF AC 39 30 79               $.m~.#5..90y
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x325A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0025 (37)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 5
Sending Authenticated ICMP Echo-Request with Sequence Number: 6
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B83 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  20 58 DD 01 23 8E 27 70                            X..#.'p
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3158 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0026 (38)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AA 1B 91 22 C8 90 9D CE 5A 14 9E 43               ..."....Z..C
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3258 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0026 (38)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 6
Sending Authenticated ICMP Echo-Request with Sequence Number: 7
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B81 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B3 71 96 68 F6 B2 97 4D                           .q.h...M
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3156 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0027 (39)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  80 BB 40 C3 56 C0 F3 CD 0C 95 D0 8C               ..@.V.......
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3256 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0027 (39)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 7
Sending Authenticated ICMP Echo-Request with Sequence Number: 8
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B7F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  60 89 87 BA B5 CE 5C 81                           `.....\.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3154 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0028 (40)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F6 D9 E0 D2 43 7B DD 2B 93 7B 42 7E               ....C{.+.{B~
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3254 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0028 (40)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 8
Sending Authenticated ICMP Echo-Request with Sequence Number: 9
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B7D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  91 54 D7 78 5D 76 01 EB                           .T.x]v..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3152 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0029 (41)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  70 14 B1 EA 4F 5A 65 50 71 E5 5E D8               p...OZePq.^.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3252 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0029 (41)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 9
Sending Authenticated ICMP Echo-Request with Sequence Number: 10
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B7B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D8 27 2F A7 F2 78 9A 44                           .'/..x.D
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3150 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002A (42)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  99 38 40 4A 2D 9E C6 B1 AD BD 5D D4               .8@J-.....].
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3250 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDD0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002A (42)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 10
Sending Authenticated ICMP Echo-Request with Sequence Number: 11
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B79 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BD 45 CB D6 82 17 DE E6                           .E......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x314E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002B (43)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BF 97 1C B4 30 AE 26 D6 6E 9C A6 95               ....0.&.n...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x324E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002B (43)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 11
Sending Authenticated ICMP Echo-Request with Sequence Number: 12
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B77 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  29 DD 25 A0 0A 77 32 38                           ).%..w28
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x314C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002C (44)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  37 35 81 26 38 1D E2 21 8A CA 8D 84               75.&8..!....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x324C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002C (44)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 12
Sending Authenticated ICMP Echo-Request with Sequence Number: 13
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B75 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B3 39 4E 61 DD E4 16 17                           .9Na....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x314A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002D (45)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B2 DD 34 51 92 5E AC 5C B6 80 DF 9D               ..4Q.^.\....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x324A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002D (45)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 13
Sending Authenticated ICMP Echo-Request with Sequence Number: 14
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B73 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  1C 0A 9F FB F1 28 C2 4E                           .....(.N
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3148 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002E (46)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  10 75 5D 57 13 60 05 09 FD 60 53 A4               .u]W.`...`S.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3248 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002E (46)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 14
Sending Authenticated ICMP Echo-Request with Sequence Number: 15
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B71 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  7D 22 1B 00 20 66 BB 5D                           }".. f.]
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3146 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002F (47)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  49 55 04 09 06 14 98 D4 95 36 AC 10               IU.......6..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3246 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x002F (47)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 15
Sending Authenticated ICMP Echo-Request with Sequence Number: 16
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B6F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DB 40 94 B9 20 96 79 35                           .@.. .y5
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3144 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0030 (48)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6D 36 11 97 54 44 7D 43 7E 14 07 E4               m6..TD}C~...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3244 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDCA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0030 (48)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 16
Sending Authenticated ICMP Echo-Request with Sequence Number: 17
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B6D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  3F E4 D5 CD 9A DD F6 82                           ?.......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3142 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0031 (49)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8F DB 66 8F 05 FE 9F 57 BB D9 D9 37               ..f....W...7
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3242 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0031 (49)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 17
Sending Authenticated ICMP Echo-Request with Sequence Number: 18
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B6B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  15 95 FD 2C EC CA 23 5B                           ...,..#[
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3140 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0032 (50)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  30 16 E5 12 A6 6C F2 98 89 54 CC DB               0....l...T..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3240 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0032 (50)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 18
Sending Authenticated ICMP Echo-Request with Sequence Number: 19
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B69 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BE 80 A6 D2 07 60 67 32                           .....`g2
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x313E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0033 (51)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E5 7D 56 B9 18 FA F4 25 A3 BB 02 80               .}V....%....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x323E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0033 (51)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 19
Sending Authenticated ICMP Echo-Request with Sequence Number: 20
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B67 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  76 15 A7 9B BD 71 25 65                           v....q%e
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x313C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0034 (52)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  22 F1 EF 50 F1 51 B3 2C E2 1D 5E AA               "..P.Q.,..^.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x323C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0034 (52)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 20
Sending Authenticated ICMP Echo-Request with Sequence Number: 21
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B65 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000015 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B6 E2 7E D2 03 04 AA 90                           ..~.....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x313A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0035 (53)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D2 9F C5 9B 93 4A CE 13 98 00 73 C3               .....J....s.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x323A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0035 (53)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 21
Sending Authenticated ICMP Echo-Request with Sequence Number: 22
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B63 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F7 45 3A 95 4F 26 F5 E4                           .E:.O&..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3138 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0036 (54)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E9 C2 F7 B7 D4 D7 34 28 28 8D CC F1               ......4((...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3238 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0036 (54)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 22
Sending Authenticated ICMP Echo-Request with Sequence Number: 23
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B61 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000017 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BE 22 9F 5F 48 29 6D B1                           ."._H)m.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3136 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0037 (55)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F7 35 75 66 9F FF C9 A8 BB 48 A8 2C               .5uf.....H.,
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3236 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0037 (55)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 23
Sending Authenticated ICMP Echo-Request with Sequence Number: 24
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B5F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000018 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A0 73 4C 3E 43 81 EA 21                           .sL>C..!
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3134 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0038 (56)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4D 35 DD 07 3B 59 A7 C3 91 8C 47 D9               M5..;Y....G.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3234 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0038 (56)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 24
Sending Authenticated ICMP Echo-Request with Sequence Number: 25
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B5D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  67 5F 0D 3A ED 59 CD EF                           g_.:.Y..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3132 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0039 (57)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A4 7E F6 F8 44 4F 3A 33 96 D1 FC 35               .~..DO:3...5
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3232 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0039 (57)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 25
Sending Authenticated ICMP Echo-Request with Sequence Number: 26
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B5B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  67 37 70 18 1B 71 42 C7                           g7p..qB.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3130 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003A (58)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0D 14 8D 20 DA 2F 0C BA 38 8C 51 A0               ... ./..8.Q.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3230 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDC0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003A (58)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 26
Sending Authenticated ICMP Echo-Request with Sequence Number: 27
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B59 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F6 19 73 50 FD 45 DE 91                           ..sP.E..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x312E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003B (59)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2F 8F 29 D1 09 F6 00 D3 02 F6 7F 05               /.).........
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x322E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003B (59)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 27
Sending Authenticated ICMP Echo-Request with Sequence Number: 28
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B57 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  90 EF 55 B6 C1 DE 24 C1                           ..U...$.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x312C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003C (60)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  09 B4 D9 48 C2 86 3A 38 77 9E 08 CA               ...H..:8w...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x322C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003C (60)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 28
Sending Authenticated ICMP Echo-Request with Sequence Number: 29
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B55 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001D 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  29 F8 64 65 3A EC B3 19                           ).de:...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x312A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003D (61)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FF AF 65 F2 F9 22 0A DB 80 D5 7C EE               ..e.."....|.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x322A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003D (61)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 29
Sending Authenticated ICMP Echo-Request with Sequence Number: 30
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B53 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001E 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  55 F7 93 1B 6E 66 7F D4                           U...nf..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3128 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003E (62)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0E EA 5E 01 06 B5 A5 A5 65 4F 20 FE               ..^.....eO .
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3228 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003E (62)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 30
Sending Authenticated ICMP Echo-Request with Sequence Number: 31
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B51 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  7D 31 35 79 A4 AC B9 AF                           }15y....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3126 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003F (63)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  36 22 DE F6 92 9D C4 34 BB 54 AF 36               6".....4.T.6
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3226 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x003F (63)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 31

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-7.2: Passed

>> IPSEC-ESP-7.3
TEST_DESCRIPTION
IPSec MUST discard an ESP-secured IP-datagram that has same Sequence
Number in ESP Header as a previously received datagram falling within
replay window.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host
        containing the value 1 in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host containing
        the value <window-size> in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Send (<window-size> - 2) ESP-secured ICMP Echo Requests from
        Remote Host, with Sequence Numbers from 2 to
       (<window-size> - 1)
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Send (<window-size> - 2) ESP-secured ICMP Echo Requests from
        Remote Host, with Sequence Numbers from 2 to
        (<window-size> - 1)
-  DUT: Do not forward any ICMP Echo Requests to Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1494  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1495  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1496  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1497  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1498  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1093] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1094] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1092] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1095] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP Echo-Request with Seyquence Number: 1
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0081 (129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B4F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  EE DF BF 05 36 30 75 E0                           ....60u.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0080 (128)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3124 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0040 (64)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0E 52 A9 A1 64 03 AB 61 C2 91 10 1F               .R..d..a....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0080 (128)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3224 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDBA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0040 (64)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending encrypted ICMP Echo-Request with Sequence Number: 32
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0083 (131)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B4D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000020 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  2C DB 68 E7 AA 1D 10 84                           ,.h.....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3122 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0041 (65)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D9 07 4E D5 93 35 19 67 3C 67 10 88               ..N..5.g<g..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3222 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0041 (65)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending Authenticated ICMP Echo-Request with Sequence Number: 2
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0085 (133)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B4B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  CA 92 6E A6 38 8F 70 51                           ..n.8.pQ
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0084 (132)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3120 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0042 (66)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0B 2A 28 D3 E3 69 EF F4 EC 22 20 86               .*(..i..." .
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0084 (132)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3220 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0042 (66)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 2
Sending Authenticated ICMP Echo-Request with Sequence Number: 3
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0087 (135)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B49 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A4 A6 6B D1 AB 36 74 66                           ..k..6tf
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0086 (134)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x311E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0043 (67)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5F B9 65 F9 BE AE 0D 57 0E 66 D2 5B               _.e....W.f.[
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0086 (134)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x321E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0043 (67)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 3
Sending Authenticated ICMP Echo-Request with Sequence Number: 4
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0089 (137)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B47 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  54 5D 35 3B 2D CE 8E 69                           T]5;-..i
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0088 (136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x311C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0044 (68)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B2 20 65 50 A9 05 B0 63 BF F6 5B 10               . eP...c..[.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0088 (136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x321C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0044 (68)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 4
Sending Authenticated ICMP Echo-Request with Sequence Number: 5
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x008B (139)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B45 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  26 FE 8E 5D F5 23 02 55                           &..].#.U
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008A (138)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x311A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0045 (69)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B4 34 59 9A EB C3 13 FD 56 9C 48 D3               .4Y.....V.H.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008A (138)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x321A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0045 (69)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 5
Sending Authenticated ICMP Echo-Request with Sequence Number: 6
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x008D (141)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B43 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DC BB F1 0F 2D DE 4D BF                           ....-.M.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008C (140)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3118 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0046 (70)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  21 65 D8 22 C4 28 76 ED 9E 02 21 BF               !e.".(v...!.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008C (140)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3218 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0046 (70)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 6
Sending Authenticated ICMP Echo-Request with Sequence Number: 7
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x008F (143)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B41 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  E2 B7 0D 72 F2 DE E1 EB                           ...r....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008E (142)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3116 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0047 (71)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A7 A4 8C 7C A3 3D 25 B3 BA A9 4B 6B               ...|.=%...Kk
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x008E (142)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3216 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0047 (71)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 7
Sending Authenticated ICMP Echo-Request with Sequence Number: 8
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0091 (145)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B3F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DF 69 95 FA 2F EF 7A 21                           .i../.z!
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0090 (144)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3114 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0048 (72)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  17 8C 04 43 7E D3 BE F0 78 51 27 3C               ...C~...xQ'<
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0090 (144)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3214 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0048 (72)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 8
Sending Authenticated ICMP Echo-Request with Sequence Number: 9
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0093 (147)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B3D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  FC 66 2F E3 7D 32 0E 86                           .f/.}2..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0092 (146)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3112 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0049 (73)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  3E 23 37 31 15 C9 06 AD DD 16 F0 71               >#71.......q
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0092 (146)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3212 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0049 (73)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 9
Sending Authenticated ICMP Echo-Request with Sequence Number: 10
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0095 (149)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B3B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  36 C5 04 AD 45 EB 26 E3                           6...E.&.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0094 (148)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3110 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004A (74)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  66 BA 66 03 2F 0D 21 25 A4 DA 81 37               f.f./.!%...7
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0094 (148)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3210 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDB0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004A (74)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 10
Sending Authenticated ICMP Echo-Request with Sequence Number: 11
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0097 (151)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B39 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  44 BA 79 89 16 06 59 14                           D.y...Y.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0096 (150)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x310E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004B (75)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E4 68 12 4C 3F 81 4F 4D 1F A0 5F EF               .h.L?.OM.._.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0096 (150)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x320E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAF (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004B (75)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 11
Sending Authenticated ICMP Echo-Request with Sequence Number: 12
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0099 (153)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B37 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F6 82 8D C5 C3 CD 4B 65                           ......Ke
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0098 (152)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x310C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004C (76)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  3D E4 C8 CA C8 42 E2 A8 30 4B 16 30               =....B..0K.0
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0098 (152)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x320C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAE (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004C (76)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 12
Sending Authenticated ICMP Echo-Request with Sequence Number: 13
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x009B (155)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B35 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  58 CB F0 75 D2 6A 04 A0                           X..u.j..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009A (154)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x310A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004D (77)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  45 36 9A F3 77 AA 48 23 53 22 22 10               E6..w.H#S"".
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009A (154)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x320A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAD (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004D (77)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 13
Sending Authenticated ICMP Echo-Request with Sequence Number: 14
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x009D (157)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B33 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  84 9C D3 A2 01 EC 4E 0F                           ......N.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009C (156)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3108 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004E (78)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AA 5A 3C 01 08 35 5E E6 24 5C 56 F1               .Z<..5^.$\V.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009C (156)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3208 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004E (78)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 14
Sending Authenticated ICMP Echo-Request with Sequence Number: 15
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x009F (159)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B31 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  14 92 4F 9A 17 5D 14 24                           ..O..].$
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009E (158)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3106 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004F (79)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  83 98 44 0A 04 7C 02 71 82 75 C6 2D               ..D..|.q.u.-
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x009E (158)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3206 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x004F (79)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 15
Sending Authenticated ICMP Echo-Request with Sequence Number: 16
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00A1 (161)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B2F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  CD 65 D7 3B 19 8E 20 D0                           .e.;.. .
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A0 (160)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3104 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0050 (80)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  88 7D 41 6E 2F 7C 3D D5 AC 65 89 21               .}An/|=..e.!
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A0 (160)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3204 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDAA (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0050 (80)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 16
Sending Authenticated ICMP Echo-Request with Sequence Number: 17
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00A3 (163)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B2D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  7F C6 4B 5D 2E 35 B5 0B                           ..K].5..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A2 (162)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3102 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0051 (81)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  11 54 D3 0B F7 E7 F4 1E 60 CD 44 99               .T......`.D.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A2 (162)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3202 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA9 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0051 (81)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 17
Sending Authenticated ICMP Echo-Request with Sequence Number: 18
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00A5 (165)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B2B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  0A 26 8A 27 A1 10 7F 37                           .&.'...7
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A4 (164)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3100 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0052 (82)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 07 E6 21 44 D5 4A 62 58 85 36 E8               R..!D.JbX.6.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A4 (164)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3200 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA8 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0052 (82)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 18
Sending Authenticated ICMP Echo-Request with Sequence Number: 19
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00A7 (167)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B29 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  31 67 EF 99 46 8D BA 25                           1g..F..%
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A6 (166)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30FE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0053 (83)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  43 D8 F6 A5 1F 04 34 DD 20 B0 F4 FE               C.....4. ...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A6 (166)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31FE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0053 (83)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 19
Sending Authenticated ICMP Echo-Request with Sequence Number: 20
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00A9 (169)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B27 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F2 AA 2F 18 E1 A4 1C EC                           ../.....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A8 (168)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30FC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0054 (84)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6D C6 6B 6C D0 8D 4F F0 A5 87 02 D7               m.kl..O.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00A8 (168)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31FC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA6 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0054 (84)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 20
Sending Authenticated ICMP Echo-Request with Sequence Number: 21
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00AB (171)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B25 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000015 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F9 41 D2 53 9F 22 6B 26                           .A.S."k&
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AA (170)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30FA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0055 (85)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C2 33 A7 A6 25 F4 61 F4 52 FC E9 07               .3..%.a.R...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AA (170)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31FA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA5 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0055 (85)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 21
Sending Authenticated ICMP Echo-Request with Sequence Number: 22
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00AD (173)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B23 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  50 7C 79 43 35 8B 32 1E                           P|yC5.2.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AC (172)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0056 (86)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  71 FA 5A A1 03 3D 90 34 22 4E 3E EC               q.Z..=.4"N>.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AC (172)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0056 (86)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 22
Sending Authenticated ICMP Echo-Request with Sequence Number: 23
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00AF (175)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B21 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000017 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  0D C7 60 24 D1 9D D0 29                           ..`$...)
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AE (174)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0057 (87)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  52 17 84 E1 3A C7 C5 C0 F2 87 80 D4               R...:.......
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00AE (174)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0057 (87)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 23
Sending Authenticated ICMP Echo-Request with Sequence Number: 24
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00B1 (177)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B1F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000018 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D6 9E 34 DF AE CC F5 21                           ..4....!
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B0 (176)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0058 (88)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CB DC 88 66 6B 35 FA 2E D8 38 DF 2C               ...fk5...8.,
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B0 (176)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0058 (88)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 24
Sending Authenticated ICMP Echo-Request with Sequence Number: 25
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00B3 (179)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B1D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F0 B9 2F 3C 2C 67 57 AC                           ../<,gW.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B2 (178)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0059 (89)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B9 FD 7C D7 0D B7 4C 64 CA F3 91 DC               ..|...Ld....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B2 (178)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA1 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0059 (89)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 25
Sending Authenticated ICMP Echo-Request with Sequence Number: 26
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00B5 (181)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B1B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F0 8E FF 42 EC A9 71 5E                           ...B..q^
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B4 (180)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30F0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005A (90)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  40 25 1B 00 C3 F9 B3 FB 95 75 0A 2F               @%.......u./
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B4 (180)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31F0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEDA0 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005A (90)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 26
Sending Authenticated ICMP Echo-Request with Sequence Number: 27
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00B7 (183)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B19 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  34 25 46 C8 31 DB 8E AA                           4%F.1...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B6 (182)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30EE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005B (91)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  90 87 94 D9 BB 06 02 CA 5D 9B ED 63               ........]..c
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B6 (182)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31EE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005B (91)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 27
Sending Authenticated ICMP Echo-Request with Sequence Number: 28
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00B9 (185)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B17 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  0B 77 DC BC FD 58 E0 F6                           .w...X..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B8 (184)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30EC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005C (92)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  77 43 BA 83 4D 1E 06 E6 33 5B C1 CE               wC..M...3[..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00B8 (184)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31EC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005C (92)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 28
Sending Authenticated ICMP Echo-Request with Sequence Number: 29
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00BB (187)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B15 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001D 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  FA C1 21 B6 3F D3 22 83                           ..!.?.".
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BA (186)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30EA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005D (93)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5B 68 F4 26 96 F6 0D 21 BE 36 2A 76               [h.&...!.6*v
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BA (186)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31EA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005D (93)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 29
Sending Authenticated ICMP Echo-Request with Sequence Number: 30
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00BD (189)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B13 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001E 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  56 AD 26 A9 76 81 F0 AA                           V.&.v...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BC (188)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005E (94)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  74 3C 89 25 5F FE 41 71 FB 97 37 0A               t<.%_.Aq..7.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BC (188)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31E8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005E (94)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 30
Sending Authenticated ICMP Echo-Request with Sequence Number: 31
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00BF (191)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B11 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C0 9F 4A C9 8C 20 8F AC                           ..J.. ..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BE (190)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005F (95)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9E C3 D3 D7 39 DF 70 AA 12 40 5C 32               ....9.p..@\2
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00BE (190)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31E6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x005F (95)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT forwarded corresponding ICMP Echo-Request: 31
Sending encrypted ICMP Echo-Request with Sequence Number: 2
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00C1 (193)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B0F (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  4A B5 89 CE C1 C3 52 A6                           J.....R.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C0 (192)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED9A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0060 (96)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4D D0 AC 1C E1 51 B6 85 E3 EB 36 69               M....Q....6i
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 3
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00C3 (195)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B0D (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C3 C1 B8 04 B8 B6 B8 D3                           ........
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C2 (194)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED99 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0061 (97)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5A 75 49 64 05 96 C4 05 76 F5 0B 31               ZuId....v..1
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 4
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00C5 (197)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B0B (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  2B EC 8F D2 FF B5 3E 2D                           +.....>-
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C4 (196)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30E0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED98 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0062 (98)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0E 29 74 7D 2C 27 81 4D 87 9A D2 8F               .)t},'.M....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 5
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00C7 (199)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B09 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  54 17 3E 7B B2 C2 A5 ED                           T.>{....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C6 (198)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30DE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED97 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0063 (99)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CA 06 26 E7 5E 40 61 92 A1 EB F6 BB               ..&.^@a.....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 6
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00C9 (201)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B07 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  20 A5 C5 E2 84 04 6B AE                            .....k.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00C8 (200)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30DC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED96 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0064 (100)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9D FA 98 B4 8E 58 FC FB B5 FB AB 14               .....X......
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 7
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00CB (203)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B05 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  89 33 F5 5B 74 58 BF D3                           .3.[tX..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00CA (202)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30DA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED95 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0065 (101)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A5 90 62 E5 C7 64 F8 D3 8D 45 D7 68               ..b..d...E.h
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 8
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00CD (205)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B03 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D1 D3 E3 56 6E 8A F3 2D                           ...Vn..-
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00CC (204)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED94 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0066 (102)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  62 09 23 EB 78 5C BE 5A D3 CA 44 B9               b.#.x\.Z..D.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 9
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00CF (207)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3B01 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  49 EA C4 40 EB 89 53 7F                           I..@..S.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00CE (206)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED93 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0067 (103)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D5 D2 12 E2 48 BC 95 1F A7 77 FC B6               ....H....w..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 10
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00D1 (209)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  9A 41 E4 E6 1E 94 BC CD                           .A......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D0 (208)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED92 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0068 (104)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AA C2 80 4D 6E B8 31 18 97 47 68 B2               ...Mn.1..Gh.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 11
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00D3 (211)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AFD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D0 FC 31 6F 29 F8 5D E0                           ..1o).].
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D2 (210)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED91 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0069 (105)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  14 D8 F0 55 9B 95 F2 B8 40 92 48 87               ...U....@.H.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 12
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00D5 (213)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AFB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000C 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  59 FA 7C A4 64 CA 0A 00                           Y.|.d...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D4 (212)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30D0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED90 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006A (106)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  74 D5 CB 5A 64 47 14 2D A7 CE E6 C8               t..ZdG.-....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 13
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00D7 (215)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AF9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000D 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  4C 55 79 9C 7F 7A CB 62                           LUy..z.b
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D6 (214)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30CE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006B (107)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  82 C7 E4 A5 62 9E 9D 24 A5 49 14 8B               ....b..$.I..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 14
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00D9 (217)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AF7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000E 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  56 C2 1B E6 51 15 32 23                           V...Q.2#
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00D8 (216)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30CC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006C (108)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A4 6A E6 33 33 75 8B 33 34 A0 F2 29               .j.33u.34..)
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 15
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00DB (219)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AF5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000F 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F1 6A AC 03 73 19 AE BF                           .j..s...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DA (218)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30CA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006D (109)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  97 73 CC 05 67 2B D8 72 96 5E 61 40               .s..g+.r.^a@
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 16
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00DD (221)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AF3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000010 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  25 55 8A C7 83 44 17 72                           %U...D.r
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DC (220)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006E (110)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  40 47 62 75 94 2C BC 20 96 81 CF A0               @Gbu.,. ....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 17
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00DF (223)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AF1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000011 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  43 98 2F 4D A3 ED 24 87                           C./M..$.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00DE (222)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x006F (111)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8E AF EB AA C3 F6 86 E8 F3 B9 D9 8F               ............
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 18
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00E1 (225)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AEF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000012 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  2D 46 03 33 FB 8B 3B 46                           -F.3..;F
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E0 (224)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED8A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0070 (112)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B7 F4 6B BE F5 7B D4 BF 7A FF 45 73               ..k..{..z.Es
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 19
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00E3 (227)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AED (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000013 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  AB 85 F8 71 EB 6D AD 91                           ...q.m..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E2 (226)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED89 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0071 (113)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  80 41 7E 70 BA 04 00 2B 26 9B E1 01               .A~p...+&...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 20
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00E5 (229)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AEB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000014 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D7 FC D7 75 CC 0A 36 C0                           ...u..6.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E4 (228)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30C0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED88 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0072 (114)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  18 49 81 0E 95 04 AC 7D 92 B7 DC 8A               .I.....}....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 21
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00E7 (231)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AE9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000015 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BE 05 29 C3 47 B0 8F E0                           ..).G...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E6 (230)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30BE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED87 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0073 (115)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  91 E1 F2 E7 25 8E 0A 8B 3A 0E 94 31               ....%...:..1
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 22
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00E9 (233)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AE7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000016 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  86 DF 43 55 3D F2 1E 6C                           ..CU=..l
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00E8 (232)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30BC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED86 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0074 (116)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FA 9C C3 14 47 91 E2 77 20 99 50 C0               ....G..w .P.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 23
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00EB (235)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AE5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000017 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  36 DE A9 E1 91 47 23 A4                           6....G#.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00EA (234)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30BA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED85 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0075 (117)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E1 28 2F E1 C5 7D BE 41 B2 40 7E 5D               .(/..}.A.@~]
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 24
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00ED (237)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AE3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000018 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  48 C9 B7 A1 F6 42 1D 77                           H....B.w
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00EC (236)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED84 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0076 (118)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  40 44 9B 9B 39 2F 58 EF 27 91 25 06               @D..9/X.'.%.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 25
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00EF (239)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AE1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000019 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  05 56 0C 7F F6 F7 3C C7                           .V....<.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00EE (238)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED83 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0077 (119)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  86 FC 26 52 2B 58 B9 1F A6 FD BC B7               ..&R+X......
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 26
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00F1 (241)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3ADF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B2 51 44 B7 C5 9B AD E9                           .QD.....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F0 (240)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED82 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0078 (120)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C3 EE CD 95 1A 48 1F 35 18 69 B7 BA               .....H.5.i..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 27
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00F3 (243)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3ADD (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  E4 4C 80 47 83 3F 7C 17                           .L.G.?|.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F2 (242)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED81 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0079 (121)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5F 99 3D B7 75 33 C2 62 A8 6F F8 F5               _.=.u3.b.o..
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 28
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00F5 (245)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3ADB (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001C 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  81 0F 18 4B 0F 57 60 4A                           ...K.W`J
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F4 (244)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30B0 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED80 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007A (122)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  1C 36 BD FD 1F 2F CC 5A AD A2 D7 53               .6.../.Z...S
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 29
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00F7 (247)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AD9 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001D 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  1D FF 84 24 F5 B7 2B 3E                           ...$..+>
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F6 (246)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30AE (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007B (123)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F1 0A 5A 2D 2F 41 E0 5C BB 9D 87 61               ..Z-/A.\...a
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 30
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00F9 (249)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AD7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001E 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  15 66 3F 6D 5B 41 03 50                           .f?m[A.P
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00F8 (248)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30AC (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007C (124)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  81 71 54 E9 C5 20 24 D5 54 D6 18 B8               .qT.. $.T...
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)
Sending encrypted ICMP Echo-Request with Sequence Number: 31
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00FB (251)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AD5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000001F 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DD D0 03 BD FC 1C 1D 97                           ........
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FA (250)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30AA (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007D (125)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A5 A9 D5 E4 C0 27 9F 64 92 69 23 18               .....'.d.i#.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly no IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-7.3: Passed

>> IPSEC-ESP-7.4
TEST_DESCRIPTION
IPSec MUST NOT update *right* edge of replay window if the ICV
verification on a received IP datagram fails, while using ESP
Authentication.
TEST_REFERENCE
NEGATIVE: RFC 4303 s3.4.3 p29 Sequence Number Verification
TEST_METHOD
- ANVL: Reset the SA with anti-replay service between ANVL and DUT
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host
        containing the value 1 in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host
        containing the value (<window-size> + 2) in the Sequence
        Number field of the ESP header and with incorrect ICV in the
        AuthData field in ESP header
-  DUT: Do not forward the corresponding ICMP Echo Request to
        Local Host
- ANVL: Send ESP-secured ICMP Echo Request from Remote Host
        containing the value 2 in the Sequence Number field of the
        ESP Header
-  DUT: Forward the corresponding ICMP Echo Request to Local Host
- ANVL: Restore the default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1499  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1500  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1501  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1502  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1503  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1097] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1098] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1096] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1099] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 32

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-sa-with-anti-replay-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP Echo-Request with Sequence Number: 1
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00FD (253)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AD3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  84 F3 B4 35 EA E8 4C 4B                           ...5..LK
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FC (252)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007E (126)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A6 6F C2 FB C4 DB 26 43 D4 99 DF C9               .o....&C....
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FC (252)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A8 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007E (126)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending encrypted ICMP Echo-Request with Sequence Number: 34
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x00FF (255)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3AD1 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000022 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  38 1B 11 A4 CD 78 7B 4C                           8....x{L
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x00FE (254)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x007F (127)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  00 39 C5 27 F0 D3 F1 5A B1 59 20 C7               .9.'...Z.Y .
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending encrypted ICMP Echo-Request with Sequence Number: 2
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0101 (257)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3ACF (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  20 A1 0B 38 87 8E 1B 3C                            ..8...<
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0100 (256)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0080 (128)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  15 82 2F 64 A9 BD B5 F6 F1 8C 3F E0               ../d......?.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0100 (256)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A4 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED7A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0080 (128)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

DUT has correctly forwarded the corresponding ICMP Echo-Request
on interface eth4(40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-7.4: Passed

>> IPSEC-ESP-8.1
TEST_DESCRIPTION
IPSec MUST set the value 50 (ESP) in the Protocol field of IP-Header
in an ESP-secured IPv4 datagram.
TEST_REFERENCE
RFC 4303 s2 p5 Encapsulating Security Payload Packet Format
TEST_METHOD
- ANVL: Send a ICMP Echo Request using IPv4 from Local Host
-  DUT: Forward the ESP-secured ICMP Echo Request to Remote Host
        containing the value 50 (ESP) in the Protocol field of the
        outer IP-Header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1504  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1505  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1506  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1507  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1508  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1101] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1102] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1100] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1103] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0102 (258)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED79 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0081 (129)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x2867 (10343)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x1469 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  00 6B B8 FC 8F 72 1B 36                           .k...r.6
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0102 (258)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A2 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED79 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0081 (129)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  01 33 BD 56 9E 8A 70 7D 97 24 5B 4C               .3.V..p}.$[L
ESP: --- Authentication Data End ---
ESP:

Correctly received protocol in outer IP: 50
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.1: Passed

>> IPSEC-ESP-8.2
TEST_DESCRIPTION
IPSec MUST set the SPI field in ESP Header to a value greater than 255.
TEST_REFERENCE
RFC 4303 s2.1 p11 Security Parameters Index
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host
-  DUT: Forward ESP-secured IPv4 ICMP Echo Request to Remote Host
        with SPI field in ESP Header set to value greater
        than 255
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1509  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1510  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1511  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1512  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1513  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1105] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1106] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1104] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1107] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0103 (259)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED78 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0082 (130)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x05D6 (1494)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x36FA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  52 5E 6C FB 93 9F 45 1D                           R^l...E.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0103 (259)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A1 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED78 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0082 (130)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  60 7F 2C 6F 17 E8 0F 53 E1 FF E8 30               `.,o...S...0
ESP: --- Authentication Data End ---
ESP:

Correctly received ESP spi value: 770
received on interface
 eth3 (30.1.1.150)  (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.2: Passed

>> IPSEC-ESP-8.3
TEST_DESCRIPTION
IPSec MUST set the SPI field in ESP Header in an encrypted outbound IP
datagram using the SPI value associated with the outbound SA
TEST_REFERENCE
RFC 4303 s2.1 p10 Security Parameters Index
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host
-  DUT: Forward ESP-secured IPv4 ICMP Echo Request to Remote Host
        with SPI field in ESP Header set to value associated
        with the outbound SA
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1514  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1515  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1516  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1517  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1518  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1109] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1110] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1108] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1111] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0104 (260)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED77 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0083 (131)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x1634 (5684)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x269C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  3B 2E C0 57 32 67 12 98                           ;..W2g..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0104 (260)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED77 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0083 (131)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  92 98 7D 47 F9 77 80 C3 88 43 BD C8               ..}G.w...C..
ESP: --- Authentication Data End ---
ESP:

Correctly received ESP spi value: 770
received on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.3: Passed

>> IPSEC-ESP-8.5
TEST_DESCRIPTION
IPSec MUST set the Pad Length and Next Header in ESP Trailer such that
they are right aligned within 8-byte word, while using non-NULL
Encryption Algo.
TEST_REFERENCE
RFC 4303 s2.4 p15 Padding
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host with
        <n> bytes of ULP Information
-  DUT: Forward the ESP-secured IPv4 ICMP Echo Request to Remote Host
        with Padding field in ESP Trailer set such that Pad-Length
        and Next-Header fields are right-aligned within a 8-byte word
- CASE: <n> = 10 (needs 8n bytes Padding, n>=0)
- CASE: <n> =  9 (needs (8n+1) bytes Padding, n>=0)
- CASE: <n> =  8 (needs (8n+2) bytes Padding, n>=0)
- CASE: <n> =  7 (needs (8n+3) bytes Padding, n>=0)
- CASE: <n> =  6 (needs (8n+4) bytes Padding, n>=0)
- CASE: <n> =  5 (needs (8n+5) bytes Padding, n>=0)
- CASE: <n> =  4 (needs (8n+6) bytes Padding, n>=0)
- CASE: <n> =  3 (needs (8n+7) bytes Padding, n>=0)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1519  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1520  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1521  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1522  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1523  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1113] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1114] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1112] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1115] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send ICMP Echo Request with 10 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 38 bytes
IP: Identification         = 0x0105 (261)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA619 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0084 (132)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [8 bytes] ---
ETHER:  00 00 00 00 00 00 00 00                           ........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xD430 (54320)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x68A7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  5D 2D 8A BC AB A2 B1 B9                           ]-......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 38 bytes
IP: Identification         = 0x0105 (261)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA619 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0084 (132)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9F 06 27 35 70 37 B3 E6 64 C2 C5 65               ..'5p7..d..e
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
0 (8x0 + 0) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 9 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 37 bytes
IP: Identification         = 0x0106 (262)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA638 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0085 (133)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [9 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [9 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00                        .........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x18A9 (6313)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x242F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  67 FA C7 8C 19 D3 8F 76                           g......v
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 37 bytes
IP: Identification         = 0x0106 (262)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA638 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0085 (133)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [9 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [1 bytes] ---
ESP:  01                                                .
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 1 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  51 5A 61 52 F8 97 7D 52 6C E9 CD 21               QZaR..}Rl..!
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
1 (8x0 + 1) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 8 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x0107 (263)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA37 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0086 (134)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [8 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x5FC3 (24515)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xDD14 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  93 BE 23 E8 A2 38 8C A0                           ..#..8..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x0107 (263)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA37 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0086 (134)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [8 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0B 05 39 87 A7 F8 D7 31 20 10 73 96               ..9....1 .s.
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
2 (8x0 + 2) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 7 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 35 bytes
IP: Identification         = 0x0108 (264)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA89 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0087 (135)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [7 bytes] ---
ICMP:  41 4E 56 4C 20 54 45                              ANVL TE
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [11 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00                  ...........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x4144 (16708)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xFB93 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  EE 5F EC CD E5 0A 54 0D                           ._....T.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 35 bytes
IP: Identification         = 0x0108 (264)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA89 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0087 (135)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [7 bytes] ---
ICMP:  41 4E 56 4C 20 54 45                              ANVL TE
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  79 20 14 E4 82 18 26 9B 08 B2 9A 31               y ....&....1
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
3 (8x0 + 3) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 6 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 34 bytes
IP: Identification         = 0x0109 (265)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3F89 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0088 (136)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [6 bytes] ---
ICMP:  41 4E 56 4C 20 54                                 ANVL T
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [12 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00               ............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xD0E3 (53475)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x6BF4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  4F 6E F3 F4 04 9A E1 A4                           On......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 34 bytes
IP: Identification         = 0x0109 (265)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3F89 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0088 (136)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [6 bytes] ---
ICMP:  41 4E 56 4C 20 54                                 ANVL T
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [4 bytes] ---
ESP:  01 02 03 04                                       ....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 4 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2F 2A 78 53 AD 1F 2F E3 48 37 FD AE               /*xS../.H7..
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
4 (8x0 + 4) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 5 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 33 bytes
IP: Identification         = 0x010A (266)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3FDC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0089 (137)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [5 bytes] ---
ICMP:  41 4E 56 4C 20                                    ANVL 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [13 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00            .............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xB542 (46402)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x8795 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  8B C6 56 04 65 47 B7 4C                           ..V.eG.L
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 33 bytes
IP: Identification         = 0x010A (266)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3FDC (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0089 (137)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [5 bytes] ---
ICMP:  41 4E 56 4C 20                                    ANVL 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [5 bytes] ---
ESP:  01 02 03 04 05                                    .....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 5 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8B 91 02 09 E9 BC C3 7D 45 57 5B 79               .......}EW[y
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
5 (8x0 + 5) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 4 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x010B (267)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x5FDB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008A (138)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [4 bytes] ---
ICMP:  41 4E 56 4C                                       ANVL
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xC04A (49226)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x7C8D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  80 BF 80 9F 99 D7 93 77                           .......w
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x010B (267)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x5FDB (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008A (138)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [4 bytes] ---
ICMP:  41 4E 56 4C                                       ANVL
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  41 23 DD 3B C5 B5 73 87 44 2E 31 65               A#.;..s.D.1e
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
6 (8x0 + 6) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 3 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 31 bytes
IP: Identification         = 0x010C (268)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x30A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6026 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008B (139)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [3 bytes] ---
ICMP:  41 4E 56                                          ANV
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [15 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00      ...............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xE441 (58433)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x5896 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  5D B1 23 E0 86 43 70 AC                           ].#..Cp.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 31 bytes
IP: Identification         = 0x010C (268)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x31A5 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6026 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008B (139)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [3 bytes] ---
ICMP:  41 4E 56                                          ANV
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [7 bytes] ---
ESP:  01 02 03 04 05 06 07                              .......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 7 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CE 2B 36 9A C3 62 19 E1 EF 3E C0 41               .+6..b...>.A
ESP: --- Authentication Data End ---
ESP:

Correct Pad Length field in ESP Trailer:
7 (8x0 + 7) in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.5: Passed

>> IPSEC-ESP-8.7
TEST_DESCRIPTION
IPSec MUST set Padding in ESP Trailer, with sequence of monotonically
increasing integers starting from 1, while using non-NULL Encryption
Algo.
TEST_REFERENCE
RFC 4303 s2.4 p15 Padding; RFC 2405 s3.1 p3 ESP Payload
TEST_METHOD
- ANVL: Send an ICMP Echo Request from Local Host with <n> bytes of
        ULP Information
-  DUT: Forward the corresponding ESP-secured IPv4 ICMP Echo Request
        to Remote Host with Padding field in ESP trailer set such
        that the Padding field contains a sequence of monotonically
        increasing integers starting from 1
- CASE: <n> = 10 (needs 8n bytes Padding, n>=0)
- CASE: <n> =  9 (needs (8n+1) bytes Padding, n>=0)
- CASE: <n> =  8 (needs (8n+2) bytes Padding, n>=0)
- CASE: <n> =  7 (needs (8n+3) bytes Padding, n>=0)
- CASE: <n> =  6 (needs (8n+4) bytes Padding, n>=0)
- CASE: <n> =  5 (needs (8n+5) bytes Padding, n>=0)
- CASE: <n> =  4 (needs (8n+6) bytes Padding, n>=0)
- CASE: <n> =  3 (needs (8n+7) bytes Padding, n>=0)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1524  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1525  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1526  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1527  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1528  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1117] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1118] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1116] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1119] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send ICMP Echo Request with 10 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 38 bytes
IP: Identification         = 0x010D (269)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA611 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008C (140)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [8 bytes] ---
ETHER:  00 00 00 00 00 00 00 00                           ........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x8900 (35072)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xB3D7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A0 7D 5C 80 7F 6C AF 1C                           .}\..l..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 38 bytes
IP: Identification         = 0x010D (269)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA611 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008C (140)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [10 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20                     ANVL TEST 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP:
ESP: Pad Length               = 0 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  76 1F 83 2D 7E 33 1E E6 36 52 23 7E               v..-~3..6R#~
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:

is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 9 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 37 bytes
IP: Identification         = 0x010E (270)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA630 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008D (141)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [9 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [9 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00                        .........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xE30E (58126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x59C9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  14 70 10 7B 94 9A C9 78                           .p.{...x
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 37 bytes
IP: Identification         = 0x010E (270)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xA630 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008D (141)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [9 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54                        ANVL TEST
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [1 bytes] ---
ESP:  01                                                .
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 1 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  59 61 30 54 1A CD 6D 3C 5F 29 92 58               Ya0T..m<_).X
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01                                                .
is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 8 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x010F (271)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA2F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008E (142)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [8 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [10 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00                     ..........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xA404 (41988)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x98D3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  76 D3 CC 0E FE 70 37 DD                           v....p7.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 36 bytes
IP: Identification         = 0x010F (271)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA2F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008E (142)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [8 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53                           ANVL TES
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2E DD DF 50 CB 43 0B 72 A6 E7 D7 79               ...P.C.r...y
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02                                             ..
is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 7 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 35 bytes
IP: Identification         = 0x0110 (272)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA81 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008F (143)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [7 bytes] ---
ICMP:  41 4E 56 4C 20 54 45                              ANVL TE
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [11 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00                  ...........
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x740B (29707)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xC8CC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C7 E5 A1 35 45 6F BA 87                           ...5Eo..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 35 bytes
IP: Identification         = 0x0110 (272)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFA81 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x008F (143)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [7 bytes] ---
ICMP:  41 4E 56 4C 20 54 45                              ANVL TE
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [3 bytes] ---
ESP:  01 02 03                                          ...
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 3 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  67 F9 75 EF 17 A7 0A 98 48 77 BB 3B               g.u.....Hw.;
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03                                          ...
is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 6 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 34 bytes
IP: Identification         = 0x0111 (273)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3F81 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0090 (144)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [6 bytes] ---
ICMP:  41 4E 56 4C 20 54                                 ANVL T
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [12 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00               ............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xBD24 (48420)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x7FB3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C1 CE 2E C1 A9 75 64 1C                           .....ud.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 34 bytes
IP: Identification         = 0x0111 (273)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3F81 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0090 (144)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [6 bytes] ---
ICMP:  41 4E 56 4C 20 54                                 ANVL T
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [4 bytes] ---
ESP:  01 02 03 04                                       ....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 4 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B8 84 3B 3C 47 21 94 91 71 A9 22 CA               ..;<G!..q.".
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04                                       ....
is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 5 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 33 bytes
IP: Identification         = 0x0112 (274)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3FD4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0091 (145)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [5 bytes] ---
ICMP:  41 4E 56 4C 20                                    ANVL 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [13 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00            .............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0xEB75 (60277)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x5162 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  46 A1 6B 65 B0 2C 51 13                           F.ke.,Q.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 33 bytes
IP: Identification         = 0x0112 (274)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x3FD4 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0091 (145)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [5 bytes] ---
ICMP:  41 4E 56 4C 20                                    ANVL 
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [5 bytes] ---
ESP:  01 02 03 04 05                                    .....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 5 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  DF 92 3E B9 90 7C FA 3E 6C E7 48 A8               ..>..|.>l.H.
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04 05                                    .....
is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 4 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x0113 (275)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x5FD3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0092 (146)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [4 bytes] ---
ICMP:  41 4E 56 4C                                       ANVL
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [14 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00         ..............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x761C (30236)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xC6BB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  11 85 AB 1D DC CC 3B B8                           ......;.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 32 bytes
IP: Identification         = 0x0113 (275)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x5FD3 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0092 (146)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [4 bytes] ---
ICMP:  41 4E 56 4C                                       ANVL
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  27 BC D5 B1 18 28 B2 48 C6 F1 46 37               '....(.H..F7
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04 05 06                                 ......
is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)


Case: send ICMP Echo Request with 3 bytes of ULP Information
Sending Non-Encrypted ICMP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 31 bytes
IP: Identification         = 0x0114 (276)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x309D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x601E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0093 (147)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [3 bytes] ---
ICMP:  41 4E 56                                          ANV
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [15 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00      ...............
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 88 bytes
IP: Identification         = 0x39A1 (14753)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x0337 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  E0 67 2C 66 90 96 8E 06                           .g,f....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 31 bytes
IP: Identification         = 0x0114 (276)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x319D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x601E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0093 (147)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [3 bytes] ---
ICMP:  41 4E 56                                          ANV
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [7 bytes] ---
ESP:  01 02 03 04 05 06 07                              .......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 7 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CC 15 CF 8F EB D9 5E 0B 9C E0 E3 04               ......^.....
ESP: --- Authentication Data End ---
ESP:

Padding field in ESP Trailer:
01 02 03 04 05 06 07                              .......
is correct in the ESP packet received on interface
eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.7: Passed

>> IPSEC-ESP-8.8
TEST_DESCRIPTION
IPSec MUST set the Next Header field in ESP trailer, to one of the
IP-Protocol-Numbers defined in Assigned Numbers RFC.
TEST_REFERENCE
RFC 4303 s2.6 p16 Next Header
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host
-  DUT: Forward the corresponding ESP-secured IPv4 ICMP Echo Request
        to Remote Host with the Next-Header field in ESP Trailer
        set to IP (4)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1529  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1530  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1531  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1532  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1533  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1121] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1122] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1120] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1123] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0115 (277)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x308F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED66 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0094 (148)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xB060 (45152)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x8C6F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C1 10 A5 6D F3 77 87 A1                           ...m.w..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0115 (277)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x318F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED66 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0094 (148)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  EE 06 95 9C 7C F0 EF 9F F8 38 FB D4               ....|....8..
ESP: --- Authentication Data End ---
ESP:

Correctly received NextHeader Field: 4
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.8: Passed

>> IPSEC-ESP-8.9
TEST_DESCRIPTION
IPSec MUST indicate the correct type of payload in the Next Header
field of the ESP Trailerin an encrypted outbound IP datagram
TEST_REFERENCE
RFC 4303 s2.6 p16 Next Header
TEST_METHOD
- ANVL: Send an IPv4 datagram containing a payload of type <plt>
        from Local Host
-  DUT: Forward the corresponding ESP-secured IPv4 ICMP Echo Request
        to Remote Host with the Next-Header field in ESP Trailerto the
        value IP and the Protocol field in inner IP header to <plt>
- CASE: <plt> = ICMP
- CASE: <plt> = TCP
- CASE: <plt> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1534  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1535  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1536  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1537  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1538  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1125] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1126] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1124] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1127] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: send the ICMP packet
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0116 (278)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x308E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED65 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0095 (149)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x55C2 (21954)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xE70D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  3E B6 E0 86 C3 66 5D 3A                           >....f]:
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0116 (278)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x318E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED65 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0095 (149)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BC EB 7F DC 8B 9E 59 FF E1 FC 61 37               ......Y...a7
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IP Protocol: 1
on intefcace eth3 (30.1.1.150)
(Remote Host)


Case: send the TCP packet
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0117 (279)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x308C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x8089 (32905)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xBC46 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  85 A3 DD 75 AA 91 BE 6D                           ...u...m
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0117 (279)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x318C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  36 42 F0 EF 59 63 EE 6E A1 64 CB 1C               6B..Yc.n.d..
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IP Protocol: 6
on intefcace eth3 (30.1.1.150)
(Remote Host)


Case: send the UDP packet
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0118 (280)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x308C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x348A (13450)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x0856 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  ED F4 C4 23 98 2A 83 6D                           ...#.*.m
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0118 (280)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x318C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  FF 03 D1 1E 0F 35 7F 2B AE 05 39 23               .....5.+..9#
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IP Protocol: 17
on intefcace eth3 (30.1.1.150)
(Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.9: Passed

>> IPSEC-ESP-8.10
TEST_DESCRIPTION
IPSec MUST set the AuthData field in ESP Header, to a 96 bits ICV.
TEST_REFERENCE
RFC 2403 s2.7 p2 Algorithm and Mode
RFC 2404 s2.7 p2 Algorithm and Mode
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host
-  DUT: Forward the corresponding IPv4 ICMP Echo Request to Remote Host
        containing 96 bits of ICV in the AuthData field in ESP Header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1539  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1540  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1541  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1542  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1543  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1129] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1130] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1128] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1131] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0119 (281)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x308B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED64 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0096 (150)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x378B (14219)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x0545 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  FE 82 11 A8 6A E7 B2 69                           ....j..i
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0119 (281)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x318B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED64 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0096 (150)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  36 4F 46 B5 8E 7B AA B3 77 5D C1 B1               6OF..{..w]..
ESP: --- Authentication Data End ---
ESP:

Correctly received  Auth Data Length: 12
on interface eth3 (30.1.1.150)
(Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.10: Passed

>> IPSEC-ESP-8.11
TEST_DESCRIPTION
IPSec MUST do fragmentation AFTER ESP-processing while processing
a packet.
TEST_REFERENCE
RFC 4303 s3.3.4 p26 Fragmentation
TEST_METHOD
- ANVL: Send a ICMP Echo Request with data equal to
        <MTU-size>-30 bytes with MF bit on down interface A2
-  DUT: Add the ESP header and outer IP packet in the original packet
        in tunnel mode and it will be more than that of <MTU-Size>.
        Fragment the ICMP Echo Request into two parts and send the two
        parts down interface A2 to ANVL.
- ANVL: Verify Only the first part will contain ESP Header after
        IP-Header and will have MF bit set on and offset set to zero.
        The second part will not have any ESP Header after the IP-Header
        and will have MF bit off and Offset set to nonzero value
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1544  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1545  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1546  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1547  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1548  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1133] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1134] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1132] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1135] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted IP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1498 bytes
IP: Identification         = 0x011A (282)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2ADC (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x1587 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0097 (151)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [1470 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01         ..............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Encrypted  IP Packet
Received Encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1500 bytes
IP: Identification         = 0x6C76 (27766)
IP: Flags                  = 1
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..1                  = More Fragments
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xAADD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: --- Bad Encrypted Payload Data [1460 bytes] ---
ESP:  1E B5 20 58 0A 01 A5 88 91 61 77 7A BD 3C D1 AD   .. X.....awz.<..
ESP:  BB 55 21 CB 4B 88 D8 4C D5 98 2E 72 F6 F8 BE 04   .U!.K..L...r....
ESP:  99 AF C9 B0 E0 7A B7 22 9C D0 85 3E C0 D9 2C 04   .....z."...>..,.
ESP:  A2 EB D5 8B 56 AF 06 9B EC 9F 7B AF DB 96 72 D3   ....V.....{...r.
ESP:  8A 10 DB AB 54 17 66 56 3B 4D 8E 68 5D 9F 04 7C   ....T.fV;M.h]..|
ESP:  5F 5E 1F EB A6 AC 22 24 0D 66 D0 40 2E 93 45 28   _^...."$.f.@..E(
ESP:  05 20 ED 0F BE FC CD D4 34 30 90 38 4D 42 58 A2   . ......40.8MBX.
ESP:  3D D7 FD 33 7B 3F 07 D9 4C 13 2B A7 8C 15 32 CC   =..3{?..L.+...2.
ESP:  4D 1F 9B 86 CF 01 FA CF F1 1E F7 6A AB 6F 21 E2   M..........j.o!.
ESP:  A5 DE C3 5A FE 19 E8 61 6F 07 80 EC 5D 6A 7E 86   ...Z...ao...]j~.
ESP:  18 EB FC 85 90 56 7D DB FD A8 0F 0C 32 07 A0 7D   .....V}.....2..}
ESP:  28 CB EF 95 32 18 86 2F 68 BD A1 C8 28 4A E1 28   (...2../h...(J.(
ESP:  E3 79 7A 04 32 57 CE 75 45 4C 8C D8 6A 69 09 57   .yz.2W.uEL..ji.W
ESP:  F7 91 B8 25 66 31 03 20 C9 5D A8 B8 83 A5 4B 06   ...%f1. .]....K.
ESP:  31 D9 C0 3C 78 B5 8E 17 E5 79 4B AE 3F DF 2A B6   1..<x....yK.?.*.
ESP:  D9 12 B3 19 58 84 74 BC B1 F9 02 29 74 6B C5 BF   ....X.t....)tk..
ESP:  54 E1 25 2D 0D 83 03 05 09 00 DA 9D 4E 64 C6 51   T.%-........Nd.Q
ESP:  4C B6 9B A1 B0 8B CD 95 25 92 FA C8 93 78 E7 EA   L.......%....x..
ESP:  B5 D2 20 2E A8 DC B2 9C 1F 87 83 7C 5B CB 0C D6   .. ........|[...
ESP:  03 49 3A EC A9 EE 01 11 08 37 AC 32 DD 4A 70 13   .I:......7.2.Jp.
ESP:  BD 59 4F A7 5A 6A 8D 4B 9B 4A 71 DA F1 5C A0 A4   .YO.Zj.K.Jq..\..
ESP:  98 2E 94 0A 0D B5 A7 4B 79 03 FF 01 2F 95 E8 CB   .......Ky.../...
ESP:  82 CE 94 6C 70 C4 AC 03 2C 4D 1B 73 CA 9B 6A 25   ...lp...,M.s..j%
ESP:  60 39 94 C9 A3 12 7C C5 8A 84 6F 10 AE AC 76 40   `9....|...o...v@
ESP:  FC 11 2E 06 EA 6A 51 79 5E 01 0C 78 EC AF EB 44   .....jQy^..x...D
ESP:  C3 45 E1 CE CB E4 CA B7 FE FB 17 8D 43 39 25 17   .E..........C9%.
ESP:  A4 C8 18 70 A8 30 36 DB CA 06 52 2B 8A 1F A1 12   ...p.06...R+....
ESP:  CD FF B9 B1 7F 23 0C D3 65 7E 70 59 63 74 13 08   .....#..e~pYct..
ESP:  15 7A 76 A7 9E CC BB 4B 3D B1 60 B6 EE 1E 53 D3   .zv....K=.`...S.
ESP:  93 9F 9F B7 F8 70 93 E8 96 DC 7A E5 60 5F F9 73   .....p....z.`_.s
ESP:  46 1B 10 3B D2 7B 3E 20 06 DC 0E 5C 37 B1 48 45   F..;.{> ...\7.HE
ESP:  3A 34 99 8E 98 22 82 A7 78 77 14 FF 80 7D 1E D7   :4..."..xw...}..
ESP:  2E 84 7E 15 7B DD 28 CB 74 C0 83 83 8E AA 16 78   ..~.{.(.t......x
ESP:  E8 B3 83 A8 D0 18 F8 6E 96 83 A4 16 17 08 A5 F2   .......n........
ESP:  83 EF 3D 75 B8 2A 39 2E 03 0F 89 C3 99 F6 83 E6   ..=u.*9.........
ESP:  FD BD C3 19 82 CB F9 3A 12 BA 1E C0 FD 9F 07 DA   .......:........
ESP:  00 30 08 C4 A6 49 BE E6 67 CE A5 DD 58 DE 00 40   .0...I..g...X..@
ESP:  64 2D 8C 05 FF 51 21 49 61 51 E7 76 C5 9C 05 C5   d-...Q!IaQ.v....
ESP:  BB 3D EB B8 56 79 F5 1B 6F 57 00 AA 26 02 05 58   .=..Vy..oW..&..X
ESP:  EF 50 8F FE D4 51 6A BF 48 53 B8 AD E1 95 1F B9   .P...Qj.HS......
ESP:  75 DB 3E AF F2 E3 D6 57 19 E0 24 EE 22 62 79 DD   u.>....W..$."by.
ESP:  18 8E 87 3B FB B3 BE 06 89 F7 C9 58 02 42 74 9A   ...;.......X.Bt.
ESP:  DA 1C 32 6A 00 F0 69 D4 B4 2A E0 D1 B5 C2 84 6A   ..2j..i..*.....j
ESP:  0C 51 E0 03 15 FB AA 95 1B 91 06 70 24 22 3F 09   .Q.........p$"?.
ESP:  93 1E 2B 88 75 79 3C 93 20 3F 15 E3 9D 2E CF FF   ..+.uy<. ?......
ESP:  81 07 FB 69 24 49 2C B7 54 FC 2C 44 82 8E 1B 3D   ...i$I,.T.,D...=
ESP:  29 5A C0 D6 87 8E 24 8A 9F 2C 98 92 11 DB 1D 40   )Z....$..,.....@
ESP:  2B 5C 7C BF 27 01 61 70 27 28 15 92 21 EA 30 D7   +\|.'.ap'(..!.0.
ESP:  AF 32 31 78 4E 6D FA EE 87 4F 21 DA 25 A1 69 44   .21xNm...O!.%.iD
ESP:  9A 65 03 12 E8 B9 5C 08 AE 0D 24 57 DD D0 57 7E   .e....\...$W..W~
ESP:  C4 1E 2F 6C A9 42 CC F0 66 76 80 1A FD 45 76 B1   ../l.B..fv...Ev.
ESP:  70 20 07 C2 50 30 A6 D2 2B 14 50 1E D7 65 1E C8   p ..P0..+.P..e..
ESP:  36 73 25 60 78 B5 84 E8 1E 2C F5 8E 2C 25 9D DC   6s%`x....,..,%..
ESP:  D6 7C 3F 25 4A CF F0 37 34 79 05 FE 3F E5 D3 42   .|?%J..74y..?..B
ESP:  1B 49 43 3C 89 18 C1 51 CF AD 8C 88 2A 83 12 22   .IC<...Q....*.."
ESP:  E8 12 E3 53 44 DF 5F 7D 65 29 98 A5 83 31 4D 44   ...SD._}e)...1MD
ESP:  14 2B D4 48 27 6B 67 F9 E1 63 71 2A C6 7A 90 A9   .+.H'kg..cq*.z..
ESP:  03 67 0C 8D FD DA B2 33 72 90 04 99 A9 D4 D5 1D   .g.....3r.......
ESP:  FD 11 4E 7B DE 95 FC DF 2D 66 84 CC 75 6E 8D C1   ..N{....-f..un..
ESP:  70 E6 1B 46 FD 4D 9F A4 C9 5E DB 97 9A 3D 59 01   p..F.M...^...=Y.
ESP:  D8 FE A9 A4 CB 6F FC D7 24 1B 98 21 7F 14 FD 37   .....o..$..!...7
ESP:  BC C0 D1 F8 8D 9D E2 96 9A F0 73 E4 57 00 03 01   ..........s.W...
ESP:  30 99 0B 31 FA 59 69 5C 83 F9 65 DC F0 51 7B 36   0..1.Yi\..e..Q{6
ESP:  10 67 9B A5 CF 26 F9 A4 7A 05 F1 AE 75 F5 79 7D   .g...&..z...u.y}
ESP:  26 9F ED EA C0 1C D5 67 61 EA 03 97 DE FC 8E 6E   &......ga......n
ESP:  3B 26 5C AC 85 2D AA A8 D2 9D AF 1F 1B 18 A9 5D   ;&\..-.........]
ESP:  30 B3 A3 28 67 86 A3 56 7D DF 52 1F 51 F1 7F 5C   0..(g..V}.R.Q..\
ESP:  C7 5D 5B 45 40 04 3F 3F DF DF B5 DC DA 96 77 96   .][E@.??......w.
ESP:  39 39 1E B7 F1 B8 88 BE A8 EF B8 59 43 FA 84 A1   99.........YC...
ESP:  C6 14 43 D3 08 01 04 BE 97 5A 70 0A 06 B6 89 35   ..C......Zp....5
ESP:  CB 5F 73 8A 97 22 B5 D9 A3 13 B9 B6 19 F2 1F CF   ._s.."..........
ESP:  2A 94 C1 C4 78 CE B0 A9 1C 82 D1 94 89 D8 9C 53   *...x..........S
ESP:  83 BF 16 51 34 7F D0 FA D2 12 2D 1D 4F DF 78 5C   ...Q4.....-.O.x\
ESP:  ED 2F A4 37 59 CE 73 2A 2C 10 84 20 A5 CF E6 C6   ./.7Y.s*,.. ....
ESP:  BE 3E D6 8F D7 F7 21 98 57 6B BF 94 95 91 BB EA   .>....!.Wk......
ESP:  53 DE 79 5A D7 D9 54 F7 CE B9 76 03 62 E0 72 8E   S.yZ..T...v.b.r.
ESP:  72 3B 01 B6 A2 AE 61 13 6B CB 59 C8 C1 54 0D F4   r;....a.k.Y..T..
ESP:  D5 1C 84 4D 46 D1 CC 50 A5 D5 51 C9 D9 07 26 24   ...MF..P..Q...&$
ESP:  42 4D BC C2 17 24 F0 1F 04 2A E5 3A AE F5 61 61   BM...$...*.:..aa
ESP:  F4 D0 7C D0 DA 8F F2 2E E9 B6 14 15 3B CC 6F D0   ..|.........;.o.
ESP:  41 C2 54 E9 A7 FD A1 B7 89 EF 36 2A 2A 9D D0 FC   A.T.......6**...
ESP:  BF FB 95 95 B3 E9 46 D9 DE 45 B0 6C 3B 7E B8 B9   ......F..E.l;~..
ESP:  58 DB 99 E3 30 A2 94 44 DB 1A 43 02 5F 2C 50 4C   X...0..D..C._,PL
ESP:  0A 08 7D 87 D0 06 30 A0 E9 34 4D 4B FB 7A 38 57   ..}...0..4MK.z8W
ESP:  3A B7 EA 8B FE 97 72 A2 4B E0 8E C8 37 60 9D CD   :.....r.K...7`..
ESP:  49 A1 96 0B A0 4E 02 C2 92 EA 58 1B 40 EE 6B 88   I....N....X.@.k.
ESP:  39 99 96 9C 3D 98 1F CF 23 2F 31 67 C9 00 8B 28   9...=...#/1g...(
ESP:  48 3F BD 91 31 73 47 02 54 88 65 C5 AA 49 34 22   H?..1sG.T.e..I4"
ESP:  FF 3D 0C 48 27 7A 6A B8 8C 33 95 EB 59 7D 23 43   .=.H'zj..3..Y}#C
ESP:  5B 21 61 CF 23 BA 71 70 40 15 6F 71 B4 F9 15 53   [!a.#.qp@.oq...S
ESP:  0B C4 76 81 FC 9F 4C 80 17 41 41 15 75 89 FA 30   ..v...L..AA.u..0
ESP:  75 CC B7 F2                                       u...
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BB 8B 41 D0 89 95 47 6C 02 F0 A0 4A               ..A...Gl...J
ESP: --- Authentication Data End ---
ESP:

Received Encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x6C76 (27766)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x00B9 (1480 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xCFB8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x634A723A 
ESP: Sequence Number          = 0xD2F3E60E 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A6 99 3A B5 AF DF 0B 42                           ..:....B
ESP: --- Initialization Vector End ---
ESP:
ESP: --- Payload Data [18 bytes] ---
ESP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ESP:  01 01                                             ..
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [4 bytes] ---
ESP:  01 02 03 04                                       ....
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 4 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CB 24 4D 72 FD 25 22 47 ED C8 13 25               .$Mr.%"G...%
ESP: --- Authentication Data End ---
ESP:

Received expected 2 Fragmented packets on interface
eth3 (30.1.1.150) (Remote Host)

Correctly, the MF-bit in the first IP packet set to 1

Correctly, the First IP fragmented packet contains ESP header

The Fragment offset in the first packet is correctly set to zero

Correctly, the MF-bit in the second IP packet set to 0

Correctly, the 2nd IP fragmented packet does not contain ESP header

The Fragment offset in the 2nd packet is correctly set to non-zero value 0x0B9


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-8.11: Passed

>> IPSEC-ESP-9.1
TEST_DESCRIPTION
When anti-replay is enabled IPSec MUST set the Sequence Number field in 
ESP Header to monotonically increasing values in two consecutive packets.
TEST_REFERENCE
RFC 4303 s2.2 p12 Sequence Number
TEST_METHOD
- ANVL: Send an ICMP Echo Request from Local Host
-  DUT: Forward the corresponding ESP-secured ICMP Echo Request to
        Remote Host containing some value <v1> in the Sequence-Number
        field of ESP Header
- ANVL: Note the value <v1> and send next IPv4 ICMP Echo Request from
        Local Host
-  DUT: Forward the corresponding ESP-secured IPv4 ICMP Echo Request
        to Remote Host containing value greater than <v1>
        in the Sequence-Number field of ESP header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1549  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1550  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1551  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1552  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1553  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1137] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1138] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1136] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1139] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011B (283)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3089 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED62 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0098 (152)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xDF84 (57220)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x5D4B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C5 37 F7 57 34 A0 49 72                           .7.W4.Ir
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011B (283)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3189 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED62 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0098 (152)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8C CC 67 BD 5E 8F 98 25 85 20 45 A2               ..g.^..%. E.
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011C (284)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3088 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED61 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0099 (153)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xCAC3 (51907)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x720C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F9 09 E9 9A A3 46 7F 95                           .....F..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011C (284)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3188 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED61 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0099 (153)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  50 37 D0 6F 73 89 DE 2D 41 F6 C8 96               P7.os..-A...
ESP: --- Authentication Data End ---
ESP:

Correctly received sequence number in ESP Packet: 2
on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-9.1: Passed

>> IPSEC-ESP-9.2
TEST_DESCRIPTION
IPSec MUST set the Sequence-Number field to 1 in the first packet
sent by it using a new SA.
TEST_REFERENCE
RFC 4303 s2.2 p12 Sequence Number
TEST_METHOD
- ANVL: Reset the SA between ANVL and the DUT
- ANVL: Send an IPv4 ICMP Echo Request from Local Host
-  DUT: Forward the corresponding ESP-secure IPv4 ICMP Echo Request
        to Remote Host containing the value 1 in the 
        Sequence-Number field in ESP header
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1554  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1555  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1556  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1557  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1558  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1141] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1142] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1140] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1143] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011D (285)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3087 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED60 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009A (154)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x9E7B (40571)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x9E54 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  51 4F 98 C9 D4 5B 9B CB                           QO...[..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011D (285)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3187 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED60 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009A (154)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  46 DA 2B 5B A5 80 A7 E2 E2 B9 4E A4               F.+[......N.
ESP: --- Authentication Data End ---
ESP:

Correctly received ESP sequence number: 1
on interface eth3 (30.1.1.150)
(Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-9.2: Passed

>> IPSEC-ESP-9.3
TEST_DESCRIPTION
IPSec MUST NOT duplicate the Sequence Number field in the ESP Header
of an outbound IP datagram during the Lifetime of the SA.
TEST_REFERENCE
RFC 4303 s2.2 p12 Sequence Number Verification
TEST_METHOD
- ANVL: Set SA between ANVL and the DUT with Lifetime
        <LifeTimeSeconds> seconds
- ANVL: Send at most 10 ICMP Echo-requests from Local Host
        within the Lifetime of the SA
-  DUT: Forward the corresponding ESP-secured ICMP Echo Requests to
        Remote Host without duplicating the Sequence Number in the
        ESP Header of any response
- ANVL: Restore default SA between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1559  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1560  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1561  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1562  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1563  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1145] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1146] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1144] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1147] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 120

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=168  seq=1564  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=29856 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=168  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=29856 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1565  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 1024 -lh 120
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=1566  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=120 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1567  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=29857 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011E (286)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3086 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009B (155)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x6E49 (28233)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xCE86 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  E7 B8 DA D2 A5 11 62 20                           ......b 
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011E (286)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3186 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009B (155)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7E DB B0 35 51 06 81 FA 07 9B 48 41               ~..5Q.....HA
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011F (287)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3085 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009C (156)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x1AA2 (6818)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x222E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  D9 62 F0 B2 4D CE 21 0B                           .b..M.!.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x011F (287)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3185 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009C (156)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6B 5C 88 AD A4 F9 62 77 88 20 9C 18               k\....bw. ..
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0120 (288)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3084 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009D (157)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xABEE (44014)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x90E1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B1 67 64 4E 67 99 B5 81                           .gdNg...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0120 (288)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3184 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009D (157)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E4 D9 CB F2 95 B0 52 44 42 4A 56 10               ......RDBJV.
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0121 (289)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3083 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009E (158)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x8368 (33640)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xB967 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  FE DE 3A 65 6D 4B 7F 8F                           ..:emK..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0121 (289)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3183 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009E (158)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  F1 48 85 95 D1 A1 8A C1 5A D9 05 DB               .H......Z...
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0122 (290)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3082 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009F (159)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x8BF6 (35830)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xB0D9 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  12 56 F7 B1 69 7F F6 9E                           .V..i...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0122 (290)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3182 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x009F (159)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  94 10 1C 6A 2F 65 7E C1 33 11 4F 5B               ...j/e~.3.O[
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0123 (291)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3081 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A0 (160)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0B9F (2975)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3131 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  9A 46 E3 FD B4 5B E2 6D                           .F...[.m
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0123 (291)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3181 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED5A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A0 (160)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  32 25 35 91 96 64 B3 38 1A E3 90 6E               2%5..d.8...n
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0124 (292)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3080 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED59 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A1 (161)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x2638 (9784)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x1698 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  BA 8D 71 3D B3 43 55 D8                           ..q=.CU.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0124 (292)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3180 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED59 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A1 (161)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  00 83 FC D2 3C 35 49 2A 6C 2C 56 BF               ....<5I*l,V.
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0125 (293)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED58 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A2 (162)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xA1DC (41436)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x9AF3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  31 C6 85 D4 4D AE F0 50                           1...M..P
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0125 (293)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED58 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A2 (162)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  38 30 E5 99 67 32 AB 85 DF 29 CA FA               80..g2...)..
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0126 (294)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED57 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A3 (163)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x4B20 (19232)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xF1AF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  06 0D 46 4B AC 0E 4E 6A                           ..FK..Nj
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0126 (294)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED57 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A3 (163)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AD E7 B5 AE 47 ED F4 71 9A 42 9E 2D               ....G..q.B.-
ESP: --- Authentication Data End ---
ESP:

Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0127 (295)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED56 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A4 (164)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xE396 (58262)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x5939 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  99 00 89 03 40 79 08 4F                           ....@y.O
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0127 (295)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED56 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A4 (164)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  7B 56 26 9D 10 5F A5 E7 59 93 98 6C               {V&.._..Y..l
ESP: --- Authentication Data End ---
ESP:

DUT correctly forwarded Encrypted packets without duplicating
sequence number field in ESP
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1569  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1570  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1571  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1572  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1573  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1152] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1153] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1151] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1154] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-9.3: Passed

>> IPSEC-ESP-10.1
TEST_DESCRIPTION
IPSec MUST add 8 bytes of Initialization Vector at the start of the
Payload-Data in ESP Header.
TEST_REFERENCE
RFC 2405 s3 p2 ESP Payload
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host with <n>
        bytes of ULP Information
-  DUT: Forward the corresponding ESP-secured IPv4 ICMP Echo Request
        to Remote Host with Payload-Data field in ESP Header having
        length <n+8+20+8>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1574  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1575  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1576  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1577  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1578  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1156] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1157] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1155] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1158] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0128 (296)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED55 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A5 (165)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x5564 (21860)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xE76B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  14 DF D4 69 15 19 B7 75                           ...i...u
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0128 (296)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED55 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A5 (165)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  66 EC C2 31 8D BC A8 84 9D A1 68 F1               f..1......h.
ESP: --- Authentication Data End ---
ESP:

Correctly received payload data len in ESP Packet:52
on interface eth3 (30.1.1.150)
(Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-10.1: Passed

>> IPSEC-ESP-10.2
TEST_DESCRIPTION
IPSec MUST set IV field in ESP Header Payload Data to random value.
Consecutive packets MUST not have same IV.
TEST_REFERENCE
RFC 2405 s3 p2 ESP PAYLOAD
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host
-  DUT: Forward the corresponding IPv4 ICMP Echo Request to
        Remote Host
- ANVL: Note the value of IV (iv1) in ESP-secured ICMP Echo Request
        to Remote Host and send next IPv4 ICMP Echo Request
-  DUT: Forward the corresponding ESP-secured IPv4 ICMP Echo Request
        to Remote Host with a random IV different from iv1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1579  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1580  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1581  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1582  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1583  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1160] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1161] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1159] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1162] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0129 (297)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED54 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A6 (166)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xD9C5 (55749)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x630A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A8 A5 C2 03 BF 55 29 C4                           .....U).
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0129 (297)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED54 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A6 (166)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  5D 7F F5 EE DA 02 F9 25 D1 1C DE F5               ]......%....
ESP: --- Authentication Data End ---
ESP:

Received expected ESP Packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012A (298)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED53 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A7 (167)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xF097 (61591)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x4C38 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  E7 65 F6 15 EE 2B AE 9B                           .e...+..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012A (298)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x317A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED53 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A7 (167)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2F 90 73 04 F4 F4 30 AC AD E4 C3 8A               /.s...0.....
ESP: --- Authentication Data End ---
ESP:

! Incorrect initialization vector in ESP Packet:
! 00 00 00 00 00 00 00 00                           ........
! should be different:
! 00 00 00 00 00 00 00 00                           ........
! - received on interface eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-10.2: !FAILED!

>> IPSEC-ESP-10.3
TEST_DESCRIPTION
IPSec MUST set IV field in ESP Header Payload Data to random value.
Consecutive packets MUST NOT use a counter to generate IV.
TEST_REFERENCE
RFC 2405 s3 p2 ESP Payload
TEST_METHOD
- ANVL: Send 10 ICMP Echo Requests from Local Host
-  DUT: Forward the corresponding ESP-secured IPv4 ICMP Echo Requests
        to Remote Host, such that the I-th (1 <= I <= 10)
        forwarded Request contains <ivI> in the IV field of the
        ESP Payload
- ANVL: Check that (iv1, iv2, ... iv10) do not form an arithmetic
        sequence
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1584  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1585  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1586  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1587  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1588  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1164] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1165] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1163] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1166] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012B (299)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3079 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED52 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A8 (168)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x8939 (35129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xB396 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  5D 8E 92 AD 32 5A 5A F1                           ]...2ZZ.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012B (299)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3179 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED52 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A8 (168)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C2 2F 98 97 75 7F 67 C1 32 C5 FD 1C               ./..u.g.2...
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012C (300)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3078 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED51 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A9 (169)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xF5B0 (62896)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x471F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  42 2F 93 EB 7C 94 2D 34                           B/..|.-4
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012C (300)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3178 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED51 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00A9 (169)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  CC 7C F9 77 04 8F 78 CE C4 EC 1B 28               .|.w..x....(
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012D (301)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3077 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED50 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AA (170)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x2857 (10327)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x1479 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A2 08 67 14 8A 3C 71 D3                           ..g..<q.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012D (301)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3177 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED50 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AA (170)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  32 F6 D4 F6 AF 86 99 A8 09 43 8B 87               2........C..
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012E (302)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3076 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AB (171)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xDF75 (57205)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x5D5A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  CD F5 8D 23 09 A5 B5 91                           ...#....
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012E (302)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3176 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AB (171)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  76 87 3C FF 9D E5 D7 64 A5 66 8B 18               v.<....d.f..
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012F (303)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3075 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AC (172)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x77D9 (30681)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xC4F6 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  00 5D 24 09 4A 3D 9D B0                           .]$.J=..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x012F (303)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3175 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AC (172)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B5 12 21 40 FC DE 2F C6 F2 BC 21 F2               ..!@../...!.
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0130 (304)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3074 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AD (173)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x141C (5148)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x28B4 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  AE 64 F1 63 7C CB 1D 29                           .d.c|..)
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0130 (304)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3174 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AD (173)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  51 62 9D 0B E0 67 95 4F 1F C5 40 09               Qb...g.O..@.
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0131 (305)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3073 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AE (174)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xAC24 (44068)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x90AB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  7E 95 5C 43 5F 54 FB AD                           ~.\C_T..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0131 (305)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3173 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AE (174)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  90 A8 76 BE CA 20 92 47 45 2F 83 31               ..v.. .GE/.1
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0132 (306)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3072 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AF (175)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x3144 (12612)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x0B8C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  15 1A 46 22 73 3A 7A 11                           ..F"s:z.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0132 (306)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3172 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00AF (175)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  40 93 67 9A 12 23 A0 76 7A 84 80 7D               @.g..#.vz..}
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0133 (307)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3071 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B0 (176)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x3354 (13140)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x097C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DF E6 1A 62 82 6B F5 1D                           ...b.k..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0133 (307)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3171 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED4A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B0 (176)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B7 73 BB 8F 9A DB 03 87 01 F9 26 E8               .s........&.
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0134 (308)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3070 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED49 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B1 (177)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xBB13 (47891)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x81BC (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  81 9E AE 3C 57 3F 93 69                           ...<W?.i
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0134 (308)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3170 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED49 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B1 (177)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  6A 81 E0 7D 03 F0 B9 34 1B A5 79 15               j..}...4..y.
ESP: --- Authentication Data End ---
ESP:

Received expected ESP packet on interface
eth3 (30.1.1.150) (Remote Host)
Correctly received initialization vectors in ESP Packets
They did not form an arithmetic sequence.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-10.3: Passed

>> IPSEC-ESP-10.4
TEST_DESCRIPTION
Next Header field must be right aligned within a 4-byte word
TEST_REFERENCE
RFC 4303 s2.4 p14 Padding
TEST_METHOD
- ANVL: Send an ICMP Echo Request from local host to remote host
        through the DUT.
-  DUT: Forward the ESP-secured ICMP Echo Request to remote Host.
- ANVL: Verify that the begining of the next layer protocol is
        aligned with a multiple of 4 bytes to the ESP header.
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1589  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1590  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1591  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1592  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1593  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1168] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1169] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1167] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1170] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0135 (309)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x306F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED48 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B2 (178)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x2C54 (11348)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x107C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  AF BD 7A 31 1E FB DC 72                           ..z1...r
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0135 (309)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED48 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B2 (178)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A6 5D 2B 9A 3C 61 A2 0F 08 15 30 41               .]+.<a....0A
ESP: --- Authentication Data End ---
ESP:

Correctly, received packet contains the "Next Header"
field right aligned at the multiple of 4 bytes in the ESP header

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-10.4: Passed

>> IPSEC-ESP-11.1
TEST_DESCRIPTION
Reusing an nonce/key combination destroys the security guarantees of
AES-GCM mode, it can be difficult to use this mode securely when using
statically configured keys.  For safety's sake, implementations MUST
use an automated key management system, such as the Internet Key
Exchange (IKE) [RFC2409], to ensure that this requirement is met
TEST_REFERENCE
The size of the KEYMAT for the AES-GCM-ESP MUST be four octets longer
than is needed for the associated AES key
RFC4106 Section 2 Page 3 'AES-GCM'
RFC4106 Section 8.1 Page 6 'Keying Material and Salt Values'
TEST_METHOD
- ANVL: Initiate ISAKMP SA with DUT
-  DUT: Establish ISAKMP SA with ANVL
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1594  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1595  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1596  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1597  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1598  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1172] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1173] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1171] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1174] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 IPSec SA  established between 30.1.1.5 and 30.1.1.150


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-11.1: Passed

>> IPSEC-ESP-11.3
TEST_DESCRIPTION
The same nonce and key combination must not be used more than once
TEST_REFERENCE
RFC 4106 s2 page 3 'AES GCM'
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host  
-  DUT: Forward the ICMP Echo Request to Local Host
TEST_METHOD
- ANVL: Send an ESP-secured ICMP Echo Request from Remote Host using different nonce and key combination as above
-  DUT:Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1599  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1600  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1601  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1602  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1603  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1176] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1177] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1175] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1178] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
sending an ESP-secured ICMP Echo Request from Remote Host  
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0137 (311)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A99 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  81 B1 D8 F9 6E 77 AF DE                           ....nw..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0136 (310)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x306E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED47 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B3 (179)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  85 73 03 A2 1E C9 2D B1 AE 2E AF 44               .s....-....D
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0136 (310)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316E (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED47 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B3 (179)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected unsecured IP packet on interface
eth4 (40.1.1.150) (Local Host)
sending an ESP-secured ICMP Echo Request from Remote Host using different nonce and key combination 
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0139 (313)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A97 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000004 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  DB 8D E2 C9 63 5C CD 3D                           ....c\.=
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0138 (312)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x306C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED46 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B4 (180)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BA 9C A1 7E 53 92 17 DA A4 A8 F7 35               ...~S......5
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Received non-encrypted IP packet from 30.1.1.150 on interface eth4 (40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0138 (312)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x316C (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED46 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B4 (180)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received  unsecured IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-11.3: Passed

>> IPSEC-ESP-11.5
TEST_DESCRIPTION
The receiver checks the Next Header field.If the value is 59
(no next header), the (dummy) packet is discarded without further processing.
TEST_REFERENCE
RFC4303 Section 3.4.4.2 Page 32 'Combined Confidentiality and Integrity Algorithms'
TEST_METHOD
- ANVL: Send an ESP-Secured ICMP Echo Request from remote host to
        local host through the DUT having Next Layer Protocol field
        set to 59.
-  DUT: Discard the ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1604  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1605  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1606  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1607  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1608  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1180] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1181] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1179] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1182] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Next Header to 59 in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x013B (315)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A95 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000005 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  61 10 82 5B C1 26 5C 92                           a..[.&\.
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ESP: --- Payload Data [60 bytes] ---
ESP:  00 00 03 00 00 00 00 05 61 10 82 5B C1 26 5C 92   ........a..[.&\.
ESP:  45 00 00 2C 01 3A 00 00 40 01 30 6A 1E 01 01 96   E..,.:..@.0j....
ESP:  28 01 01 96 08 00 ED 45 00 B5 00 00 41 4E 56 4C   (......E....ANVL
ESP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 59 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  8D 4B 14 6A 76 7E 12 A1 E7 8B DE FC               .K.jv~......
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-11.5: Passed

>> IPSEC-ESP-11.8
TEST_DESCRIPTION
The ICV consists solely of the AES-GCM Authentication Tag. Implementations
MUST support a full-length 16-octet ICV, and MAY support 8 or 12 octet ICVs,
and MUST NOT support other ICV lengths.
TEST_REFERENCE
NEGATIVE - RFC4106 Section 6 Page 5 'Integrity Check Value (ICV)'
TEST_METHOD
- ANVL: Send an IPv4 ICMP Echo Request from Local Host
        with an ICV tag not matching the configured algorithm
-  DUT: Do not forward the ICMP Echo Request to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1609  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1610  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1611  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1612  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1613  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1184] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1185] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1183] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1186] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 95 bytes
IP: Identification         = 0x013D (317)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A94 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000006 
ESP:
ESP: --- Bad Encrypted Payload Data [55 bytes] ---
ESP:  F8 FC BA 8F 5D 15 2A 14 C4 45 58 64 B6 3D 7D 71   ....].*..EXd.=}q
ESP:  EC 5F 9B 13 EF D7 2C AD F9 9F A9 6F 24 7B D1 62   ._....,....o${.b
ESP:  1C 7E 6D 8D 86 0F 7B FF D3 22 DF 2D F7 57 21 0B   .~m...{..".-.W!.
ESP:  AF 47 1C B5 BE 14 DC                              .G.....
ESP: --- Bad Encrypted Payload Data End ---
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4E 96 AD 4C 6F DF D9 32 6C 5B 47 7D               N..Lo..2l[G}
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, no IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-11.8: Passed

>> IPSEC-ESP-24.1
TEST_DESCRIPTION
For inbound processing, for unicast SAs, the SPI is used either alone
to look up an SA or in conjunction with the IPsec protocol type.
IPSec MUST discard an incoming IP datagram containing a SPI and protocol
entry for which no corresponding entry exists in the SAD.
Note: This testcase is to test SPI based SA lookup only
TEST_REFERENCE
NEGATIVE: RFC 4301 s4.4.2 p35 Security Association Database
TEST_METHOD
- ANVL: Send secured IP packet from Remote Host with SPI
        not matching the SA configuration in DUT
-  DUT: Do not forward IP packet, to Local Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1614  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1615  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1616  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1617  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1618  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1188] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1189] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1187] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1190] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Sending packets having some BAD value for SPI

	 Set the SPI Value to 778 in ESP Header - Wrong SPI
	--------------------------------------------------------------
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x013F (319)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A91 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x0000030A 
ESP: Sequence Number          = 0x00000007 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  AF 47 1C B5 BE 14 DC 4E                           .G.....N
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ESP: --- Payload Data [60 bytes] ---
ESP:  00 00 03 0A 00 00 00 07 AF 47 1C B5 BE 14 DC 4E   .........G.....N
ESP:  45 00 00 2C 01 3E 00 00 40 01 30 66 1E 01 01 96   E..,.>..@.0f....
ESP:  28 01 01 96 08 00 ED 43 00 B7 00 00 41 4E 56 4C   (......C....ANVL
ESP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 59 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B5 2D AF C0 29 FB 7F EA F4 D3 6C 67               .-..).....lg
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, no IP packet received on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-24.1: Passed

>> IPSEC-ESP-25.3
TEST_DESCRIPTION
IPSec on a security gateway MUST decrement the TTL field in the inner
IP header and recompute the checksum
TEST_REFERENCE
RFC 4301 s5.1.2.1 p55 IPv4 - Header Construction for Tunnel mode
TEST_METHOD
- ANVL: Send ICMP Echo Request, from Local Host
-  DUT: Forward secured ICMP Echo Request to Remote Host
        decrementing the TTL field in inner IP-Header and
        recomputing the checksum
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1619  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1620  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1621  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1622  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1623  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1192] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1193] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1191] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1194] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0140 (320)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3064 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED42 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B8 (184)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xF470 (62576)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x485F (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A6 55 83 7F 0D B3 8C BD                           .U......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0140 (320)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3164 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED42 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B8 (184)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BC 42 6D EC D7 6F 5C 14 7C DC 0D 4C               .Bm..o\.|..L
ESP: --- Authentication Data End ---
ESP:

Correctly received inner IP Time to Live field: 63
on interface eth3 (30.1.1.150)
(Remote Host)
Received expected Checksum for the inner IP packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-25.3: Passed

>> IPSEC-ESP-25.4
TEST_DESCRIPTION
IPSec on a security gateway MUST set the DF bit in the outer IP header
according to its configuration
TEST_REFERENCE
RFC 4301 s5.1.2.1 p55 IPv4 - Header Construction for Tunnel mode
TEST_METHOD
- ANVL: Send an ICMP Echo-request from Local Host through the DUT
        Remote Host, with the DF bit in the inner IP header set
        to <DF>
-  DUT: Forward the secured IP datagram to Remote Host, and set
        the DF bit flag in the outer IP header to <DF_SETTING>
- CASE: <DF> = 0 and <DF_SETTING> = set
- CASE: <DF> = 0 and <DF_SETTING> = clear
- CASE: <DF> = 0 and <DF_SETTING> = copy
- CASE: <DF> = 1 and <DF_SETTING> = set
- CASE: <DF> = 1 and <DF_SETTING> = clear
- CASE: <DF> = 1 and <DF_SETTING> = copy
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1624  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1625  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1626  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1627  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1628  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1196] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1197] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1195] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1198] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 1: Send a plain IP packet with DF bit set to 0
and DUT is configured to set the DF-Bit in the outer IP header to SET

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1629  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1630  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel ingress setdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1631  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1632  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel setdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1633  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0141 (321)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3063 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED41 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B9 (185)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x7614 (30228)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x86BB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  4D 34 98 47 E7 B5 69 69                           M4.G..ii
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0141 (321)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3163 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED41 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00B9 (185)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  EE 5C 2C 03 81 75 E9 BD 5C 73 E0 DE               .\,..u..\s..
ESP: --- Authentication Data End ---
ESP:

Received expected DF bit in the outer IP Flag field: 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1634  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1635  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1636  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1637  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1638  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1204] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1205] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1203] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1206] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 2: Send a plain IP packet with DF bit set to 0
and DUT is configured to set the DF-Bit in the outer IP header to CLEAR

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1639  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1640  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel ingress clrdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1641  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1642  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel clrdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1643  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0142 (322)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3062 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED40 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BA (186)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x6907 (26887)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xD3C8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  EB E4 8F 00 21 62 70 EE                           ....!bp.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0142 (322)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3162 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED40 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BA (186)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  EE 46 2C E3 B4 3A F3 73 BC E9 C8 FA               .F,..:.s....
ESP: --- Authentication Data End ---
ESP:

Received expected DF bit in the outer IP Flag field: 0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1644  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1645  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1646  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1647  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1648  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1212] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1213] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1211] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1214] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 3: Send a plain IP packet with DF bit set to 0
and DUT is configured to set the DF-Bit in the outer IP header to COPY

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cguo:WindRiver default with DF=copy
exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0143 (323)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3061 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BB (187)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x6F2D (28461)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xCDA2 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A0 11 EF B8 55 73 BF B9                           ....Us..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0143 (323)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3161 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BB (187)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  3E 17 CA F2 78 02 40 B3 5E 07 30 CC               >...x.@.^.0.
ESP: --- Authentication Data End ---
ESP:

Received expected DF bit in the outer IP Flag field: 0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1649  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1650  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1651  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1652  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1653  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1216] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1217] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1215] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1218] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 4: Send a plain IP packet with DF bit set to 1
and DUT is configured to set the DF-Bit in the outer IP header to SET

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1654  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1655  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel ingress setdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1656  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -setdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1657  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel setdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1658  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0144 (324)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF05F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BC (188)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xC532 (50482)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x379D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  A7 5B 68 B8 5F 6C F5 F5                           .[h._l..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0144 (324)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF15F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BC (188)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  37 37 04 03 C0 E0 8E 43 1A 56 C8 D0               77.....C.V..
ESP: --- Authentication Data End ---
ESP:

Received expected DF bit in the outer IP Flag field: 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1659  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1660  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1661  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1662  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1663  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1224] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1225] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1223] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1226] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 5: Send a plain IP packet with DF bit set to 1
and DUT is configured to set the DF-Bit in the outer IP header to CLEAR

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 3

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1664  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1665  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel ingress clrdf 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1666  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -clrdf
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1667  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=0  tunnel clrdf 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1668  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0145 (325)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF05E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BD (189)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xB7B7 (47031)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x8518 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  26 EE B4 BC 07 05 1F 90                           &.......
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0145 (325)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF15E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BD (189)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  2D 56 95 1E FB 9B 3A EB 10 76 F1 7C               -V....:..v.|
ESP: --- Authentication Data End ---
ESP:

Received expected DF bit in the outer IP Flag field: 0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1669  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1670  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1671  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1672  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1673  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1232] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1233] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1231] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1234] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case 6: Send a plain IP packet with DF bit set to 1
and DUT is configured to set the DF-Bit in the outer IP header to COPY

Configuring IPSec on DUT to set policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cguo:WindRiver default with DF=copy
exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0146 (326)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF05D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BE (190)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xAFD4 (45012)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x4CFB (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  12 2B E4 39 C3 28 7F 0D                           .+.9.(..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0146 (326)
IP: Flags                  = 2
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.1.                  = Don't Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF15D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BE (190)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  76 E2 7C 6B 5D 24 AF FE 4D 37 0C 10               v.|k]$..M7..
ESP: --- Authentication Data End ---
ESP:

Received expected DF bit in the outer IP Flag field: 1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1674  pid=0x639a70
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1675  pid=0x639a70
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1676  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1677  pid=0x639a70
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1678  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1236] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1237] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1235] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1238] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring IPSec on DUT to reset policy for DF Bit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-reset-df-bit-processing-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> configure t
C interp: ambiguous task name 't'.
-> interface gei0
C interp: unknown symbol name 'gei0'.
-> crypto ipsec df-bit copy
C interp: unknown symbol name 'ipsec'.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-25.4: Passed

>> IPSEC-ESP-26.2
TEST_DESCRIPTION
IPSec MUST discard an outbound IP datagram if the datagram SPD entry
does not point to a matching SA and there is no key-management entity
TEST_REFERENCE
NEGATIVE: RFC 4301 s5.1(3b) p53 Outbound IP Traffic Processing
TEST_METHOD
- ANVL: Remove all IPSec SAs on the DUT associated with a packet with
        source address ANVL Local Host Address and destination address
        ANVL Remote Host Address
- ANVL: Send an ICMP Echo-request from ANVL Local Host to ANVL Remote
        Host via the DUT
-  DUT: Do not forward ICMP Echo Request or secured ICMP Echo
        Request to Remote Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1679  pid=0x68bb40
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1680  pid=0x68bb40
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1681  pid=0x68bb40
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1682  pid=0x68bb40
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1683  pid=0x68bb40
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1240] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1241] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1239] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1242] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Clearing SAs based on source address (40.1.1.150) and 
destination address (30.1.1.150)
from IPSec SAs configured on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 30.1.1.150

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-anvl-clear-sa-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipsecctrl flows 
Flows:
[1240] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1241] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1239] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1242] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=192  seq=1684  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/24
 DSTFLOW: addr=40.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=in id=1243
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 40.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress -flowpri 10 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=192  seq=1685  pid=0x639a70
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=40.1.1.150/32
 FLOWOPT: type=deny prio=10 dscp=0x0 dir=in id=1244
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.150 -dstflow 30.1.1.150 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=192  seq=1686  pid=0x639a70
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1245
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1240] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
exit
[1243] :: deny src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: none
[1244] :: deny pri=10 src=30.1.1.150/32:any dst=40.1.1.150/32:any any <- SA: none
[1239] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1245] :: deny src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: none
Total of 5 flows.
-> Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0147 (327)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x305D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED3B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00BF (191)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Correctly, no ESP packets received on interface
eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-26.2: Passed

>> IPSEC-ESP-26.3
TEST_DESCRIPTION
IPSec MUST allow a Lifetime field to be associated with any SAD entry
and the Lifetime of an SA may be specified as a time or byte count or
simultaneous use of BOTH.
TEST_REFERENCE
RFC 4301 s4.4.2.1 p37 Data Items in the SAD
TEST_METHOD
- ANVL: Reset the SA between ANVL and DUT with Lifetime
        <LifeTimeBytes> bytes
- ANVL: Send as many ICMP Echo-requests as possible within the
        Lifetime from Local Host
-  DUT: Forward the corresponding ESP secured ICMP Echo-requests
        to Remote Host
- ANVL: Send ICMP Echo-requests beyond the Lifetime bytes
        from Local Host
-  DUT: Do not forward the corresponding ESP secured ICMP
        Echo-requests to Remote Host
- ANVL: Reset the SA between ANVL and DUT with Lifetime
        <LifeTimeSeconds> seconds
- ANVL: Send ICMP Echo-requests within the Lifetime
        from Local Host
-  DUT: Forward the corresponding ESP secured ICMP Echo-requests
        to Remote Host
- ANVL: Send ICMP Echo-requests beyond the Lifetime seconds
        from Local Host
-  DUT: Do not forward the corresponding ESP secured ICMP
        Echo-requests to Remote Host
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1687  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1688  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1689  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1690  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1691  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1247] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1248] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1246] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1249] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
10

30.1.1.5

40.1.1.5

255.255.255.0

255.255.255.0

40.1.1.150

30.1.1.150

TUNNEL

MANUAL

PRESHARED-KEY

1HMAC_MD5

HMAC_MD5_96

ESP_DES

DES_CBC

NOT_CONFIGURED

66306630663066306630663066302222

8000000000000000

768

770

0202020202020202

1024

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm update -spi 302 -proto esp -src 30.1.1.5 -dst 30.1.1.150 -bh 1024
SADB_MSG: msgtype=UPDATE  err=0  satype=ESP  len=112  seq=1692  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=0 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=168  seq=1693  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=29918 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=29918 usetime=0 bytes=0
    HARD: addtime=0 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 1 ICMP plain Packet to DUT to expire Lifetime
byte in DUT
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1000 bytes
IP: Identification         = 0x0148 (328)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2CA0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF58 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C0 (192)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [972 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01               ............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1056 bytes
IP: Identification         = 0x1B77 (7031)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x1D99 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  22 2A 28 31 64 18 F2 7F                           "*(1d...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1000 bytes
IP: Identification         = 0x0148 (328)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2DA0 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF58 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C0 (192)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [972 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01               ............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4F 8F 53 F5 CF 9C B2 FB 8F 5C E7 C8               O.S......\..
ESP: --- Authentication Data End ---
ESP:

Correctly, 1-th ESP packets received on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0149 (329)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x305B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED39 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C1 (193)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no ESP packets received on interface eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 120

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=168  seq=0  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=29918 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1695  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 1024 -lh 120
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=1696  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=120 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1697  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=29929 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014A (330)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x305A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED38 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C2 (194)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xBADE (47838)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x81F1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C9 E4 54 56 1E E1 02 3A                           ..TV...:
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014A (330)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x315A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED38 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C2 (194)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  86 9A CF 93 6A 1D 89 C0 87 6F C5 F2               ....j....o..
ESP: --- Authentication Data End ---
ESP:

Correctly, ESP packets received on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014B (331)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3059 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED37 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C3 (195)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014B (331)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3159 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED37 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C3 (195)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014C (332)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3058 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 40.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF537 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C3 (195)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no ESP packets received on interface
eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1699  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1700  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1701  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1702  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1703  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1254] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1255] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1253] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1256] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-26.3: Passed

>> IPSEC-ESP-26.4
TEST_DESCRIPTION
If an entire IP-datagram does not get delivered during the SA
lifetime the packet SHOULD be discarded
TEST_REFERENCE
RFC 4301 s4.4.2 p37 Security Association Database (SAD)
TEST_METHOD
- ANVL: Configure IPSec SA on the DUT with a lifetime
        of <LifeTimeBytes> bytes
-SETUP: Configure lifetime seconds on DUT such that
        SA doesnt get expired
- ANVL: Send as many ICMP Echo-requests as possible within the
        Lifetime from Local Host to expire the lifetime bytes
-  DUT: Forward the corresponding ESP secured ICMP Echo-requests
        to Remote Host
- ANVL: Send ICMP Echo Request of size 44 bytes
-  DUT: Do not send secured ICMP Echo Request
- ANVL: Restore default IPSec SA on the DUT
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1704  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1705  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1706  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1707  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1708  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1258] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1259] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1257] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1260] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-set-sa-lifetime-bytes-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
10

30.1.1.5

40.1.1.5

255.255.255.0

255.255.255.0

40.1.1.150

30.1.1.150

TUNNEL

MANUAL

PRESHARED-KEY

1HMAC_MD5

HMAC_MD5_96

ESP_DES

DES_CBC

NOT_CONFIGURED

66306630663066306630663066302222

8000000000000000

768

770

0202020202020202

1024

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm update -spi 302 -proto esp -src 30.1.1.5 -dst 30.1.1.150 -bh 1024
SADB_MSG: msgtype=UPDATE  err=0  satype=ESP  len=112  seq=1709  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=0 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=168  seq=1710  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=30061 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=30062 usetime=0 bytes=0
    HARD: addtime=0 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 120

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-set-sa-lifetime-seconds-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=168  seq=1711  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=30061 usetime=0 bytes=0
     SA2: mode=tunnel reqid=0
------------------------------------------
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=30062 usetime=0 bytes=0
    HARD: addtime=0 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 2 security associations
-> cmd keyadm flush 
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1712  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32 -bh 1024 -lh 120
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=112  seq=1713  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
    HARD: addtime=120 usetime=0 bytes=1024
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow  30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1714  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd keyadm dump 
SADB_MSG: msgtype=DUMP  err=0  satype=ESP  len=200  seq=0  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 AUTHKEY: bits=128
  ENCKEY: bits=64
 CURRENT: addtime=30062 usetime=0 bytes=0
    HARD: addtime=120 usetime=0 bytes=1024
     SA2: mode=tunnel reqid=0
------------------------------------------
Total of 1 security associations
-> exit
Au revoir!
Connection closed by foreign host.
Sending 1 ICMP plain Packet to DUT to expire Lifetime
byte in DUT
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1000 bytes
IP: Identification         = 0x014D (333)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2C9B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF54 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C4 (196)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [972 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01               ............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1056 bytes
IP: Identification         = 0x314B (12619)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x07C5 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  F4 C8 3D C6 15 AE 4C 52                           ..=...LR
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1000 bytes
IP: Identification         = 0x014D (333)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2D9B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF54 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C4 (196)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [972 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01               ............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  9E BA 55 88 80 D8 03 E4 1F 6B 88 8C               ..U......k..
ESP: --- Authentication Data End ---
ESP:

Correctly, 1-th ESP packets received on interface
eth3 (30.1.1.150) (Remote Host)
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 1000 bytes
IP: Identification         = 0x014E (334)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2C9A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF54 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C4 (196)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [972 bytes] ---
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01   ................
ICMP:  01 01 01 01 01 01 01 01 01 01 01 01               ............
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Correctly, no ESP packets received on interface eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1716  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1717  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1718  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1719  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1720  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1265] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1266] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1264] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1267] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-26.4: Passed

>> IPSEC-ESP-27.1
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on a Destination IP Address
selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams (via
        interface D1) with IP Destination Address set to ANVL Remote
        Address use Discard policy
- ANVL: Send ICMP Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Do not forward secured ICMP Echo Request to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send ICMP Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Forward ICMP Echo Request to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send ICMP Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Forward secure ICMP Echo Request to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1721  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1722  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1723  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1724  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1725  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1269] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1270] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1268] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1271] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 DISCARD REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=168  seq=1726  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1272
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x014F (335)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3055 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED35 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C5 (197)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 BYPASS REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=152  seq=1727  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0150 (336)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3054 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED34 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C6 (198)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0150 (336)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3154 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED34 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C6 (198)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for REMOTE Host(30.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.150 APPLY REMOTE

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=152  seq=1728  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0151 (337)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3053 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED33 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xFCF7 (64759)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3FD8 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  74 15 A3 B0 3A 4C 35 2B                           t...:L5+
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0151 (337)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3153 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED33 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C7 (199)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  89 49 1C 46 C0 9E 0A 00 34 66 FB A2               .I.F....4f..
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-27.1: Passed

>> IPSEC-ESP-27.2
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on a Source IP Address selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with IP Source Address set to A2Addr use Discard
        policy
- ANVL: Send ICMP Echo Request from Local Host
-  DUT: Do not forward secured ICMP Echo Request to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send ICMP Echo Request from Local Host
-  DUT: Forward ICMP Echo Request to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send ICMP Echo Request from Local Host
-  DUT: Forward secure ICMP Echo Request to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1729  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1730  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1731  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1732  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1733  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1276] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1277] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1275] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1278] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 DISCARD LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=168  seq=1734  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1279
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0152 (338)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3052 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED32 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C8 (200)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 BYPASS LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=152  seq=1735  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0153 (339)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3051 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED31 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C9 (201)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0153 (339)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3151 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED31 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00C9 (201)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec for LOCAL Host(40.1.1.150)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
40.1.1.150 APPLY LOCAL

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-host-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=152  seq=1736  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0154 (340)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3050 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED30 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CA (202)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x1FBB (8123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x1D15 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  C9 A6 DD 1C 16 36 0C BB                           .....6..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0154 (340)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3150 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED30 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CA (202)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  44 AC EA 14 0D 38 5B EF F2 60 B4 42               D....8[..`.B
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-27.2: Passed

>> IPSEC-ESP-27.3
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on Transport Layer Protocol
selector
TEST_REFERENCE
RFC 4301 s4.4.1 p21(SPD-O) The Security Policy Database
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with Transport Layer Protocol <protocol> use
        Discard policy
- ANVL: Send IP Packet from Local Host with Transport Layer
        Protocol <protocol>
-  DUT: Do not forward secured IP Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send IP Packet from Local Host with Transport Layer
        Protocol <protocol>
-  DUT: Forward IP Packet to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send ICMP Echo Request from Local Host destined to virtual
        host address ANVL Remote Address
-  DUT: Forward secured IP Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = ICMP
- CASE: <protocol> = TCP
- CASE: <protocol> = UDP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1737  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1738  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1739  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1740  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1741  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1283] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1284] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1282] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1285] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = ICMP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for icmp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 0 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1742  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1286
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0155 (341)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x304F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2F (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CB (203)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for icmp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 0 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1743  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0156 (342)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x304E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CC (204)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0156 (342)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x314E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CC (204)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for icmp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
icmp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 0 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1744  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0157 (343)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x304D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CD (205)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x1C92 (7314)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x203E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  2C 5F 1D 42 82 AE 2C D7                           ,_.B..,.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0157 (343)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x314D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2D (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CD (205)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4D 9A 1C 1E 9F 51 FC 60 4D 69 B0 DF               M....Q.`Mi..
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1745  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1746  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1747  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1748  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1749  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1290] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1291] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1289] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1292] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1750  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1293
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0158 (344)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x304B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for TCP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1751  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0159 (345)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x304A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for TCP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0159 (345)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x314A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1752  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x015A (346)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3049 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x5558 (21848)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xE777 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  23 CD 1D 0B 1F 70 C5 DF                           #....p..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x015A (346)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3149 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xECB0 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  4A 74 AE 82 B5 7D 0A E5 14 23 42 44               Jt...}...#BD
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1753  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1754  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1755  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1756  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1757  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1297] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1298] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1296] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1299] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1758  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1300
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x015B (347)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3049 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for UDP Packet

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:15:17:C8:90:29
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1759  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x015C (348)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3048 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for UDP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x015C (348)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3148 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1760  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x015D (349)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3047 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0xA7F8 (43000)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x94E7 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B1 61 BB 03 05 77 98 A9                           .a...w..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x015D (349)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3147 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  12 C4 4A B4 F2 A3 65 57 C6 25 B2 94               ..J...eW.%..
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1761  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1762  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1763  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1764  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1765  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1304] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1305] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1303] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1306] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-27.3: Passed

>> IPSEC-ESP-27.4
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify the security
processing for outbound traffic based on TCP/UDP Source Port Number
selector
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with Transport Layer Protocol <protocol> and
        Transport Layer Source Port <port> use Discard policy
- ANVL: Send IP Packet from Local Host with Transport Layer
        Protocol <protocol> and Transport Layer Source Port <port>
-  DUT: Do not forward secured IP Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send IP Packet from Local Host with Transport Layer
        Protocol <protocol> and Transport Layer Source Port <port>
-  DUT: Forward IP Packet to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send IP Packet from Local Host with Transport Layer
        Protocol <protocol> and Transport Layer Source Port <port>
-  DUT: Forward secured IP Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = TCP, <port> = 6000
- CASE: <protocol> = UDP, <port> = 6000
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1766  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1767  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1768  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1769  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1770  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1308] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1309] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1307] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1310] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Source Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -srcport 6000 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1771  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24 port=6000
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1311
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x015E (350)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3045 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xFC51 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for TCP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -srcport 6000 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1772  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24 port=6000
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x015F (351)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3044 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xFC51 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for TCP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x015F (351)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3144 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xFC51 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp SOURCE 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -srcport 6000 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1773  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24 port=6000
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0160 (352)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3043 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xFC51 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xA772 (42866)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x955D (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  56 D5 33 E8 2F 49 F7 94                           V.3./I..
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0160 (352)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x3143 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 6000 (6000)
TCP: Destination Port      = 20001 (20001)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0xFC51 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  28 2C 10 BB 4E E5 54 4A 17 06 87 22               (,..N.TJ..."
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1774  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1775  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1776  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1777  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1778  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1315] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1316] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1314] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1317] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Source Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -srcport 6000 -deny -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1779  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24 port=6000
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1318
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0161 (353)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3043 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for UDP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -srcport 6000 -bypass -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1780  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24 port=6000
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0162 (354)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3042 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for UDP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0162 (354)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3142 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and SOURCE Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp SOURCE 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -srcport 6000 -replace
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1781  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24 port=6000
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0163 (355)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3041 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x71F2 (29170)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xCAED (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  AD 70 2A 66 D9 13 0F 7D                           .p*f...}
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0163 (355)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3141 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 6000 (6000)
UDP: Destination Port = 0 (0)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C4 50 BD 22 26 60 88 CD 1B F5 6B 70               .P."&`....kp
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1782  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1783  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1784  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1785  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1786  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1322] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1323] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1321] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1324] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-27.4: Passed

>> IPSEC-ESP-27.5
TEST_DESCRIPTION
IPSec MUST allow an administrative interface to specify security
processing for outbound traffic based on TCP/UDP Destination Port
Number selector
TEST_REFERENCE
RFC 4301 s4.4.1.1 p27 Selectors
TEST_METHOD
- ANVL: Add entry in the DUT's SPD such that outbound IP-datagrams via
        interface D1 with Transport Layer Protocol <protocol> and
        Transport Layer Destination Port <port> use Discard policy
- ANVL: Send IP Packet from Local Host with Transport Layer Protocol
        <protocol> and Transport Layer Destination Port <port>
-  DUT: Do not forward secured IP Packet to Remote Host
- ANVL: Modify the SPD entry to use Bypass policy
- ANVL: Send IP Packet from Local Host with Transport Layer Protocol
        <protocol> and Transport Layer Destination Port <port>
-  DUT: Forward IP Packet to Remote Host
- ANVL: Modify the SPD entry to use IPSec policy
- ANVL: Send IP Packet from Local Host with Transport Layer Protocol
        <protocol> and Transport Layer Destination Port <port>
-  DUT: Forward secured IP Packet to Remote Host
- ANVL: Restore default SA and SPD between ANVL and DUT
- CASE: <protocol> = TCP, port = <6000>
- CASE: <protocol> = UDP, port = <6000>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1787  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1788  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1789  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1790  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1791  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1326] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1327] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1325] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1328] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = TCP, <Destination Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -dstport 6000 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1792  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24 port=6000
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1329
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0164 (356)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x303F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x2362 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for TCP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -dstport 6000 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1793  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0165 (357)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x303E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x2362 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for TCP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0165 (357)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x313E (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x2362 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for tcp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
tcp DESTINATION 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 6 -dstport 6000 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1794  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=TCP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted TCP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0166 (358)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x303D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x2362 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ETHER: --- Padding [6 bytes] ---
ETHER:  00 00 00 00 00 00                                 ......
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted TCP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xF60C (62988)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x46C3 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  6F 6A 27 B8 5F BD DF D2                           oj'._...
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 40 bytes
IP: Identification         = 0x0166 (358)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = TCP (6)
IP: Header Checksum        = 0x313D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
TCP: ---- TCP Packet ----
TCP:
TCP: Source Port           = 10001 (10001)
TCP: Destination Port      = 6000 (6000)
TCP: Sequence Number       = 1234 (0x000004D2)
TCP: Acknowledgment Number = 0 (0x00000000) (Not Significant)
TCP: Data Offset           = 5 (20 bytes)
TCP: Reserved              = 0 
TCP: Control Bits          = 0x02
TCP:  |543210
TCP:  |0.....              = Urgent Pointer Isn't Significant
TCP:  |.0....              = Acknowledgment Isn't Significant
TCP:  |..0...              = No Push Function
TCP:  |...0..              = No Reset Connection
TCP:  |....1.              = Synchronize Sequence Numbers
TCP:  |.....0              = More Data From Sender
TCP: Window                = 0 bytes
TCP: Checksum              = 0x2362 (Correct)
TCP: Urgent Pointer        = 0 (Not Significant)
TCP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  A2 BA CC D4 65 B2 81 43 D3 DF CF 66               ....e..C...f
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1795  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1796  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1797  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1798  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1799  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1333] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1334] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1332] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1335] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


<CASE> :: <Protocol> = UDP, <Destination Port> = 6000

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for udp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -dstport 6000 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1800  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24 port=6000
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1336
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0167 (359)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x303D (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for UDP Packet
Correctly, no IP packets received on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for udp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -dstport 6000 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1801  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0168 (360)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x303C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for UDP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0168 (360)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x313C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for udp transport Protocol and DESTINATION Port 6000
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
udp DESTINATION 6000 APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-and-port-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 17 -dstport 6000 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1802  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=UDP 
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24 port=6000
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted UDP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0169 (361)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x303B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted UDP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 80 bytes
IP: Identification         = 0x30B0 (12464)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x0C30 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  07 8A C7 7C E4 49 66 35                           ...|.If5
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 28 bytes
IP: Identification         = 0x0169 (361)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x313B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 0 (0)
UDP: Destination Port = 6000 (6000)
UDP: Length           = 8 
UDP: Checksum         = 0x0000 
UDP:
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  89 A4 58 C1 07 8C CC C8 F8 5F 68 A2               ..X......_h.
ESP: --- Authentication Data End ---
ESP:

Correctly Received IP Packet on interface
eth3 (30.1.1.150)(Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1803  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1804  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1805  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1806  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1807  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1340] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1341] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1339] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1342] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-27.5: Passed

>> IPSEC-ESP-27.8
TEST_DESCRIPTION
IPsec MUST allow an management interface to specify the security
processing for outbound traffic based on SA value - Next Layer 
protocol (e.g. ICMP). 
TEST_REFERENCE
rfc 4301 S4.4.1, p23, The Security Policy Database (SPD)
rfc 4301 S4.4.1.1, p28, Selectors
TEST_METHOD
- SETUP: Add the following entry in the DUT SPD:  Discard packets 
         containing next protocol set to ICMP
- ANVL:  Send an ICMP packets, from Local Host through the DUT 
         to Remote Host
-  DUT:  Do not forward the ICMP packet to Remote Host
- SETUP: Add the following entry in the DUT SPD:  Bypass IPsec for
         packets containing next protocol set to ICMP
- ANVL:  Send an ICMP packet, from Local Host through the DUT 
         to Remote Host  
-  DUT:  Forward the ICMP packet to Remote Host  
- SETUP: Add the following entry in the DUT SPD:  Use IPsec while  
         packets containing next protocol set to ICMP
- ANVL:  Send an ICMP packet, from Local Host through the DUT 
         to Remote Host 
-  DUT:  Forward the secured ICMP packet to Remote Host 
- ANVL:  Restore the DUT SPD 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1808  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1809  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1810  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1811  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1812  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1344] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1345] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1343] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1346] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DUT with the following Outbound IPSec policy:
DISCARD IPSec to the IP packet for ICMP transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMP DISCARD

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 0 -deny -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1813  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
 FLOWOPT: type=deny prio=0 dscp=0x0 dir=out id=1347
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016A (362)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x303A (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CE (206)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Correctly, no IP packet received on interface eth3 (30.1.1.150)
(Remote Host)

Configuring DUT with the following Outbound IPSec policy:
BYPASS IPSec to the IP packet for ICMP transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMP BYPASS

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 0 -bypass -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=BYPASS  len=160  seq=1814  pid=0x5de180
      SA: spi=0  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016B (363)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3039 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CF (207)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for ICMP Packet
Received non-encrypted IP packet from 40.1.1.150 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016B (363)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3139 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00CF (207)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Received expected Unsecured IP Packet on interface
eth3 (30.1.1.150) (Remote Host)

Configuring DUT with the following Outbound IPSec policy:
APPLY IPSec to the IP packet for ICMP transport Protocol
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
ICMP APPLY

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-set-outbound-spd-for-protocol-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm addflow -proto esp -spi 302 -dst 30.1.1.150/24 -srcflow 40.1.1.150/24 -dstflow  30.1.1.150/24 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -transport 0 -replace 
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=160  seq=1815  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  replaceflow 
     DST: addr=30.1.1.150
PROTOCOL: proto=any
 SRCFLOW: addr=40.1.1.150/24
 DSTFLOW: addr=30.1.1.150/24
------------------------------------------
-> exit
Au revoir!
Connection closed by foreign host.
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016C (364)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3038 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D0 (208)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x7725 (30501)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xC5AA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B9 05 12 60 06 DB 4B 44                           ...`..KD
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x016C (364)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3138 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED2A (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D0 (208)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  E1 32 29 4E 12 FE F6 74 50 05 68 B3               .2)N...tP.h.
ESP: --- Authentication Data End ---
ESP:

Received expected secured IP Packet on interface
eth3 (30.1.1.150) (Remote Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1816  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1817  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1818  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1819  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1820  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1351] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1352] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1350] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1353] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-27.8: Passed

>> IPSEC-ESP-29.1
TEST_DESCRIPTION
In transport mode, the DSCP value might change en route, but this SHOULD
not cause problems with respect to IPsec processings - since the value
is not employed for SA selection and MUST NOT be checked as part of
SA/packet validation.
TEST_REFERENCE
rfc 4301 S4.1 p14 Definition and Scope
TEST_METHOD
- ANVL: Send an ICMP echo request from <AIface-0> to <DIface-0>
        with DSCP field set to <DSCP>
- ANVL: Listen upto <ParamListenTime> for ESP-secured ICMP
        echo reply.
-  DUT: Send an secured echo reply to <AIface-0>
- ANVL: Verify that the received packet is ESP-secured.
- CASE: <DSCP> = 0x28 (EXPRESS FWDing precedence)
- CASE: <DSCP> = 0x30 (stays for IP routing protocol)
- CASE: <DSCP> = 0x0  (Default case. Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1821  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1822  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1823  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1824  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1825  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1355] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1356] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1354] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1357] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 30.1.1.5 30.1.1.150 TRANSPORT MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-configure-dut-mode-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1826  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1827  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 30.1.1.5 -dstflow  30.1.1.150 -srcmask 255.255.255.255 -dstmask 255.255.255.255
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1828  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=30.1.1.5/32
 DSTFLOW: addr=30.1.1.150/32
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1829  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.150 -dstflow 30.1.1.5 -srcmask 255.255.255.255 -dstmask 255.255.255.255 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1830  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.150/32
 DSTFLOW: addr=30.1.1.5/32
------------------------------------------
-> cmd ipsecctrl flows 
Flows:
[1359] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1361] :: use src=30.1.1.150/32:any dst=30.1.1.5/32:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1358] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1360] :: use src=30.1.1.5/32:any dst=30.1.1.150/32:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a secured packet with DSCPfield set to 0x28
Sending encrypted IP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xA0
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x016D (365)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x39E3 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000008 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  B4 81 BF 8C 0B 0A F9 F3                           ........
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF72E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  BD 88 9E 4F 23 69 C9 CF 47 3B 52 8C               ...O#i..G;R.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv4 Packet

Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xA0
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x7C61 (31841)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xBEEE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  18 DE FA 44 A4 36 34 1C                           ...D.64.
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFF2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C0 C3 69 5F D7 A6 AE E9 0E 4E 35 0B               ..i_.....N5.
ESP: --- Authentication Data End ---
ESP:

Received expected packet on interface eth3 (30.1.1.150)
(Local host)


 Case: Sending a secured packet with DSCPfield set to 0x30
Sending encrypted IP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x016E (366)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x39C2 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x00000009 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  26 4D BA 9A 65 83 20 5A                           &M..e. Z
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF72E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  C2 05 95 62 B4 5C 91 4B CE 6B BA 5F               ...b.\.K.k._
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv4 Packet

Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xC0
IP:  |01234567
IP:  |110.....             = Precedence (Internetwork Control)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x7C62 (31842)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xBECD (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  19 BB F3 46 D4 6C C9 D1                           ...F.l..
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFF2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  31 AB A0 42 04 C4 BA C9 B1 31 33 25               1..B.....13%
ESP: --- Authentication Data End ---
ESP:

Received expected packet on interface eth3 (30.1.1.150)
(Local host)


 Case: Sending a secured packet with DSCPfield set to 0x0
Sending encrypted IP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.5)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x016F (367)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A81 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000A 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  78 68 00 87 54 15 6A 9C                           xh..T.j.
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xF72E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AC EB 99 B5 A3 A7 E2 70 AA 0B 61 C9               .......p..a.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for Encrypted IPv4 Packet

Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 64 bytes
IP: Identification         = 0x7C63 (31843)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xBF8C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  07 74 A3 35 87 43 3F CD                           .t.5.C?.
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 0 (Echo Reply)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xFF2E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D1 (209)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [0 bytes] ---
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [6 bytes] ---
ESP:  01 02 03 04 05 06                                 ......
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 6 
ESP: Next Header              = 1 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  71 C4 DC 59 76 40 34 09 98 20 AC C8               q..Yv@4.. ..
ESP: --- Authentication Data End ---
ESP:

Received expected packet on interface eth3 (30.1.1.150)
(Local host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-29.1: Passed

>> IPSEC-ESP-29.2
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the DS field from the inner IP
header to the outer IP header.
TEST_REFERENCE
RFC 4301 s5.1.2.1 p57 IPv4 header construction for tunnel mode
TEST_METHOD
- ANVL: Send ICMP Echo Request from Local Host, with the DS field
        in the inner IP-Header set to <DSCP>
-  DUT: Forward secured ICMP Echo Request to Remote Host
- ANVL: Verify that the DS field of the outer header is set to <ds>
- CASE: <DSCP> = 101110 (High Priority, Expedited Forwarding)
- CASE: <DSCP> = 001010 (Assured forwarding 11)
- CASE: <DSCP> = 000000 (Default case.Will give BEST EFFORT precedence)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1831  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1832  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1833  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1834  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1835  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1363] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1364] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1362] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1365] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


 Case: Sending a plain packet with DSCPfield set to 0x2E
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xB8
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0170 (368)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x2F7C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED28 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D2 (210)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xB8
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xE804 (59396)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x5413 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  58 36 55 E4 BD 18 49 7A                           X6U...Iz
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0xB8
IP:  |01234567
IP:  |101.....             = Precedence (CRITIC/ECP)
IP:  |...1....             = Low Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0170 (368)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x307C (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED28 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D2 (210)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  27 62 BE D7 B3 79 22 DB DF B7 97 B8               'b...y".....
ESP: --- Authentication Data End ---
ESP:

Correctly received outer IP DSCP field: 0x2E
on interface eth3 (30.1.1.150) (Remote Host) 


 Case: Sending a plain packet with DSCPfield set to 0xA
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x28
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0171 (369)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x300B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED27 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D3 (211)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x28
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0xD110 (53520)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x6B97 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  77 C9 C9 F7 FA C7 44 CC                           w.....D.
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x28
IP:  |01234567
IP:  |001.....             = Precedence (Priority)
IP:  |...0....             = Normal Delay
IP:  |....1...             = High Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0171 (369)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x310B (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED27 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D3 (211)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  0B 83 EC 93 26 90 75 F8 0D B7 A7 95               ....&.u.....
ESP: --- Authentication Data End ---
ESP:

Correctly received outer IP DSCP field: 0xA
on interface eth3 (30.1.1.150) (Remote Host) 


 Case: Sending a plain packet with DSCPfield set to 0x0
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0172 (370)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3032 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED26 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D4 (212)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x5315 (21269)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xE9BA (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000003 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  25 65 22 BC 1E 81 F4 7A                           %e"....z
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0172 (370)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3132 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED26 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D4 (212)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  B7 60 86 33 31 8B 80 26 59 84 DC DF               .`.31..&Y...
ESP: --- Authentication Data End ---
ESP:

Correctly received outer IP DSCP field: 0x0
on interface eth3 (30.1.1.150) (Remote Host) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-29.2: Passed

>> IPSEC-ESP-29.3
TEST_DESCRIPTION
IPsec on a security gateway MUST copy the ECN field from 
the inner IP header to the outer IP header.
(Note: This test is for tunnel mode, Encapsulator side)
TEST_REFERENCE
RFC 4301 s5.1.2.1 p57 IPv4 header construction for tunnel mode
IETF-proceedings-draft-ipsec-ecn-00.txt s3.1.3 p7 
TEST_METHOD
- ANVL: Send plain ICMP Echo Request from Local Host to Remote host 
     through DUT
-  DUT: Forward secured ICMP Echo Request to Remote Host
- ANVL: Verify that the ECT & CE bit-field of the outer IP-header 
- CASE: [<ECT>,<CE>] = [1,0] 
- CASE: [<ECT>,<CE>] = [0,0] 
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1836  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1837  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1838  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1839  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1840  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1367] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1368] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1366] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1369] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


	 Case: Sending a plain packet with <ECT,CE>field set to <1,0>
	------------------------------------------------------------------
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0173 (371)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x302F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED25 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D5 (213)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x943C (37948)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xA891 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000001 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  1E 74 D4 B4 C8 50 52 46                           .t...PRF
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x02
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......1.             = Low Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0173 (371)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x312F (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED25 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D5 (213)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D6 89 22 2A FF B6 DC 15 F9 0D 6A 48               .."*......jH
ESP: --- Authentication Data End ---
ESP:


Correctly received outer ECT bit field: 1
on interface eth3 (30.1.1.150) (Remote Host) 

Correctly received outer CE bit field: 0
on interface eth3 (30.1.1.150) (Remote Host) 


	 Case: Sending a plain packet with <ECT,CE>field set to <0,0>
	------------------------------------------------------------------
Sending non-encrypted ICMP IP packet from interface eth4 (ANVL virtual address 40.1.1.150) 
to interface eth3 (ANVL virtual address 30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:29
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0174 (372)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3030 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED24 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D6 (214)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Waiting (up to 10.000 seconds) for Encrypted ICMP Packet
Received encrypted IP packet from 30.1.1.5 on interface eth3 (30.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x6C21 (27681)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0xD0AE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000302 
ESP: Sequence Number          = 0x00000002 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  4C B2 82 71 52 B5 63 5F                           L..qR.c_
ESP: --- Initialization Vector End ---
ESP:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0174 (372)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 63
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3130 (Correct)
IP: Source Address         = 40.1.1.150
IP: Destination Address    = 30.1.1.150
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xED24 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x00D6 (214)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 4E 56 4C 20 54 45 53 54 20 44 41 54 41 20 20   ANVL TEST DATA  
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 4 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  46 D6 BE 74 37 16 7F F2 26 E0 4A F4               F..t7...&.J.
ESP: --- Authentication Data End ---
ESP:


Correctly received outer ECT bit field: 0
on interface eth3 (30.1.1.150) (Remote Host) 

Correctly received outer CE bit field: 0
on interface eth3 (30.1.1.150) (Remote Host) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-29.3: Passed

>> IPSEC-ESP-33.1
TEST_DESCRIPTION
If the value of the Next header field is 59(i.e. no next header), the
packet (Dummy packet) is discarded without further processing.
TEST_REFERENCE
RFC 4303, s3.4.4., p31, Separate Confidentiality & Integrity Algorithm 
TEST_METHOD
- ANVL: Send an ESP-Secured ICMP Echo Request from remote host to
        local host through the DUT having Next Layer Protocol field
        set to 59.
-  DUT: Discard the ICMP Echo Request
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1841  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1842  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1843  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1844  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1845  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1371] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1372] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1370] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1373] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.


Case: Set the Next Header to 59 in ESP Trailer
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0176 (374)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A5A (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x00000300 
ESP: Sequence Number          = 0x0000000B 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  45 8E DD C7 95 1B FD 7F                           E.......
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ESP: --- Payload Data [60 bytes] ---
ESP:  00 00 03 00 00 00 00 0B 45 8E DD C7 95 1B FD 7F   ........E.......
ESP:  45 00 00 2C 01 75 00 00 40 01 30 2F 1E 01 01 96   E..,.u..@.0/....
ESP:  28 01 01 96 08 00 ED 23 00 D7 00 00 41 4E 56 4C   (......#....ANVL
ESP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 59 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  AD CE 11 64 49 1A 5E 38 D9 39 87 51               ...dI.^8.9.Q
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface
eth4 (40.1.1.150) (Local Host)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-33.1: Passed

>> IPSEC-ESP-34.1
TEST_DESCRIPTION
No valid SA exists for a session.The audit Log entry for this event
SHOULD include the SPI values, date/time received, source address and
destination address, sequence number.
(Note: Here we are doing this test only for SPI mismatch scenario. Can
be done for other parameter mis-match also)
TEST_REFERENCE
RFC 4303, s4, p33, Auditing
TEST_METHOD
- ANVL: Send an ESP-secured ICMP echo request containing a SPI value
        that doesn't match the SPI entry of the established SA from
        remote host.
-  DUT: Don't forward this ICMP echo request and LOG the error.
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-2

ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.5 40.1.1.5 255.255.255.0 255.255.255.0 40.1.1.150 30.1.1.150 TUNNEL MANUAL PRESHARED-KEY HMAC_MD5 HMAC_MD5_96 ESP_DES DES_CBC NOT_CONFIGURED 66306630663066306630663066302222 8000000000000000 768 770 0202020202020202 SHA DES_CBC MODP768 MODP1024

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-esp-reset-ip-security-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
aaa=25
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1846  pid=0x5de180
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -akey 66306630663066306630663066302222 -ingress -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1847  pid=0x5de180
      SA: spi=300  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 300 -src 30.1.1.150 -dst 30.1.1.5 -srcflow 30.1.1.0 -dstflow 40.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0 -ingress
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1848  pid=0x5de180
      SA: spi=300  sta=LARVAL  auth=NONE  enc=NONE  replay=0  ingress 
     SRC: addr=30.1.1.150
     DST: addr=30.1.1.5
 SRCFLOW: addr=30.1.1.0/24
 DSTFLOW: addr=40.1.1.0/24
------------------------------------------
-> cmd keyadm add -proto esp -enc des -ekey 8000000000000000 -auth md5 -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -akey 66306630663066306630663066302222 -forcetunnel -replay 32
SADB_MSG: msgtype=ADD  err=0  satype=ESP  len=80  seq=1849  pid=0x5de180
      SA: spi=302  sta=MATURE  auth=MD5  enc=DES  replay=32  tunnel 
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
------------------------------------------
-> cmd keyadm addflow -proto esp -spi 302 -src 30.1.1.5 -dst 30.1.1.150 -srcflow 40.1.1.0 -dstflow 30.1.1.0 -srcmask 255.255.255.0 -dstmask 255.255.255.0
SADB_MSG: msgtype=X_ADDFLOW  err=0  satype=ESP  len=176  seq=1850  pid=0x5de180
      SA: spi=302  sta=LARVAL  auth=NONE  enc=NONE  replay=0  
     SRC: addr=30.1.1.5
     DST: addr=30.1.1.150
 SRCFLOW: addr=40.1.1.0/24
 DSTFLOW: addr=30.1.1.0/24
------------------------------------------
-> cmd ipsecctrl sa
SA - Security Associations:
[ 1] :: ESP  spi=0x300   src=30.1.1.150        dst=30.1.1.5          auth=md5 hmac enc=espDes
[ 2] :: ESP  spi=0x302   src=30.1.1.5          dst=30.1.1.150        auth=md5 hmac enc=espDes
Total of 2 SAs.
-> cmd ipsecctrl flows
Flows:
[1375] :: bypass pri=-120 src=0.0.0.0/0:any dst=128.224.166.238/32:500 UDP  <- SA: BYPS
[1376] :: use src=30.1.1.0/24:any dst=40.1.1.0/24:any any <- SA: ESP  spi=0x300 src=30.1.1.150 dst=30.1.1.5
[1374] :: bypass pri=-120 src=128.224.166.238/32:500 dst=0.0.0.0/0:any UDP  -> SA: BYPS
[1377] :: use src=40.1.1.0/24:any dst=30.1.1.0/24:any any -> SA: ESP  spi=0x302 src=30.1.1.5 dst=30.1.1.150
Total of 4 flows.
-> exit
Au revoir!
Connection closed by foreign host.
Sending encrypted ICMP (over IPv4) packet from interface eth3 (ANVL virtual address 30.1.1.150) 
to interface eth4 (ANVL virtual address 40.1.1.150)

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 96 bytes
IP: Identification         = 0x0178 (376)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ESP (50)
IP: Header Checksum        = 0x3A58 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 30.1.1.5
IP:
ESP: ---- ESP Header ----
ESP:
ESP: Security Parameter Index = 0x0000030A 
ESP: Sequence Number          = 0x0000000C 
ESP:
ESP: ---- ESP Payload Data ----
ESP:
ESP: --- Initialization Vector [8 bytes] ---
ESP:  88 97 74 7D CC 8F 94 83                           ..t}....
ESP: --- Initialization Vector End ---
ESP:
ESP: ---- Reconstructed IP Packet ----
ESP:
ESP: --- Payload Data [60 bytes] ---
ESP:  00 00 03 0A 00 00 00 0C 88 97 74 7D CC 8F 94 83   ..........t}....
ESP:  45 00 00 2C 01 77 00 00 40 01 30 2D 1E 01 01 96   E..,.w..@.0-....
ESP:  28 01 01 96 08 00 ED 22 00 D8 00 00 41 4E 56 4C   (......"....ANVL
ESP:  20 54 45 53 54 20 44 41 54 41 20 20                TEST DATA  
ESP: --- Payload Data End ---
ESP: ---- ESP Trailer ----
ESP:
ESP: --- Padding [2 bytes] ---
ESP:  01 02                                             ..
ESP: --- Padding End ---
ESP:
ESP: Pad Length               = 2 
ESP: Next Header              = 59 
ESP:
ESP: --- Authentication Data [12 bytes] ---
ESP:  D6 6D D0 F1 97 03 D7 B1 D5 65 39 DF               .m.......e9.
ESP: --- Authentication Data End ---
ESP:

Waiting (up to 10.000 seconds) for IPv4 Packet

Correctly, did not receive IP packet on interface eth4 (40.1.1.150)(Local Host)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
778

Executing system command:
  "./DocScriptQ35/IPSEC-ESP/ipsec-verify-audit-bad-spi-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
DUT has logged this SA-mismatch phenomenon correctly

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< IPSEC-ESP-34.1: Passed
Executing system command:
  "./DocScriptQ35/IPSEC-ESP/IPSECESPpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipnet.inet.AcceptSourceRoute "0"
sysvar: ipnet.inet.AcceptSourceRoute=0 ok
-> cmd keyadm flush
SADB_MSG: msgtype=FLUSH  err=0  satype=NONE  len=16  seq=1851  pid=0x5b38d0
------------------------------------------
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          58
Number of tests passed:       57
Number of tests failed:       1
Number of tests inconclusive: 0
