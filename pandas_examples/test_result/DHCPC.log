ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 5799528 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient dhcp-client 1-6.2 6.4-6.6 6.8-7 8.2-13.6 13.9 14.1 14.3 16.1-16.5 16.7-16.8 16.10 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           "./DocScriptQ35/IP/reboot-command.exp $ANVL_DUTHOSTNAME"
Post suite Command                       "./DocScriptQ35/DHCP-CLIENT/DHCPCpostsuite.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
IP DUT Background Echo Request Send Command "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
DHCP Client Suite Setup Command          "./DocScriptQ35/DHCP-CLIENT/dhcp-client-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Configure Command            "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Reset Command                "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Renew Command                "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Release Command              "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Option Configure Command     "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Boot Command                 "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Reboot Command               "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client DHCPINFORM Message Send Command "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Restart Log Check Command    "./DocScriptQ35/DHCP-CLIENT/dhcp-client-restart-log-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Static IP Assign Command     "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Supports Sending DHCPINFORM  True
DHCP Client Supports Lease Renewal       True
DHCP Listen Time                         10                  # (0x0000000A)
DHCP Lease Time                          80                  # (0x00000050)
DHCP Tolerance Time                      20                  # (0x00000014)
DHCP Tolerance Factor                    1                   # (0x00000001)
DHCP Process Time                        2                   # (0x00000002)
DHCP First Retransmission Interval       4                   # (0x00000004)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        
IP First Unused Net                      50.0.0.0
IP Number Unused Nets                    100                 # (0x00000064)
IP Unused Net Mask                       255.0.0.0

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29

# Configuration File End.

WARNING: It is recommended that the value of lease time should
WARNING: kept higher than 5 seconds since in various cases,
WARNING: verification of T1 and T2 (Ref: rfc2131) is done which
WARNING: are fractions of 'DHCP Lease Time'. Keeping it too low
WARNING: may cause the T1 and T2 to become too low for proper
WARNING: verifications.
WARNING: Too high values are also deprreciated since it will
WARNING: lead to unnecessary long running of tests which
WARNING: may not add any value to the test results.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.rfc2131_init_delay "1"
sysvar: ipdhcpc.rfc2131_init_delay=1 ok
-> cmd sysvar get ipdhcpc.rfc2131_init_delay
sysvar: ipdhcpc.rfc2131_init_delay=1
-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time 
sysvar: ipdhcpc.option.lease_time=60
-> cmd sysvar set -c -o ipdhcpc.option.requested_options "1,6,28,42"
sysvar: ipdhcpc.option.requested_options=1,6,28,42 ok
-> cmd sysvar get ipdhcpc.option.requested_options
sysvar: ipdhcpc.option.requested_options=1,6,28,42
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd ipd kill ipdhcpc
ipd: kill ipdhcpc ok
-> cmd ipd start ipdhcpc
ipd: start ipdhcpc ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 up
-> exit
Au revoir!
Connection closed by foreign host.

Starting Active Validation for DHCP Client for
all 2 DUT interface(s)

  DHCP Client topology # 2
  ---------------------------------------

  +----------------+                          +----------------+
  |                |<AIface-0>      <DIface-0>|                |
  |             N0 +--------------------------+ N0             |
  |                |                          |                |
  |             N1 +--------------------------+ N1             |
  | <SERVER-1>     |<AIface-1>      <DIface-1>|           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2336  lo0    0    
128.224.166.0/23                vxTarget                      UC       3674  gei2   0    
vxTarget                        vxTarget                      UH       7376  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       283339lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: ipnet.inet.AddressConflictDetect=1 ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1
gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:24
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2336  lo0    0    
128.224.166.0/23                vxTarget                      UC       3674  gei2   0    
vxTarget                        vxTarget                      UH       7376  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       283339lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Causing the DUT DHCP Client to transit its state to SELECTING state
through <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> FF:FF:FF:FF:FF:FF < 00:15:17:C8:90:28 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e00:15:17:C8:90:28 < 00:1B:21:7D:57:BA IP 50.0.0.2 < 50.0.0.1 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Booting up DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Causing the DUT DHCP Client to transit its state to SELECTING
state through <DIface-1>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-1>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei1 -dhcp
-> cmd ifconfig gei1 dhcp
-> FF:FF:FF:FF:FF:FF < 00:15:17:C8:90:29 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e00:15:17:C8:90:29 < 00:1B:21:7D:57:BB IP 51.0.0.2 < 51.0.0.1 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Active validation of DHCP Client was completed successfully
for all the interfaces provided in the configuration file
Continuing with tests .....

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei1 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

This test suite tests statements from:
ANVL Test Suite DHCP Client
RFC 2131:  'Dynamic Host Configuration Protocol'
R. Droms, Bucknell University, March 1997

ANVL Test Suite Required Setup:
This suite expects to be running against a node which has at least one
interface for which it can obtain IPv4 address dynamically using DHCP
(A DHCP Client implementation is expected to be present in the DUT
which will actually obtain the IP address using DHCP


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> DHCP-CLIENT-1.1
TEST_DESCRIPTION
A DHCP Client Listens on UDP port 68
TEST_REFERENCE
Setup Verification
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:1 mcast:0 errors:0 dropped:1
	TX packets:9 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:322  TX bytes:1806

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2344  lo0    0    
128.224.166.0/23                vxTarget                      UC       3681  gei2   0    
vxTarget                        vxTarget                      UH       7520  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       290362lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2C82 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 610246453 (0x245F9F35)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB4 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2039 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 610246453 (0x245F9F35)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5662 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 610246453 (0x245F9F35)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-1.1: Passed

>> DHCP-CLIENT-2.1
TEST_DESCRIPTION
A DHCP client must be prepared to receive multiple responses
to a request for configuration parameters
(Note: If the 'xid' of an arriving DHCPOFFER message does not match the
'xid' of the most recent DHCPDISCOVER message, the DHCPOFFER message
must be silently discarded.)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 1.6 Page 7 'Design Goals'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL: DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT
        through <DIface-0> containing :
        - 'xid' field set to (extractedXID+1)
- ANVL:DHCP Server <SERVER-2> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to extractedXID
- ANVL:DHCP Server <SERVER-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 54 (Server Identifier Option)
          - Length field set to 4
          - Value set to <SERVER2-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


  DHCP Client topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <SERVER-2>     |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:2 mcast:0 errors:0 dropped:2
	TX packets:12 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:644  TX bytes:2832

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2352  lo0    0    
128.224.166.0/23                vxTarget                      UC       3683  gei2   0    
vxTarget                        vxTarget                      UH       7593  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       293870lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0BAE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 23061257 (0x015FE309)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0x015FE309) to <extractedXID>
exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to (extractedXID+1) (0x015FE30A) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB2 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFF61 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 23061258 (0x015FE30A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-2> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to extractedXID (0x015FE309) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:04
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAC (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.7
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFE59 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 23061257 (0x015FE309)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.7
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3588 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 23061257 (0x015FE309)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.7
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-2> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Server Identifier (54) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.1: Passed

>> DHCP-CLIENT-2.2
TEST_DESCRIPTION
A DHCP client must be prepared to receive DHCP messages with an
 'options'
field of at least length 312 octets.  This requirement implies that a
 DHCP
client must be prepared to receive a message of up to 576 octets
TEST_REFERENCE
RFC 2131 Section 2 Page 10 'Protocol Summary'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:4 mcast:0 errors:0 dropped:4
	TX packets:15 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1288  TX bytes:3858

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2360  lo0    0    
128.224.166.0/23                vxTarget                      UC       3689  gei2   0    
vxTarget                        vxTarget                      UH       7664  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       296466lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB1CC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1120336771 (0x42C6FB83)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576 (576) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0CA5 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xA36B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1120336771 (0x42C6FB83)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDBAC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1120336771 (0x42C6FB83)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.2: Passed

>> DHCP-CLIENT-2.3
TEST_DESCRIPTION
The remaining bits of the flags field are reserved for future use.  
They MUST be set to zero by clients and ignored by servers and relay
 agents
TEST_REFERENCE
RFC 2131 Section 2 Page 11 'Protocol Summary'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Bits 2 to 16 of 'flags' field  is set to  0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:18 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:4884

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2368  lo0    0    
128.224.166.0/23                vxTarget                      UC       3693  gei2   0    
vxTarget                        vxTarget                      UH       7739  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       300822lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6777 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3249850090 (0xC1B4C6EA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Received DHCPDISCOVER Message correctly contains:
- Bits 2 to 16 of 'flags' field correctly set to 000000000000000

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.3: Passed

>> DHCP-CLIENT-4.1
TEST_DESCRIPTION
The first four octets of the 'options' field of the DHCP message
contain the (decimal) values 99, 130, 83 and 99, respectively (this
is the same magic cookie as is defined in RFC 1497)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - First four octets of DHCP Options is set to
           <DHCP-MAGIC-COOKIE>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:19 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5226

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2376  lo0    0    
128.224.166.0/23                vxTarget                      UC       3698  gei2   0    
vxTarget                        vxTarget                      UH       7812  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       304366lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEDFD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2531158842 (0x96DE6B3A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

First four octets of DHCP Options in received DHCPDISCOVER Message is correctly set to 99 130 83 99

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.1: Passed

>> DHCP-CLIENT-4.2
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPDISCOVER Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:20 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5568

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2384  lo0    0    
128.224.166.0/23                vxTarget                      UC       3698  gei2   0    
vxTarget                        vxTarget                      UH       7879  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       307882lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3DEB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4178229536 (0xF90AB920)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.2: Passed

>> DHCP-CLIENT-4.3
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPREQUEST Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:21 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5910

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2392  lo0    0    
128.224.166.0/23                vxTarget                      UC       3698  gei2   0    
vxTarget                        vxTarget                      UH       7922  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       310346lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x98D9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 214714993 (0x0CCC4A71)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB0 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8C90 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 214714993 (0x0CCC4A71)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC2B9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 214714993 (0x0CCC4A71)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Message Option in received DHCPREQUEST Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.3: Passed

>> DHCP-CLIENT-4.4
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPRELEASE Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:6 mcast:0 errors:0 dropped:6
	TX packets:24 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:2200  TX bytes:6936

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2400  lo0    0    
128.224.166.0/23                vxTarget                      UC       3699  gei2   0    
vxTarget                        vxTarget                      UH       8028  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       315146lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0CE6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2720481545 (0xA2274109)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAF (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x009D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2720481545 (0xA2274109)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x36C6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2720481545 (0xA2274109)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAE (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFD9C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2720481545 (0xA2274109)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF192 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2720481545 (0xA2274109)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Message Option in received DHCPRELEASE Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
-> e
-> cmd sysvar set -co ipdhcpc.if.gei0.informatixit
Au revoir!
Connection closed by foreign host.
on_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.4: Passed

>> DHCP-CLIENT-4.5
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPDECLINE Message)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Sends ARP Response Message to DUT
       through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Sender IP Address field set to
           <SERVER1-IP-POOL-0-0>(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL: Verify that received DHCPDECLINE Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:8 mcast:0 errors:0 dropped:8
	TX packets:27 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:2844  TX bytes:7962

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2408  lo0    0    
128.224.166.0/23                vxTarget                      UC       3704  gei2   0    
vxTarget                        vxTarget                      UH       8118  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       318834lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x99E2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2306985138 (0x8981CCB2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAD (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8D99 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2306985138 (0x8981CCB2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC3C2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2306985138 (0x8981CCB2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAC (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8A99 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2306985138 (0x8981CCB2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Server <SERVER-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0>(*INVALID*) (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDECLINE Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x858D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2306985138 (0x8981CCB2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Message Option in received DHCPDECLINE Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.5: Passed

>> DHCP-CLIENT-4.6
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPINFORM Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:31 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9030

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2416  lo0    0    
128.224.166.0/23                vxTarget                      UC       3715  gei2   0    
vxTarget                        vxTarget                      UH       8191  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       322226lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0ECD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1166629880 (0x45895BF8)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Message Option in received DHCPINFORM Message correctly contains Option Message Type (53) 

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.6: Passed

>> DHCP-CLIENT-5.1
TEST_DESCRIPTION
The client broadcasts a DHCPDISCOVER message on its local physical
 subnet
TEST_REFERENCE
RFC 2131 Section 3.1 Page 13 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:34 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9456

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2440  lo0    0    
128.224.166.0/23                vxTarget                      UC       3718  gei2   0    
vxTarget                        vxTarget                      UH       8327  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       328118lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x63EE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3342058740 (0xC733C4F4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Destination IP Address field in received DHCPDISCOVER Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
exit
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.1: Passed

>> DHCP-CLIENT-5.2
TEST_DESCRIPTION
The DHCPDISCOVER message MAY include options that suggest values for the
network address and lease duration
(Note: This test checks that DUT may suggest a value for lease time)
TEST_REFERENCE
RFC 2131 Section 3.1 Page 13 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 51 (IP Address Lease Time
        Option)
        with value 60 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 60
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:35 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9798

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2448  lo0    0    
128.224.166.0/23                vxTarget                      UC       3722  gei2   0    
vxTarget                        vxTarget                      UH       8408  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       331666lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option IP Address Lease Time with value
60 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 51 60

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time
sysvar: ipdhcpc.option.lease_time=60
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE167 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2593747989 (0x9A997415)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 60 seconds (1 minute ) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.2: Passed

>> DHCP-CLIENT-5.3
TEST_DESCRIPTION
The client broadcasts a DHCPREQUEST message that MUST include the
 'server 
identifier' option to indicate which server it has selected
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 54 (Server Identifier Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:36 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:10140 (10 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2456  lo0    0    
128.224.166.0/23                vxTarget                      UC       3723  gei2   0    
vxTarget                        vxTarget                      UH       8499  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       335422lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5FA4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2481978498 (0x93EFFC82)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAB (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x535B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2481978498 (0x93EFFC82)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8984 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2481978498 (0x93EFFC82)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Server Identifier (54) Length : 4 Value : 54.0.0.1 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.3: Passed

>> DHCP-CLIENT-5.4
TEST_DESCRIPTION
the DHCPREQUEST message MUST use the same value in the DHCP message
header's 'secs' field ... as the original DHCPDISCOVER message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'secs' field to <extractedSeconds>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'secs' field is set to extractedSeconds
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:12 mcast:0 errors:0 dropped:11
	TX packets:39 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3870  TX bytes:11166 (11 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2464  lo0    0    
128.224.166.0/23                vxTarget                      UC       3726  gei2   0    
vxTarget                        vxTarget                      UH       8569  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       338526lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC6B5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2706999303 (0xA1598807)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'secs' field (0) to <extractedSeconds>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAA (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xBA6C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2706999303 (0xA1598807)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF095 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2706999303 (0xA1598807)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'secs' field in received DHCPREQUEST Message is correctly set to 0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.4: Passed

>> DHCP-CLIENT-5.5
TEST_DESCRIPTION
the DHCPREQUEST message MUST ... be sent to the same IP broadcast
 address
as the original DHCPDISCOVER message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:13 mcast:0 errors:0 dropped:12
	TX packets:42 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4192  TX bytes:12192 (12 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2472  lo0    0    
128.224.166.0/23                vxTarget                      UC       3727  gei2   0    
vxTarget                        vxTarget                      UH       8644  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       342342lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCB17 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 349638696 (0x14D71028)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Destination IP Address field in received DHCPDISCOVER Message is correctly set to 255.255.255.255

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA9 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xBECE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 349638696 (0x14D71028)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF4F7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 349638696 (0x14D71028)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.5: Passed

>> DHCP-CLIENT-5.6
TEST_DESCRIPTION
The client times out and retransmits the DHCPDISCOVER message if
the client receives no DHCPOFFER messages
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:14 mcast:0 errors:0 dropped:13
	TX packets:45 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4514  TX bytes:13218 (13 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2480  lo0    0    
128.224.166.0/23                vxTarget                      UC       3731  gei2   0    
vxTarget                        vxTarget                      UH       8717  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       346074lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBB5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1478732861 (0x5823AC3D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBB1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1478732861 (0x5823AC3D)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.6: Passed

>> DHCP-CLIENT-5.8
TEST_DESCRIPTION
If the client detects that the address is already in use (e.g., through
the use of ARP), the client MUST send a DHCPDECLINE message to the
 server
and restarts the configuration process
(Note: In this test we check that the DUT does restart the configuration
       process after sending the DHCPDECLINE Message)
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Client <STATIC-CLIENT-1> Listens (upto
       <ParamListenTime>) on <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Client <STATIC-CLIENT-1> Sends ARP Response Message to
       DUT through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Target MAC Address field set to <DIface-0-MAC-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
        - ARP Target IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-4


  DHCP Client topology # 4
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
  <STATIC-CLIENT-1>             |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  |                |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:14 mcast:0 errors:0 dropped:13
	TX packets:47 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4514  TX bytes:13902 (13 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2488  lo0    0    
128.224.166.0/23                vxTarget                      UC       3734  gei2   0    
vxTarget                        vxTarget                      UH       8790  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       349626lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9479 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 306268508 (0x1241495C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA8 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8830 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 306268508 (0x1241495C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBE59 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 306268508 (0x1241495C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA7 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8530 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 306268508 (0x1241495C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Client <STATIC-CLIENT-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Client <STATIC-CLIENT-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Target MAC Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 
  - ARP Target IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:05
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8024 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 306268508 (0x1241495C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCCA6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2548861807 (0x97EC8B6F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.8: Passed

>> DHCP-CLIENT-5.9
TEST_DESCRIPTION
The client SHOULD wait a minimum of ten seconds before restarting
the configuration process to avoid excessive network traffic in case
of looping
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Client <STATIC-CLIENT-1> Listens (upto
       <ParamListenTime>) on <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Client <STATIC-CLIENT-1> Sends ARP Response Message to
       DUT through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Target MAC Address field set to <DIface-0-MAC-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
        - ARP Target IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the time interval between
        reception of last DHCPDECLINE Message and reception of last
         DHCPDISCOVER Message
         is greater than 
        (10  -  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-4


  DHCP Client topology # 4
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
  <STATIC-CLIENT-1>             |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  |                |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:17 mcast:0 errors:0 dropped:15
	TX packets:52 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:5218  TX bytes:15312 (15 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2504  lo0    0    
128.224.166.0/23                vxTarget                      UC       3745  gei2   0    
vxTarget                        vxTarget                      UH       8874  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       353346lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2887 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2647534017 (0x9DCE29C1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA6 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1C3E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2647534017 (0x9DCE29C1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5267 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2647534017 (0x9DCE29C1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA5 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x193E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2647534017 (0x9DCE29C1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Client <STATIC-CLIENT-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Client <STATIC-CLIENT-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Target MAC Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 
  - ARP Target IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:06
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1432 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2647534017 (0x9DCE29C1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x912C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1289359868 (0x4CDA11FC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Time interval (10.834 sec) between
reception of last DHCPDECLINE Message and reception of last DHCPDISCOVER Message 
is correctly  is greater than 
(10  -  <ParamToleranceTime>) second (greater than 0.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.9: Passed

>> DHCP-CLIENT-5.10
TEST_DESCRIPTION
If the client receives a DHCPNAK message, the client restarts the
configuration process
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:20 mcast:0 errors:0 dropped:17
	TX packets:57 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:5922  TX bytes:16722 (16 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2504  lo0    0    
128.224.166.0/23                vxTarget                      UC       3759  gei2   0    
vxTarget                        vxTarget                      UH       8933  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       355784lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF85D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530371201 (0x5B379C81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA4 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xEC14 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530371201 (0x5B379C81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x223E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530371201 (0x5B379C81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA3 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE914 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530371201 (0x5B379C81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x6EB1 (28337)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9EF1 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5444 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530371201 (0x5B379C81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x43C2 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0x2751 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530371201 (0x5B379C81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF5EF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1554789728 (0x5CAC3560)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.10: Passed

>> DHCP-CLIENT-5.11
TEST_DESCRIPTION
The client times out and retransmits the DHCPREQUEST message if the
client receives neither a DHCPACK or a DHCPNAK message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto ((<REMOTE-CLIENT1-T2> -
       <REMOTE-CLIENT1-T1>) + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:24 mcast:0 errors:0 dropped:19
	TX packets:67 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:6918  TX bytes:18342 (18 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2512  lo0    0    
128.224.166.0/23                vxTarget                      UC       3779  gei2   0    
vxTarget                        vxTarget                      UH       9008  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       360278lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6DEF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2456416189 (0x9269EFBD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA1 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE0A3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2456416189 (0x9269EFBD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x96C1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2456416189 (0x9269EFBD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0017 (23)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA0 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDDA3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2456416189 (0x9269EFBD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 155.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 151.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x7A0B (31243)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9397 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC8C7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2456416189 (0x9269EFBD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xCC7A (52346)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4128 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC8C7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2456416189 (0x9269EFBD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.11: Passed

>> DHCP-CLIENT-5.12
TEST_DESCRIPTION
The client SHOULD notify the user that the initialization process has
failed and is restarting
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto
       (<REMOTE-CLIENT1-LEASE-TIME> + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the DUT has correctly logged that
        initialization process has failed and is restarting
        for 
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:27 mcast:0 errors:0 dropped:21
	TX packets:78 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:7622  TX bytes:20304 (20 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2520  lo0    0    
128.224.166.0/23                vxTarget                      UC       3836  gei2   0    
vxTarget                        vxTarget                      UH       9082  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       363778lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1E2A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2744594005 (0xA3972E55)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x11E1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2744594005 (0xA3972E55)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x480A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2744594005 (0xA3972E55)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0EE1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2744594005 (0xA3972E55)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 100.000 seconds) for DHCPDISCOVER Message on <DIface-0>
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xEC85 (60549)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x211D (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7A10 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2744594005 (0xA3972E55)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB011 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2744594005 (0xA3972E55)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0AE5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1016676478 (0x3C99407E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

 Verifying that the DUT has correctly logged that
initialization process has failed and is restarting
for 
Verifying DUT has logged the event of restarting DHCP Client
for <DIface-0> in case of failure to reacquire IP Address
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-restart-log-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
 DUT has correctly logged that initialization process
has failed and is restarting for 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.12: Passed

>> DHCP-CLIENT-5.13
TEST_DESCRIPTION
The client may choose to relinquish its lease on a network address
by sending a DHCPRELEASE message to the server
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Wait till <ParamProcessTime> for DUT to actually stop using
        the released address
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:30 mcast:0 errors:0 dropped:23
	TX packets:89 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:8326  TX bytes:22266 (22 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2528  lo0    0    
128.224.166.0/23                vxTarget                      UC       3860  gei2   0    
vxTarget                        vxTarget                      UH       9164  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       367116lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x438C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2907766585 (0xAD50FF39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3743 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2907766585 (0xAD50FF39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6D6C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2907766585 (0xAD50FF39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3443 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2907766585 (0xAD50FF39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cm
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2839 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2907766585 (0xAD50FF39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Waiting (up to 2.000 seconds) for DUT to actually stop using the released address
d ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0EB3 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.13: Passed

>> DHCP-CLIENT-5.14
TEST_DESCRIPTION
The client identifies the lease to be released with its 'client
 identifier',
or 'chaddr' and network address in the DHCPRELEASE message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 'chaddr' field to <extractedChaddr>
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - 'chaddr' field is set to extractedChaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:33 mcast:0 errors:0 dropped:26
	TX packets:92 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:9030  TX bytes:23292 (23 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2536  lo0    0    
128.224.166.0/23                vxTarget                      UC       3874  gei2   0    
vxTarget                        vxTarget                      UH       9253  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       370740lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF00A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2677563507 (0x9F986073)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE3C1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2677563507 (0x9F986073)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x19EB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2677563507 (0x9F986073)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D99 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE0C1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2677563507 (0x9F986073)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 'chaddr' field (00:15:17:C8:90:28) to <extractedChaddr>

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD4B7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2677563507 (0x9F986073)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

'chaddr' field in received DHCPRELEASE Message is correctly set to 00:15:17:C8:90:28

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
dhcp
-> e
-> cmd sysvar set -co ipdhcpc.if.gei0.informatioxit
Au revoir!
Connection closed by foreign host.
n_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.14: Passed

>> DHCP-CLIENT-5.15
TEST_DESCRIPTION
If the client used a 'client identifier' when it obtained the lease, it
MUST use the same 'client identifier' in the DHCPRELEASE message
If the client supplies a 'client identifier', the client MUST use the
same 'client identifier' in all subsequent messages
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
RFC 2131 Section 4.2 Page 26 'DHCP server administrative controls'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 61 (Client-identifier Option)
        with value "CONFORMANCE-DUT-0" for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to SELECTING
-  DUT: Transit finite state to SELECTING
- ANVL: Extracts the content of 61 (Client-identifier Option) to
        <extractedClientID>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - Message Option containing extractedClientID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:35 mcast:0 errors:0 dropped:28
	TX packets:95 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:9674  TX bytes:24318 (24 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2544  lo0    0    
128.224.166.0/23                vxTarget                      UC       3880  gei2   0    
vxTarget                        vxTarget                      UH       9336  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       374540lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Client-identifier with value
"CONFORMANCE-DUT-0" on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 61 "CONFORMANCE-DUT-0"

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.client_identifier ""CONFORMANCE-DUT-0""
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0 ok
-> cmd sysvar get ipdhcpc.option.client_identifier
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6203 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3778202048 (0xE132C9C0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D98 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x38DA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3778202048 (0xE132C9C0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to SELECTING state

Extracted the content of 61 (Client-identifier Option) (
Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30) to <extractedClientID>

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x402F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3778202048 (0xE132C9C0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D97 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x35DA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3778202048 (0xE132C9C0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA155 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3778202048 (0xE132C9C0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Message Option in received DHCPRELEASE Message correctly contains Option Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
-> ex
-> cmd sysvar set -co ipdhcpc.if.gei0.informatioit
Au revoir!
Connection closed by foreign host.
n_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.15: Passed

>> DHCP-CLIENT-6.1
TEST_DESCRIPTION
If the client receives neither a DHCPACK or a DHCPNAK message after
employing the retransmission algorithm, the client reverts to INIT state
and restarts the initialization process
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till <ParamProcessTime> for DUT to stabilize in BOUND
        state
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
- ANVL:DHCP Server <SERVER-1> Listens (upto (130 + 10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
(Note: We have derived 130 seconds keeping in mind the total retransmission
        time in RFC 2131 Section 4.1 Page 24)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:37 mcast:0 errors:0 dropped:30
	TX packets:98 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:10318 (10 k)  TX bytes:25344 (25 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2552  lo0    0    
128.224.166.0/23                vxTarget                      UC       3885  gei2   0    
vxTarget                        vxTarget                      UH       9449  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       378680lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB71A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D96 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0CEF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8745 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D95 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x09EF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to stabilize in BOUND state
xit
Au revoir!
Connection closed by foreign host.

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8CB1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8CAD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Listening (up to 160.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8CA5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8C95 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8C75 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2675095145 (0x9F72B669)
DHCP: secs                      = 60
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2B24 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3705920645 (0xDCE3DC85)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.1: Passed

>> DHCP-CLIENT-6.2
TEST_DESCRIPTION
If a client remembers and wishes to reuse a previously allocated
network address, a client may choose to omit some of the steps
described in the previous section
TEST_REFERENCE
RFC 2131 Section 3.2 Page 17
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till <ParamProcessTime> for DUT to stabilize in BOUND
        state
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:39 mcast:0 errors:0 dropped:32
	TX packets:119 mcast:12 errors:0
	collisions:0 unsupported proto:0
	RX bytes:10962 (10 k)  TX bytes:28950 (28 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2560  lo0    0    
128.224.166.0/23                vxTarget                      UC       3922  gei2   0    
vxTarget                        vxTarget                      UH       9538  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       382508lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x188D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2524601839 (0x967A5DEF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D94 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xEF63 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2524601839 (0x967A5DEF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF6B8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2524601839 (0x967A5DEF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D93 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xEC63 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2524601839 (0x967A5DEF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to stabilize in BOUND state
xit
Au revoir!
Connection closed by foreign host.

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFC24 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2524601839 (0x967A5DEF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.2: Passed

>> DHCP-CLIENT-6.4
TEST_DESCRIPTION
If a client remembers and wishes to reuse a previously allocated
network address, ... .The message includes the client's network address
in the 'requested IP address' option
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:41 mcast:0 errors:0 dropped:34
	TX packets:136 mcast:19 errors:0
	collisions:0 unsupported proto:0
	RX bytes:11606 (11 k)  TX bytes:30888 (30 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2568  lo0    0    
128.224.166.0/23                vxTarget                      UC       3934  gei2   0    
vxTarget                        vxTarget                      UH       9627  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       386128lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC870 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2465378707 (0x92F2B193)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D92 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9F47 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2465378707 (0x92F2B193)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA69C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2465378707 (0x92F2B193)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D91 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9C47 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2465378707 (0x92F2B193)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAC08 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2465378707 (0x92F2B193)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.4: Passed

>> DHCP-CLIENT-6.5
TEST_DESCRIPTION
As the client has not received its network address, it MUST NOT fill in
the 'ciaddr' field
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:43 mcast:0 errors:0 dropped:36
	TX packets:152 mcast:26 errors:0
	collisions:0 unsupported proto:0
	RX bytes:12250 (12 k)  TX bytes:32784 (32 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2576  lo0    0    
128.224.166.0/23                vxTarget                      UC       3945  gei2   0    
vxTarget                        vxTarget                      UH       9717  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       389744lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5DC2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1185769607 (0x46AD6887)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D90 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3499 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1185769607 (0x46AD6887)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3BEE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1185769607 (0x46AD6887)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3199 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1185769607 (0x46AD6887)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x415A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1185769607 (0x46AD6887)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.5: Passed

>> DHCP-CLIENT-6.6
TEST_DESCRIPTION
If the client used a 'client identifier' to obtain its
address, the client MUST use the same 'client identifier' in the
If the client supplies a 'client identifier', the client MUST use the
same 'client identifier' in all subsequent messages
DHCPREQUEST message
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
RFC 2131 Section 4.2 Page 26 'DHCP server administrative controls'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 61 (Client-identifier Option)
        with value "CONFORMANCE-DUT-0" for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 61 (Client-identifier Option) to
        <extractedClientID>
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing extractedClientID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:45 mcast:0 errors:0 dropped:38
	TX packets:168 mcast:33 errors:0
	collisions:0 unsupported proto:0
	RX bytes:12894 (12 k)  TX bytes:34680 (34 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2584  lo0    0    
128.224.166.0/23                vxTarget                      UC       3956  gei2   0    
vxTarget                        vxTarget                      UH       9806  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       393388lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Client-identifier with value
"CONFORMANCE-DUT-0" on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 61 "CONFORMANCE-DUT-0"

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.client_identifier ""CONFORMANCE-DUT-0""
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0 ok
-> cmd sysvar get ipdhcpc.option.client_identifier
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3716 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2264026862 (0x86F24EEE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0DED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2264026862 (0x86F24EEE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1542 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2264026862 (0x86F24EEE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0AED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2264026862 (0x86F24EEE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 61 (Client-identifier Option) (
Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30) to <extractedClientID>

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1AAE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2264026862 (0x86F24EEE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.6: Passed

>> DHCP-CLIENT-6.8
TEST_DESCRIPTION
If the client receives a DHCPNAK message, it cannot reuse its
remembered network address.  It must instead request a new
address by restarting the configuration process, this time
using the (non-abbreviated) procedure described in section 3.1
TEST_REFERENCE
RFC 2131 Section 3.2 Page 19
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:47 mcast:0 errors:0 dropped:40
	TX packets:184 mcast:40 errors:0
	collisions:0 unsupported proto:0
	RX bytes:13538 (13 k)  TX bytes:36576 (36 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2592  lo0    0    
128.224.166.0/23                vxTarget                      UC       3967  gei2   0    
vxTarget                        vxTarget                      UH       9912  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       397524lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x916E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3455626639 (0xCDF8AD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6845 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3455626639 (0xCDF8AD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6F9A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3455626639 (0xCDF8AD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6545 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3455626639 (0xCDF8AD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7506 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3455626639 (0xCDF8AD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x43AA (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0xA381 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3455626639 (0xCDF8AD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5C41 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2939152157 (0xAF2FE71D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.8: Passed

>> DHCP-CLIENT-7.1
TEST_DESCRIPTION
If a client has obtained a network address through some other means
(e.g., manual configuration), it may use a DHCPINFORM request message
to obtain other local configuration parameters
TEST_REFERENCE
RFC 2131 Section 3.4 Page 20
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <IP-UNUSED-ADDRESS> with mask
        <IP-UNUSED-NET-MASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:50 mcast:0 errors:0 dropped:42
	TX packets:201 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14474 (14 k)  TX bytes:38814 (38 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2600  lo0    0    
128.224.166.0/23                vxTarget                      UC       3980  gei2   0    
vxTarget                        vxTarget                      UH       10002 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       401284lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 56.0.0.1 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 56.0.0.1 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 56.0.0.1 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x01A5 (Correct)
IP: Source Address         = 56.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x657A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1693518776 (0x64F10BB8)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 56.0.0.1
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Deleting IP Address 56.0.0.1 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 56.0.0.1 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 56.0.0.1 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-7.1: Passed

>> DHCP-CLIENT-8.2
TEST_DESCRIPTION
First, most of the parameters have defaults defined in the Host
Requirements RFCs; if the client receives no parameters from the server
that override the defaults, a client uses those default values
(Note: This test checks that if default value is overridden,
       DUT uses the overridden value for Time To Live)
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to <ParamLeaseTime>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to <ParamLeaseTime>
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:50 mcast:0 errors:0 dropped:42
	TX packets:207 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14474 (14 k)  TX bytes:39366 (39 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2616  lo0    0    
128.224.166.0/23                vxTarget                      UC       3988  gei2   0    
vxTarget                        vxTarget                      UH       10112 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       405682lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9690 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1150628305 (0x449531D1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_IP_ADDRESS_LEASE_TIME (IP Address Lease Time) 
  - Length field set to 4 (4) 
  - Value set to <ParamLeaseTime> (80 seconds (1 minute 20 seconds)) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D89 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8E46 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1150628305 (0x449531D1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x74BC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1150628305 (0x449531D1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 80 seconds (1 minute 20 seconds) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.2: Passed

>> DHCP-CLIENT-8.3
TEST_DESCRIPTION
If the client includes a list of parameters in a DHCPDISCOVER
message, it MUST include that list in any subsequent DHCPREQUEST
messages.
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 55 (Parameter Request List Option)
        to <extractedParamReq>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing extractedParamReq
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:51 mcast:0 errors:0 dropped:43
	TX packets:210 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14796 (14 k)  TX bytes:40392 (40 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2624  lo0    0    
128.224.166.0/23                vxTarget                      UC       3992  gei2   0    
vxTarget                        vxTarget                      UH       10196 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       409528lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0EFD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 301132807 (0x11F2EC07)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
Extracted the content of 55 (Parameter Request List Option) (
Parameter Request List (55) Length : 4 Value : 
  1 = Subnet Mask
  6 = Domain Name Server
 28 = Broadcast Address
 42 = Network Time Protocol Servers
) to <extractedParamReq>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D88 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE5D3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 301132807 (0x11F2EC07)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xED28 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 301132807 (0x11F2EC07)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Parameter Request List (55) Length : 4 Value : 
  1 = Subnet Mask
  6 = Domain Name Server
 28 = Broadcast Address
 42 = Network Time Protocol Servers
 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.3: Passed

>> DHCP-CLIENT-8.4
TEST_DESCRIPTION
The client SHOULD include the 'maximum DHCP message size' option to
let the server know how large the server may make its DHCP messages
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 57 (Maximum DHCP Size Option)
        with value 600 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 57 (Maximum DHCP Size Option)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:213 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:41418 (41 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2632  lo0    0    
128.224.166.0/23                vxTarget                      UC       3996  gei2   0    
vxTarget                        vxTarget                      UH       10269 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       412996lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Maximum DHCP Size with value
600 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 57 600

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.max_message_size "600"
sysvar: ipdhcpc.option.max_message_size=600 ok
-> cmd sysvar get ipdhcpc.option.max_message_size
sysvar: ipdhcpc.option.max_message_size=600
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7DE3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2352087777 (0x8C3202E1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option Maximum DHCP Size (57) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.4: Passed

>> DHCP-CLIENT-8.5
TEST_DESCRIPTION
In addition, the client may suggest values for the network address
and lease time in the DHCPDISCOVER message.  The client may ... include
the 'IP address lease time' option to suggest the lease time it would
like
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 51 (IP Address Lease Time
        Option)
        with value 60 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 60
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:214 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:41760 (41 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2640  lo0    0    
128.224.166.0/23                vxTarget                      UC       4000  gei2   0    
vxTarget                        vxTarget                      UH       10351 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       416508lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option IP Address Lease Time with value
60 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 51 60

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time
sysvar: ipdhcpc.option.lease_time=60
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x223C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1377999000 (0x52229898)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 60 seconds (1 minute ) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.5: Passed

>> DHCP-CLIENT-9.1
TEST_DESCRIPTION
A client with multiple network interfaces must use DHCP through each
interface independently to obtain configuration information
parameters for those separate interfaces
TEST_REFERENCE
RFC 2131 Section 3.6 Page 22 
'Use of DHCP in clients with multiple interfaces'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP Client on <DIface-1>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'chaddr' field to <extractedChaddr>
- ANVL: Externally cause DUT to bring up <DIface-1>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-1>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'chaddr' field is not set to extractedChaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


  DHCP Client topology # 2
  ---------------------------------------

  +----------------+                          +----------------+
  |                |<AIface-0>      <DIface-0>|                |
  |             N0 +--------------------------+ N0             |
  |                |                          |                |
  |             N1 +--------------------------+ N1             |
  | <SERVER-1>     |<AIface-1>      <DIface-1>|           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:215 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:42102 (42 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2648  lo0    0    
128.224.166.0/23                vxTarget                      UC       4001  gei2   0    
vxTarget                        vxTarget                      UH       10453 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       420828lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1
gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:24
	RX packets:1 mcast:0 errors:0 dropped:1
	TX packets:8 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:322  TX bytes:1464

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2648  lo0    0    
128.224.166.0/23                vxTarget                      UC       4001  gei2   0    
vxTarget                        vxTarget                      UH       10453 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       420828lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4EC9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2176662640 (0x81BD3C70)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'chaddr' field (00:15:17:C8:90:28) to <extractedChaddr>

Booting up DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-1>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei1 -dhcp
-> cmd ifconfig gei1 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCBAB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4192356199 (0xF9E24767)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:29
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-1>

'chaddr' field in received DHCPDISCOVER Message is correctly set to 00:15:17:C8:90:29 (not set to 00:15:17:C8:90:28)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei1 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-9.1: Passed

>> DHCP-CLIENT-10.1
TEST_DESCRIPTION
A client SHOULD use DHCP to reacquire or verify its IP address and
network parameters whenever the local network parameters may have
changed; e.g., at system boot time
TEST_REFERENCE
RFC 2131 Section 3.7 Page 22 'When clients should use DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-2> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
          - Length field is not set to 4
          - Value is not set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


  DHCP Client topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <SERVER-2>     |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:217 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:42786 (42 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2664  lo0    0    
128.224.166.0/23                vxTarget                      UC       4001  gei2   0    
vxTarget                        vxTarget                      UH       10583 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       427232lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAB62 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1626013865 (0x60EB00A9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D86 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8237 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1626013865 (0x60EB00A9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x888E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1626013865 (0x60EB00A9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.3
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D85 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7F37 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1626013865 (0x60EB00A9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4787 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2879330768 (0xAB9F19D0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-2> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:07
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D7F (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.7
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1D53 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2879330768 (0xAB9F19D0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.7
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1FB3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2879330768 (0xAB9F19D0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.7
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.7 
(not containing option Requested IP Address (50) Length : 4 Value : 54.0.0.3 )

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-10.1: Passed

>> DHCP-CLIENT-11.1
TEST_DESCRIPTION
The last option must always be the 'end' option
TEST_REFERENCE
RFC 2131 Section 4.1 Page 22-23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - 255 (End Option) at position Last
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:47
	TX packets:224 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16084 (16 k)  TX bytes:44880 (44 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2672  lo0    0    
128.224.166.0/23                vxTarget                      UC       4010  gei2   0    
vxTarget                        vxTarget                      UH       10702 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       431612lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7C0F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1946426595 (0x74041CE3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message is correctly set as  End Option (255) in position 5  

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
espawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.1: Passed

>> DHCP-CLIENT-11.2
TEST_DESCRIPTION
DHCP clients MUST use the IP address provided in the 'server identifier'
option for any unicast requests to the DHCP server
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:47
	TX packets:225 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16084 (16 k)  TX bytes:45222 (45 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2680  lo0    0    
128.224.166.0/23                vxTarget                      UC       4010  gei2   0    
vxTarget                        vxTarget                      UH       10764 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       434892lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD1D9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2712508783 (0xA1AD996F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D84 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA8B0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2712508783 (0xA1AD996F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB005 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2712508783 (0xA1AD996F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D83 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA5B0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2712508783 (0xA1AD996F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x31B4 (12724)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xDBEE (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x19D4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2712508783 (0xA1AD996F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 54.0.0.1

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.2: Passed

>> DHCP-CLIENT-11.3
TEST_DESCRIPTION
DHCP messages broadcast by a client prior to that client obtaining
its IP address must have the source address field in the IP header
set to 0
(Note: This test verifies source IP address field of DHCPDISCOVER
 Message)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Source IP Address field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:58 mcast:0 errors:0 dropped:49
	TX packets:235 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16788 (16 k)  TX bytes:46842 (46 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2688  lo0    0    
128.224.166.0/23                vxTarget                      UC       4027  gei2   0    
vxTarget                        vxTarget                      UH       10848 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       438812lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4E39 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2747996914 (0xA3CB1AF2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Source IP Address field in received DHCPDISCOVER Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.3: Passed

>> DHCP-CLIENT-11.4
TEST_DESCRIPTION
DHCP messages broadcast by a client prior to that client obtaining
its IP address must have the source address field in the IP header
set to 0
(Note: This test verifies source IP address field of DHCPREQUEST
 Message)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Source IP Address field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:58 mcast:0 errors:0 dropped:49
	TX packets:236 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16788 (16 k)  TX bytes:47184 (47 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2696  lo0    0    
128.224.166.0/23                vxTarget                      UC       4027  gei2   0    
vxTarget                        vxTarget                      UH       10922 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       442320lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x642D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4240747524 (0xFCC4AC04)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D82 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3B04 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4240747524 (0xFCC4AC04)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4259 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4240747524 (0xFCC4AC04)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Source IP Address field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.4: Passed

>> DHCP-CLIENT-11.5
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly parses 'sname' field when
       Option Overload is present and set to 'sname contains options')
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:59 mcast:0 errors:0 dropped:50
	TX packets:239 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:17110 (17 k)  TX bytes:48210 (48 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2704  lo0    0    
128.224.166.0/23                vxTarget                      UC       4033  gei2   0    
vxTarget                        vxTarget                      UH       10993 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       444804lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBB45 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 913644348 (0x36751B3C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C75 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xCA54 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 913644348 (0x36751B3C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9971 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 913644348 (0x36751B3C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C74 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xCA51 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 913644348 (0x36751B3C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2712  lo0    0    
128.224.166.0/23                vxTarget                      UC       4034  gei2   0    
vxTarget                        vxTarget                      UH       11038 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       448428lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xABAA (43946)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6108 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x935E (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xD1F8 (53752)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.5: Passed

>> DHCP-CLIENT-11.6
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly parses 'file' field when
       Option Overload is present and set to 'file contains options')
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:62 mcast:0 errors:0 dropped:52
	TX packets:248 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:18350 (18 k)  TX bytes:49532 (49 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2720  lo0    0    
128.224.166.0/23                vxTarget                      UC       4045  gei2   0    
vxTarget                        vxTarget                      UH       11110 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       451230lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x20C8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3287492667 (0xC3F3283B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C73 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x30D7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3287492667 (0xC3F3283B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFEF3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3287492667 (0xC3F3283B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C72 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x30D4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3287492667 (0xC3F3283B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2720  lo0    0    
128.224.166.0/23                vxTarget                      UC       4049  gei2   0    
vxTarget                        vxTarget                      UH       11138 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       453740lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

! DHCP Server <SERVER-1> did not receive expected

! ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.6: !FAILED!

>> DHCP-CLIENT-11.8
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly does not parse 'file' field 
       as Options when Option Overload is not present)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)(*INVALID*)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)(*INVALID*)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:64 mcast:0 errors:0 dropped:54
	TX packets:256 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:19530 (19 k)  TX bytes:50468 (50 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2728  lo0    0    
128.224.166.0/23                vxTarget                      UC       4061  gei2   0    
vxTarget                        vxTarget                      UH       11211 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       456842lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC200 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 140788370 (0x08644292)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C71 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xD20F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 140788370 (0x08644292)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA02C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 140788370 (0x08644292)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C70 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xD20C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 140788370 (0x08644292)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2728  lo0    0    
128.224.166.0/23                vxTarget                      UC       4066  gei2   0    
vxTarget                        vxTarget                      UH       11235 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       459114lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xAEF4 (44788)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x5DBE (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x782B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xED2B (60715)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:67 mcast:0 errors:0 dropped:56
	TX packets:265 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:20770 (20 k)  TX bytes:51790 (51 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       4071  gei2   0    
vxTarget                        vxTarget                      UH       11306 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       461838lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE9B8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2167579147 (0x8132A20B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x8671 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2167579147 (0x8132A20B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 6
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC7E4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2167579147 (0x8132A20B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x8371 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2167579147 (0x8132A20B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 6
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       4075  gei2   0    
vxTarget                        vxTarget                      UH       11334 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       464340lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.8: Passed

>> DHCP-CLIENT-11.9
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
by the 'options overload' option) MUST begin with the first octet of
the field
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'sname' field when 1st octet is not the
       start of the option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:69 mcast:0 errors:0 dropped:58
	TX packets:273 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:21950 (21 k)  TX bytes:52726 (52 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       4085  gei2   0    
vxTarget                        vxTarget                      UH       11389 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       467248lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x171F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2854636465 (0xAA264BB1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x262E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2854636465 (0xAA264BB1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF54A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2854636465 (0xAA264BB1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x262B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2854636465 (0xAA264BB1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2744  lo0    0    
128.224.166.0/23                vxTarget                      UC       4088  gei2   0    
vxTarget                        vxTarget                      UH       11433 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       469660lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x0510 (1296)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x07A3 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x1B48 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4A0F (18959)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:72 mcast:0 errors:0 dropped:60
	TX packets:282 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:23190 (23 k)  TX bytes:54048 (54 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2752  lo0    0    
128.224.166.0/23                vxTarget                      UC       4094  gei2   0    
vxTarget                        vxTarget                      UH       11504 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       472474lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6848 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2779447043 (0xA5AAFF03)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xA925 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2779447043 (0xA5AAFF03)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4674 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2779447043 (0xA5AAFF03)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xA922 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2779447043 (0xA5AAFF03)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2752  lo0    0    
128.224.166.0/23                vxTarget                      UC       4097  gei2   0    
vxTarget                        vxTarget                      UH       11532 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       475004lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.9: Passed

>> DHCP-CLIENT-11.10
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated ...
MUST be terminated by an 'end' option
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'sname' field in absence of 'end' option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:74 mcast:0 errors:0 dropped:62
	TX packets:290 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:24370 (24 k)  TX bytes:54984 (54 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2752  lo0    0    
128.224.166.0/23                vxTarget                      UC       4106  gei2   0    
vxTarget                        vxTarget                      UH       11587 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       478092lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8E45 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3495734868 (0xD05CAE54)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C69 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x9D54 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3495734868 (0xD05CAE54)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6C71 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3495734868 (0xD05CAE54)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C68 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x9D51 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3495734868 (0xD05CAE54)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2760  lo0    0    
128.224.166.0/23                vxTarget                      UC       4108  gei2   0    
vxTarget                        vxTarget                      UH       11630 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       480572lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x9CF0 (40176)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x6FC2 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xC226 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xA330 (41776)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:77 mcast:0 errors:0 dropped:64
	TX packets:299 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:25610 (25 k)  TX bytes:56306 (56 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2768  lo0    0    
128.224.166.0/23                vxTarget                      UC       4115  gei2   0    
vxTarget                        vxTarget                      UH       11702 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       483306lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDE54 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3482017558 (0xCF8B5F16)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C67 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xEC64 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3482017558 (0xCF8B5F16)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBC80 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3482017558 (0xCF8B5F16)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C66 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xEC61 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3482017558 (0xCF8B5F16)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2768  lo0    0    
128.224.166.0/23                vxTarget                      UC       4117  gei2   0    
vxTarget                        vxTarget                      UH       11730 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       485788lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.10: Passed

>> DHCP-CLIENT-11.11
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated ...
MUST be terminated by an 'end' option
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'file' field in absence of 'end' option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:79 mcast:0 errors:0 dropped:66
	TX packets:307 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:26790 (26 k)  TX bytes:57242 (57 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2768  lo0    0    
128.224.166.0/23                vxTarget                      UC       4130  gei2   0    
vxTarget                        vxTarget                      UH       11785 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       488724lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBC07 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3471475204 (0xCEEA8204)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C65 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xCC16 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3471475204 (0xCEEA8204)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9A33 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3471475204 (0xCEEA8204)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C64 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xCC13 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3471475204 (0xCEEA8204)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2776  lo0    0    
128.224.166.0/23                vxTarget                      UC       4135  gei2   0    
vxTarget                        vxTarget                      UH       11828 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       491108lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x1BCF (7119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xF0E3 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x899B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xDBBB (56251)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:82 mcast:0 errors:0 dropped:68
	TX packets:317 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:28030 (28 k)  TX bytes:58606 (58 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2784  lo0    0    
128.224.166.0/23                vxTarget                      UC       4139  gei2   0    
vxTarget                        vxTarget                      UH       11899 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       493410lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x03BD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4274784877 (0xFECC0A6D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C63 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x12CD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4274784877 (0xFECC0A6D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE1E8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4274784877 (0xFECC0A6D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C62 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x12CA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4274784877 (0xFECC0A6D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2784  lo0    0    
128.224.166.0/23                vxTarget                      UC       4144  gei2   0    
vxTarget                        vxTarget                      UH       11928 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       496236lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.11: Passed

>> DHCP-CLIENT-11.12
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
 ...)
and MUST be followed by 'pad' options to fill the remainder of the field
(Note: This test is done using the 'sname' field only)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:84 mcast:0 errors:0 dropped:70
	TX packets:325 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:29210 (29 k)  TX bytes:59542 (59 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2784  lo0    0    
128.224.166.0/23                vxTarget                      UC       4151  gei2   0    
vxTarget                        vxTarget                      UH       11983 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       499276lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6339 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 467242468 (0x1BD98DE4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D6A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x745A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 467242468 (0x1BD98DE4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4165 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 467242468 (0x1BD98DE4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D69 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x7457 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 467242468 (0x1BD98DE4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2792  lo0    0    
128.224.166.0/23                vxTarget                      UC       4152  gei2   0    
vxTarget                        vxTarget                      UH       12026 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       501668lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x5895 (22677)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xB41D (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xE38C (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x81CA (33226)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:87 mcast:0 errors:0 dropped:72
	TX packets:335 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:29920 (29 k)  TX bytes:60906 (60 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2800  lo0    0    
128.224.166.0/23                vxTarget                      UC       4160  gei2   0    
vxTarget                        vxTarget                      UH       12097 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       503424lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCE35 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2862453795 (0xAA9D9423)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION(*INVALID*)     (End Option) 
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D68 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0xE055 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2862453795 (0xAA9D9423)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAC61 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2862453795 (0xAA9D9423)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION(*INVALID*)     (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D67 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0xE052 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2862453795 (0xAA9D9423)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2800  lo0    0    
128.224.166.0/23                vxTarget                      UC       4161  gei2   0    
vxTarget                        vxTarget                      UH       12125 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       506864lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.12: Passed

>> DHCP-CLIENT-11.13
TEST_DESCRIPTION
The retransmission delay SHOULD be doubled with subsequent
retransmissions up to a maximum of 64 seconds
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (64 + 32 + 16 + 8 + 4 +
       2 + 1 + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends  DHCPDISCOVER Message(s)
- ANVL: Verify that the time interval between
        reception of last two DHCPDISCOVER Messages
         is less than 
        (64  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:89 mcast:0 errors:0 dropped:74
	TX packets:343 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:30570 (30 k)  TX bytes:61842 (61 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2800  lo0    0    
128.224.166.0/23                vxTarget                      UC       4171  gei2   0    
vxTarget                        vxTarget                      UH       12180 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       509956lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 147.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x39C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1873372042 (0x6FA9638A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x39BF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1873372042 (0x6FA9638A)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x39B7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1873372042 (0x6FA9638A)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x39A7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1873372042 (0x6FA9638A)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3987 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1873372042 (0x6FA9638A)
DHCP: secs                      = 60
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected  DHCPDISCOVER Messages from <DIface-0>

Time interval (32.052 sec) between
reception of last two DHCPDISCOVER Messages 
is correctly  is less than 
(64  +  <ParamToleranceTime>) second (less than 84.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.13: Passed

>> DHCP-CLIENT-11.14
TEST_DESCRIPTION
The client MUST adopt a retransmission strategy that incorporates a
randomized exponential backoff algorithm to determine the delay
between retransmissions
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Listen (for upto (3 *
        (<ParamFirstRetransmissionInterval> + <ParamToleranceTime>)) seconds)
        on <DIface-0>
-  DUT: Send multiple DHCPDISCOVER Messages
- ANVL: Verify that the time interval between
        reception of 3rd last DHCPDISCOVER Message and second last
         DHCPDISCOVER Message
         is within the range of 
        (<ParamFirstRetransmissionInterval>  -  1) to
        (<ParamFirstRetransmissionInterval>  +  1seconds
- ANVL: Verify that the time interval between
        reception of last two DHCPDISCOVER Messages
         is within the range of 
        ((2*<ParamFirstRetransmissionInterval>)  -  1) to
        ((2*<ParamFirstRetransmissionInterval>)  +  1seconds
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:89 mcast:0 errors:0 dropped:74
	TX packets:348 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:30570 (30 k)  TX bytes:63552 (63 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2808  lo0    0    
128.224.166.0/23                vxTarget                      UC       4198  gei2   0    
vxTarget                        vxTarget                      UH       12252 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       513268lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 72.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC08D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 661595386 (0x276F24FA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC089 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 661595386 (0x276F24FA)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC081 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 661595386 (0x276F24FA)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER
 Messages from <DIface-0>

Time interval (3.923 sec) between
reception of 3dr last DHCPDISCOVER Message and second last
 DHCPDISCOVER Message 
is correctly  is within the range of 
(<ParamFirstRetransmissionInterval>  - 1) to
(<ParamFirstRetransmissionInterval>  + 1) seconds (3.000 to 5.000 sec)

Time interval (8.000 sec) between
reception of last two DHCPDISCOVER Messages 
is correctly  is within the range of 
((2*<ParamFirstRetransmissionInterval>) - 1) to
((2*<ParamFirstRetransmissionInterval>) + 1) seconds (7.000 to 9.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.14: Passed

>> DHCP-CLIENT-11.15
TEST_DESCRIPTION
For example, a client may choose a different, random initial 'xid'
each time the client is rebooted,
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 'xid' field to <extractedXID>
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'xid' field is not set to extractedXID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:89 mcast:0 errors:0 dropped:74
	TX packets:351 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:30570 (30 k)  TX bytes:64578 (64 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2816  lo0    0    
128.224.166.0/23                vxTarget                      UC       4203  gei2   0    
vxTarget                        vxTarget                      UH       12324 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       516892lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBB9B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4223423902 (0xFBBC559E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D69 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9272 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4223423902 (0xFBBC559E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x99C7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4223423902 (0xFBBC559E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D68 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8F72 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4223423902 (0xFBBC559E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 'xid' field (0xFBBC559E) to <extractedXID>

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2599 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1353160374 (0x50A796B6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

'xid' field in received DHCPDISCOVER Message is correctly set to 1353160374 (0x50A796B6) (not set to 4223423902 (0xFBBC559E))

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.15: Passed

>> DHCP-CLIENT-12.1
TEST_DESCRIPTION
Client inserts ... , 'ciaddr' MUST be zero
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:91 mcast:0 errors:0 dropped:76
	TX packets:355 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31214 (31 k)  TX bytes:65946 (65 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2824  lo0    0    
128.224.166.0/23                vxTarget                      UC       4207  gei2   0    
vxTarget                        vxTarget                      UH       12428 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       520712lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x090E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 232650251 (0x0DDDF60B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D67 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xDFE4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 232650251 (0x0DDDF60B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE739 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 232650251 (0x0DDDF60B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.1: Passed

>> DHCP-CLIENT-12.2
TEST_DESCRIPTION
requested IP address' MUST be filled in with the yiaddr value from the
chosen DHCPOFFER.
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'yiaddr' field set to <SERVER1-IP-POOL-0-1>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:92 mcast:0 errors:0 dropped:77
	TX packets:358 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31536 (31 k)  TX bytes:66972 (66 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2832  lo0    0    
128.224.166.0/23                vxTarget                      UC       4213  gei2   0    
vxTarget                        vxTarget                      UH       12500 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       524420lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5DCC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1087925842 (0x40D86E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'yiaddr' field set to <SERVER1-IP-POOL-0-1> (54.0.0.3) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D66 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x34A2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1087925842 (0x40D86E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3AF8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1087925842 (0x40D86E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.3
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.3 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.2: Passed

>> DHCP-CLIENT-12.3
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:93 mcast:0 errors:0 dropped:78
	TX packets:361 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31858 (31 k)  TX bytes:67998 (67 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2840  lo0    0    
128.224.166.0/23                vxTarget                      UC       4216  gei2   0    
vxTarget                        vxTarget                      UH       12573 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       527840lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBC69 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4213069166 (0xFB1E556E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D65 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9340 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4213069166 (0xFB1E556E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9A95 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4213069166 (0xFB1E556E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D64 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9040 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4213069166 (0xFB1E556E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA001 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4213069166 (0xFB1E556E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.3: Passed

>> DHCP-CLIENT-12.4
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'requested IP address' option MUST be filled in with client's notion
  of its previously assigned address.
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:95 mcast:0 errors:0 dropped:80
	TX packets:377 mcast:54 errors:0
	collisions:0 unsupported proto:0
	RX bytes:32502 (32 k)  TX bytes:69894 (69 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2848  lo0    0    
128.224.166.0/23                vxTarget                      UC       4225  gei2   0    
vxTarget                        vxTarget                      UH       12662 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       531340lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC4AD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3411180790 (0xCB527CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D63 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9B84 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3411180790 (0xCB527CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA2D9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3411180790 (0xCB527CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D62 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9884 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3411180790 (0xCB527CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA845 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3411180790 (0xCB527CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.4: Passed

>> DHCP-CLIENT-12.5
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'ciaddr' MUST be zero
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:97 mcast:0 errors:0 dropped:82
	TX packets:393 mcast:61 errors:0
	collisions:0 unsupported proto:0
	RX bytes:33146 (33 k)  TX bytes:71790 (71 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2856  lo0    0    
128.224.166.0/23                vxTarget                      UC       4235  gei2   0    
vxTarget                        vxTarget                      UH       12750 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       534592lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1045 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2996062749 (0xB2944A1D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D61 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE71B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2996062749 (0xB2944A1D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEE70 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2996062749 (0xB2944A1D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D60 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE41B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2996062749 (0xB2944A1D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF3DC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2996062749 (0xB2944A1D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.5: Passed

>> DHCP-CLIENT-12.6
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:99 mcast:0 errors:0 dropped:84
	TX packets:408 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:33790 (33 k)  TX bytes:73644 (73 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2864  lo0    0    
128.224.166.0/23                vxTarget                      UC       4244  gei2   0    
vxTarget                        vxTarget                      UH       12842 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       538552lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5F3E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 401839557 (0x17F395C5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3615 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 401839557 (0x17F395C5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3D6A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 401839557 (0x17F395C5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3315 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 401839557 (0x17F395C5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xB0BA (45242)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5CE8 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA738 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 401839557 (0x17F395C5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.6: Passed

>> DHCP-CLIENT-12.7
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  'requested IP address' option MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:102 mcast:0 errors:0 dropped:86
	TX packets:418 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:34494 (34 k)  TX bytes:75264 (75 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2872  lo0    0    
128.224.166.0/23                vxTarget                      UC       4258  gei2   0    
vxTarget                        vxTarget                      UH       12915 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       541972lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x83EF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1172063019 (0x45DC432B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5AC6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1172063019 (0x45DC432B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x621B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1172063019 (0x45DC432B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x57C6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1172063019 (0x45DC432B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x8F87 (36743)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7E1B (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCBE9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1172063019 (0x45DC432B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Requested IP Address (50) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.7: Passed

>> DHCP-CLIENT-12.8
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  ciaddr' MUST be filled in with client's IP address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:105 mcast:0 errors:0 dropped:88
	TX packets:428 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:35198 (35 k)  TX bytes:76884 (76 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2880  lo0    0    
128.224.166.0/23                vxTarget                      UC       4274  gei2   0    
vxTarget                        vxTarget                      UH       12988 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       545516lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7EE7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 380991322 (0x16B5775A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x55BE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 380991322 (0x16B5775A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5D13 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 380991322 (0x16B5775A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x52BE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 380991322 (0x16B5775A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x4F18 (20248)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xBE8A (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC6E1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 380991322 (0x16B5775A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 54.0.0.2

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.8: Passed

>> DHCP-CLIENT-12.9
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:108 mcast:0 errors:0 dropped:90
	TX packets:438 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:35902 (35 k)  TX bytes:78504 (78 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2888  lo0    0    
128.224.166.0/23                vxTarget                      UC       4286  gei2   0    
vxTarget                        vxTarget                      UH       13062 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       549060lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3041 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3526232711 (0xD22E0A87)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D59 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0718 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3526232711 (0xD22E0A87)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0E6D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3526232711 (0xD22E0A87)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D58 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0418 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3526232711 (0xD22E0A87)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAE3C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3526232711 (0xD22E0A87)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.9: Passed

>> DHCP-CLIENT-12.10
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'requested IP address' option MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:111 mcast:0 errors:0 dropped:92
	TX packets:449 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:36606 (36 k)  TX bytes:80466 (80 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2896  lo0    0    
128.224.166.0/23                vxTarget                      UC       4308  gei2   0    
vxTarget                        vxTarget                      UH       13133 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       551790lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5443 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2934639048 (0xAEEB09C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D57 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2B1A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2934639048 (0xAEEB09C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x326F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2934639048 (0xAEEB09C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D56 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x281A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2934639048 (0xAEEB09C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD23E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2934639048 (0xAEEB09C8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Requested IP Address (50) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.10: Passed

>> DHCP-CLIENT-12.11
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'ciaddr' MUST be filled in with client's IP address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:114 mcast:0 errors:0 dropped:94
	TX packets:460 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:37310 (37 k)  TX bytes:82428 (82 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2904  lo0    0    
128.224.166.0/23                vxTarget                      UC       4328  gei2   0    
vxTarget                        vxTarget                      UH       13209 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       556436lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE3C5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1845607215 (0x6E01BB2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D55 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xBA9C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1845607215 (0x6E01BB2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC1F1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1845607215 (0x6E01BB2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D54 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB79C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1845607215 (0x6E01BB2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x61C1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1845607215 (0x6E01BB2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 54.0.0.2

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.11: Passed

>> DHCP-CLIENT-12.12
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  This message MUST be broadcast to the 0xffffffff IP broadcast address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:117 mcast:0 errors:0 dropped:96
	TX packets:471 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38014 (38 k)  TX bytes:84390 (84 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2912  lo0    0    
128.224.166.0/23                vxTarget                      UC       4348  gei2   0    
vxTarget                        vxTarget                      UH       13282 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       559764lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0E1D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1887931986 (0x70878E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exi
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D53 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE4F3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1887931986 (0x70878E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEC48 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1887931986 (0x70878E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D52 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE1F3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1887931986 (0x70878E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
t
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8C18 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1887931986 (0x70878E52)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.12: Passed

>> DHCP-CLIENT-13.1
TEST_DESCRIPTION
The client SHOULD wait a random time between one and ten seconds to
desynchronize the use of DHCP at startup
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the time interval between
        sending of last DHCPNAK Message and reception of last
         DHCPDISCOVER Message
         is greater than or equal to 
        (1  -  <ParamToleranceTime>) second
- ANVL: Verify that the time interval between
        sending of last DHCPNAK Message and reception of last
         DHCPDISCOVER Message
         is less than or equal to 
        (10  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:120 mcast:0 errors:0 dropped:98
	TX packets:482 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38718 (38 k)  TX bytes:86352 (86 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2920  lo0    0    
128.224.166.0/23                vxTarget                      UC       4364  gei2   0    
vxTarget                        vxTarget                      UH       13353 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       562800lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3CF1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3965838243 (0xEC61E3A3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D51 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x13C8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3965838243 (0xEC61E3A3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1B1D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3965838243 (0xEC61E3A3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D50 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x10C8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3965838243 (0xEC61E3A3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x077E (1918)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0625 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x84EB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3965838243 (0xEC61E3A3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x436F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0x4F04 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3965838243 (0xEC61E3A3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0529 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1962965093 (0x75007865)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Time interval (9.950 sec) between
sending of last DHCPNAK Message and reception of last DHCPDISCOVER Message 
is correctly  is greater than or equal to 
(1  -  <ParamToleranceTime>) second (greater than or equal to 0.000 sec)

Time interval (9.950 sec) between
sending of last DHCPNAK Message and reception of last DHCPDISCOVER Message 
is correctly  is less than or equal to 
(10  +  <ParamToleranceTime>) second (less than or equal to 30.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.1: Passed

>> DHCP-CLIENT-13.2
TEST_DESCRIPTION
The client begins in INIT state and forms a DHCPDISCOVER message ...
The client sets 'ciaddr' to 0x00000000
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:124 mcast:0 errors:0 dropped:100
	TX packets:492 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:39714 (39 k)  TX bytes:87972 (87 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2928  lo0    0    
128.224.166.0/23                vxTarget                      UC       4384  gei2   0    
vxTarget                        vxTarget                      UH       13426 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       566368lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0A82 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 34734179 (0x02120063)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

'ciaddr' field in received DHCPDISCOVER Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.2: Passed

>> DHCP-CLIENT-13.3
TEST_DESCRIPTION
The client begins in INIT state and forms a DHCPDISCOVER message ...
The client MUST include its hardware address in the 'chaddr' field
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of Source Harware Address field to
        <extractedSrcHwAddr>
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'chaddr' field is set to extractedSrcHwAddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:124 mcast:0 errors:0 dropped:100
	TX packets:493 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:39714 (39 k)  TX bytes:88314 (88 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2936  lo0    0    
128.224.166.0/23                vxTarget                      UC       4386  gei2   0    
vxTarget                        vxTarget                      UH       13501 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       570480lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB483 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2356988918 (0x8C7CCBF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of Source Harware Address field (00:15:17:C8:90:28) to <extractedSrcHwAddr>

'chaddr' field in received DHCPDISCOVER Message is correctly set to 00:15:17:C8:90:28

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.3: Passed

>> DHCP-CLIENT-13.4
TEST_DESCRIPTION
If the 'xid' of an arriving DHCPOFFER message does not match the
'xid' of the most recent DHCPDISCOVER message, the DHCPOFFER message
must be silently discarded
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to (extractedXID+1)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:124 mcast:0 errors:0 dropped:100
	TX packets:494 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:39714 (39 k)  TX bytes:88656 (88 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2944  lo0    0    
128.224.166.0/23                vxTarget                      UC       4387  gei2   0    
vxTarget                        vxTarget                      UH       13573 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       574168lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBC9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 583925343 (0x22CDFE5F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0x22CDFE5F) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to (extractedXID+1) (0x22CDFE60) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xC29F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 583925344 (0x22CDFE60)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for no DHCPREQUEST Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBC5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 583925343 (0x22CDFE5F)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBBD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 583925343 (0x22CDFE5F)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBAD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 583925343 (0x22CDFE5F)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> correctly did not receive DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.4: Passed

>> DHCP-CLIENT-13.5
TEST_DESCRIPTION
Any arriving DHCPACK messages must be silently discarded
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:125 mcast:0 errors:0 dropped:101
	TX packets:498 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40036 (40 k)  TX bytes:90024 (90 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2952  lo0    0    
128.224.166.0/23                vxTarget                      UC       4391  gei2   0    
vxTarget                        vxTarget                      UH       13618 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       576702lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE5CE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3955112809 (0xEBBE3B69)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB9A5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3955112809 (0xEBBE3B69)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for no DHCPREQUEST Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE5CA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3955112809 (0xEBBE3B69)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE5C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3955112809 (0xEBBE3B69)
DHCP: secs                      = 11
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE5B2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3955112809 (0xEBBE3B69)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> correctly did not receive DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.5: Passed

>> DHCP-CLIENT-13.6
TEST_DESCRIPTION
The DHCPREQUEST message contains the same 'xid' as the DHCPOFFER
message
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 38
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to extractedXID
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'xid' field is set to extractedXID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:126 mcast:0 errors:0 dropped:102
	TX packets:502 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40358 (40 k)  TX bytes:91392 (91 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2960  lo0    0    
128.224.166.0/23                vxTarget                      UC       4395  gei2   0    
vxTarget                        vxTarget                      UH       13719 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       581656lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAAF4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1396707010 (0x53400EC2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0x53400EC2) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to extractedXID (0x53400EC2) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x81CB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1396707010 (0x53400EC2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8920 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1396707010 (0x53400EC2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'xid' field in received DHCPREQUEST Message is correctly set to 1396707010 (0x53400EC2)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.6: Passed

>> DHCP-CLIENT-13.9
TEST_DESCRIPTION
If the network address appears to be in use, the client MUST send a
DHCPDECLINE message to the server
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 39
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Sends ARP Response Message to DUT
       through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:127 mcast:0 errors:0 dropped:103
	TX packets:505 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40680 (40 k)  TX bytes:92418 (92 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2968  lo0    0    
128.224.166.0/23                vxTarget                      UC       4398  gei2   0    
vxTarget                        vxTarget                      UH       13789 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       584416lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6A21 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 443844705 (0x1A748861)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x40F8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 443844705 (0x1A748861)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x484D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 443844705 (0x1A748861)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3DF8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 443844705 (0x1A748861)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Server <SERVER-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDECLINE Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1210 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 443844705 (0x1A748861)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.9: Passed

>> DHCP-CLIENT-14.1
TEST_DESCRIPTION
The client SHOULD NOT request lease time parameters
TEST_REFERENCE
RFC 2131 Section 4.4.3 Page 39
'Initialization with an externally assigned network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Message Option containing:
          - Type field is not set to 55 (Parameter Request List
             Option)
          - Length field is not set to 3
          - Value is not set to 51 (IP Address Lease Time Option)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:130 mcast:0 errors:0 dropped:105
	TX packets:509 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:41384 (41 k)  TX bytes:93486 (93 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2976  lo0    0    
128.224.166.0/23                vxTarget                      UC       4407  gei2   0    
vxTarget                        vxTarget                      UH       13862 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       588272lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x199F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1629642592 (0x61225F60)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Message Option in received DHCPINFORM Message correctly contains Option Parameter Request List (55) Length : 4 
(not containing option Parameter Request List (55) Length : 3 )

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-14.1: Passed

>> DHCP-CLIENT-14.3
TEST_DESCRIPTION
otherwise it broadcasts the message to the limited (all 1s) broadcast
 address
TEST_REFERENCE
RFC 2131 Section 4.4.3 Page 39
'Initialization with an externally assigned network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:130 mcast:0 errors:0 dropped:105
	TX packets:512 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:41384 (41 k)  TX bytes:93912 (93 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3000  lo0    0    
128.224.166.0/23                vxTarget                      UC       4414  gei2   0    
vxTarget                        vxTarget                      UH       13975 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       593880lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 0.0.0.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 0.0.0.0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "0.0.0.0" 
sysvar: ipdhcpc.server=0.0.0.0 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=0.0.0.0
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9B88 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2763758049 (0xA4BB99E1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Destination IP Address field in received DHCPINFORM Message is correctly set to 255.255.255.255

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
0 dhcp 
-> e
-> cmd ifconfig gei0 inet delete 54.0.0.2 up
xit
Au revoir!
Connection closed by foreign host.
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-14.3: Passed

>> DHCP-CLIENT-16.1
TEST_DESCRIPTION
At time T1 the client moves to RENEWING state and sends (via unicast)
a DHCPREQUEST message to the server to extend its lease
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 40 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:130 mcast:0 errors:0 dropped:105
	TX packets:514 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:41384 (41 k)  TX bytes:94296 (94 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3024  lo0    0    
128.224.166.0/23                vxTarget                      UC       4420  gei2   0    
vxTarget                        vxTarget                      UH       14151 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       600516lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8DBE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3334977648 (0xC6C7B870)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D49 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6495 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3334977648 (0xC6C7B870)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6BEA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3334977648 (0xC6C7B870)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D48 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6195 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3334977648 (0xC6C7B870)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x7DE3 (32227)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x8FBF (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD5B8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3334977648 (0xC6C7B870)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 54.0.0.1

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.1: Passed

>> DHCP-CLIENT-16.2
TEST_DESCRIPTION
If no DHCPACK arrives before time T2, the client moves to REBINDING
state and sends (via broadcast) a DHCPREQUEST message to extend its
lease
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T2>-<ParamToleranceTime>) for DUT
        to go to a state just before T2 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:133 mcast:0 errors:0 dropped:107
	TX packets:524 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42088 (42 k)  TX bytes:95916 (95 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3032  lo0    0    
128.224.166.0/23                vxTarget                      UC       4435  gei2   0    
vxTarget                        vxTarget                      UH       14224 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       603792lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1EA8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 669173356 (0x27E2C66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D47 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xF57E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 669173356 (0x27E2C66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFCD3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 669173356 (0x27E2C66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D46 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xF27E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 669173356 (0x27E2C66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 50.000 seconds) for DUT to go to a state just before T2 expires
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9CA3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 669173356 (0x27E2C66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.2: Passed

>> DHCP-CLIENT-16.3
TEST_DESCRIPTION
T1 defaults to (0.5 * duration_of_lease).  T2 defaults to (0.875 *
duration_of_lease).  Times T1 and T2 SHOULD be chosen with some
random "fuzz" around a fixed value, to avoid synchronization of
client reacquisition
(Note: This test verifies the value of T1)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T1>-<ParamToleranceTime>) for DUT
        to go to a state just before T1 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that the time interval between
        sending of last DHCPACK Message and reception of last
         DHCPREQUEST Message
         is within the range of 
        (<REMOTE-CLIENT1-T1>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T1>  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:136 mcast:0 errors:0 dropped:109
	TX packets:535 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42792 (42 k)  TX bytes:97878 (97 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3040  lo0    0    
128.224.166.0/23                vxTarget                      UC       4452  gei2   0    
vxTarget                        vxTarget                      UH       14295 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       606226lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5290 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4199071773 (0xFA48C01D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D45 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2967 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4199071773 (0xFA48C01D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x30BC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4199071773 (0xFA48C01D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D44 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2667 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4199071773 (0xFA48C01D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT to go to a state just before T1 expires
xit
Au revoir!
Connection closed by foreign host.

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x651B (25883)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA887 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9A8A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4199071773 (0xFA48C01D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Time interval (45.575 sec) between
sending of last DHCPACK Message and reception of last DHCPREQUEST Message 
is correctly  is within the range of 
(<REMOTE-CLIENT1-T1>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T1>  +  <ParamToleranceTime>) second (20.000 to 60.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.3: Passed

>> DHCP-CLIENT-16.4
TEST_DESCRIPTION
T1 defaults to (0.5 * duration_of_lease).  T2 defaults to (0.875 *
duration_of_lease).  Times T1 and T2 SHOULD be chosen with some
random "fuzz" around a fixed value, to avoid synchronization of
client reacquisition
(Note: This test verifies the value of T2)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T2>-<ParamToleranceTime>) for DUT
        to go to a state just before T2 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that the time interval between
        sending of last DHCPACK Message and reception of last
         DHCPREQUEST Message
         is within the range of 
        (<REMOTE-CLIENT1-T2>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T2>  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:139 mcast:0 errors:0 dropped:111
	TX packets:545 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:43496 (43 k)  TX bytes:99498 (99 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3048  lo0    0    
128.224.166.0/23                vxTarget                      UC       4466  gei2   0    
vxTarget                        vxTarget                      UH       14371 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       610860lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA65A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1278810723 (0x4C391A63)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D43 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7D31 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1278810723 (0x4C391A63)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8486 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1278810723 (0x4C391A63)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D42 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7A31 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1278810723 (0x4C391A63)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 50.000 seconds) for DUT to go to a state just before T2 expires
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2456 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1278810723 (0x4C391A63)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Time interval (74.760 sec) between
sending of last DHCPACK Message and reception of last DHCPREQUEST Message 
is correctly  is within the range of 
(<REMOTE-CLIENT1-T2>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T2>  +  <ParamToleranceTime>) second (50.000 to 90.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.4: Passed

>> DHCP-CLIENT-16.5
TEST_DESCRIPTION
In both RENEWING and REBINDING states, if the client receives no
response to its DHCPREQUEST message, the client SHOULD wait one-half
of the remaining time until T2 (in RENEWING state) and one-half of
the remaining lease time (in REBINDING state), down to a minimum of
60 seconds, before retransmitting the DHCPREQUEST message.
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto (((<REMOTE-CLIENT1-T2> -
       <REMOTE-CLIENT1-T1>) / 2) + (2 * <ParamToleranceTime>)) second) on
       <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
- ANVL: Verify that the time interval between
        reception of last two DHCPREQUEST Messages
         is within the range of 
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  - 
         <ParamToleranceTime>) to
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  + 
         <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:142 mcast:0 errors:0 dropped:113
	TX packets:556 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:44200 (44 k)  TX bytes:101460 (101 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3056  lo0    0    
128.224.166.0/23                vxTarget                      UC       4484  gei2   0    
vxTarget                        vxTarget                      UH       14444 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       614148lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDB1A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3732231014 (0xDE755366)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D41 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x30EF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3732231014 (0xDE755366)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAB45 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3732231014 (0xDE755366)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D40 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2DEF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3732231014 (0xDE755366)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 155.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 105.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xB7A5 (47013)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x55FD (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1514 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3732231014 (0xDE755366)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x54EA (21738)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB8B8 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1514 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3732231014 (0xDE755366)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Time interval (65.570 sec) between
reception of last two DHCPREQUEST Messages 
is correctly  is within the range of 
(((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  -     <ParamToleranceTime>) to
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>)        (((<REMOTE   / 2)  +  <ParamToleranceTime>) second (45.000 to 85.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.5: Passed

>> DHCP-CLIENT-16.7
TEST_DESCRIPTION
If the lease expires before the client receives a DHCPACK, the client
moves to INIT state, MUST immediately stop any other network
processing and requests network initialization parameters as if the
client were uninitialized
(Note: In this test we verify that the DUT stops network processing
       after lease time expires)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>+<ParamToleranceTime>) for the
        lease on the DUT to expire (*INVALID*)
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:145 mcast:0 errors:0 dropped:115
	TX packets:567 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:44904 (44 k)  TX bytes:103422 (103 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3064  lo0    0    
128.224.166.0/23                vxTarget                      UC       4527  gei2   0    
vxTarget                        vxTarget                      UH       14518 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       617540lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7230 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2708863312 (0xA175F950)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4907 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2708863312 (0xA175F950)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x505C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2708863312 (0xA175F950)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4607 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2708863312 (0xA175F950)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 100.000 seconds) for the lease on the DUT to expire (*INVALID*)
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0E55 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.7: Passed

>> DHCP-CLIENT-16.8
TEST_DESCRIPTION
If the lease expires before the client receives a DHCPACK, the client
moves to INIT state, MUST immediately stop any other network
processing and requests network initialization parameters as if the
client were uninitialized
(Note: In this test we verify that the DUT requests network
 initialization 
       parameters after lease time expires)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>+<ParamToleranceTime>) for the
        lease on the DUT to expire
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:149 mcast:0 errors:0 dropped:118
	TX packets:581 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:45668 (45 k)  TX bytes:106410 (106 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3072  lo0    0    
128.224.166.0/23                vxTarget                      UC       4556  gei2   0    
vxTarget                        vxTarget                      UH       14591 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       621068lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9B0C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2731527962 (0xA2CFCF1A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x71E3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2731527962 (0xA2CFCF1A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7938 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2731527962 (0xA2CFCF1A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6EE3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2731527962 (0xA2CFCF1A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 100.000 seconds) for the lease on the DUT to expire
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD357 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1666628572 (0x6356BBDC)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.8: Passed

>> DHCP-CLIENT-16.10
TEST_DESCRIPTION
If the client is given a new network address, it MUST NOT continue 
using the previous network address
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>-<ParamToleranceTime>) for the
        lease on the DUT to almost expire
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Destination IP Address field set to
           <SERVER1-IP-POOL-0-1>(*INVALID*)
        - 'yiaddr' field set to <SERVER1-IP-POOL-0-1>
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:152 mcast:0 errors:0 dropped:120
	TX packets:593 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:46372 (46 k)  TX bytes:108714 (108 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3080  lo0    0    
128.224.166.0/23                vxTarget                      UC       4582  gei2   0    
vxTarget                        vxTarget                      UH       14664 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       624444lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       5     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       50    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       2     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA80D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1324094973 (0x4EEC15FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7EE4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1324094973 (0x4EEC15FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8639 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1324094973 (0x4EEC15FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D39 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7BE4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1324094973 (0x4EEC15FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 60.000 seconds) for the lease on the DUT to almost expire
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-1>(*INVALID*) (54.0.0.3) 
  - 'yiaddr' field set to <SERVER1-IP-POOL-0-1> (54.0.0.3) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D37 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7BE2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1324094973 (0x4EEC15FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0080 (128)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0E4F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.10: Passed
Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/DHCPCpostsuite.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -o ipdhcpc.rfc2131_init_delay "1"
sysvar: ipdhcpc.rfc2131_init_delay=1 ok
-> cmd sysvar set -o ipdhcpc.option.lease_time "0"
sysvar: ipdhcpc.option.lease_time=0 ok
-> cmd sysvar unset ipdhcpc.option.requested_options 
sysvar: 'ipdhcpc.option.requested_options' unset ok
-> cmd sysvar unset ipdhcpc.if.gei0.information_only 
sysvar: 'ipdhcpc.if.gei0.information_only' unset ok
-> cmd sysvar unset ipdhcpc.if.gei1.information_only 
sysvar: 'ipdhcpc.if.gei1.information_only' unset ok
-> cmd ipd kill ipdhcpc
ipd: kill ipdhcpc ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          80
Number of tests passed:       79
Number of tests failed:       1
Number of tests inconclusive: 0
