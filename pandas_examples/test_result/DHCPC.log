ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 6038140 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient dhcp-client 1-6.2 6.4-6.6 6.8-7 8.2-13.6 13.9 14.1 14.3 16.1-16.5 16.7-16.8 16.10 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           "./DocScriptQ35/IP/reboot-command.exp $ANVL_DUTHOSTNAME"
Post suite Command                       "./DocScriptQ35/DHCP-CLIENT/DHCPCpostsuite.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
IP DUT Background Echo Request Send Command "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
DHCP Client Suite Setup Command          "./DocScriptQ35/DHCP-CLIENT/dhcp-client-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Configure Command            "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Reset Command                "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Renew Command                "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Release Command              "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Option Configure Command     "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Boot Command                 "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Reboot Command               "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client DHCPINFORM Message Send Command "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Restart Log Check Command    "./DocScriptQ35/DHCP-CLIENT/dhcp-client-restart-log-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Static IP Assign Command     "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Client Supports Sending DHCPINFORM  True
DHCP Client Supports Lease Renewal       True
DHCP Listen Time                         10                  # (0x0000000A)
DHCP Lease Time                          80                  # (0x00000050)
DHCP Tolerance Time                      20                  # (0x00000014)
DHCP Tolerance Factor                    1                   # (0x00000001)
DHCP Process Time                        2                   # (0x00000002)
DHCP First Retransmission Interval       4                   # (0x00000004)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpclient.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        
IP First Unused Net                      50.0.0.0
IP Number Unused Nets                    100                 # (0x00000064)
IP Unused Net Mask                       255.0.0.0

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29

# Configuration File End.

WARNING: It is recommended that the value of lease time should
WARNING: kept higher than 5 seconds since in various cases,
WARNING: verification of T1 and T2 (Ref: rfc2131) is done which
WARNING: are fractions of 'DHCP Lease Time'. Keeping it too low
WARNING: may cause the T1 and T2 to become too low for proper
WARNING: verifications.
WARNING: Too high values are also deprreciated since it will
WARNING: lead to unnecessary long running of tests which
WARNING: may not add any value to the test results.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.rfc2131_init_delay "1"
sysvar: ipdhcpc.rfc2131_init_delay=1 ok
-> cmd sysvar get ipdhcpc.rfc2131_init_delay
sysvar: ipdhcpc.rfc2131_init_delay=1
-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time 
sysvar: ipdhcpc.option.lease_time=60
-> cmd sysvar set -c -o ipdhcpc.option.requested_options "1,6,28,42"
sysvar: ipdhcpc.option.requested_options=1,6,28,42 ok
-> cmd sysvar get ipdhcpc.option.requested_options
sysvar: ipdhcpc.option.requested_options=1,6,28,42
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd ipd kill ipdhcpc
ipd: kill ipdhcpc ok
-> cmd ipd start ipdhcpc
ipd: start ipdhcpc ok
-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 up
-> exit
Au revoir!
Connection closed by foreign host.

Starting Active Validation for DHCP Client for
all 2 DUT interface(s)

  DHCP Client topology # 2
  ---------------------------------------

  +----------------+                          +----------------+
  |                |<AIface-0>      <DIface-0>|                |
  |             N0 +--------------------------+ N0             |
  |                |                          |                |
  |             N1 +--------------------------+ N1             |
  | <SERVER-1>     |<AIface-1>      <DIface-1>|           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:1 mcast:1 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:90

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2336  lo0    0    
128.224.166.0/23                vxTarget                      UC       2816  gei2   0    
vxTarget                        vxTarget                      UH       7392  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       285254lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: ipnet.inet.AddressConflictDetect=1 ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1
gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  tentative  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:24
	RX packets:0 mcast:0 errors:0 dropped:0
	TX packets:2 mcast:2 errors:0
	collisions:0 unsupported proto:0
	RX bytes:0  TX bytes:168

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2336  lo0    0    
128.224.166.0/23                vxTarget                      UC       2816  gei2   0    
vxTarget                        vxTarget                      UH       7392  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       285254lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Causing the DUT DHCP Client to transit its state to SELECTING state
through <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> FF:FF:FF:FF:FF:FF < 00:15:17:C8:90:28 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message

exi
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
00:15:17:C8:90:28 < 00:1B:21:7D:57:BA IP 50.0.0.2 < 50.0.0.1 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Booting up DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Causing the DUT DHCP Client to transit its state to SELECTING
state through <DIface-1>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-1>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
t
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei1 -dhcp
-> cmd ifconfig gei1 dhcp
-> FF:FF:FF:FF:FF:FF < 00:15:17:C8:90:29 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit
00:15:17:C8:90:29 < 00:1B:21:7D:57:BB IP 51.0.0.2 < 51.0.0.1 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Active validation of DHCP Client was completed successfully
for all the interfaces provided in the configuration file
Continuing with tests .....

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei1 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

This test suite tests statements from:
ANVL Test Suite DHCP Client
RFC 2131:  'Dynamic Host Configuration Protocol'
R. Droms, Bucknell University, March 1997

ANVL Test Suite Required Setup:
This suite expects to be running against a node which has at least one
interface for which it can obtain IPv4 address dynamically using DHCP
(A DHCP Client implementation is expected to be present in the DUT
which will actually obtain the IP address using DHCP


This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> DHCP-CLIENT-1.1
TEST_DESCRIPTION
A DHCP Client Listens on UDP port 68
TEST_REFERENCE
Setup Verification
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:1 mcast:0 errors:0 dropped:1
	TX packets:9 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:322  TX bytes:1806

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2344  lo0    0    
128.224.166.0/23                vxTarget                      UC       2822  gei2   0    
vxTarget                        vxTarget                      UH       7535  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       292210lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8E8D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1579025259 (0x5E1E036B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB4 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8244 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1579025259 (0x5E1E036B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB86D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1579025259 (0x5E1E036B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-1.1: Passed

>> DHCP-CLIENT-2.1
TEST_DESCRIPTION
A DHCP client must be prepared to receive multiple responses
to a request for configuration parameters
(Note: If the 'xid' of an arriving DHCPOFFER message does not match the
'xid' of the most recent DHCPDISCOVER message, the DHCPOFFER message
must be silently discarded.)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 1.6 Page 7 'Design Goals'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL: DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT
        through <DIface-0> containing :
        - 'xid' field set to (extractedXID+1)
- ANVL:DHCP Server <SERVER-2> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to extractedXID
- ANVL:DHCP Server <SERVER-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 54 (Server Identifier Option)
          - Length field set to 4
          - Value set to <SERVER2-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


  DHCP Client topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <SERVER-2>     |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:2 mcast:0 errors:0 dropped:2
	TX packets:12 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:644  TX bytes:2832

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2352  lo0    0    
128.224.166.0/23                vxTarget                      UC       2823  gei2   0    
vxTarget                        vxTarget                      UH       7608  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       295282lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3346 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3859142346 (0xE605D6CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0xE605D6CA) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to (extractedXID+1) (0xE605D6CB) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB2 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x26FA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3859142347 (0xE605D6CB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-2> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to extractedXID (0xE605D6CA) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:04
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAC (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.7
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x25F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3859142346 (0xE605D6CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.7
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5D20 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3859142346 (0xE605D6CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.7
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-2> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Server Identifier (54) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.1: Passed

>> DHCP-CLIENT-2.2
TEST_DESCRIPTION
A DHCP client must be prepared to receive DHCP messages with an
 'options'
field of at least length 312 octets.  This requirement implies that a
 DHCP
client must be prepared to receive a message of up to 576 octets
TEST_REFERENCE
RFC 2131 Section 2 Page 10 'Protocol Summary'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:4 mcast:0 errors:0 dropped:4
	TX packets:15 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1288  TX bytes:3858

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2360  lo0    0    
128.224.166.0/23                vxTarget                      UC       2827  gei2   0    
vxTarget                        vxTarget                      UH       7679  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       297766lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x12ED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2034721762 (0x794763E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576 (576) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0CA5 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x048C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2034721762 (0x794763E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3CCD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2034721762 (0x794763E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.2: Passed

>> DHCP-CLIENT-2.3
TEST_DESCRIPTION
The remaining bits of the flags field are reserved for future use.  
They MUST be set to zero by clients and ignored by servers and relay
 agents
TEST_REFERENCE
RFC 2131 Section 2 Page 11 'Protocol Summary'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Bits 2 to 16 of 'flags' field  is set to  0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:18 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:4884

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2368  lo0    0    
128.224.166.0/23                vxTarget                      UC       2829  gei2   0    
vxTarget                        vxTarget                      UH       7755  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       302414lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x39F8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 759072992 (0x2D3E88E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Received DHCPDISCOVER Message correctly contains:
- Bits 2 to 16 of 'flags' field correctly set to 000000000000000

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-2.3: Passed

>> DHCP-CLIENT-4.1
TEST_DESCRIPTION
The first four octets of the 'options' field of the DHCP message
contain the (decimal) values 99, 130, 83 and 99, respectively (this
is the same magic cookie as is defined in RFC 1497)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - First four octets of DHCP Options is set to
           <DHCP-MAGIC-COOKIE>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:19 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5226

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2376  lo0    0    
128.224.166.0/23                vxTarget                      UC       2832  gei2   0    
vxTarget                        vxTarget                      UH       7829  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       306030lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE021 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3002621180 (0xB2F85CFC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

First four octets of DHCP Options in received DHCPDISCOVER Message is correctly set to 99 130 83 99

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.1: Passed

>> DHCP-CLIENT-4.2
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPDISCOVER Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:20 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5568

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2384  lo0    0    
128.224.166.0/23                vxTarget                      UC       2833  gei2   0    
vxTarget                        vxTarget                      UH       7891  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       309010lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEF3F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3361290365 (0xC859387D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
exit

Message Option in received DHCPDISCOVER Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.2: Passed

>> DHCP-CLIENT-4.3
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPREQUEST Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:5 mcast:0 errors:0 dropped:5
	TX packets:21 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:1878  TX bytes:5910

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2392  lo0    0    
128.224.166.0/23                vxTarget                      UC       2833  gei2   0    
vxTarget                        vxTarget                      UH       7973  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       312858lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x94D1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1371801985 (0x51C40981)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DB0 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8888 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1371801985 (0x51C40981)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBEB1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1371801985 (0x51C40981)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Message Option in received DHCPREQUEST Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.3: Passed

>> DHCP-CLIENT-4.4
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPRELEASE Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:6 mcast:0 errors:0 dropped:6
	TX packets:24 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:2200  TX bytes:6936

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2400  lo0    0    
128.224.166.0/23                vxTarget                      UC       2834  gei2   0    
vxTarget                        vxTarget                      UH       8046  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       316116lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x518A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2622554683 (0x9C51023B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAF (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4541 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2622554683 (0x9C51023B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7B6A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2622554683 (0x9C51023B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAE (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4241 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2622554683 (0x9C51023B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig ge
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3637 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2622554683 (0x9C51023B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Message Option in received DHCPRELEASE Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
i0 -dhcp
-> e
-> cmd sysvar set -co ipdhcpc.if.gei0.information_onxit
Au revoir!
Connection closed by foreign host.
ly "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.4: Passed

>> DHCP-CLIENT-4.5
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPDECLINE Message)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Sends ARP Response Message to DUT
       through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Sender IP Address field set to
           <SERVER1-IP-POOL-0-0>(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL: Verify that received DHCPDECLINE Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:8 mcast:0 errors:0 dropped:8
	TX packets:27 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:2844  TX bytes:7962

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2408  lo0    0    
128.224.166.0/23                vxTarget                      UC       2838  gei2   0    
vxTarget                        vxTarget                      UH       8133  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       319796lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0DBA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2071095018 (0x7B7266EA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAD (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0171 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2071095018 (0x7B7266EA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x379A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2071095018 (0x7B7266EA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAC (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFE70 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2071095018 (0x7B7266EA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Server <SERVER-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0>(*INVALID*) (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDECLINE Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF964 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2071095018 (0x7B7266EA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Message Option in received DHCPDECLINE Message correctly contains Option Message Type (53) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.5: Passed

>> DHCP-CLIENT-4.6
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the above statement for DHCPINFORM Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:31 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9030

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2416  lo0    0    
128.224.166.0/23                vxTarget                      UC       2848  gei2   0    
vxTarget                        vxTarget                      UH       8208  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       323252lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x798C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2538250103 (0x974A9F77)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Message Option in received DHCPINFORM Message correctly contains Option Message Type (53) 

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-4.6: Passed

>> DHCP-CLIENT-5.1
TEST_DESCRIPTION
The client broadcasts a DHCPDISCOVER message on its local physical
 subnet
TEST_REFERENCE
RFC 2131 Section 3.1 Page 13 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:34 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9456

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2440  lo0    0    
128.224.166.0/23                vxTarget                      UC       2850  gei2   0    
vxTarget                        vxTarget                      UH       8332  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       328132lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6148 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1486108218 (0x5894363A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Destination IP Address field in received DHCPDISCOVER Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.1: Passed

>> DHCP-CLIENT-5.2
TEST_DESCRIPTION
The DHCPDISCOVER message MAY include options that suggest values for the
network address and lease duration
(Note: This test checks that DUT may suggest a value for lease time)
TEST_REFERENCE
RFC 2131 Section 3.1 Page 13 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 51 (IP Address Lease Time
        Option)
        with value 60 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 60
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:35 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:9798

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2448  lo0    0    
128.224.166.0/23                vxTarget                      UC       2855  gei2   0    
vxTarget                        vxTarget                      UH       8425  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       332586lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option IP Address Lease Time with value
60 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 51 60

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time
sysvar: ipdhcpc.option.lease_time=60
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD477 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3633857286 (0xD8984306)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 60 seconds (1 minute ) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.2: Passed

>> DHCP-CLIENT-5.3
TEST_DESCRIPTION
The client broadcasts a DHCPREQUEST message that MUST include the
 'server 
identifier' option to indicate which server it has selected
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 54 (Server Identifier Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:11 mcast:0 errors:0 dropped:10
	TX packets:36 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3548  TX bytes:10140 (10 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2456  lo0    0    
128.224.166.0/23                vxTarget                      UC       2856  gei2   0    
vxTarget                        vxTarget                      UH       8516  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       336634lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3820 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3076063389 (0xB759009D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAB (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2BD7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3076063389 (0xB759009D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6200 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3076063389 (0xB759009D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Server Identifier (54) Length : 4 Value : 54.0.0.1 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.3: Passed

>> DHCP-CLIENT-5.4
TEST_DESCRIPTION
the DHCPREQUEST message MUST use the same value in the DHCP message
header's 'secs' field ... as the original DHCPDISCOVER message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'secs' field to <extractedSeconds>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'secs' field is set to extractedSeconds
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:12 mcast:0 errors:0 dropped:11
	TX packets:39 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:3870  TX bytes:11166 (11 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2464  lo0    0    
128.224.166.0/23                vxTarget                      UC       2857  gei2   0    
vxTarget                        vxTarget                      UH       8586  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       339262lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x57F9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3572417326 (0xD4EEC32E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'secs' field (0) to <extractedSeconds>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DAA (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4BB0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3572417326 (0xD4EEC32E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x81D9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3572417326 (0xD4EEC32E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'secs' field in received DHCPREQUEST Message is correctly set to 0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.4: Passed

>> DHCP-CLIENT-5.5
TEST_DESCRIPTION
the DHCPREQUEST message MUST ... be sent to the same IP broadcast
 address
as the original DHCPDISCOVER message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:13 mcast:0 errors:0 dropped:12
	TX packets:42 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4192  TX bytes:12192 (12 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2472  lo0    0    
128.224.166.0/23                vxTarget                      UC       2859  gei2   0    
vxTarget                        vxTarget                      UH       8661  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       343502lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF0E7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2977320376 (0xB1764DB8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Destination IP Address field in received DHCPDISCOVER Message is correctly set to 255.255.255.255

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA9 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xE49E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2977320376 (0xB1764DB8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1AC8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2977320376 (0xB1764DB8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.5: Passed

>> DHCP-CLIENT-5.6
TEST_DESCRIPTION
The client times out and retransmits the DHCPDISCOVER message if
the client receives no DHCPOFFER messages
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16 
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:14 mcast:0 errors:0 dropped:13
	TX packets:45 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4514  TX bytes:13218 (13 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2480  lo0    0    
128.224.166.0/23                vxTarget                      UC       2862  gei2   0    
vxTarget                        vxTarget                      UH       8734  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       346922lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD24E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1695529144 (0x650FB8B8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD24A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1695529144 (0x650FB8B8)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.6: Passed

>> DHCP-CLIENT-5.8
TEST_DESCRIPTION
If the client detects that the address is already in use (e.g., through
the use of ARP), the client MUST send a DHCPDECLINE message to the
 server
and restarts the configuration process
(Note: In this test we check that the DUT does restart the configuration
       process after sending the DHCPDECLINE Message)
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Client <STATIC-CLIENT-1> Listens (upto
       <ParamListenTime>) on <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Client <STATIC-CLIENT-1> Sends ARP Response Message to
       DUT through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Target MAC Address field set to <DIface-0-MAC-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
        - ARP Target IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-4


  DHCP Client topology # 4
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
  <STATIC-CLIENT-1>             |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  |                |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:14 mcast:0 errors:0 dropped:13
	TX packets:47 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:4514  TX bytes:13902 (13 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2488  lo0    0    
128.224.166.0/23                vxTarget                      UC       2864  gei2   0    
vxTarget                        vxTarget                      UH       8808  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       350310lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD113 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2547812134 (0x97DC8726)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA8 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xC4CA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2547812134 (0x97DC8726)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFAF3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2547812134 (0x97DC8726)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA7 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xC1CA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2547812134 (0x97DC8726)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Client <STATIC-CLIENT-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Client <STATIC-CLIENT-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Target MAC Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 
  - ARP Target IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:05
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBCBE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2547812134 (0x97DC8726)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8411 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1280581533 (0x4C541F9D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.8: Passed

>> DHCP-CLIENT-5.9
TEST_DESCRIPTION
The client SHOULD wait a minimum of ten seconds before restarting
the configuration process to avoid excessive network traffic in case
of looping
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Client <STATIC-CLIENT-1> Listens (upto
       <ParamListenTime>) on <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Client <STATIC-CLIENT-1> Sends ARP Response Message to
       DUT through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Target MAC Address field set to <DIface-0-MAC-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
        - ARP Target IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the time interval between
        reception of last DHCPDECLINE Message and reception of last
         DHCPDISCOVER Message
         is greater than 
        (10  -  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-4


  DHCP Client topology # 4
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
  <STATIC-CLIENT-1>             |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  |                |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:17 mcast:0 errors:0 dropped:15
	TX packets:52 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:5218  TX bytes:15312 (15 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2496  lo0    0    
128.224.166.0/23                vxTarget                      UC       2873  gei2   0    
vxTarget                        vxTarget                      UH       8881  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       353754lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC59B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1378998345 (0x5231D849)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA6 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB952 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1378998345 (0x5231D849)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEF7B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1378998345 (0x5231D849)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA5 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB652 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1378998345 (0x5231D849)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
xit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Client <STATIC-CLIENT-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Client <STATIC-CLIENT-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Target MAC Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 
  - ARP Target IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:06
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB146 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1378998345 (0x5231D849)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5C5B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2387215709 (0x8E4A055D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Time interval (9.484 sec) between
reception of last DHCPDECLINE Message and reception of last DHCPDISCOVER Message 
is correctly  is greater than 
(10  -  <ParamToleranceTime>) second (greater than 0.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.9: Passed

>> DHCP-CLIENT-5.10
TEST_DESCRIPTION
If the client receives a DHCPNAK message, the client restarts the
configuration process
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:20 mcast:0 errors:0 dropped:17
	TX packets:57 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:5922  TX bytes:16722 (16 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2504  lo0    0    
128.224.166.0/23                vxTarget                      UC       2885  gei2   0    
vxTarget                        vxTarget                      UH       8954  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       356998lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAED2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 626203633 (0x25531BF1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA4 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA289 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 626203633 (0x25531BF1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD8B2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 626203633 (0x25531BF1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA3 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9F89 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 626203633 (0x25531BF1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x6B9C (27548)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xA206 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0AB9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 626203633 (0x25531BF1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x43C2 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0xDDC5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 626203633 (0x25531BF1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x047E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2809584647 (0xA776DC07)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.10: Passed

>> DHCP-CLIENT-5.11
TEST_DESCRIPTION
The client times out and retransmits the DHCPREQUEST message if the
client receives neither a DHCPACK or a DHCPNAK message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto ((<REMOTE-CLIENT1-T2> -
       <REMOTE-CLIENT1-T1>) + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:24 mcast:0 errors:0 dropped:19
	TX packets:67 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:6918  TX bytes:18342 (18 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2512  lo0    0    
128.224.166.0/23                vxTarget                      UC       2902  gei2   0    
vxTarget                        vxTarget                      UH       9024  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       360290lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x939B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 155931440 (0x094B5330)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA1 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0650 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 155931440 (0x094B5330)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBC6D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 155931440 (0x094B5330)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0017 (23)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0DA0 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0350 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 155931440 (0x094B5330)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 155.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 151.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xC951 (51537)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4451 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEE73 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 155931440 (0x094B5330)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x104F (4175)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xFD53 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEE73 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 155931440 (0x094B5330)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.11: Passed

>> DHCP-CLIENT-5.12
TEST_DESCRIPTION
The client SHOULD notify the user that the initialization process has
failed and is restarting
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto
       (<REMOTE-CLIENT1-LEASE-TIME> + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the DUT has correctly logged that
        initialization process has failed and is restarting
        for 
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:27 mcast:0 errors:0 dropped:21
	TX packets:78 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:7622  TX bytes:20304 (20 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2520  lo0    0    
128.224.166.0/23                vxTarget                      UC       2946  gei2   0    
vxTarget                        vxTarget                      UH       9096  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       364058lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB813 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 980680079 (0x3A73FD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xABCA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 980680079 (0x3A73FD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE1F3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 980680079 (0x3A73FD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA8CA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 980680079 (0x3A73FD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 100.000 seconds) for DHCPDISCOVER Message on <DIface-0>
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xD72E (55086)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3674 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x13FA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 980680079 (0x3A73FD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x49FB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 980680079 (0x3A73FD8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7062 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2266861692 (0x871D907C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

 Verifying that the DUT has correctly logged that
initialization process has failed and is restarting
for 
Verifying DUT has logged the event of restarting DHCP Client
for <DIface-0> in case of failure to reacquire IP Address
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-restart-log-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> 
 DUT has correctly logged that initialization process
has failed and is restarting for 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.12: Passed

>> DHCP-CLIENT-5.13
TEST_DESCRIPTION
The client may choose to relinquish its lease on a network address
by sending a DHCPRELEASE message to the server
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Wait till <ParamProcessTime> for DUT to actually stop using
        the released address
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:30 mcast:0 errors:0 dropped:23
	TX packets:89 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:8326  TX bytes:22266 (22 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2528  lo0    0    
128.224.166.0/23                vxTarget                      UC       2964  gei2   0    
vxTarget                        vxTarget                      UH       9178  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       366632lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x32A9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3338729068 (0xC700F66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2660 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3338729068 (0xC700F66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5C89 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3338729068 (0xC700F66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2360 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3338729068 (0xC700F66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1756 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3338729068 (0xC700F66C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Waiting (up to 2.000 seconds) for DUT to actually stop using the released address
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0EB3 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.13: Passed

>> DHCP-CLIENT-5.14
TEST_DESCRIPTION
The client identifies the lease to be released with its 'client
 identifier',
or 'chaddr' and network address in the DHCPRELEASE message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 'chaddr' field to <extractedChaddr>
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - 'chaddr' field is set to extractedChaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:33 mcast:0 errors:0 dropped:26
	TX packets:92 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:9030  TX bytes:23292 (23 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2536  lo0    0    
128.224.166.0/23                vxTarget                      UC       2976  gei2   0    
vxTarget                        vxTarget                      UH       9241  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       370122lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x66B6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 208305398 (0x0C6A7CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D9A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5A6D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 208305398 (0x0C6A7CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9096 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 208305398 (0x0C6A7CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D99 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x576D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 208305398 (0x0C6A7CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 'chaddr' field (00:15:17:C8:90:28) to <extractedChaddr>

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4B63 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 208305398 (0x0C6A7CF6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 7
DHCP: Value                    = 01 00 15 17 C8 90 28
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

'chaddr' field in received DHCPRELEASE Message is correctly set to 00:15:17:C8:90:28

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
-> e
-> cmd sysvar set -co ipdhcpc.if.gei0.informatioxit
Au revoir!
Connection closed by foreign host.
n_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.14: Passed

>> DHCP-CLIENT-5.15
TEST_DESCRIPTION
If the client used a 'client identifier' when it obtained the lease, it
MUST use the same 'client identifier' in the DHCPRELEASE message
If the client supplies a 'client identifier', the client MUST use the
same 'client identifier' in all subsequent messages
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
RFC 2131 Section 4.2 Page 26 'DHCP server administrative controls'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 61 (Client-identifier Option)
        with value "CONFORMANCE-DUT-0" for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to SELECTING
-  DUT: Transit finite state to SELECTING
- ANVL: Extracts the content of 61 (Client-identifier Option) to
        <extractedClientID>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPRELEASE Message
- ANVL: Verify that received DHCPRELEASE Message contains:
        - Message Option containing extractedClientID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:35 mcast:0 errors:0 dropped:28
	TX packets:96 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:9674  TX bytes:24360 (24 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2544  lo0    0    
128.224.166.0/23                vxTarget                      UC       2979  gei2   0    
vxTarget                        vxTarget                      UH       9356  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       374832lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Client-identifier with value
"CONFORMANCE-DUT-0" on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 61 "CONFORMANCE-DUT-0"

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.client_identifier ""CONFORMANCE-DUT-0""
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0 ok
-> cmd sysvar get ipdhcpc.option.client_identifier
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9E90 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3358107197 (0xC828A63D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D98 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7567 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3358107197 (0xC828A63D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to SELECTING state

Extracted the content of 61 (Client-identifier Option) (
Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30) to <extractedClientID>

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7CBC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3358107197 (0xC828A63D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D97 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7267 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3358107197 (0xC828A63D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPRELEASE Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDDE2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3358107197 (0xC828A63D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPRELEASE Message from <DIface-0>

Message Option in received DHCPRELEASE Message correctly contains Option Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
-> e
-> cmd sysvar set -co ipdhcpc.if.gei0.informationxit
Au revoir!
Connection closed by foreign host.
_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-5.15: Passed

>> DHCP-CLIENT-6.1
TEST_DESCRIPTION
If the client receives neither a DHCPACK or a DHCPNAK message after
employing the retransmission algorithm, the client reverts to INIT state
and restarts the initialization process
TEST_REFERENCE
RFC 2131 Section 3.1 Page 17
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till <ParamProcessTime> for DUT to stabilize in BOUND
        state
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
- ANVL:DHCP Server <SERVER-1> Listens (upto (130 + 10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
(Note: We have derived 130 seconds keeping in mind the total retransmission
        time in RFC 2131 Section 4.1 Page 24)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:37 mcast:0 errors:0 dropped:30
	TX packets:99 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:10318 (10 k)  TX bytes:25386 (25 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2552  lo0    0    
128.224.166.0/23                vxTarget                      UC       2986  gei2   0    
vxTarget                        vxTarget                      UH       9456  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       378904lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA854 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D96 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFE28 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x787F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D95 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xFB28 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to stabilize in BOUND state
xit
Au revoir!
Connection closed by foreign host.

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7DEB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7DE7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Listening (up to 160.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7DDF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7DCF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7DAF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1005856942 (0x3BF428AE)
DHCP: secs                      = 60
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPREQUEST Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6D26 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 781076697 (0x2E8E48D9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.1: Passed

>> DHCP-CLIENT-6.2
TEST_DESCRIPTION
If a client remembers and wishes to reuse a previously allocated
network address, a client may choose to omit some of the steps
described in the previous section
TEST_REFERENCE
RFC 2131 Section 3.2 Page 17
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till <ParamProcessTime> for DUT to stabilize in BOUND
        state
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:39 mcast:0 errors:0 dropped:32
	TX packets:120 mcast:12 errors:0
	collisions:0 unsupported proto:0
	RX bytes:10962 (10 k)  TX bytes:28992 (28 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2560  lo0    0    
128.224.166.0/23                vxTarget                      UC       3015  gei2   0    
vxTarget                        vxTarget                      UH       9550  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       381774lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF6E4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3886886500 (0xE7AD2E64)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D94 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xCDBB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3886886500 (0xE7AD2E64)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD510 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3886886500 (0xE7AD2E64)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D93 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xCABB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3886886500 (0xE7AD2E64)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to stabilize in BOUND state
Au revoir!
Connection closed by foreign host.

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDA7C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3886886500 (0xE7AD2E64)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.2: Passed

>> DHCP-CLIENT-6.4
TEST_DESCRIPTION
If a client remembers and wishes to reuse a previously allocated
network address, ... .The message includes the client's network address
in the 'requested IP address' option
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:41 mcast:0 errors:0 dropped:34
	TX packets:137 mcast:19 errors:0
	collisions:0 unsupported proto:0
	RX bytes:11606 (11 k)  TX bytes:30930 (30 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2568  lo0    0    
128.224.166.0/23                vxTarget                      UC       3024  gei2   0    
vxTarget                        vxTarget                      UH       9640  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       386060lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x35BB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 999857059 (0x3B989BA3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D92 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0C92 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 999857059 (0x3B989BA3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x13E7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 999857059 (0x3B989BA3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D91 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0992 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 999857059 (0x3B989BA3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1953 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 999857059 (0x3B989BA3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.4: Passed

>> DHCP-CLIENT-6.5
TEST_DESCRIPTION
As the client has not received its network address, it MUST NOT fill in
the 'ciaddr' field
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:43 mcast:0 errors:0 dropped:36
	TX packets:153 mcast:26 errors:0
	collisions:0 unsupported proto:0
	RX bytes:12250 (12 k)  TX bytes:32826 (32 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2576  lo0    0    
128.224.166.0/23                vxTarget                      UC       3033  gei2   0    
vxTarget                        vxTarget                      UH       9730  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       389596lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4C44 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 597728530 (0x23A09D12)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D90 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x231B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 597728530 (0x23A09D12)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2A70 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 597728530 (0x23A09D12)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x201B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 597728530 (0x23A09D12)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2FDC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 597728530 (0x23A09D12)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.5: Passed

>> DHCP-CLIENT-6.6
TEST_DESCRIPTION
If the client used a 'client identifier' to obtain its
address, the client MUST use the same 'client identifier' in the
If the client supplies a 'client identifier', the client MUST use the
same 'client identifier' in all subsequent messages
DHCPREQUEST message
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
RFC 2131 Section 4.2 Page 26 'DHCP server administrative controls'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 61 (Client-identifier Option)
        with value "CONFORMANCE-DUT-0" for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 61 (Client-identifier Option) to
        <extractedClientID>
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing extractedClientID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:45 mcast:0 errors:0 dropped:38
	TX packets:169 mcast:33 errors:0
	collisions:0 unsupported proto:0
	RX bytes:12894 (12 k)  TX bytes:34722 (34 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2584  lo0    0    
128.224.166.0/23                vxTarget                      UC       3042  gei2   0    
vxTarget                        vxTarget                      UH       9820  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       393264lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Client-identifier with value
"CONFORMANCE-DUT-0" on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 61 "CONFORMANCE-DUT-0"

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.client_identifier ""CONFORMANCE-DUT-0""
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0 ok
-> cmd sysvar get ipdhcpc.option.client_identifier
sysvar: ipdhcpc.option.client_identifier=CONFORMANCE-DUT-0
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2F0D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2328711964 (0x8ACD531C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x05E4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2328711964 (0x8ACD531C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0D39 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2328711964 (0x8ACD531C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x02E4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2328711964 (0x8ACD531C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 61 (Client-identifier Option) (
Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30) to <extractedClientID>

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x12A5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2328711964 (0x8ACD531C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Client-identifier (61) Length : 18 Value : 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.6: Passed

>> DHCP-CLIENT-6.8
TEST_DESCRIPTION
If the client receives a DHCPNAK message, it cannot reuse its
remembered network address.  It must instead request a new
address by restarting the configuration process, this time
using the (non-abbreviated) procedure described in section 3.1
TEST_REFERENCE
RFC 2131 Section 3.2 Page 19
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to renew <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:47 mcast:0 errors:0 dropped:40
	TX packets:185 mcast:40 errors:0
	collisions:0 unsupported proto:0
	RX bytes:13538 (13 k)  TX bytes:36618 (36 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2600  lo0    0    
128.224.166.0/23                vxTarget                      UC       3053  gei2   0    
vxTarget                        vxTarget                      UH       9941  lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       397410lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x548A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2965112752 (0xB0BC07B0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2B61 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2965112752 (0xB0BC07B0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x32B6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2965112752 (0xB0BC07B0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D8B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2861 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2965112752 (0xB0BC07B0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Renewng IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-renew-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down
-> cmd ifconfig gei0 up
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3822 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2965112752 (0xB0BC07B0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x43AA (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0x669D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2965112752 (0xB0BC07B0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD13B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 860483081 (0x3349EE09)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-6.8: Passed

>> DHCP-CLIENT-7.1
TEST_DESCRIPTION
If a client has obtained a network address through some other means
(e.g., manual configuration), it may use a DHCPINFORM request message
to obtain other local configuration parameters
TEST_REFERENCE
RFC 2131 Section 3.4 Page 20
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <IP-UNUSED-ADDRESS> with mask
        <IP-UNUSED-NET-MASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:50 mcast:0 errors:0 dropped:42
	TX packets:201 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14474 (14 k)  TX bytes:38814 (38 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2600  lo0    0    
128.224.166.0/23                vxTarget                      UC       3065  gei2   0    
vxTarget                        vxTarget                      UH       10018 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       400930lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 56.0.0.1 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 56.0.0.1 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 56.0.0.1 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x01A5 (Correct)
IP: Source Address         = 56.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x290C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 346986601 (0x14AE9869)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 56.0.0.1
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Deleting IP Address 56.0.0.1 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 56.0.0.1 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 56.0.0.1 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-7.1: Passed

>> DHCP-CLIENT-8.2
TEST_DESCRIPTION
First, most of the parameters have defaults defined in the Host
Requirements RFCs; if the client receives no parameters from the server
that override the defaults, a client uses those default values
(Note: This test checks that if default value is overridden,
       DUT uses the overridden value for Time To Live)
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to <ParamLeaseTime>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to <ParamLeaseTime>
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:50 mcast:0 errors:0 dropped:42
	TX packets:207 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14474 (14 k)  TX bytes:39366 (39 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2616  lo0    0    
128.224.166.0/23                vxTarget                      UC       3072  gei2   0    
vxTarget                        vxTarget                      UH       10138 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       405258lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAA54 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3504705980 (0xD0E591BC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_IP_ADDRESS_LEASE_TIME (IP Address Lease Time) 
  - Length field set to 4 (4) 
  - Value set to <ParamLeaseTime> (80 seconds (1 minute 20 seconds)) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D89 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA20A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3504705980 (0xD0E591BC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8880 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3504705980 (0xD0E591BC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 80 seconds (1 minute 20 seconds) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.2: Passed

>> DHCP-CLIENT-8.3
TEST_DESCRIPTION
If the client includes a list of parameters in a DHCPDISCOVER
message, it MUST include that list in any subsequent DHCPREQUEST
messages.
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 55 (Parameter Request List Option)
        to <extractedParamReq>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing extractedParamReq
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:51 mcast:0 errors:0 dropped:43
	TX packets:210 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:14796 (14 k)  TX bytes:40392 (40 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2624  lo0    0    
128.224.166.0/23                vxTarget                      UC       3075  gei2   0    
vxTarget                        vxTarget                      UH       10209 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       407622lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC894 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 636296821 (0x25ED1E75)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 55 (Parameter Request List Option) (
Parameter Request List (55) Length : 4 Value : 
  1 = Subnet Mask
  6 = Domain Name Server
 28 = Broadcast Address
 42 = Network Time Protocol Servers
) to <extractedParamReq>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0>
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D88 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9F6B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 636296821 (0x25ED1E75)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA6C0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 636296821 (0x25ED1E75)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Parameter Request List (55) Length : 4 Value : 
  1 = Subnet Mask
  6 = Domain Name Server
 28 = Broadcast Address
 42 = Network Time Protocol Servers
 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.3: Passed

>> DHCP-CLIENT-8.4
TEST_DESCRIPTION
The client SHOULD include the 'maximum DHCP message size' option to
let the server know how large the server may make its DHCP messages
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 57 (Maximum DHCP Size Option)
        with value 600 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 57 (Maximum DHCP Size Option)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:213 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:41418 (41 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2632  lo0    0    
128.224.166.0/23                vxTarget                      UC       3078  gei2   0    
vxTarget                        vxTarget                      UH       10284 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       411962lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option Maximum DHCP Size with value
600 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 57 600

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.max_message_size "600"
sysvar: ipdhcpc.option.max_message_size=600 ok
-> cmd sysvar get ipdhcpc.option.max_message_size
sysvar: ipdhcpc.option.max_message_size=600
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBA59 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 259670819 (0x0F7A4323)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exi
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option Maximum DHCP Size (57) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
t
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.4: Passed

>> DHCP-CLIENT-8.5
TEST_DESCRIPTION
In addition, the client may suggest values for the network address
and lease time in the DHCPDISCOVER message.  The client may ... include
the 'IP address lease time' option to suggest the lease time it would
like
TEST_REFERENCE
RFC 2131 Section 3.5 Page 21 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP option 51 (IP Address Lease Time
        Option)
        with value 60 for interface <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 60
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:214 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:41760 (41 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2640  lo0    0    
128.224.166.0/23                vxTarget                      UC       3079  gei2   0    
vxTarget                        vxTarget                      UH       10373 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       415662lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Client to send option IP Address Lease Time with value
60 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 51 60

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcpc.option.lease_time "60"
sysvar: ipdhcpc.option.lease_time=60 ok
-> cmd sysvar get ipdhcpc.option.lease_time
sysvar: ipdhcpc.option.lease_time=60
-> ipd reconfigure ipdhcpc
C interp: unknown symbol name 'reconfigure'.
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCB09 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 399387167 (0x17CE2A1F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 60 seconds (1 minute ) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-8.5: Passed

>> DHCP-CLIENT-9.1
TEST_DESCRIPTION
A client with multiple network interfaces must use DHCP through each
interface independently to obtain configuration information
parameters for those separate interfaces
TEST_REFERENCE
RFC 2131 Section 3.6 Page 22 
'Use of DHCP in clients with multiple interfaces'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
 SETUP: Externally configure DHCP Client on <DIface-1>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'chaddr' field to <extractedChaddr>
- ANVL: Externally cause DUT to bring up <DIface-1>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-1>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'chaddr' field is not set to extractedChaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-2


  DHCP Client topology # 2
  ---------------------------------------

  +----------------+                          +----------------+
  |                |<AIface-0>      <DIface-0>|                |
  |             N0 +--------------------------+ N0             |
  |                |                          |                |
  |             N1 +--------------------------+ N1             |
  | <SERVER-1>     |<AIface-1>      <DIface-1>|           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:215 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:42102 (42 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2648  lo0    0    
128.224.166.0/23                vxTarget                      UC       3082  gei2   0    
vxTarget                        vxTarget                      UH       10430 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       418470lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei1
gei1	Link type:Ethernet  HWaddr 00:15:17:c8:90:29
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9029%gei1  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1300  metric:1  VR:0  ifindex:24
	RX packets:1 mcast:0 errors:0 dropped:1
	TX packets:8 mcast:5 errors:0
	collisions:0 unsupported proto:0
	RX bytes:322  TX bytes:1464

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2656  lo0    0    
128.224.166.0/23                vxTarget                      UC       3082  gei2   0    
vxTarget                        vxTarget                      UH       10488 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       422008lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x97C4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 375938762 (0x16685ECA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'chaddr' field (00:15:17:C8:90:28) to <extractedChaddr>

Booting up DHCP client on the DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-1>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei1 -dhcp
-> cmd ifconfig gei1 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5BD3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 913930921 (0x36797AA9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:29
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-1>

'chaddr' field in received DHCPDISCOVER Message is correctly set to 00:15:17:C8:90:29 (not set to 00:15:17:C8:90:28)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei1 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-9.1: Passed

>> DHCP-CLIENT-10.1
TEST_DESCRIPTION
A client SHOULD use DHCP to reacquire or verify its IP address and
network parameters whenever the local network parameters may have
changed; e.g., at system boot time
TEST_REFERENCE
RFC 2131 Section 3.7 Page 22 'When clients should use DHCP'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-2> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
          - Length field is not set to 4
          - Value is not set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


  DHCP Client topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <SERVER-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <SERVER-2>     |
  +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:52 mcast:0 errors:0 dropped:44
	TX packets:217 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:15118 (15 k)  TX bytes:42786 (42 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2664  lo0    0    
128.224.166.0/23                vxTarget                      UC       3082  gei2   0    
vxTarget                        vxTarget                      UH       10609 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       426388lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF9AA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2847828365 (0xA9BE698D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D86 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xD07F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2847828365 (0xA9BE698D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD6D6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2847828365 (0xA9BE698D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.3
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D85 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xCD7F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2847828365 (0xA9BE698D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x689D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 748451773 (0x2C9C77BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-2> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:07
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D7F (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.7
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3E69 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 748451773 (0x2C9C77BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.7
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x40C9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 748451773 (0x2C9C77BD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.7
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.7 
(not containing option Requested IP Address (50) Length : 4 Value : 54.0.0.3 )

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-10.1: Passed

>> DHCP-CLIENT-11.1
TEST_DESCRIPTION
The last option must always be the 'end' option
TEST_REFERENCE
RFC 2131 Section 4.1 Page 22-23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Message Option containing:
          - 255 (End Option) at position Last
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:47
	TX packets:223 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16084 (16 k)  TX bytes:44838 (44 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2672  lo0    0    
128.224.166.0/23                vxTarget                      UC       3088  gei2   0    
vxTarget                        vxTarget                      UH       10713 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       430304lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x46B6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4090024567 (0xF3C8D277)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Message Option in received DHCPDISCOVER Message is correctly set as  End Option (255) in position 5  

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.1: Passed

>> DHCP-CLIENT-11.2
TEST_DESCRIPTION
DHCP clients MUST use the IP address provided in the 'server identifier'
option for any unicast requests to the DHCP server
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:55 mcast:0 errors:0 dropped:47
	TX packets:224 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16084 (16 k)  TX bytes:45180 (45 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2680  lo0    0    
128.224.166.0/23                vxTarget                      UC       3090  gei2   0    
vxTarget                        vxTarget                      UH       10786 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       433964lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3FEC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3349611875 (0xC7A70563)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D84 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x16C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3349611875 (0xC7A70563)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1E18 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3349611875 (0xC7A70563)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D83 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x13C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3349611875 (0xC7A70563)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xD4C4 (54468)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x38DE (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x87E6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3349611875 (0xC7A70563)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 54.0.0.1

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.2: Passed

>> DHCP-CLIENT-11.3
TEST_DESCRIPTION
DHCP messages broadcast by a client prior to that client obtaining
its IP address must have the source address field in the IP header
set to 0
(Note: This test verifies source IP address field of DHCPDISCOVER
 Message)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - Source IP Address field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:58 mcast:0 errors:0 dropped:49
	TX packets:234 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16788 (16 k)  TX bytes:46800 (46 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2688  lo0    0    
128.224.166.0/23                vxTarget                      UC       3104  gei2   0    
vxTarget                        vxTarget                      UH       10859 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       437320lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDEE3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2578551905 (0x99B19461)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Source IP Address field in received DHCPDISCOVER Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.3: Passed

>> DHCP-CLIENT-11.4
TEST_DESCRIPTION
DHCP messages broadcast by a client prior to that client obtaining
its IP address must have the source address field in the IP header
set to 0
(Note: This test verifies source IP address field of DHCPREQUEST
 Message)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Source IP Address field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:58 mcast:0 errors:0 dropped:49
	TX packets:235 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:16788 (16 k)  TX bytes:47142 (47 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2696  lo0    0    
128.224.166.0/23                vxTarget                      UC       3107  gei2   0    
vxTarget                        vxTarget                      UH       10932 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       441016lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x60DE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4262964736 (0xFE17AE00)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D82 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x37B5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4262964736 (0xFE17AE00)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3F0A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4262964736 (0xFE17AE00)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

Source IP Address field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.4: Passed

>> DHCP-CLIENT-11.5
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly parses 'sname' field when
       Option Overload is present and set to 'sname contains options')
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:59 mcast:0 errors:0 dropped:50
	TX packets:238 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:17110 (17 k)  TX bytes:48168 (48 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2704  lo0    0    
128.224.166.0/23                vxTarget                      UC       3108  gei2   0    
vxTarget                        vxTarget                      UH       11004 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       444604lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4A84 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1804490468 (0x6B8E56E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C75 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x5993 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1804490468 (0x6B8E56E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x28B0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1804490468 (0x6B8E56E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C74 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x5990 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1804490468 (0x6B8E56E4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2712  lo0    0    
128.224.166.0/23                vxTarget                      UC       3111  gei2   0    
vxTarget                        vxTarget                      UH       11047 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       447020lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x2DD4 (11732)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xDEDE (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x933B (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xD21B (53787)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.5: Passed

>> DHCP-CLIENT-11.6
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly parses 'file' field when
       Option Overload is present and set to 'file contains options')
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:62 mcast:0 errors:0 dropped:52
	TX packets:248 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:18350 (18 k)  TX bytes:49532 (49 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2720  lo0    0    
128.224.166.0/23                vxTarget                      UC       3116  gei2   0    
vxTarget                        vxTarget                      UH       11118 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       449850lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2B40 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3672114902 (0xDAE006D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C73 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x3B4F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3672114902 (0xDAE006D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x096C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3672114902 (0xDAE006D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C72 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x3B4C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3672114902 (0xDAE006D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2720  lo0    0    
128.224.166.0/23                vxTarget                      UC       3119  gei2   0    
vxTarget                        vxTarget                      UH       11146 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       452184lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xC33B (49979)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x4977 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x7DB2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0xE7A4 (59300)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.6: Passed

>> DHCP-CLIENT-11.8
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: Here we verify that DUT correctly does not parse 'file' field 
       as Options when Option Overload is not present)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)(*INVALID*)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)(*INVALID*)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:65 mcast:0 errors:0 dropped:54
	TX packets:257 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:19590 (19 k)  TX bytes:50854 (50 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2728  lo0    0    
128.224.166.0/23                vxTarget                      UC       3124  gei2   0    
vxTarget                        vxTarget                      UH       11217 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       454966lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xED09 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 309398908 (0x12710D7C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C71 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xFD18 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 309398908 (0x12710D7C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCB35 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 309398908 (0x12710D7C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C70 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xFD15 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 309398908 (0x12710D7C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2728  lo0    0    
128.224.166.0/23                vxTarget                      UC       3127  gei2   0    
vxTarget                        vxTarget                      UH       11245 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       457468lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xD91F (55583)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x3393 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x5F50 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0607 (1543)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:68 mcast:0 errors:0 dropped:56
	TX packets:266 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:20830 (20 k)  TX bytes:52176 (52 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       3132  gei2   0    
vxTarget                        vxTarget                      UH       11318 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       460282lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC34F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2998245105 (0xB2B596F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x6008 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2998245105 (0xB2B596F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 6
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA17B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2998245105 (0xB2B596F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x5D08 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2998245105 (0xB2B596F1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 6
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       3135  gei2   0    
vxTarget                        vxTarget                      UH       11346 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       462544lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.8: Passed

>> DHCP-CLIENT-11.9
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
by the 'options overload' option) MUST begin with the first octet of
the field
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'sname' field when 1st octet is not the
       start of the option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:70 mcast:0 errors:0 dropped:58
	TX packets:274 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:22010 (22 k)  TX bytes:53112 (53 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2736  lo0    0    
128.224.166.0/23                vxTarget                      UC       3144  gei2   0    
vxTarget                        vxTarget                      UH       11400 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       465260lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2FAB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3205635641 (0xBF121E39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x3EBA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3205635641 (0xBF121E39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0DD7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3205635641 (0xBF121E39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x3EB7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3205635641 (0xBF121E39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2744  lo0    0    
128.224.166.0/23                vxTarget                      UC       3147  gei2   0    
vxTarget                        vxTarget                      UH       11446 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       467628lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

! DHCP Server <SERVER-1> did not receive expected

! ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.9: !INCONCLUSIVE!

>> DHCP-CLIENT-11.10
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated ...
MUST be terminated by an 'end' option
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'sname' field in absence of 'end' option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:72 mcast:0 errors:0 dropped:60
	TX packets:282 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:23190 (23 k)  TX bytes:54048 (54 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2752  lo0    0    
128.224.166.0/23                vxTarget                      UC       3157  gei2   0    
vxTarget                        vxTarget                      UH       11519 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       470296lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x333E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 146395391 (0x08B9D0FF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x424D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 146395391 (0x08B9D0FF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x116A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 146395391 (0x08B9D0FF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C6A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x424A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 146395391 (0x08B9D0FF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2752  lo0    0    
128.224.166.0/23                vxTarget                      UC       3160  gei2   0    
vxTarget                        vxTarget                      UH       11543 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       472668lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xF6B3 (63155)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x15FF (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xD962 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x8BF4 (35828)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:75 mcast:0 errors:0 dropped:62
	TX packets:291 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:24430 (24 k)  TX bytes:55370 (55 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2760  lo0    0    
128.224.166.0/23                vxTarget                      UC       3165  gei2   0    
vxTarget                        vxTarget                      UH       11614 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       474574lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4C8C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2638619428 (0x9D462324)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C69 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x5A9C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2638619428 (0x9D462324)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2AB8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2638619428 (0x9D462324)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C68 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0x5A99 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2638619428 (0x9D462324)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2760  lo0    0    
128.224.166.0/23                vxTarget                      UC       3168  gei2   0    
vxTarget                        vxTarget                      UH       11642 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       477508lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.10: Passed

>> DHCP-CLIENT-11.11
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated ...
MUST be terminated by an 'end' option
(Note: In this test we verify that the DUT correctly does not imbibe
       the Option present in 'file' field in absence of 'end' option)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:77 mcast:0 errors:0 dropped:64
	TX packets:299 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:25610 (25 k)  TX bytes:56306 (56 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2760  lo0    0    
128.224.166.0/23                vxTarget                      UC       3176  gei2   0    
vxTarget                        vxTarget                      UH       11697 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       480344lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE656 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2218762848 (0x843FA260)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to 576     (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C67 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xF665 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2218762848 (0x843FA260)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC482 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2218762848 (0x843FA260)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C66 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xF662 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2218762848 (0x843FA260)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2768  lo0    0    
128.224.166.0/23                vxTarget                      UC       3178  gei2   0    
vxTarget                        vxTarget                      UH       11741 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       482792lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0x407A (16506)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0xCC38 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0xEBA2 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x79B4 (31156)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:80 mcast:0 errors:0 dropped:66
	TX packets:309 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:26850 (26 k)  TX bytes:57670 (57 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2776  lo0    0    
128.224.166.0/23                vxTarget                      UC       3184  gei2   0    
vxTarget                        vxTarget                      UH       11813 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       485454lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE756 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1651688237 (0x6272C32D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C65 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xF666 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1651688237 (0x6272C32D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC582 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1651688237 (0x6272C32D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0C64 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 556 
UDP: Checksum         = 0xF663 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1651688237 (0x6272C32D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2776  lo0    0    
128.224.166.0/23                vxTarget                      UC       3186  gei2   0    
vxTarget                        vxTarget                      UH       11842 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       487596lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.11: Passed

>> DHCP-CLIENT-11.12
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
 ...)
and MUST be followed by 'pad' options to fill the remainder of the field
(Note: This test is done using the 'sname' field only)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ICMP Echo Message
- ANVL: Externally reset all client configurations
        for all configured interfaces on the DUT
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 3 (Router Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL: Externally cause DUT to send ICMP Echo Request
        through <DIface-0> to IP address <IP-UNUSED-ADDRESS>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:82 mcast:0 errors:0 dropped:68
	TX packets:317 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:28030 (28 k)  TX bytes:58606 (58 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2776  lo0    0    
128.224.166.0/23                vxTarget                      UC       3194  gei2   0    
vxTarget                        vxTarget                      UH       11897 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       490256lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x53D5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 376021688 (0x1669A2B8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D6C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x64F6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 376021688 (0x1669A2B8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3201 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 376021688 (0x1669A2B8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D6B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x64F3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 376021688 (0x1669A2B8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2784  lo0    0    
128.224.166.0/23                vxTarget                      UC       3195  gei2   0    
vxTarget                        vxTarget                      UH       11940 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       492816lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 72 bytes
IP: Identification         = 0xB1F0 (45552)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x5AC2 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 56.0.0.1
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x57D7 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x0D80 (3456)
ICMP: Sequence Number  = 0x0000 (0)
ICMP:
ICMP: --- Data [44 bytes] ---
ICMP:  20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F    !"#$%&'()*+,-./
ICMP:  30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F   0123456789:;<=>?
ICMP:  40 41 42 43 44 45 46 47 48 49 4A 4B               @ABCDEFGHIJK
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----


DHCP Server <SERVER-1> received expected ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:85 mcast:0 errors:0 dropped:70
	TX packets:326 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:28740 (28 k)  TX bytes:59928 (59 k)

-> cmd route delete default
    delete net 0.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2792  lo0    0    
128.224.166.0/23                vxTarget                      UC       3201  gei2   0    
vxTarget                        vxTarget                      UH       12011 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       495558lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.
cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFB3C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1018025228 (0x3CADD50C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION(*INVALID*)     (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D6A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x0D5D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1018025228 (0x3CADD50C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD968 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1018025228 (0x3CADD50C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_ROUTER_OPTION (Router) 
  - Length field set to 4 (4) 
  - Value set to <SERVER1-IP-ADDRESS> (54.0.0.1) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION(*INVALID*)     (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 311 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D69 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 291 
UDP: Checksum         = 0x0D5A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1018025228 (0x3CADD50C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Causing DUT to send 5 ICMP Echo Request through <DIface-0>,
containing:
IP Destination Address field set to 56.0.0.1
ICMP Echo Data size 32
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
56.0.0.1 0 5 32

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/ip-dut-background-echo-request-send-command.exp $ANVL_DUTHOSTNAME"

Listening (up to 30.000 seconds) for no ICMP Echo Request Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2792  lo0    0    
128.224.166.0/23                vxTarget                      UC       3203  gei2   0    
vxTarget                        vxTarget                      UH       12039 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       497944lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> cmd ping -c 5  -s 52 56.0.0.1

Pinging 56.0.0.1 (56.0.0.1) with 52 bytes of data:
sendmsg(): operation failed: errno = 0x33 (51)
-> exit
Au revoir!
Connection closed by foreign host.

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.12: Passed

>> DHCP-CLIENT-11.13
TEST_DESCRIPTION
The retransmission delay SHOULD be doubled with subsequent
retransmissions up to a maximum of 64 seconds
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (64 + 32 + 16 + 8 + 4 +
       2 + 1 + <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends  DHCPDISCOVER Message(s)
- ANVL: Verify that the time interval between
        reception of last two DHCPDISCOVER Messages
         is less than 
        (64  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:87 mcast:0 errors:0 dropped:72
	TX packets:334 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:29390 (29 k)  TX bytes:60864 (60 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2792  lo0    0    
128.224.166.0/23                vxTarget                      UC       3215  gei2   0    
vxTarget                        vxTarget                      UH       12092 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       500720lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 147.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2525 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3347849285 (0xC78C2045)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2521 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3347849285 (0xC78C2045)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2519 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3347849285 (0xC78C2045)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2509 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3347849285 (0xC78C2045)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x24E9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3347849285 (0xC78C2045)
DHCP: secs                      = 60
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected  DHCPDISCOVER Messages from <DIface-0>

Time interval (32.052 sec) between
reception of last two DHCPDISCOVER Messages 
is correctly  is less than 
(64  +  <ParamToleranceTime>) second (less than 84.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.13: Passed

>> DHCP-CLIENT-11.14
TEST_DESCRIPTION
The client MUST adopt a retransmission strategy that incorporates a
randomized exponential backoff algorithm to determine the delay
between retransmissions
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Listen (for upto (3 *
        (<ParamFirstRetransmissionInterval> + <ParamToleranceTime>)) seconds)
        on <DIface-0>
-  DUT: Send multiple DHCPDISCOVER Messages
- ANVL: Verify that the time interval between
        reception of 3rd last DHCPDISCOVER Message and second last
         DHCPDISCOVER Message
         is within the range of 
        (<ParamFirstRetransmissionInterval>  -  1) to
        (<ParamFirstRetransmissionInterval>  +  1seconds
- ANVL: Verify that the time interval between
        reception of last two DHCPDISCOVER Messages
         is within the range of 
        ((2*<ParamFirstRetransmissionInterval>)  -  1) to
        ((2*<ParamFirstRetransmissionInterval>)  +  1seconds
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:87 mcast:0 errors:0 dropped:72
	TX packets:339 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:29390 (29 k)  TX bytes:62574 (62 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2800  lo0    0    
128.224.166.0/23                vxTarget                      UC       3234  gei2   0    
vxTarget                        vxTarget                      UH       12167 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       504052lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 72.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x69CA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 881946267 (0x34916E9B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x69C6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 881946267 (0x34916E9B)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x69BE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 881946267 (0x34916E9B)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER
 Messages from <DIface-0>

Time interval (3.940 sec) between
reception of 3dr last DHCPDISCOVER Message and second last
 DHCPDISCOVER Message 
is correctly  is within the range of 
(<ParamFirstRetransmissionInterval>  - 1) to
(<ParamFirstRetransmissionInterval>  + 1) seconds (3.000 to 5.000 sec)

Time interval (8.084 sec) between
reception of last two DHCPDISCOVER Messages 
is correctly  is within the range of 
((2*<ParamFirstRetransmissionInterval>) - 1) to
((2*<ParamFirstRetransmissionInterval>) + 1) seconds (7.000 to 9.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.14: Passed

>> DHCP-CLIENT-11.15
TEST_DESCRIPTION
For example, a client may choose a different, random initial 'xid'
each time the client is rebooted,
TEST_REFERENCE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Extracts the content of 'xid' field to <extractedXID>
 SETUP: Externally cause DUT to release <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'xid' field is not set to extractedXID
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:87 mcast:0 errors:0 dropped:72
	TX packets:342 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:29390 (29 k)  TX bytes:63600 (63 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2808  lo0    0    
128.224.166.0/23                vxTarget                      UC       3238  gei2   0    
vxTarget                        vxTarget                      UH       12240 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       507628lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x788E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2814373032 (0xA7BFECA8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D6B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4F65 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2814373032 (0xA7BFECA8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x56BA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2814373032 (0xA7BFECA8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D6A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4C65 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2814373032 (0xA7BFECA8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Extracted the content of 'xid' field (0xA7BFECA8) to <extractedXID>

Releasing IP address on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-release-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 up
-> cmd ifconfig gei0 -dhcp
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA44F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3633025051 (0xD88B901B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>
e
'xid' field in received DHCPDISCOVER Message is correctly set to 3633025051 (0xD88B901B) (not set to 2814373032 (0xA7BFECA8))

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-11.15: Passed

>> DHCP-CLIENT-12.1
TEST_DESCRIPTION
Client inserts ... , 'ciaddr' MUST be zero
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REQUESTING
-  DUT: Transit finite state to REQUESTING
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:89 mcast:0 errors:0 dropped:74
	TX packets:346 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:30034 (30 k)  TX bytes:64968 (64 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2816  lo0    0    
128.224.166.0/23                vxTarget                      UC       3243  gei2   0    
vxTarget                        vxTarget                      UH       12346 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       511404lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x4572 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3788498356 (0xE1CFE5B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D69 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1C49 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3788498356 (0xE1CFE5B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x239E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3788498356 (0xE1CFE5B4)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to REQUESTING state

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.1: Passed

>> DHCP-CLIENT-12.2
TEST_DESCRIPTION
requested IP address' MUST be filled in with the yiaddr value from the
chosen DHCPOFFER.
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'yiaddr' field set to <SERVER1-IP-POOL-0-1>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-1>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:90 mcast:0 errors:0 dropped:75
	TX packets:349 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:30356 (30 k)  TX bytes:65994 (65 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2824  lo0    0    
128.224.166.0/23                vxTarget                      UC       3246  gei2   0    
vxTarget                        vxTarget                      UH       12420 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       515044lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB490 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530527020 (0x5B39FD2C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'yiaddr' field set to <SERVER1-IP-POOL-0-1> (54.0.0.3) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x004F (79)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D68 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8B66 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530527020 (0x5B39FD2C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x91BC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1530527020 (0x5B39FD2C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.3
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.3 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.2: Passed

>> DHCP-CLIENT-12.3
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:91 mcast:0 errors:0 dropped:76
	TX packets:352 mcast:47 errors:0
	collisions:0 unsupported proto:0
	RX bytes:30678 (30 k)  TX bytes:67020 (67 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2832  lo0    0    
128.224.166.0/23                vxTarget                      UC       3248  gei2   0    
vxTarget                        vxTarget                      UH       12491 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       517818lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9D15 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3022502841 (0xB427BBB9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0050 (80)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D67 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x73EC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3022502841 (0xB427BBB9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7B41 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3022502841 (0xB427BBB9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0051 (81)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D66 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x70EC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3022502841 (0xB427BBB9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x80AD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3022502841 (0xB427BBB9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.3: Passed

>> DHCP-CLIENT-12.4
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'requested IP address' option MUST be filled in with client's notion
  of its previously assigned address.
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:93 mcast:0 errors:0 dropped:78
	TX packets:368 mcast:54 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31322 (31 k)  TX bytes:68916 (68 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2840  lo0    0    
128.224.166.0/23                vxTarget                      UC       3259  gei2   0    
vxTarget                        vxTarget                      UH       12583 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       521906lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBA0A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4019938128 (0xEF9B6350)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0052 (82)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D65 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x90E1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4019938128 (0xEF9B6350)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9836 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4019938128 (0xEF9B6350)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D64 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x8DE1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4019938128 (0xEF9B6350)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9DA2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4019938128 (0xEF9B6350)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly contains Option Requested IP Address (50) Length : 4 Value : 54.0.0.2 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.4: Passed

>> DHCP-CLIENT-12.5
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  'ciaddr' MUST be zero
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
 SETUP: Externally cause DUT to reboot <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:95 mcast:0 errors:0 dropped:80
	TX packets:384 mcast:61 errors:0
	collisions:0 unsupported proto:0
	RX bytes:31966 (31 k)  TX bytes:70812 (70 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2848  lo0    0    
128.224.166.0/23                vxTarget                      UC       3268  gei2   0    
vxTarget                        vxTarget                      UH       12672 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       525498lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x9CE6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 226255508 (0x0D7C6294)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D63 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x73BD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 226255508 (0x0D7C6294)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x7B12 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 226255508 (0x0D7C6294)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D62 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x70BD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 226255508 (0x0D7C6294)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Rebooting DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reboot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd ifconfig gei0 down 
-> cmd ifconfig gei0 up 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x807E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 226255508 (0x0D7C6294)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.5: Passed

>> DHCP-CLIENT-12.6
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:97 mcast:0 errors:0 dropped:82
	TX packets:400 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:32610 (32 k)  TX bytes:72708 (72 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2856  lo0    0    
128.224.166.0/23                vxTarget                      UC       3278  gei2   0    
vxTarget                        vxTarget                      UH       12762 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       528970lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE2C2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1154999644 (0x44D7E55C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D61 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB999 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1154999644 (0x44D7E55C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC0EE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1154999644 (0x44D7E55C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D60 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xB699 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1154999644 (0x44D7E55C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xC59D (50589)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4805 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2ABD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1154999644 (0x44D7E55C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.6: Passed

>> DHCP-CLIENT-12.7
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  'requested IP address' option MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:100 mcast:0 errors:0 dropped:84
	TX packets:410 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:33314 (33 k)  TX bytes:74328 (74 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2864  lo0    0    
128.224.166.0/23                vxTarget                      UC       3294  gei2   0    
vxTarget                        vxTarget                      UH       12835 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       532474lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF768 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 865526263 (0x3396E1F7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
e
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xCE3F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 865526263 (0x3396E1F7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD594 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 865526263 (0x3396E1F7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xCB3F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 865526263 (0x3396E1F7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0C5B (3163)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0148 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3F63 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 865526263 (0x3396E1F7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Requested IP Address (50) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.7: Passed

>> DHCP-CLIENT-12.8
TEST_DESCRIPTION
o DHCPREQUEST generated during RENEWING state:
  ciaddr' MUST be filled in with client's IP address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:103 mcast:0 errors:0 dropped:86
	TX packets:420 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:34018 (34 k)  TX bytes:75948 (75 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2872  lo0    0    
128.224.166.0/23                vxTarget                      UC       3307  gei2   0    
vxTarget                        vxTarget                      UH       12906 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       535594lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xFD23 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1156434661 (0x44EDCAE5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xD3FA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1156434661 (0x44EDCAE5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xDB4F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1156434661 (0x44EDCAE5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xD0FA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1156434661 (0x44EDCAE5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA152 (41298)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x6C50 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x451E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1156434661 (0x44EDCAE5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 54.0.0.2

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.8: Passed

>> DHCP-CLIENT-12.9
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'server identifier' MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 54 (Server Identifier Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:106 mcast:0 errors:0 dropped:88
	TX packets:430 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:34722 (34 k)  TX bytes:77568 (77 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2880  lo0    0    
128.224.166.0/23                vxTarget                      UC       3319  gei2   0    
vxTarget                        vxTarget                      UH       12981 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       539534lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5BE5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2300782574 (0x892327EE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x32BC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2300782574 (0x892327EE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x3A11 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2300782574 (0x892327EE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D5A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x2FBC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2300782574 (0x892327EE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD9E0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2300782574 (0x892327EE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Server Identifier (54) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.9: Passed

>> DHCP-CLIENT-12.10
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'requested IP address' option MUST NOT be filled in
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Message Option containing:
          - Type field is not set to 50 (Requested IP Address Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:109 mcast:0 errors:0 dropped:90
	TX packets:441 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:35426 (35 k)  TX bytes:79530 (79 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2888  lo0    0    
128.224.166.0/23                vxTarget                      UC       3337  gei2   0    
vxTarget                        vxTarget                      UH       13054 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       543046lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x17F0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 80277566 (0x04C8F03E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D59 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xEEC6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 80277566 (0x04C8F03E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xF61B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 80277566 (0x04C8F03E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D58 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xEBC6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 80277566 (0x04C8F03E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x95EB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 80277566 (0x04C8F03E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Message Option in received DHCPREQUEST Message correctly does not contain Option Requested IP Address (50) 

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.10: Passed

>> DHCP-CLIENT-12.11
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  'ciaddr' MUST be filled in with client's IP address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'ciaddr' field is set to <SERVER1-IP-POOL-0-0>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:112 mcast:0 errors:0 dropped:92
	TX packets:452 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:36130 (36 k)  TX bytes:81492 (81 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2896  lo0    0    
128.224.166.0/23                vxTarget                      UC       3354  gei2   0    
vxTarget                        vxTarget                      UH       13125 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       546194lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xE844 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 150084544 (0x08F21BC0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D57 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xBF1B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 150084544 (0x08F21BC0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC670 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 150084544 (0x08F21BC0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D56 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xBC1B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 150084544 (0x08F21BC0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6640 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 150084544 (0x08F21BC0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'ciaddr' field in received DHCPREQUEST Message is correctly set to 54.0.0.2

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.11: Passed

>> DHCP-CLIENT-12.12
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  This message MUST be broadcast to the 0xffffffff IP broadcast address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to REBINDING
-  DUT: Transit finite state to REBINDING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:115 mcast:0 errors:0 dropped:94
	TX packets:463 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:36834 (36 k)  TX bytes:83454 (83 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2904  lo0    0    
128.224.166.0/23                vxTarget                      UC       3376  gei2   0    
vxTarget                        vxTarget                      UH       13198 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       549738lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC5FC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 729357185 (0x2B791B81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D55 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9CD3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 729357185 (0x2B791B81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA428 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 729357185 (0x2B791B81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D54 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x99D3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 729357185 (0x2B791B81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

Waiting (up to 30.000 seconds) for DUT Client to transit to REBINDING state
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DUT successfully transited to REBINDING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x43F8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 729357185 (0x2B791B81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-12.12: Passed

>> DHCP-CLIENT-13.1
TEST_DESCRIPTION
The client SHOULD wait a random time between one and ten seconds to
desynchronize the use of DHCP at startup
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPNAK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto (10 +
       <ParamToleranceTime>) second) on <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that the time interval between
        sending of last DHCPNAK Message and reception of last
         DHCPDISCOVER Message
         is greater than or equal to 
        (1  -  <ParamToleranceTime>) second
- ANVL: Verify that the time interval between
        sending of last DHCPNAK Message and reception of last
         DHCPDISCOVER Message
         is less than or equal to 
        (10  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:118 mcast:0 errors:0 dropped:96
	TX packets:474 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:37538 (37 k)  TX bytes:85416 (85 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2912  lo0    0    
128.224.166.0/23                vxTarget                      UC       3393  gei2   0    
vxTarget                        vxTarget                      UH       13273 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       553642lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8EA6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 612784586 (0x248659CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D53 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x657D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 612784586 (0x248659CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6CD2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 612784586 (0x248659CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D52 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x627D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 612784586 (0x248659CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xC5D8 (50648)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x47CA (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD6A0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 612784586 (0x248659CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPNAK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x4371 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 258 
UDP: Checksum         = 0xA0B9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 612784586 (0x248659CA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCDAC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 4184681332 (0xF96D2B74)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Time interval (10.033 sec) between
sending of last DHCPNAK Message and reception of last DHCPDISCOVER Message 
is correctly  is greater than or equal to 
(1  -  <ParamToleranceTime>) second (greater than or equal to 0.000 sec)

Time interval (10.033 sec) between
sending of last DHCPNAK Message and reception of last DHCPDISCOVER Message 
is correctly  is less than or equal to 
(10  +  <ParamToleranceTime>) second (less than or equal to 30.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.1: Passed

>> DHCP-CLIENT-13.2
TEST_DESCRIPTION
The client begins in INIT state and forms a DHCPDISCOVER message ...
The client sets 'ciaddr' to 0x00000000
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'ciaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:122 mcast:0 errors:0 dropped:98
	TX packets:484 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38534 (38 k)  TX bytes:87036 (87 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2920  lo0    0    
128.224.166.0/23                vxTarget                      UC       3410  gei2   0    
vxTarget                        vxTarget                      UH       13346 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       557154lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x34CF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3205503255 (0xBF101917)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

'ciaddr' field in received DHCPDISCOVER Message is correctly set to 0.0.0.0

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
exit
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.2: Passed

>> DHCP-CLIENT-13.3
TEST_DESCRIPTION
The client begins in INIT state and forms a DHCPDISCOVER message ...
The client MUST include its hardware address in the 'chaddr' field
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of Source Harware Address field to
        <extractedSrcHwAddr>
- ANVL: Verify that received DHCPDISCOVER Message contains:
        - 'chaddr' field is set to extractedSrcHwAddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:122 mcast:0 errors:0 dropped:98
	TX packets:485 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38534 (38 k)  TX bytes:87378 (87 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2928  lo0    0    
128.224.166.0/23                vxTarget                      UC       3411  gei2   0    
vxTarget                        vxTarget                      UH       13418 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       560604lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xEBED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1693563927 (0x64F1BC17)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of Source Harware Address field (00:15:17:C8:90:28) to <extractedSrcHwAddr>

'chaddr' field in received DHCPDISCOVER Message is correctly set to 00:15:17:C8:90:28

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
xit
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.3: Passed

>> DHCP-CLIENT-13.4
TEST_DESCRIPTION
If the 'xid' of an arriving DHCPOFFER message does not match the
'xid' of the most recent DHCPDISCOVER message, the DHCPOFFER message
must be silently discarded
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to (extractedXID+1)
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:122 mcast:0 errors:0 dropped:98
	TX packets:486 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38534 (38 k)  TX bytes:87720 (87 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2936  lo0    0    
128.224.166.0/23                vxTarget                      UC       3414  gei2   0    
vxTarget                        vxTarget                      UH       13486 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       564380lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6451 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 358912833 (0x15649341)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0x15649341) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to (extractedXID+1) (0x15649342) 
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D50 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x3B27 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 358912834 (0x15649342)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for no DHCPREQUEST Message on <DIface-0>
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x644D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 358912833 (0x15649341)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6445 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 358912833 (0x15649341)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6435 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 358912833 (0x15649341)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> correctly did not receive DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.4: Passed

>> DHCP-CLIENT-13.5
TEST_DESCRIPTION
Any arriving DHCPACK messages must be silently discarded
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 36 
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL:DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
       <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPREQUEST Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:123 mcast:0 errors:0 dropped:99
	TX packets:490 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:38856 (38 k)  TX bytes:89088 (89 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2944  lo0    0    
128.224.166.0/23                vxTarget                      UC       3418  gei2   0    
vxTarget                        vxTarget                      UH       13564 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       567884lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA930 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1522927872 (0x5AC60900)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4F (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x7D07 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1522927872 (0x5AC60900)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for no DHCPREQUEST Message on <DIface-0>
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA92C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1522927872 (0x5AC60900)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA924 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1522927872 (0x5AC60900)
DHCP: secs                      = 12
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA914 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1522927872 (0x5AC60900)
DHCP: secs                      = 28
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> ignoring DHCPDISCOVER Message from <DIface-0>

DHCP Server <SERVER-1> correctly did not receive DHCPREQUEST Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.5: Passed

>> DHCP-CLIENT-13.6
TEST_DESCRIPTION
The DHCPREQUEST message contains the same 'xid' as the DHCPOFFER
message
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 38
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
- ANVL: Extracts the content of 'xid' field to <extractedXID>
- ANVL:DHCP Server <SERVER-1> Sends DHCPOFFER Message to DUT through
       <DIface-0> containing :
        - 'xid' field set to extractedXID
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - 'xid' field is set to extractedXID
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:124 mcast:0 errors:0 dropped:100
	TX packets:494 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:39178 (39 k)  TX bytes:90456 (90 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2960  lo0    0    
128.224.166.0/23                vxTarget                      UC       3422  gei2   0    
vxTarget                        vxTarget                      UH       13643 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       571668lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2BC1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1296864233 (0x4D4C93E9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exi
DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Extracted the content of 'xid' field (0x4D4C93E9) to <extractedXID>

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT through <DIface-0> containing :
  - 'xid' field set to extractedXID (0x4D4C93E9) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x0298 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1296864233 (0x4D4C93E9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x09ED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1296864233 (0x4D4C93E9)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

'xid' field in received DHCPREQUEST Message is correctly set to 1296864233 (0x4D4C93E9)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
t
Au revoir!
Connection closed by foreign host.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.6: Passed

>> DHCP-CLIENT-13.9
TEST_DESCRIPTION
If the network address appears to be in use, the client MUST send a
DHCPDECLINE message to the server
TEST_REFERENCE
RFC 2131 Section 4.4.1 Page 39
'Initialization and allocation of network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ARP Request Message
- ANVL: Verify that received ARP Request Message contains:
        - ARP Target IP Address field is set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Sends ARP Response Message to DUT
       through <DIface-0> containing :
        - ARP Sender MAC Address field set to <MAC-UNUSED-ADDRESS>
        - ARP Sender IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDECLINE Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:125 mcast:0 errors:0 dropped:101
	TX packets:497 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:39500 (39 k)  TX bytes:91482 (91 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2960  lo0    0    
128.224.166.0/23                vxTarget                      UC       3424  gei2   0    
vxTarget                        vxTarget                      UH       13710 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       575128lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8BFC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 546791523 (0x20976063)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x62D3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 546791523 (0x20976063)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6A28 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 546791523 (0x20976063)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x5FD3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 546791523 (0x20976063)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Listening (up to 30.000 seconds) for ARP Request Message on <DIface-0>
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 0.0.0.0
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> received expected ARP Request Message from <DIface-0>

ARP Target IP Address field in received ARP Request is correctly set to 54.0.0.2

DHCP Server <SERVER-1> sending ARP Response Message to DUT through <DIface-0> containing :
  - ARP Sender MAC Address field set to     <MAC-UNUSED-ADDRESS> (02:02:00:00:00:03) 
  - ARP Sender IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:03
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDECLINE Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x33EB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 546791523 (0x20976063)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDECLINE Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-13.9: Passed

>> DHCP-CLIENT-14.1
TEST_DESCRIPTION
The client SHOULD NOT request lease time parameters
TEST_REFERENCE
RFC 2131 Section 4.4.3 Page 39
'Initialization with an externally assigned network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Message Option containing:
          - Type field is not set to 55 (Parameter Request List
             Option)
          - Length field is not set to 3
          - Value is not set to 51 (IP Address Lease Time Option)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:128 mcast:0 errors:0 dropped:103
	TX packets:501 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40204 (40 k)  TX bytes:92550 (92 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2968  lo0    0    
128.224.166.0/23                vxTarget                      UC       3437  gei2   0    
vxTarget                        vxTarget                      UH       13783 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       578460lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 54.0.0.1
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.1

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "54.0.0.1" 
sysvar: ipdhcpc.server=54.0.0.1 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=54.0.0.1
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dhcp 
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x685D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2634929334 (0x9D0DD4B6)
DHCP: secs                      = 4
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Message Option in received DHCPINFORM Message correctly contains Option Parameter Request List (55) Length : 4 
(not containing option Parameter Request List (55) Length : 3 )

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-14.1: Passed

>> DHCP-CLIENT-14.3
TEST_DESCRIPTION
otherwise it broadcasts the message to the limited (all 1s) broadcast
 address
TEST_REFERENCE
RFC 2131 Section 4.4.3 Page 39
'Initialization with an externally assigned network address'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally assign IP Address <SERVER1-IP-POOL-0-0> with mask
        <SERVER1-IP-POOL-NETMASK> on DUT
        for interface <DIface-0>
- ANVL: Externally cause DUT to send DHCPINFORM Message through
        <DIface-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPINFORM Message
- ANVL: Verify that received DHCPINFORM Message contains:
        - Destination IP Address field is set to
           <IP-BROADCAST-ADDRESS>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:128 mcast:0 errors:0 dropped:103
	TX packets:505 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40204 (40 k)  TX bytes:93018 (93 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       2992  lo0    0    
128.224.166.0/23                vxTarget                      UC       3440  gei2   0    
vxTarget                        vxTarget                      UH       13926 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       584936lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Assigning IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 inet add 54.0.0.2 netmask 255.0.0.0 up 
-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to send DHCPINFORM Message through <DIface-0>
to address 0.0.0.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 0.0.0.0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-dhcpinform-message-send-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPINFORM Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "enable"
sysvar: ipdhcpc.if.gei0.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only
sysvar: ipdhcpc.if.gei0.information_only=enable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "enable"
sysvar: ipdhcpc.if.gei1.information_only=enable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=enable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "0"
sysvar: ipdhcpc.remove_existing_addresses=0 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses
sysvar: ipdhcpc.remove_existing_addresses=0
-> cmd sysvar set -co ipdhcpc.server "0.0.0.0" 
sysvar: ipdhcpc.server=0.0.0.0 ok
-> cmd sysvar get ipdhcpc.server
sysvar: ipdhcpc.server=0.0.0.0
-> cmd ipd reconfigure ipdhcpc 
ipd: reconfigure ipdhcpc ok
-> cmd ifconfig gei0 dh
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB978 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3307625350 (0xC5265B86)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPINFORM Message from <DIface-0>

Destination IP Address field in received DHCPINFORM Message is correctly set to 255.255.255.255

Deleting IP Address 54.0.0.2 with mask 255.0.0.0 on <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 54.0.0.2 255.0.0.0 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-static-ip-assign-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.
cp 
-> e
-> cmd ifconfig gei0 xit
Au revoir!
Connection closed by foreign host.
inet delete 54.0.0.2 up
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-14.3: Passed

>> DHCP-CLIENT-16.1
TEST_DESCRIPTION
At time T1 the client moves to RENEWING state and sends (via unicast)
a DHCPREQUEST message to the server to extend its lease
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 40 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to <SERVER1-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:128 mcast:0 errors:0 dropped:103
	TX packets:507 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40204 (40 k)  TX bytes:93402 (93 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3016  lo0    0    
128.224.166.0/23                vxTarget                      UC       3443  gei2   0    
vxTarget                        vxTarget                      UH       14070 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       590668lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD154 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 511515941 (0x1E7D1D25)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT
exit

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA82B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 511515941 (0x1E7D1D25)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xAF80 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 511515941 (0x1E7D1D25)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D4A (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA52B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 511515941 (0x1E7D1D25)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 20.000 seconds) for DUT Client to transit to RENEWING state
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x8705 (34565)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x869D (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x194F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 511515941 (0x1E7D1D25)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 54.0.0.1

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.1: Passed

>> DHCP-CLIENT-16.2
TEST_DESCRIPTION
If no DHCPACK arrives before time T2, the client moves to REBINDING
state and sends (via broadcast) a DHCPREQUEST message to extend its
lease
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T2>-<ParamToleranceTime>) for DUT
        to go to a state just before T2 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that received DHCPREQUEST Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:131 mcast:0 errors:0 dropped:105
	TX packets:517 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:40908 (40 k)  TX bytes:95022 (95 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3024  lo0    0    
128.224.166.0/23                vxTarget                      UC       3456  gei2   0    
vxTarget                        vxTarget                      UH       14142 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       594012lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC4C9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2556407757 (0x985FAFCD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D49 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x9BA0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2556407757 (0x985FAFCD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xA2F5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2556407757 (0x985FAFCD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D48 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x98A0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2556407757 (0x985FAFCD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 50.000 seconds) for DUT to go to a state just before T2 expires
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x42C5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2556407757 (0x985FAFCD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Destination IP Address field in received DHCPREQUEST Message is correctly set to 255.255.255.255

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.2: Passed

>> DHCP-CLIENT-16.3
TEST_DESCRIPTION
T1 defaults to (0.5 * duration_of_lease).  T2 defaults to (0.875 *
duration_of_lease).  Times T1 and T2 SHOULD be chosen with some
random "fuzz" around a fixed value, to avoid synchronization of
client reacquisition
(Note: This test verifies the value of T1)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T1>-<ParamToleranceTime>) for DUT
        to go to a state just before T1 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that the time interval between
        sending of last DHCPACK Message and reception of last
         DHCPREQUEST Message
         is within the range of 
        (<REMOTE-CLIENT1-T1>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T1>  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:134 mcast:0 errors:0 dropped:107
	TX packets:528 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:41612 (41 k)  TX bytes:96984 (96 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3032  lo0    0    
128.224.166.0/23                vxTarget                      UC       3474  gei2   0    
vxTarget                        vxTarget                      UH       14215 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       597680lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xD3B0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1035795337 (0x3DBCFB89)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D47 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xAA87 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1035795337 (0x3DBCFB89)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB1DC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1035795337 (0x3DBCFB89)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D46 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0xA787 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1035795337 (0x3DBCFB89)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 20.000 seconds) for DUT to go to a state just before T1 expires
xit
Au revoir!
Connection closed by foreign host.

Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xD04D (53325)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3D55 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x1BAB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1035795337 (0x3DBCFB89)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Time interval (46.290 sec) between
sending of last DHCPACK Message and reception of last DHCPREQUEST Message 
is correctly  is within the range of 
(<REMOTE-CLIENT1-T1>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T1>  +  <ParamToleranceTime>) second (20.000 to 60.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.3: Passed

>> DHCP-CLIENT-16.4
TEST_DESCRIPTION
T1 defaults to (0.5 * duration_of_lease).  T2 defaults to (0.875 *
duration_of_lease).  Times T1 and T2 SHOULD be chosen with some
random "fuzz" around a fixed value, to avoid synchronization of
client reacquisition
(Note: This test verifies the value of T2)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<REMOTE-CLIENT1-T2>-<ParamToleranceTime>) for DUT
        to go to a state just before T2 expires
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPREQUEST Message
- ANVL: Verify that the time interval between
        sending of last DHCPACK Message and reception of last
         DHCPREQUEST Message
         is within the range of 
        (<REMOTE-CLIENT1-T2>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T2>  +  <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:137 mcast:0 errors:0 dropped:109
	TX packets:538 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:42316 (42 k)  TX bytes:98604 (98 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3040  lo0    0    
128.224.166.0/23                vxTarget                      UC       3487  gei2   0    
vxTarget                        vxTarget                      UH       14288 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       601300lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8EBD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 455500563 (0x1B266313)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D45 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6594 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 455500563 (0x1B266313)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6CE9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 455500563 (0x1B266313)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D44 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6294 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 455500563 (0x1B266313)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 50.000 seconds) for DUT to go to a state just before T2 expires
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x03A4 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0CB9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 455500563 (0x1B266313)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPREQUEST Message from <DIface-0>

Time interval (77.042 sec) between
sending of last DHCPACK Message and reception of last DHCPREQUEST Message 
is correctly  is within the range of 
(<REMOTE-CLIENT1-T2>  -  <ParamToleranceTime>) to
        (<REMOTE-CLIENT1-T2>  +  <ParamToleranceTime>) second (50.000 to 90.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.4: Passed

>> DHCP-CLIENT-16.5
TEST_DESCRIPTION
In both RENEWING and REBINDING states, if the client receives no
response to its DHCPREQUEST message, the client SHOULD wait one-half
of the remaining time until T2 (in RENEWING state) and one-half of
the remaining lease time (in REBINDING state), down to a minimum of
60 seconds, before retransmitting the DHCPREQUEST message.
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: Initialize server1 to offer IP Address Lease Time
         of <HIGH-LEASE-TIME> seconds to the DUT
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to RENEWING
-  DUT: Transit finite state to RENEWING
- ANVL:DHCP Server <SERVER-1> Listens (upto (((<REMOTE-CLIENT1-T2> -
       <REMOTE-CLIENT1-T1>) / 2) + (2 * <ParamToleranceTime>)) second) on
       <DIface-0>
-  DUT: Sends 2 DHCPREQUEST Messages
- ANVL: Verify that the time interval between
        reception of last two DHCPREQUEST Messages
         is within the range of 
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  - 
         <ParamToleranceTime>) to
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  + 
         <ParamToleranceTime>) second
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:140 mcast:0 errors:0 dropped:111
	TX packets:549 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:43020 (43 k)  TX bytes:100566 (100 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3048  lo0    0    
128.224.166.0/23                vxTarget                      UC       3504  gei2   0    
vxTarget                        vxTarget                      UH       14362 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       604616lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Initializing server1 to offer IP Address Lease Time
of <HIGH-LEASE-TIME> seconds to the DUT

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xED9F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1433848288 (0x5576C9E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D43 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4374 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1433848288 (0x5576C9E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBDCA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1433848288 (0x5576C9E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D42 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x4074 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1433848288 (0x5576C9E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 175 seconds (2 minutes 55 seconds)
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 306 seconds (5 minutes 6 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Waiting (up to 155.000 seconds) for DUT Client to transit to RENEWING state
xit
Au revoir!
Connection closed by foreign host.

DUT successfully transited to RENEWING state

Listening (up to 105.000 seconds) for DHCPREQUEST Message on <DIface-0>
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xD44F (54351)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3953 (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2799 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1433848288 (0x5576C9E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x1B58 (7000)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xF24A (Correct)
IP: Source Address         = 54.0.0.2
IP: Destination Address    = 54.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x2799 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1433848288 (0x5576C9E0)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 54.0.0.2
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 350 seconds (5 minutes 50 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected 2 DHCPREQUEST Messages from <DIface-0>

Time interval (65.437 sec) between
reception of last two DHCPREQUEST Messages 
is correctly  is within the range of 
(((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>) / 2)  -     <ParamToleranceTime>) to
        (((<REMOTE-CLIENT1-T2> - <REMOTE-CLIENT1-T1>)        (((<REMOTE   / 2)  +  <ParamToleranceTime>) second (45.000 to 85.000 sec)

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.5: Passed

>> DHCP-CLIENT-16.7
TEST_DESCRIPTION
If the lease expires before the client receives a DHCPACK, the client
moves to INIT state, MUST immediately stop any other network
processing and requests network initialization parameters as if the
client were uninitialized
(Note: In this test we verify that the DUT stops network processing
       after lease time expires)
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>+<ParamToleranceTime>) for the
        lease on the DUT to expire (*INVALID*)
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:143 mcast:0 errors:0 dropped:113
	TX packets:560 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:43724 (43 k)  TX bytes:102528 (102 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3056  lo0    0    
128.224.166.0/23                vxTarget                      UC       3551  gei2   0    
vxTarget                        vxTarget                      UH       14432 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       607544lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x96C8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2991703004 (0xB251C3DC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exi
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D41 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6D9F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2991703004 (0xB251C3DC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x74F4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2991703004 (0xB251C3DC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D40 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x6A9F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2991703004 (0xB251C3DC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 100.000 seconds) for the lease on the DUT to expire (*INVALID*)
t
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0E57 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.7: Passed

>> DHCP-CLIENT-16.8
TEST_DESCRIPTION
If the lease expires before the client receives a DHCPACK, the client
moves to INIT state, MUST immediately stop any other network
processing and requests network initialization parameters as if the
client were uninitialized
(Note: In this test we verify that the DUT requests network
 initialization 
       parameters after lease time expires)
TEST_REFERENCE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>+<ParamToleranceTime>) for the
        lease on the DUT to expire
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPDISCOVER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:147 mcast:0 errors:0 dropped:116
	TX packets:574 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:44488 (44 k)  TX bytes:105516 (105 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3064  lo0    0    
128.224.166.0/23                vxTarget                      UC       3580  gei2   0    
vxTarget                        vxTarget                      UH       14505 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       610574lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x45D1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3586978136 (0xD5CCF158)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

e
DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3E (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x1CA8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3586978136 (0xD5CCF158)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x23FD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3586978136 (0xD5CCF158)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3D (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x19A8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 3586978136 (0xD5CCF158)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 100.000 seconds) for the lease on the DUT to expire
xit
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0C82 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1808038461 (0x6BC47A3D)
DHCP: secs                      = 11
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> received expected DHCPDISCOVER Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.8: Passed

>> DHCP-CLIENT-16.10
TEST_DESCRIPTION
If the client is given a new network address, it MUST NOT continue 
using the previous network address
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.4.5 Page 41 'Reacquisition and expiration'
TEST_METHOD
 SETUP: Externally configure DHCP Client on <DIface-0>
- ANVL: Externally cause DUT to bring up <DIface-0>
- ANVL: DHCP Server <SERVER-1> Cause DUT to transit its state
        to BOUND
-  DUT: Transit finite state to BOUND
- ANVL: Wait till (<ParamLeaseTime>-<ParamToleranceTime>) for the
        lease on the DUT to almost expire
- ANVL: DHCP Server <SERVER-1> Sends DHCPACK Message to DUT through
        <DIface-0> containing :
        - Destination IP Address field set to
           <SERVER1-IP-POOL-0-1>(*INVALID*)
        - 'yiaddr' field set to <SERVER1-IP-POOL-0-1>
- ANVL:DHCP Server <SERVER-1> Sends ICMP Echo Message to DUT through
       <DIface-0> containing :
        - Destination Harware Address field set to
           <DIface-0-MAC-ADDRESS>
        - Destination IP Address field set to <SERVER1-IP-POOL-0-0>
- ANVL:DHCP Server <SERVER-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Reply Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


  DHCP Client topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <SERVER-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0
gei0	Link type:Ethernet  HWaddr 00:15:17:c8:90:28
	capabilities: TXCSUM TX6CSUM VLAN_MTU VLAN_TXHWTAG VLAN_RXHWTAG 
	inet6 unicast fe80::215:17ff:fec8:9028%gei0  prefixlen 64  automatic
	UP RUNNING SIMPLEX BROADCAST MULTICAST 
	MTU:1500  metric:1  VR:0  ifindex:23
	RX packets:150 mcast:0 errors:0 dropped:118
	TX packets:587 mcast:68 errors:0
	collisions:0 unsupported proto:0
	RX bytes:45192 (45 k)  TX bytes:108162 (108 k)

-> cmd route delete default
route: failed: errno = 0x33 (51)
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
localhost                       localhost                     UH       3072  lo0    0    
128.224.166.0/23                vxTarget                      UC       3602  gei2   0    
vxTarget                        vxTarget                      UH       14579 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       614744lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> cmd sysvar set -c ipnet.inet.AddressConflictDetect 1
sysvar: set failed : duplicate entry
-> exit
Au revoir!
Connection closed by foreign host.

Booting up DHCP client on the DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
BACKGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-boot-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"

Listening (up to 30.000 seconds) for DHCPDISCOVER Message on <DIface-0>
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ifconfig gei0 -dhcp
-> cmd ifconfig gei0 dhcp
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8316 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1217478991 (0x4891414F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 60 seconds (1 minute )
DHCP: --- Option 255 (End Option) ---

exit

DHCP Server <SERVER-1> sending DHCPOFFER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3C (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x59ED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1217478991 (0x4891414F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


Listening (up to 30.000 seconds) for DHCPREQUEST Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 128
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x39A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x6142 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1217478991 (0x4891414F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 61 (Client-identifier) ---
DHCP: Length                   = 18
DHCP: Value                    = 00 43 4F 4E 46 4F 52 4D 41 4E 43 45 2D 44 55 54
2D 30
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.2
DHCP: --- Option 57 (Maximum DHCP Size) ---
DHCP: Length                   = 2
DHCP: Value                    = 576
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 4
DHCP:   1 = Subnet Mask
DHCP:   6 = Domain Name Server
DHCP:  28 = Broadcast Address
DHCP:  42 = Network Time Protocol Servers
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D3B (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x56ED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1217478991 (0x4891414F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.2
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DUT successfully transited to BOUND state

Waiting (up to 60.000 seconds) for the lease on the DUT to almost expire
Au revoir!
Connection closed by foreign host.
Received ARP Request for 54.0.0.1 from 54.0.0.2

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 54.0.0.2
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 54.0.0.1
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 54.0.0.1

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 54.0.0.1
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 54.0.0.2
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Server <SERVER-1> sending DHCPACK Message to DUT through <DIface-0> containing :
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-1>(*INVALID*) (54.0.0.3) 
  - 'yiaddr' field set to <SERVER1-IP-POOL-0-1> (54.0.0.3) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 308 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x0D39 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.3
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 288 
UDP: Checksum         = 0x56EB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1217478991 (0x4891414F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 54.0.0.3
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 00:15:17:C8:90:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.0.0.0
DHCP: --- Option 28 (Broadcast Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.255.255.255
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 80 seconds (1 minute 20 seconds)
DHCP: --- Option 58 (Renewal (T1) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 40 seconds
DHCP: --- Option 59 (Rebinding (T2) Time Value) ---
DHCP: Length                   = 4
DHCP: Value                    = 70 seconds (1 minute 10 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 54.0.0.1
DHCP: --- Option 255 (End Option) ---


DHCP Server <SERVER-1> sending ICMP Echo Message to DUT through <DIface-0> containing :
  - Destination Harware Address field set to     <DIface-0-MAC-ADDRESS> (00:15:17:C8:90:28) 
  - Destination IP Address field set to     <SERVER1-IP-POOL-0-0> (54.0.0.2) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 44 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = ICMP (1)
IP: Header Checksum        = 0x0E51 (Correct)
IP: Source Address         = 54.0.0.1
IP: Destination Address    = 54.0.0.2
IP:
ICMP: ---- ICMP Packet ----
ICMP:
ICMP: Type             = 8 (Echo Request)
ICMP: Code             = 0 (0)
ICMP: Checksum         = 0x6B73 (Correct)
ICMP:
ICMP: ---- ICMP Echo Data ----
ICMP:
ICMP: Identifier       = 0x4141 (16705)
ICMP: Sequence Number  = 0x4141 (16705)
ICMP:
ICMP: --- Data [16 bytes] ---
ICMP:  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41   AAAAAAAAAAAAAAAA
ICMP: --- Data End ---
ICMP:
ICMP: ---- End of ICMP Packet ----
ETHER: --- Padding [2 bytes] ---
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 30.000 seconds) for no ICMP Echo Reply Message on <DIface-0>

DHCP Server <SERVER-1> correctly did not receive ICMP Echo Reply Message from <DIface-0>

Resetting all IP address settings on DUT for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/dhcp-client-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -co ipdhcpc.if.gei0.information_only "disable"
sysvar: ipdhcpc.if.gei0.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei0.information_only 
sysvar: ipdhcpc.if.gei0.information_only=disable
-> cmd sysvar set -co ipdhcpc.if.gei1.information_only "disable"
sysvar: ipdhcpc.if.gei1.information_only=disable ok
-> cmd sysvar get ipdhcpc.if.gei1.information_only
sysvar: ipdhcpc.if.gei1.information_only=disable
-> cmd sysvar set -co ipdhcpc.remove_existing_addresses "1"
sysvar: ipdhcpc.remove_existing_addresses=1 ok
-> cmd sysvar get ipdhcpc.remove_existing_addresses 
sysvar: ipdhcpc.remove_existing_addresses=1
-> cmd ifconfig gei0 -dhcp
-> cmd ipd reconfigure ipdhcpc
ipd: reconfigure ipdhcpc ok
-> exit
Au revoir!
Connection closed by foreign host.
<< DHCP-CLIENT-16.10: Passed
Executing system command:
  "./DocScriptQ35/DHCP-CLIENT/DHCPCpostsuite.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -o ipdhcpc.rfc2131_init_delay "1"
sysvar: ipdhcpc.rfc2131_init_delay=1 ok
-> cmd sysvar set -o ipdhcpc.option.lease_time "0"
sysvar: ipdhcpc.option.lease_time=0 ok
-> cmd sysvar unset ipdhcpc.option.requested_options 
sysvar: 'ipdhcpc.option.requested_options' unset ok
-> cmd sysvar unset ipdhcpc.if.gei0.information_only 
sysvar: 'ipdhcpc.if.gei0.information_only' unset ok
-> cmd sysvar unset ipdhcpc.if.gei1.information_only 
sysvar: 'ipdhcpc.if.gei1.information_only' unset ok
-> cmd ipd kill ipdhcpc
ipd: kill ipdhcpc ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          80
Number of tests passed:       79
Number of tests failed:       0
Number of tests inconclusive: 1
